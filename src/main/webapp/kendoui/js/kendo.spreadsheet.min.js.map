{"version":3,"sources":["kendo.spreadsheet.js"],"names":["f","define","kendo","UndoRedoStack","Observable","extend","init","options","fn","call","this","clear","events","push","command","stack","slice","currentCommandIndex","undo","canUndo","trigger","redo","canRedo","length","deepExtend","util","amd","a1","a2","a3","$","normalizeText","text","String","replace","REPLACE_REGEX","SPACE","objectKey","object","key","parts","sort","join","hashKey","str","i","hash","charCodeAt","zeroSize","width","height","baseline","measureText","style","measureBox","TextMetrics","current","measure","LRUCache","DEFAULT_OPTIONS","defaultMeasureBox","window","Class","size","_size","_length","_map","put","value","map","entry","_head","_tail","newer","older","get","baselineMarkerSize","document","createElement","cssText","_cache","styleKey","cacheKey","cachedResult","baselineMarker","textStr","box","_baselineMarker","cloneNode","textContent","appendChild","body","offsetWidth","offsetHeight","offsetTop","parentNode","removeChild","marker","jQuery","sqr","renderSize","renderPos","pos","result","toHyphens","split","arabicToRoman","n","literals","1","10","100","2","20","200","3","30","300","4","40","400","5","50","500","6","60","600","7","70","700","8","80","800","9","90","900","1000","values","roman","shift","romanToArabic","r","digits","prev","v","toLowerCase","x","l","c","d","m","charAt","memoize","cache","Object","create","id","arguments","apply","isUnicodeLetter","ch","RX_UNICODE_LETTER","test","now","Date","getTime","RegExp","CODE","out","UCS2","code","parse","data","callbacks","readChar","index","croak","msg","Error","readWhile","pred","a","readAsciiWhile","STRING","skipWhitespace","isWhitespace","eat","save","skip","isDigit","isHexDigit","isNameStart","isName","xmlComment","END_COMMENT","xmlTag","name","attrs","QUESTION_MARK","xmlDecl","START_COMMENT","xmlName","xmlAttrs","END_SHORT_TAG","GREATER_THAN","xmlContent","pop","END_TAG","START_CDATA","END_CDATA","LESS_THAN","AMPERSAND","xmlEntity","xmlString","quote","QUOTE","APOSTROPHE","SHARP","LOWERCASE_X","UPPERCASE_X","parseInt","isNaN","ENTITIES","undefined","SEMICOLON","END_DECLARATION","$tag","EQUAL","what","thing","arg1","arg2","is","selector","j","exit","EXIT","tmp","fromCharCode","amp","lt","gt","quot","apos","nbsp","parseXML","ex","copyToClipboard","html","textarea","addClass","val","appendTo","focus","select","execCommand","remove","Command","TargetValueCommand","PropertyChangeCommand","ApplyFilterCommand","DeleteCommand","AddCommand","NameCommand","support","browser","msie","version","spreadsheet","_workbook","workbook","_property","property","_state","range","_setRange","_range","exec","setState","getState","state","_forEachCell","callback","ref","_ref","forEach","sheet","toRangeRef","bind","_target","target","_value","ColumnWidthCommand","columnWidth","RowHeightCommand","rowHeight","HyperlinkCommand","_link","link","_prevLink","_prevUnderline","underline","_hasSetValue","GridLinesChangeCommand","showGridLines","prototype","skipHiddenCells","enable","ClearContentCommand","clearContent","reason","type","EditCommand","rejectState","validationState","title","message","input","wrap","_adjustRowHeight","_getValidationState","calc","ParseError","TextWrapCommand","forEachRow","topLeft","row","_rowHeight","AdjustDecimalsCommand","_decimals","decimals","formatting","batch","forEachCell","col","cell","format","adjustDecimals","BorderChangeCommand","_type","border","_style","_batch","self","noBorders","insideBorders","outsideBorders","allBorders","leftBorder","leftColumn","borderLeft","rightBorder","rightColumn","borderRight","topBorder","topRow","borderTop","bottomBorder","bottomRow","borderBottom","insideHorizontalBorders","insideVerticalBorders","MergeCellCommand","activate","activeCell","unmerge","cells","merge","horizontally","vertically","forEachColumn","FreezePanesCommand","_topLeft","panes","frozenColumns","frozenRows","rows","columns","unfreeze","PasteCommand","_clipboard","clipboard","_event","event","activeSheet","pasteRef","status","preventDefault","canPaste","selection","paste","menuInvoked","pasteOnMerged","overflow","pasteOnDisabled","AdjustRowHeightCommand","rowIndex","ToolbarPasteCommand","_view","CopyCommand","noop","canCopy","copy","multiSelection","ToolbarCopyCommand","CutCommand","cut","AutoFillCommand","origin","_origin","fillFrom","Range","FillError","ToolbarCutCommand","FilterCommand","filter","hasFilter","SortCommand","column","ascending","expandRange","cantSort","_sheetRef","clearFilter","filterRule","exists","valueFilter","ValueFilter","customFilter","CustomFilter","eq","element","ClearFilterCommand","HideLineCommand","axis","setAxisState","getAxisState","axisManager","hideSelectedRows","hideSelectedColumns","UnHideLineCommand","unhideSelectedRows","unhideSelectedColumns","_expandedRange","_expand","_indexes","_exec","_undoOne","_restoreModifiedFormulas","formulas","layout","recalc","DeleteRowCommand","resize","left","Infinity","right","deleteSelectedRows","insertRow","DeleteColumnCommand","top","bottom","deleteSelectedColumns","insertColumn","_pos","count","base","AddColumnCommand","preventAddColumn","addColumnLeft","addColumnRight","deleteColumn","AddRowCommand","preventAddRow","addRowAbove","addRowBelow","deleteRow","EditValidationCommand","validation","OpenCommand","cannotUndo","file","match","fromFile","then","errors","excelImportErrors","openDialog","SaveAsCommand","fileName","extension","saveAsExcel","saveAsPDF","pdf","_name","nameDefinition","DefineNameCommand","defineName","DeleteNameCommand","undefineName","classNames","FormulaBar","wrapper","ui","Widget","formulaInput","FormulaInput","destroy","isOpenParen","isCloseParen","isMatchingParen","close","open","touches","begin","end","knownFunction","runtime","FUNCS","isEqualToken","tok1","tok2","ns","keys","styles","KEY_NAMES","PRIVATE_FORMULA_CHECK","listWrapper","27","37","39","35","36","32","attr","css","autoScale","on","scale","_highlightedRefs","_staticTokens","_formulaSource","_formulaList","_popup","_tooltip","_keydown","_keyup","_blur","_input","_focus","_paste","filterOperator","scalePadding","minLength","removeAttr","toggleClass","getPos","lookup","lookupNode","loop","node","nodeType","firstChild","nextSibling","nodeValue","div","sel","getSelection","focusNode","focusOffset","b","anchorNode","anchorOffset","collapsed","setPos","differ","startOffset","endOffset","startContainer","endContainer","len","el","currentRange","eiv","createRange","setStart","setEnd","getRangeAt","removeAllRanges","addRange","home","toUpperCase","formulaSource","DataSource","list","StaticList","insertAfter","autoBind","selectable","change","_formulaListChange","dataSource","dataValueField","template","e","activeToken","completion","ctx","tokenCtx","_tokenContext","_mute","token","nextToken","_replaceAt","popup","Popup","anchor","clearTimeout","_focusId","_isFormula","keyCode","_navigated","_move","_keyDownTimeout","setTimeout","_syntaxHighlight","view","visible","focusFirst","_focusTimeout","ev","clipboardData","getData","originalEvent","substr","DOWN","focusNext","UP","focusPrev","focusLast","ENTER","TAB","PAGEUP","PAGEDOWN","tokens","tok","point","tokenize","_sync","_editorToSync","isActive","_textContainer","computedStyles","getComputedStyles","position","visibility","whiteSpace","_span","_cellTooltip","tooltip","toggleTooltip","show","toggle","_activeElement","field","operator","hide","rectangle","canInsertRef","isKeyboardAction","idx","_canInsertRef","afterPoint","canReplace","canInsertBetween","strictMode","refAtPoint","simplify","clone","relative","setSheet","print","newValue","rest","syncWith","iehandler","eventName","handler","off","txt","innerText","highlightedRefs","refClasses","Pane","series","refIndex","parens","active","cls","colorClass","unshift","reverse","htmlEncode","substring","_setStaticTokens","insertNewline","eof","Mac","isAlphaNum","keyName","EventListener","13","38","33","34","46","113","navigator","platform","indexOf","observer","handlers","_handlers","_observer","keyDownProxy","keyDown","mouseProxy","mouse","threshold","_pressLocation","documentElement","handleEvent","rightClick","dx","dy","distance","which","button","pageX","y","pageY","Math","sqrt","catchAllHandler","eventKey","mod","metaKey","ctrlKey","altKey","shiftKey","skew","level","temp","insert","NilNode","RangeTreeNode","start","diff","heir","intersecting","ranges","intersects","tree","root","RangeTree","RangeList","Iterator","SparseRangeList","findrange","first","last","firstRange","lastRange","rangeValue","rangeStart","rangeEnd","expandedValues","rangeIndex","sortedIndices","valueComparer","indices","comparer","sourceStart","sourceEnd","targetStart","iterator","unique","at","lastRangeStart","ValueRange","toExcelFormat","cloneFormulaValue","deepClone","cloneFormulaTree","Property","JsonProperty","ValueProperty","set","dst","JSON","stringify","formats","dateToNumber","culture","calendar","patterns","PropertyBag","specs","sortable","serializable","depends","rowCount","columnCount","defaultValues","cellCount","properties","lists","spec","prop","formula","fromJSON","si","iter","iterators","reduce","ret","addBorder","hBorders","leftBorders","rightBorders","forEachProperty","ALL_PROPERTIES","columnName","colIndex","letter","floor","displaySheet","displayRef","rel","aa","isFinite","Ref","NULL","NameRef","CellRef","RangeRef","UnionRef","hasSheet","_hasSheet","absolute","adjust","toString","obj","intersect","isCell","toRow","toColumn","rangeAt","nextRangeIndex","previousRangeIndex","reference","refs1","refs2","r1","r2","bottomRight","single","refs","concat","replaceAt","forEachColumnIndex","forEachAxisIndex","forEachRowIndex","sorted","method","valid","renameSheet","oldSheetName","newSheetName","display","trow","tcol","abs","arow","acol","forRow","delta","tl","br","endSheet","normalize","_containsRange","_containsCell","contains","Array","that","some","_intersectRange","a_left","a_top","a_right","a_bottom","b_left","b_top","b_right","b_bottom","max","min","c1","c2","rr1","rc1","rr2","rc2","changes","relTL","relBR","collapse","toCell","startRow","endRow","startCol","endCol","union","topLeftRow","topLeftCol","bottomRightRow","bottomRightCol","modified","num","limit","move","cols","tr","u","empty","theRef","newRefs","splice","NULLREF","SHEETREF","FIRSTREF","AutoFillCalculator","grid","_grid","rectIsVertical","startRect","endRect","autoFillDest","cursor","quadrant","pivot","opposite","cornerResult","expanding","bottomLeft","topRight","lower","further","EdgeNavigator","SheetNavigator","rangeGetter","prevLeft","prevVisible","nextRight","nextVisible","nextLeft","prevRight","boundary","_sheet","_columns","autoFillCalculator","colEdge","columnRange","rowEdge","_rows","rowRange","_viewPortHeight","unionWithMerged","leftCol","rightCol","selectionIncludesMergedCells","_mergedCells","setSelectionValue","selectAll","mode","addToExisting","refForMode","rowRef","colRef","startSelection","startAutoFill","completeSelection","selectForContextMenu","modifySelection","action","scrollInto","newSelection","direction","determineDirection","viewPortHeight","originalSelection","currentOriginalSelectionRange","prevPage","nextPage","firstVisible","lastVisible","updateCurrentSelectionRange","moveActiveCell","originalActiveCell","navigateInSelection","currentNavigationRange","selTopLeft","selBottomRight","done","nextNavigationRange","previousNavigationRange","shouldSkip","singleCellSelection","extendSelection","resizeAutoFill","isMerged","forEachMergedCell","merged","hint","preview","props","_autoFillOrigin","dest","punch","_previewFillFrom","updateAutoFill","currentSelectionRange","leftMode","rightMode","topMode","bottomMode","originalSelect","selectionRangeIndex","subset","bottomCol","AxisManager","forEachSelectedColumn","forEachSelectedRow","includesHiddenColumns","includesHidden","includesHiddenRows","selectionIncludesHiddenColumns","selectionIncludesHiddenRows","indexes","_saveModifiedFormulas","hasRight","hasLeft","hideColumn","_count","isHiddenColumn","hasBottom","hasTop","hideRow","isHiddenRow","unhideColumn","unhideRow","preventInsertRow","preventInsertColumn","newState","mergedCells","foreign","origRef","setStateData","stripStyle","borderObject","color","cellState","getComputedStyle","borders","fontSize","background","italic","bold","textAlign","verticalAlign","parseHTML","table","ri","ci","td","rowSpan","colSpan","dr","dc","parseTSV","Clipboard","_content","_externalContent","_internalContent","iframe","className","_uid","guid","intersectsMerged","plain","destination","originActiveCell","rowDelta","colDelta","triggerChange","external","isExternal","_isInternal","doc","contentWindow","write","querySelector","internalHTML","internalPlain","find","partition","predicate","looksLikeANumber","getTextHeight","font-size","word-break","white-space","PROPERTIES","skipHiddenRows","skipHiddenCols","_normalize","_set","noTrigger","_get","_resizedRef","t1","t2","existingFormat","existingFormatType","compile","currency","editorChange","isInEditMode","numberToDate","_","__","toJSON","_validation","_merge","mergedRef","vi","_properties","setProp","line","propName","propValue","clearAll","contentsOnly","formatOnly","keepBorders","clearFormat","isSortable","mc","primary","secondary","cant","_getMergedCells","hasMerged","_sortBy","isFilterable","clearFilters","_filterBy","_filter","intersectingMerged","propertyName","Formula","Validation","internalClipboard","externalClipboard","maxHeight","cellRange","totalWidth","hasValue","yesItHas","defStyle","_defaultCellStyle","flag","draw","each","CalcError","argmax","sameRef","constructor","compileArgumentChecks","functionName","args","comp","allowError","isArray","arrayArgs","resolve","cond","force","canBeArrayArg","hasArrayArgs","typeCheck","forced","haveForced","forceNum","round","err","main","Function","roundFloatErrors","integer","ceil","decimal","maybeRoundFloatErrors","withErrorHandling","makeSyncFunction","check","doit","xargs","Matrix","arrays","makeAsyncFunction","makeCallback","defineFunction","func","log","console","kendoSpreadsheetArgs","argsAsync","dateToJulianDays","julianDaysToDate","jd","year","month","date","day","ord","ORDINAL_ADD_DAYS","isLeapYear","yr","daysInYear","daysInMonth","mo","DAYS_IN_MONTH","unpackDate","serial","BASE_DATE","packDate","unpackTime","ms","hours","minutes","seconds","frac","MS_IN_DAY","MS_IN_HOUR","MS_IN_MIN","milliseconds","serialToDate","t","packTime","hh","mm","ss","dateToSerial","time","getHours","getMinutes","getSeconds","getMilliseconds","getFullYear","getMonth","getDate","parseDate","parseExactDate","binaryCompare","exports","Context","NUMBER_OR_ZERO","ARGS_NUMERIC","ARGS_ANYVALUE","parent","resolveCells","_resolve","error","asMatrix","onFormula","fetch","context","pending","add","getRefCells","cellValues","getRefData","fetchName","nameValue","ValidationFormulaContext","fname","bool","h","isRange","hiddenInfo","includeEmpty","eachRow","eachCol","mapRow","mapCol","transpose","unit","multiply","s","va","vb","adds","sign","determinant","C","L","k","inverse","imax","augment","printer","absrefs","onReady","forceRefs","lcsheet","parentContext","next","reset","affectedSheet","operation","formulaMoves","formulaRow","formulaCol","newFormulaRow","newFormulaCol","formulaSheet","prevRefs","newRef","co","th","comatrix","thmatrix","elmatrix","limitPrecision","defineAlias","alias","orig","kendoSpreadsheetAliases","pow","compileValidation","validationHandler","parsedFromDate","parsedToDate","from","dataType","fromIsListValue","TRANSPOSE_FORMAT","DATE_FORMAT","fromIsDateValue","parseFormula","to","toIsDateValue","validationComparers","custom","comparerType","valueToCompare","toValue","to_value","allowNulls","from_value","_getListData","showButton","tooltipMessageTemplate","tooltipTitleTemplate","messageTemplate","titleTemplate","_formatMessages","fromFormula","toFormula","_setMessages","tooltipTitle","tooltipMessage","cube","array","_getOptions","compareValue","compareFormat","getValue","calculateFromCallBack","prevFrom","prevTo","greaterThan","lessThan","between","equalTo","notEqualTo","greaterThanOrEqualTo","lessThanOrEqualTo","notBetween","MODIFIED_FORMULAS","Selection","Sheet","_activeCell","currentOriginalNavigationRange","expanded","changeActiveCell","triggerSelect","_reinit","headerHeight","headerWidth","defaultCellStyle","fontFamily","Axis","_frozenRows","_frozenColumns","_suspendChanges","_showGridLines","_gridLinesColor","Grid","_sorter","Sorter","_viewSelection","_editSelection","_formulaSelections","_selectionState","_inEdit","_navigator","_axisManager","_sheetName","accessor","_field","suspendChanges","setDataSource","dataSourceBinder","SheetDataSourceBinder","columnIndex","unhide","hidden","_copyRange","sourceRangeRef","targetRef","nextRefTopLeft","nextRefBottomRight","nextIndex","nextBottomIndex","targetIndex","wb","sheetByName","cellRefIndex","_adjustReferences","_sheets","_forFormulas","_forValidations","adjustNames","selectedHeaders","allRows","allCols","nextRef","isEnabledRow","isEnabledColumn","gridLinesColor","numRows","numColumns","parseReference","cellRef","forEachFilterHeader","columnRef","doIt","startCellIndex","endCellIndex","startResizing","initialPosition","_initialPosition","_resizeInProgress","_autoFillInProgress","_autoFillDest","_autoFillPunch","_autoFillHint","_autoFillDirection","autoFillRef","autoFillPunch","autoFillInProgress","resizingInProgress","completeResizing","hintPosition","handlePosition","resizeHintPosition","resizeHandlePosition","_resizeHandlePosition","location","_resizeHintPosition","removeResizeHandle","positionResizeHandle","_selectionInProgress","operatingRange","selectionInProgress","expandedRef","selectionState","isAxis","trim","trims","activeCellSelection","maxRow","maxCol","rowSelection","colSelection","rowState","colState","all","isInEdit","_setFormulaSelections","_viewActiveCell","clearDefaultStyle","json","positions","viewSelection","hyperlinks","parseColor","toCss","_sort","activeCellRef","_compileFormula","_compileValidation","Filter","_refreshFilter","logToConsole","_refresh","resetFormulas","resetValidations","revalidate","_copyValuesInRange","suspended","sortBy","prepare","matches","filterColumn","filterRef","_clearFilter","ALL_REASONS","currentRef","outerWidth","DOT","EMPTYCHAR","sheetsBarClassNames","SheetsBar","_outerWidth","sheetsBarWrapper","sheetsBarSheetsWrapper","sheetsBarActive","sheetsBarInactive","sheetsBarAdd","sheetsBarRemove","sheetsBarItems","sheetsBarEditor","sheetsBarScrollable","sheetsBarNext","sheetsBarPrev","sheetsBarKItem","sheetsBarKActive","sheetsBarKTextbox","sheetsBarKLink","sheetsBarKIcon","sheetsBarKFontIcon","sheetsBarKButton","sheetsBarKButtonBare","sheetsBarKArrowW","sheetsBarKArrowE","sheetsBarKReset","sheetsBarKIconX","sheetsBarKSprite","sheetsBarKIconPlus","sheetsBarHintWrapper","sheetsBarKResetItems","_openDialog","_tree","dom","Tree","render","_addButton","_createSheetsWrapper","_toggleScrollEvents","_createSortable","_sortable","_onSheetReorderStart","_onSheetReorderEnd","_onSheetRemove","_onSheetSelect","_createEditor","_onAddSelect","scrollable","_editor","_renderSheets","_selectedIndex","_onEditorKeydown","_onEditorBlur","_destroyEditor","canceled","_onSheetRename","renderSheets","sheets","selectedIndex","wrapperOffsetWidth","sheetsGroupScrollWidth","sheetsWrapper","scrollPrevButton","scrollNextButton","gapWidth","addButton","addButtonWidth","scrollPrevButtonWidth","sheetsGroup","scrollNextButtonRight","_isRtl","isRtl","_renderHtml","_scrollableAllowed","_sheetsWrapper","children","_sheetsGroup","marginLeft","scrollWidth","parseFloat","_scrollableModeActive","_nowScrollingSheets","marginRight","_toggleScrollButtons","ul","scrollLeft","_scrollSheetsByDelta","renderScrollButtons","isSelectedSheet","elementContent","deleteIcon","sheetElements","maxlength","baseButtonClass","childrenElements","Sortable","container","animation","ignore","draggable","closest","oldIndex","newIndex","closeCallback","removedSheetName","dlg","sender","isConfirmed","confirmation","selectedSheetText","_scrollSheetsToItem","isAddButton","sheetIndex","item","currentScrollOffset","itemWidth","itemOffset","sheetsGroupWidth","sheetsGroupPadding","itemPosition","finish","animate","scrLeft","getcol","getrow","noThrow","stream","OUT","TokenStream","addReference","allowEOF","peek","parseExpression","commas","maybeBinary","maybeIntersect","parseAtom","parseSymbol","upper","TRUE","FALSE","parseFuncall","fixReference","exp","parseArray","op","maybePercent","my_prec","his_prec","OPERATORS","ast","parseNameDefinition","def","defAST","nameRef","makeFormula","makePrinter","prec","withParens","needParens","parenthesize","arg","makeClosure","toCPS","cps","cpsRef","cpsAtom","cpsUnary","cpsBinary","cpsFunc","cpsLambda","cpsMatrix","cpsNameRef","makeContinuation","cpsIf","thenK","gensym","elseK","vars","cpsAnd","cpsOr","cont","elements","isMatrix","GENSYM","js","jsArray","FORMULA_CACHE","identity","readNext","ahead","refRange3D","refCell3D","refSheetRange","refSheetCell","refRange","refCell","funcall","isFirst","forEditor","fixCell","g","space","addPos","RawTokenStream","InputStream","startToken","endToken","isIdStart","isId","isOpChar","isPunc","readNumber","has_dot","number","symbol","getRC","readSymbol","lookingAt","readString","readEscaped","readSheetName","readOperator","readPunc","EOF","forward","escaped","rx","parseSqref","getNumberRegexp","comma","dot","NUMBER_FORMAT_RX","repeat","FORMAT_PARSERS","registerFormatParser","ops","p","numberFormat","rxnum","rxcur","suffix","has_currency","readExcel","deferred","reader","FileReader","onload","zip","JSZip","readWorkbook","readAsArrayBuffer","xl","progress","strings","relationships","theme","items","loading","ERROR_LOG","readStrings","readRelationships","readTheme","byType","readStyles","enter","tag","relId","dim","SEL_SHEET","byId","sheetDimensions","SEL_VIEW","activeTab","localSheetId","SEL_DEFINED_NAME","vbProcedure","withErrorLog","Deferred","notify","recalcSheets","loadSheets","ready","promise","insertSheet","queueSheet","readSheet","defaultColWidth","toColWidth","defaultRowHeight","toRowHeight","SEL_ROW","maximumDigitWidth","fraction","pts","formulaRange","formula1","formula2","customFilterLogic","customFilterCriteria","valueFilterBlanks","valueFilterValues","nCols","prevCellRef","relsFile","filters","styleIndex","stop","acRef","SEL_CELL","applyStyle","SEL_MERGE","SEL_COL","ht","SEL_SELECTION","SEL_PANE","xSplit","ySplit","SEL_SHEET_VIEW","SEL_HYPERLINK","colId","and","getCustomFilter","DynamicFilter","dynamicFilterType","TopFilter","getFilterVal","percent","blank","leave","failed","SEL_VALIDATION","sqref","showErrorMessage","MAP_EXCEL_OPERATOR","allowBlank","showDropDown","errorTitle","logic","criteria","blanks","SEL_VALUE","SEL_STRING","SEL_FORMULA","SEL_VALIDATION_FORMULA1","SEL_VALIDATION_FORMULA2","ourOp","equal","notEqual","greaterThanOrEqual","lessThanOrEqual","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","setFormat","formatCode","setFill","setFont","setBorder","side","BORDER_WIDTHS","shouldSet","applyName","xf","inlineStyles","xfId","namedStyles","fonts","fills","numFmts","DEFAULT_FORMATS","part","files","asUint8Array","SEL_SHARED_STRING","SEL_TEXT","entries","Id","Target","Type","getXf","addBool","borderId","fillId","fontId","numFmtId","pivotButton","quotePrefix","getColor","themeColor","tint","rgb","toCSSColor","indexed","INDEXED_COLORS","colorScheme","toHSL","toCssRgba","font","fill","closed","SEL_NUM_FMT","SEL_FONT","SEL_FILL","patternType","SEL_BORDER","SEL_NAMED_STYLE","SEL_INLINE_STYLE","horizontal","vertical","wrapText","swap","arr","scheme","SEL_SCHEME_SYSCLR","SEL_SCHEME_RGBCLR","none","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantDashDot","0","11","12","14","15","16","17","18","19","21","22","45","47","48","49","_readSheet","_readStrings","_readStyles","_readTheme","_readWorkbook","sheetParamsFromJSON","or","Workbook","_sheetsSearchCache","undoRedoStack","_onUndoRedo","_context","FormulaContext","_validationContext","_names","unbind","_sheetChange","_sheetInsertRow","_sheetInsertColumn","_sheetDeleteRow","_sheetDeleteColumn","_sheetHideRow","_sheetHideColumn","_sheetUnhideRow","_sheetUnhideColumn","_sheetSelect","_sheetCommandRequest","_inputForRef","execute","commandOptions","editActiveCell","refresh","moveSheetToIndex","toIndex","fromIndex","sheetSelection","insertIndex","sheetName","getUniqueSheetName","sheetNameSuffix","_bindSheetEvents","sheetByIndex","forEachName","nameref","removeSheet","newSheet","_clearSheets","names","localName","reject","excel","ooxml","saveAs","dataURI","toDataURL","proxyURL","forceProxy","group","nameForRef","PDFMixin","_drawPDF","drawing","exportPDF","proxyTarget","fail","area","fsheet","frow","fcol","states","currentFormula","_formulaContextRefresh","toActionSelector","selectors","alphaNumRegExp","ACTIONS","ENTRY_ACTIONS","CONTAINER_EVENTS","CLIPBOARD_EVENTS","EDITOR_EVENTS","FORMULABAR_EVENTS","FORMULAINPUT_EVENTS","SELECTION_MODES","COMPOSITE_UNAVAILABLE_ACTION_SELECTORS","UNHIDE_ACTION_SELECTORS","ACTION_KEYS","SHIFT_ACTION_KEYS","ENTRY_ACTION_KEYS","Controller","up","down","ctrl+left","ctrl+right","ctrl+up","ctrl+down","ctrl+home","ctrl+end","pageup","pagedown","tab","shift+tab","shift+enter","delete","backspace","shift+:alphanum",":alphanum","ctrl+:alphanum","alt+ctrl+:alphanum",":edit","wheel","*+mousedown","contextmenu","*+mousedrag","*+mouseup","*+dblclick","mousemove","mouseup","*+cut","*+paste","*+copy","esc","alt+enter","rowheader","columnheader","topcorner","autofill","clipboardElement","cellContextMenu","rowHeaderContextMenu","colHeaderContextMenu","scroller","tabstrip","sheetsbar","nameEditor","onNameEditorEnter","onNameEditorCancel","onNameEditorSelect","onNameEditorDelete","editor","onEditorChange","onEditorActivate","onEditorDeactivate","onEditorUpdate","onScroll","listener","_enableEditorEvents","onSheetBarSelect","onSheetBarReorder","onSheetBarRename","onSheetBarRemove","onContextMenuSelect","onCommandRequest","onDialogRequest","keyListener","barKeyListener","barElement","inputKeyListener","cellElement","_execute","editorClose","_preventNavigation","showError","activateEditor","_lastEditorValue","_activeTooltip","clientHeight","isEditorDisabled","onWheel","deltaX","deltaY","deltaMode","scrollWith","onAction","onPageUp","scrollDown","onPageDown","onEntryAction","shouldPrevent","disabled","onShiftAction","appendSelection","onMouseMove","objectAt","onMouseDown","pane","originFrame","onEditorEsc","openCustomEditor","_selectionMode","deactivate","openFilterMenu","onContextMenu","menu","isComposite","showUnhide","showUnmerge","prevent","constrainResize","resizeHandle","onMouseDrag","frame","clientX","clientY","startAutoScroll","selectToLocation","scrollTop","onMouseUp","stopAutoScroll","activeEditor","onDblClick","rect","activeCellRectangle","onCut","detach","append","clipBoardValue","onPaste","hasHTML","hasPlainText","DOMStringList","types","onCopy","scrollRight","getBoundingClientRect","cellLocation","lastKnownCellLocation","autoScroll","_autoScrollTarget","boundaries","scrollStep","finalLocation","viewObject","_scrollInterval","setInterval","clearInterval","filterMenu","createFilterMenu","openFor","onEditorBarFocus","onEditorCellFocus","resetEditorValue","onEditorBlur","isFiltered","onEditorAction","onEditorShiftAction","deactivateEditor","additionalOptions","pdfExport","excelExport","selectElementContents","selectNodeContents","cellBefore","trs","cellAbove","prevRow","cellBorder","asURL","drawCell","collection","showGrid","maybeLink","textDecoration","href","defaultBorder","shouldDraw","toHSV","outline","backgroundColor","fontStyle","fontWeight","overflowWrap","wordWrap","__dataType","paneClassNames","addCell","sibling","wordBreak","borderRightColor","borderBottomColor","borderLeftColor","borderTopColor","within","RESIZE_HANDLE_WIDTH","viewClassNames","HtmlTable","CELL_CONTEXT_MENU","ROW_HEADER_CONTEXT_MENU","COL_HEADER_CONTEXT_MENU","VIEW_CONTENTS","View","fixedContainer","editContainer","viewSize","cellEditor","barEditor","topCorner","filterHeadersWrapper","filterRange","filterButton","filterButtonActive","horizontalResize","verticalResize","icon","iconFilterDefault","sheetsBar","messages","nameBox","openUnsupported","shiftingNonblankCells","insertColumnWhenRowIsSelected","insertRowWhenColumnIsSelected","filterRangeContainingMerges","sortRangeContainingMerges","cantSortMultipleSelection","cantSortNullRef","cantSortMixedCells","validationError","cannotModifyDisabled","tabs","_height","_width","addColumn","addRow","Node","toDomTree","offset","ContextMenu","contextMenuConfig","scrollbar","_chrome","_dialogs","_formulaInput","clipboardContents","SheetEditor","_sheetsbar","showOn","clientWidth","enableClipboard","isClipboardDeactivated","_resize","outerHeight","_outerHeight","tabstripHeight","formulaBarHeight","formulaBar","sheetsBarHeight","quickAccessAdjust","prependTo","NameEditor","toolbar","_tabstrip","content","TabStrip","dataTextField","dataContentField","toolbarOptions","_executeCommand","cellRectangle","_rectangle","boundingRectangle","isColumnResizer","handleWidth","_headerWidth","isRowResizer","_headerHeight","isFilterIcon","theGrid","frozen","filterIconRect","isAutoFill","isEditButton","editorOnLastColumn","ed","activeCellCustomEditor","selecting","paneAt","indexVisible","containingPane","refreshTools","totalHeight","_pane","_destroyFilterMenu","_filterMenu","FilterMenu","selectClipBoardContents","scrollIntoView","willScroll","scrollBoundaries","scrollBottom","_destroyDialog","edit","dialog","dialogs","reopenEditor","dialogOptions","errorMessages","focusButton","ESC","onClose","_retry","registered","_filterMenuColumn","resizeDirection","renderResizeHint","renderClipboardContents","resizeHint","resizeHintVertical","resizeHintHandle","resizeHintMarker","selectionView","primaryMergedCells","secondaryMergedCells","rangeDimensions","mergedCell","colspan","rowspan","vaxis","haxis","vborder","hborder","rowHeader","columnHeader","mergedCellsWrapper","selectionWrapper","autoFillWrapper","columnResizeHandle","rowResizeHandle","selectionHighlight","isVisible","paneClasses","_currentView","_currentRect","_selectedHeaders","renderData","renderSelection","renderAutoFill","renderEditorSelection","renderFilterHeaders","hasRowHeader","rowOffset","headerClassName","hasColumnHeader","columnOffset","renderResizeHandle","itemSelection","allHeaders","doLayout","forScreen","xCoords","borderColor","yCoords","Borders","vert","rendered","borderWidth","transform","horiz","BUTTON_SIZE","BUTTON_OFFSET","Rectangle","filtered","classes","_addDiv","selections","activeCellClasses","selectionClasses","activeFormulaColor","_activeFormulaColor","_directionClasses","_addTable","cssClass","autoFillRectangle","toDiv","_axis","btnClass","isLastColumn","btn","activeFormulaSelection","colorClasses","cellClasses","mergedCellLeft","mergedCellTop","EDITORS","registerEditor","kendoCalendar","kendoPopup","getKendoCalendar","getKendoPopup","setOptions","Calendar","disableDates","kendoStaticList","getKendoStaticList","matrix","read","PaneGrid","sum","total","PaneAxis","rangeRef","headerSize","hasHeader","paneSegment","_viewSize","widthCompensation","defaultValue","heightCompensation","_hidden","scrollBarSize","pageSize","firstHidden","lastHidden","startIndex","endIndex","startSegment","endSegment","lastPage","_pixelValues","_start","quarter","sameYear","today","setFullYear","sameMonth","firstDayOfMonth","setMonth","sameWeek","firstWeek","secondWeek","dayOfWeek","_values","_dates","_blanks","dates","_logic","_criteria","expression","Query","filterExpr","_matches","criterionValue","criterionType","valueType","_predicate","_average","aboveAverage","belowAverage","tomorrow","addDays","isToday","yesterday","nextWeek","thisWeek","lastWeek","nextMonth","thisMonth","lastMonth","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","yearToDate","cultures","months","_lists","ascendingComparer","descendingComparer","li","typeA","typeB","localeCompare","maybeColor","RX_COLORS","maybeCondition","RX_CONDITION","readFormat","maybeFraction","sep","decimalPart","ampm","am","pm","readSection","sections","haveConditional","sec","printSection","printToken","fmt","padLeft","adjusted","restart","compileFormatPart","checkComma","scaleCount","hasDate","hasTime","hasAmpm","percentCount","separeThousands","declen","intFormat","decFormat","condition","preamble","CACHE","TEXT","calendars","standard","days","namesAbbr","fraclen","toFixed","eltime","formatInt","iv","chf","formatDec","intpart","decpart","span","textAndColor","_cosh","_sinh","_tanh","_gcd","_lcm","forIFS","chunks","parseCriteria","COL","_avg","numbers","_var_sp","divisor","avg","_stdev_sp","_percentrank","exc","nlt","ngt","found","_covariance","ax","ay","_percentile","rank","_percentile_inc","_percentile_exc","fetchValuesForAggregate","opt_ignore_hidden_rows","opt_ignore_errors","opt_use_aggregates","fetchValues","_binom_dist","cumulative","_combinations","weeksInYear","_days_360","d1","d2","Hyperlink","numericPredicate","descending","ARGS_COUNTIFS","ARGS_SUMIFS","ARGS_SUMIF","ARGS_PERCENTRANK","_fact","AGGREGATE_FUNCS","RX_NON_PRINTABLE","PI","rad","deg","cos","sin","atan","tan","mult","prod","coef","seen","m1","sumRange","nth","res","discard","bins","asc","variance","stddev","significance","fact","f1","f2","p1","p2","funcId","ignoreHidden","alpha","s2","approx","resultCol","areanum","colRange","cmp","resultRow","fw","sy","dow","wk","holidays","inc","random","rom","radix","minLen","dec","string","noCommas","newText","oldText","valueIfError","makeComparator","lc","compLT","compLTE","compGT","compGTE","compNE","compEQ","RXCACHE","ERF","S","an","f_abs","ERFC","GAMMALN","cof","ser","GAMMA","pi","BETALN","BETA","gamma_inc","g_series","g_contfrac","ap","gln","MAX_IT","EPS","FP_MIN","aj","bj","GAMMA_DIST","GAMMA_INV","M","ab","q","NORM_S_DIST","NORM_S_INV","plow","phigh","NORM_DIST","NORM_INV","betastd_pdf","betastd_cdf","beta_lentz","m2","del","qab","qap","qam","betastd_inv","BETADIST","BETA_DIST","cdf","BETA_INV","chisq_left","cds","chisq_right","chisq_left_inv","chisq_right_inv","chisq_test","obsv","expect","eij","expon","poisson","lnf","Fdist","Fdist_right","Finv_right","Finv","_mean","me","_var_sq","Ftest","arr1","arr2","n1","n2","va1","va2","fisher","fisherinv","e2","Tdist","Tdist_right","Tdist_2tail","Tdist_inv","Tdist_2tail_inv","Tdist_test","gr1","gr2","tail","t_st","df","md","v1","v2","u1","u2","q1","q2","confidence_t","confidence_norm","gauss","z","phi","lognorm_dist","lognorm_inv","prob","x_","p_","lw","slope","y_","mx","my","b1","b2","intercept","pearson","s1","s3","rsq","steyx","forecast","_mat_mean","Mat","_mat_devsq","mean","sq","linest","Y","X","konst","stats","Xt","B","line_1","Y1","y_y1","mp","SSreg","SSresid","line_5","R2","degfre","err_est","line_3","F_sta","line_4","SCP","line_2","logest","trend","W","growth","new_X","root_newton","guess","max_it","eps","f_d","FV","rate","nper","pmt","pv","h1","h2","PV","fv","PMT","NPER","RATE","xfd","IPMT","per","ipmt","PPMT","CUMPRINC","tn","ts","te","monthlyPayment","remainingBalanceAtStart","remainingBalanceAtEnd","CUMIPMT","cip","NPV","flows","npv","IRR","npv1","EFFECT","nominal_rate","npery","NOMINAL","effect_rate","XNPV","XIRR","ISPMT","DB","cost","salvage","life","period","db","DDB","factor","prior","dep","SLN","SYD","VDB","no_switch","_getGDA","gda","oldValue","interest","_interVDB","life1","term","remValue","intEnd","lia","vdb","nowLia","intStart","_edate","_daysBetween","basis","_borderCoupons","settlement","maturity","freq","sett","periods","_borderCoupons_fw","COUPDAYBS","frequency","COUPDAYS","settl","matur","COUPDAYSNC","COUPPCD","COUPNCD","COUPNUM","mat","ACCRINTM","issue","par","year_days","ACCRINT","_numCoupons","annual","brace","prev1","next1","nrc","accr","DISC","pr","redemption","INTRATE","investment","RECEIVED","discount","PRICE","yld","N","beg_settl","settl_end","beg_end","den","yf","PRICEDISC","dsm","COUPS_ARGS","ll","ac","withPreventDefault","BORDER_TYPES","BORDER_PALETTE_MESSAGES","COLOR_PICKER_MESSAGES","ColorChooser","BorderPalette","borderPalette","colorPicker","customColor","cancel","_resetButton","_colorPalette","_customColorPalette","_customColorButton","resetButton","resetColor","customColorButton","colorPalette","flatColorPicker","_change","class","kendoColorPalette","palette","viewModel","kendoWindow","resizable","maximizable","modal","center","one","_hueSlider","kendoFlatColorPicker","observable","_borderTypePalette","_borderColorPalette","_click","colorChooser","buttons","_colorChange","currentTarget","ToolBar","MESSAGES","defaultTools","toolDefaults","SpreadsheetToolBar","DropDownTool","PopupTool","OverflowDialogButton","ColorPicker","ColorPickerButton","FONT_SIZES","DEFAULT_FONT_SIZE","FontSize","FontSizeButton","FONT_FAMILIES","DEFAULT_FONT_FAMILY","FontFamily","FontFamilyButton","defaultFormats","Format","FormatButton","BorderChangeTool","BorderChangeButton","AlignmentTool","AlignmentButton","MergeTool","MergeButton","FreezeTool","FreezeButton","Sort","SortButton","FilterButton","Open","alignment","alignmentButtons","justtifyLeft","justifyCenter","justifyRight","justifyFull","alignTop","alignMiddle","alignBottom","formatTypes","automatic","financial","dateTime","duration","moreFormats","formatDecreaseDecimal","formatIncreaseDecimal","freeze","freezeButtons","freezePanes","freezeRows","freezeColumns","mergeButtons","mergeCells","mergeHorizontally","mergeVertically","quickAccess","exportAs","toggleGridlines","sortButtons","sortRangeAsc","sortRangeDesc","textColor","textWrap","hyperlink","iconClass","dialogName","togglable","separator","formatCells","handleClick","_expandTools","tools","toolbarName","_addSeparators","tool","_nextTool","activeElement","blur","removeClass","click","activeIndex","groups","before","expandTool","toolName","isPlainObject","spriteCssClass","typeDefaults","showText","toolIcon","attributes","aria-label","menuButtons","commandType","checked","setToggle","update","_tools","isFunction","toArray","_getItem","instance","Item","dropDownList","kendoDropDownList","addUidAttr","addOverflowAttr","_open","data-command","data-property","listWidth","ddl","_listWidth","dataItem","popupName","registerComponent","ToolBarButton","_dialogName","_title","OverflowButton","iconName","comboBox","kendoComboBox","_valueChange","clearButton","fontSizes","sizes","defaultSize","fontFamilies","defaultFont","_revertTitle","dataValuePrimitive","valueTemplate","sample","_borderPalette","_action","_defineButtons","_commandPalette","_reset","_quickAccessButtons","toolbars","contentElements","_toolbar","quickAccessToolBar","hasOwnProperty","buttonTemplate","insertBefore","tabGroup","formattedValue","uniqueBy","inArray","basicErrorDialog","register","MessageDialog","messageId","ObservableObject","registry","SpreadsheetDialog","FormatCellsViewModel","FormatCellsDialog","ConfirmationDialog","ValidationErrorDialog","FontFamilyDialog","FontSizeDialog","BordersDialog","ColorPickerDialog","CustomColorDialog","AlignmentDialog","MergeDialog","FreezeDialog","ValidationViewModel","ValidationDialog","ExportAsDialog","ImportErrorDialog","UseKeyboardDialog","HyperlinkDialog","retry","revert","okText","formatCellsDialog","categories","fontFamilyDialog","fontSizeDialog","bordersDialog","alignmentDialog","mergeDialog","freezeDialog","confirmationDialog","validationDialog","hintMessage","hintTitle","any","comparers","comparerMessages","labels","onInvalidData","rejectInput","showWarning","showHint","ignoreBlank","showListButton","showCalendarButton","placeholders","typeTitle","typeMessage","exportAsDialog","fit","saveAsType","exportArea","paperSize","margins","orientation","guidelines","modifyMergedDialog","errorMessage","rangeDisabledDialog","incompatibleRangesDialog","noFillDirectionDialog","duplicateSheetNameDialog","overflowDialog","useKeyboardDialog","forCopy","forCut","forPaste","unsupportedSelectionDialog","linkDialog","url","removeLink","dialogClass","autoFocus","_dialog","_onDialogClose","_onDialogActivate","_onDialogDeactivate","useCategory","category","formatCurrency","currencies","allFormats","useFirstFormat","info","_currency","iso","convert","categoryFilter","pattern","abbr","defaultOptions","_generateFormats","calendarPatterns","currenciesFrom","numberFormats","dateFormats","currencyFilter","roleSelector","description","getter","confirm","_confirmed","_list","_colorPicker","ValidationCellsViewModel","criterion","setHintMessageTemplate","shouldBuild","buildMessages","hintTitleTemplate","hintMessageTemplate","setComparers","defaultHintTitle","text_comparers","defaultComparers","defaultHintMessage","isAny","isNumber","showToForNumber","showTo","showToForDate","isDate","isText","isList","isCustom","showRemove","fromValidationObject","useCustomMessages","toValidationObject","errorTemplate","validatable","Validator","validateOnBlur","validate","fileFormats","author","subject","keywords","creator","fitWidth","areas","paperSizes","margin","landscape","hCenter","vCenter","model","stopPropagation","o","_normalizeColumns","_dataSource","_header","_boundRowsCount","_sheetChangeHandler","_sheetDeleteRowHandler","_sheetInsertRowHandler","fields","getters","normalizedRef","_skipRebind","record","valueIndex","colValueIndex","_changeHandler","getterIdx","distinctValues","query","itemVisible","filterSpread","anyVisibleChildren","hasVisibleChildren","HierarchicalDataSource","valuesFilter","uncheckAll","hasChildren","flattenOperators","operators","FILTERMENU_MESSAGES","Details","templates","FilterMenuViewModel","FilterMenuController","details","detailsSummary","detailsContent","iconCollapse","iconExpand","iconSearch","textbox","filterByCondition","filterByValue","valuesTreeViewWrapper","actionButtons","_summary","_toggle","_icon","_container","fx","expand","sortAscending","sortDescending","search","addToCurrent","operatorNone","doesnotcontain","startswith","endswith","doesnotmatch","neq","gte","lte","binders","spreadsheetFilterValue","Binder","bindings","proxy","widget","binding","menuItem","valuesChange","valuesDataSource","lastIndexOf","appendToSearch","valueSelect","hasActiveSearch","filterValues","operatorChange","isNone","isString","valuesTree","filterType","topValue","filterForColumn","allFilters","columnFilters","_filterInit","_filterByCondition","_filterByValue","_actionButtons","valuesTreeView","_active","activeFilter","copyAnchorStyles","dir","kendoMenu","_appendTemplate","compiledTemplate","_detailToggle","not","isExpanded","activeContainer","hasClass","oldRect","newRect","barInput","cellInput","_triggerUpdate","_rect","inputType","linearRegression","findSeries","findStep","forEachSeries","getType","lst","findStringList","stringLists","strl","ERR_INCOMPATIBLE","ERR_NO_DIRECTION","srcRange","src","srcIdx","destRange","CLASS_NAMES","comboBoxTitle","comboElement","transport","success","combo","ignoreCase","_on_listChange","noDataTemplate","getKendoComboBox","_on_keyDown","_on_focus","_deleteItem","_prevValue","distributeCoords","heights","pageHeight","curr","rowHeights","colWidths","pageWidth","scaleFactor","boxWidth","boxHeight","nonEmpty","relrow","relcol","rh","cw","shouldDrawCell","emptyCells","orlast","normalOrder","sameBorder","drawLayout","addPage","page","bordersGroup","endbottom","endright","Group","clip","Path","fromRect","geo","Rect","multiplyCopy","translate","moveTo","lineTo","stroke","GUIDELINE_WIDTH","ncols","nrows","r2d2","drawText","vtrans","text_group","CONT","boxSizing","padding","lineHeight","makeFontDef","createTextNode","drawDOM","paper","getPaperOptions","multiPage","Container","pb","addVert","addHoriz","geometry","NS","Spreadsheet","F10","F11","I","U","H","A","DELETE","R","_controller","_autoRefresh","_bindWorkbookEvents","_resizeHandler","_keyDown","_workbookChange","_workbookCut","_workbookCopy","_workbookPaste","autoRefresh","blob","_workbookExcelExport","_workbookExcelImport","_initProgress","kendoProgressBar","chunkCount","always","_workbookPdfExport","_workbookInsertSheet","_workbookRemoveSheet","_workbookSelectSheet","_workbookRenameSheet","_workbookInsertRow","_workbookInsertColumn","_workbookDeleteRow","_workbookDeleteColumn","_workbookHideRow","_workbookHideColumn","_workbookUnhideRow","_workbookUnhideColumn","_workbookSelect","_workbookChangeFormat","plugin"],"mappings":"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","file":"kendo.spreadsheet.min.js","sourcesContent":["/*!\n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n                                                                                                                                                                                                       \n\n*/\n(function (f, define) {\n    define('util/undoredostack', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        var UndoRedoStack = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.clear();\n            },\n            events: [\n                'undo',\n                'redo'\n            ],\n            push: function (command) {\n                this.stack = this.stack.slice(0, this.currentCommandIndex + 1);\n                this.currentCommandIndex = this.stack.push(command) - 1;\n            },\n            undo: function () {\n                if (this.canUndo()) {\n                    var command = this.stack[this.currentCommandIndex--];\n                    command.undo();\n                    this.trigger('undo', { command: command });\n                }\n            },\n            redo: function () {\n                if (this.canRedo()) {\n                    var command = this.stack[++this.currentCommandIndex];\n                    command.redo();\n                    this.trigger('redo', { command: command });\n                }\n            },\n            clear: function () {\n                this.stack = [];\n                this.currentCommandIndex = -1;\n            },\n            canUndo: function () {\n                return this.currentCommandIndex >= 0;\n            },\n            canRedo: function () {\n                return this.currentCommandIndex != this.stack.length - 1;\n            }\n        });\n        kendo.deepExtend(kendo, { util: { UndoRedoStack: UndoRedoStack } });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/text-metrics', ['kendo.core'], f);\n}(function () {\n    (function ($) {\n        window.kendo.util = window.kendo.util || {};\n        var LRUCache = kendo.Class.extend({\n            init: function (size) {\n                this._size = size;\n                this._length = 0;\n                this._map = {};\n            },\n            put: function (key, value) {\n                var map = this._map;\n                var entry = {\n                    key: key,\n                    value: value\n                };\n                map[key] = entry;\n                if (!this._head) {\n                    this._head = this._tail = entry;\n                } else {\n                    this._tail.newer = entry;\n                    entry.older = this._tail;\n                    this._tail = entry;\n                }\n                if (this._length >= this._size) {\n                    map[this._head.key] = null;\n                    this._head = this._head.newer;\n                    this._head.older = null;\n                } else {\n                    this._length++;\n                }\n            },\n            get: function (key) {\n                var entry = this._map[key];\n                if (entry) {\n                    if (entry === this._head && entry !== this._tail) {\n                        this._head = entry.newer;\n                        this._head.older = null;\n                    }\n                    if (entry !== this._tail) {\n                        if (entry.older) {\n                            entry.older.newer = entry.newer;\n                            entry.newer.older = entry.older;\n                        }\n                        entry.older = this._tail;\n                        entry.newer = null;\n                        this._tail.newer = entry;\n                        this._tail = entry;\n                    }\n                    return entry.value;\n                }\n            }\n        });\n        var REPLACE_REGEX = /\\r?\\n|\\r|\\t/g;\n        var SPACE = ' ';\n        function normalizeText(text) {\n            return String(text).replace(REPLACE_REGEX, SPACE);\n        }\n        function objectKey(object) {\n            var parts = [];\n            for (var key in object) {\n                parts.push(key + object[key]);\n            }\n            return parts.sort().join('');\n        }\n        function hashKey(str) {\n            var hash = 2166136261;\n            for (var i = 0; i < str.length; ++i) {\n                hash += (hash << 1) + (hash << 4) + (hash << 7) + (hash << 8) + (hash << 24);\n                hash ^= str.charCodeAt(i);\n            }\n            return hash >>> 0;\n        }\n        function zeroSize() {\n            return {\n                width: 0,\n                height: 0,\n                baseline: 0\n            };\n        }\n        var DEFAULT_OPTIONS = { baselineMarkerSize: 1 };\n        var defaultMeasureBox;\n        if (typeof document !== 'undefined') {\n            defaultMeasureBox = document.createElement('div');\n            defaultMeasureBox.style.cssText = 'position: absolute !important; top: -4000px !important; width: auto !important; height: auto !important;' + 'padding: 0 !important; margin: 0 !important; border: 0 !important;' + 'line-height: normal !important; visibility: hidden !important; white-space: pre!important;';\n        }\n        var TextMetrics = kendo.Class.extend({\n            init: function (options) {\n                this._cache = new LRUCache(1000);\n                this.options = $.extend({}, DEFAULT_OPTIONS, options);\n            },\n            measure: function (text, style, options) {\n                if (options === void 0) {\n                    options = {};\n                }\n                if (!text) {\n                    return zeroSize();\n                }\n                var styleKey = objectKey(style);\n                var cacheKey = hashKey(text + styleKey);\n                var cachedResult = this._cache.get(cacheKey);\n                if (cachedResult) {\n                    return cachedResult;\n                }\n                var size = zeroSize();\n                var measureBox = options.box || defaultMeasureBox;\n                var baselineMarker = this._baselineMarker().cloneNode(false);\n                for (var key in style) {\n                    var value = style[key];\n                    if (typeof value !== 'undefined') {\n                        measureBox.style[key] = value;\n                    }\n                }\n                var textStr = options.normalizeText !== false ? normalizeText(text) : String(text);\n                measureBox.textContent = textStr;\n                measureBox.appendChild(baselineMarker);\n                document.body.appendChild(measureBox);\n                if (textStr.length) {\n                    size.width = measureBox.offsetWidth - this.options.baselineMarkerSize;\n                    size.height = measureBox.offsetHeight;\n                    size.baseline = baselineMarker.offsetTop + this.options.baselineMarkerSize;\n                }\n                if (size.width > 0 && size.height > 0) {\n                    this._cache.put(cacheKey, size);\n                }\n                measureBox.parentNode.removeChild(measureBox);\n                return size;\n            },\n            _baselineMarker: function () {\n                var marker = document.createElement('div');\n                marker.style.cssText = 'display: inline-block; vertical-align: baseline;width: ' + this.options.baselineMarkerSize + 'px; height: ' + this.options.baselineMarkerSize + 'px;overflow: hidden;';\n                return marker;\n            }\n        });\n        TextMetrics.current = new TextMetrics();\n        function measureText(text, style, measureBox) {\n            return TextMetrics.current.measure(text, style, measureBox);\n        }\n        kendo.deepExtend(kendo.util, {\n            LRUCache: LRUCache,\n            TextMetrics: TextMetrics,\n            measureText: measureText,\n            objectKey: objectKey,\n            hashKey: hashKey,\n            normalizeText: normalizeText\n        });\n    }(window.kendo.jQuery));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/main', ['kendo.core'], f);\n}(function () {\n    (function () {\n        var kendo = window.kendo, deepExtend = kendo.deepExtend;\n        function sqr(value) {\n            return value * value;\n        }\n        var now = Date.now;\n        if (!now) {\n            now = function () {\n                return new Date().getTime();\n            };\n        }\n        function renderSize(size) {\n            if (typeof size !== 'string') {\n                size += 'px';\n            }\n            return size;\n        }\n        function renderPos(pos) {\n            var result = [];\n            if (pos) {\n                var parts = kendo.toHyphens(pos).split('-');\n                for (var i = 0; i < parts.length; i++) {\n                    result.push('k-pos-' + parts[i]);\n                }\n            }\n            return result.join(' ');\n        }\n        function arabicToRoman(n) {\n            var literals = {\n                1: 'i',\n                10: 'x',\n                100: 'c',\n                2: 'ii',\n                20: 'xx',\n                200: 'cc',\n                3: 'iii',\n                30: 'xxx',\n                300: 'ccc',\n                4: 'iv',\n                40: 'xl',\n                400: 'cd',\n                5: 'v',\n                50: 'l',\n                500: 'd',\n                6: 'vi',\n                60: 'lx',\n                600: 'dc',\n                7: 'vii',\n                70: 'lxx',\n                700: 'dcc',\n                8: 'viii',\n                80: 'lxxx',\n                800: 'dccc',\n                9: 'ix',\n                90: 'xc',\n                900: 'cm',\n                1000: 'm'\n            };\n            var values = [\n                1000,\n                900,\n                800,\n                700,\n                600,\n                500,\n                400,\n                300,\n                200,\n                100,\n                90,\n                80,\n                70,\n                60,\n                50,\n                40,\n                30,\n                20,\n                10,\n                9,\n                8,\n                7,\n                6,\n                5,\n                4,\n                3,\n                2,\n                1\n            ];\n            var roman = '';\n            while (n > 0) {\n                if (n < values[0]) {\n                    values.shift();\n                } else {\n                    roman += literals[values[0]];\n                    n -= values[0];\n                }\n            }\n            return roman;\n        }\n        function romanToArabic(r) {\n            r = r.toLowerCase();\n            var digits = {\n                i: 1,\n                v: 5,\n                x: 10,\n                l: 50,\n                c: 100,\n                d: 500,\n                m: 1000\n            };\n            var value = 0, prev = 0;\n            for (var i = 0; i < r.length; ++i) {\n                var v = digits[r.charAt(i)];\n                if (!v) {\n                    return null;\n                }\n                value += v;\n                if (v > prev) {\n                    value -= 2 * prev;\n                }\n                prev = v;\n            }\n            return value;\n        }\n        function memoize(f) {\n            var cache = Object.create(null);\n            return function () {\n                var id = '';\n                for (var i = arguments.length; --i >= 0;) {\n                    id += ':' + arguments[i];\n                }\n                return id in cache ? cache[id] : cache[id] = f.apply(this, arguments);\n            };\n        }\n        function isUnicodeLetter(ch) {\n            return RX_UNICODE_LETTER.test(ch);\n        }\n        deepExtend(kendo, {\n            util: {\n                now: now,\n                renderPos: renderPos,\n                renderSize: renderSize,\n                sqr: sqr,\n                romanToArabic: romanToArabic,\n                arabicToRoman: arabicToRoman,\n                memoize: memoize,\n                isUnicodeLetter: isUnicodeLetter\n            }\n        });\n        var RX_UNICODE_LETTER = new RegExp('[\\\\u0041-\\\\u005A\\\\u0061-\\\\u007A\\\\u00AA\\\\u00B5\\\\u00BA\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02C1\\\\u02C6-\\\\u02D1\\\\u02E0-\\\\u02E4\\\\u02EC\\\\u02EE\\\\u0370-\\\\u0374\\\\u0376\\\\u0377\\\\u037A-\\\\u037D\\\\u037F\\\\u0386\\\\u0388-\\\\u038A\\\\u038C\\\\u038E-\\\\u03A1\\\\u03A3-\\\\u03F5\\\\u03F7-\\\\u0481\\\\u048A-\\\\u052F\\\\u0531-\\\\u0556\\\\u0559\\\\u0561-\\\\u0587\\\\u05D0-\\\\u05EA\\\\u05F0-\\\\u05F2\\\\u0620-\\\\u064A\\\\u066E\\\\u066F\\\\u0671-\\\\u06D3\\\\u06D5\\\\u06E5\\\\u06E6\\\\u06EE\\\\u06EF\\\\u06FA-\\\\u06FC\\\\u06FF\\\\u0710\\\\u0712-\\\\u072F\\\\u074D-\\\\u07A5\\\\u07B1\\\\u07CA-\\\\u07EA\\\\u07F4\\\\u07F5\\\\u07FA\\\\u0800-\\\\u0815\\\\u081A\\\\u0824\\\\u0828\\\\u0840-\\\\u0858\\\\u08A0-\\\\u08B2\\\\u0904-\\\\u0939\\\\u093D\\\\u0950\\\\u0958-\\\\u0961\\\\u0971-\\\\u0980\\\\u0985-\\\\u098C\\\\u098F\\\\u0990\\\\u0993-\\\\u09A8\\\\u09AA-\\\\u09B0\\\\u09B2\\\\u09B6-\\\\u09B9\\\\u09BD\\\\u09CE\\\\u09DC\\\\u09DD\\\\u09DF-\\\\u09E1\\\\u09F0\\\\u09F1\\\\u0A05-\\\\u0A0A\\\\u0A0F\\\\u0A10\\\\u0A13-\\\\u0A28\\\\u0A2A-\\\\u0A30\\\\u0A32\\\\u0A33\\\\u0A35\\\\u0A36\\\\u0A38\\\\u0A39\\\\u0A59-\\\\u0A5C\\\\u0A5E\\\\u0A72-\\\\u0A74\\\\u0A85-\\\\u0A8D\\\\u0A8F-\\\\u0A91\\\\u0A93-\\\\u0AA8\\\\u0AAA-\\\\u0AB0\\\\u0AB2\\\\u0AB3\\\\u0AB5-\\\\u0AB9\\\\u0ABD\\\\u0AD0\\\\u0AE0\\\\u0AE1\\\\u0B05-\\\\u0B0C\\\\u0B0F\\\\u0B10\\\\u0B13-\\\\u0B28\\\\u0B2A-\\\\u0B30\\\\u0B32\\\\u0B33\\\\u0B35-\\\\u0B39\\\\u0B3D\\\\u0B5C\\\\u0B5D\\\\u0B5F-\\\\u0B61\\\\u0B71\\\\u0B83\\\\u0B85-\\\\u0B8A\\\\u0B8E-\\\\u0B90\\\\u0B92-\\\\u0B95\\\\u0B99\\\\u0B9A\\\\u0B9C\\\\u0B9E\\\\u0B9F\\\\u0BA3\\\\u0BA4\\\\u0BA8-\\\\u0BAA\\\\u0BAE-\\\\u0BB9\\\\u0BD0\\\\u0C05-\\\\u0C0C\\\\u0C0E-\\\\u0C10\\\\u0C12-\\\\u0C28\\\\u0C2A-\\\\u0C39\\\\u0C3D\\\\u0C58\\\\u0C59\\\\u0C60\\\\u0C61\\\\u0C85-\\\\u0C8C\\\\u0C8E-\\\\u0C90\\\\u0C92-\\\\u0CA8\\\\u0CAA-\\\\u0CB3\\\\u0CB5-\\\\u0CB9\\\\u0CBD\\\\u0CDE\\\\u0CE0\\\\u0CE1\\\\u0CF1\\\\u0CF2\\\\u0D05-\\\\u0D0C\\\\u0D0E-\\\\u0D10\\\\u0D12-\\\\u0D3A\\\\u0D3D\\\\u0D4E\\\\u0D60\\\\u0D61\\\\u0D7A-\\\\u0D7F\\\\u0D85-\\\\u0D96\\\\u0D9A-\\\\u0DB1\\\\u0DB3-\\\\u0DBB\\\\u0DBD\\\\u0DC0-\\\\u0DC6\\\\u0E01-\\\\u0E30\\\\u0E32\\\\u0E33\\\\u0E40-\\\\u0E46\\\\u0E81\\\\u0E82\\\\u0E84\\\\u0E87\\\\u0E88\\\\u0E8A\\\\u0E8D\\\\u0E94-\\\\u0E97\\\\u0E99-\\\\u0E9F\\\\u0EA1-\\\\u0EA3\\\\u0EA5\\\\u0EA7\\\\u0EAA\\\\u0EAB\\\\u0EAD-\\\\u0EB0\\\\u0EB2\\\\u0EB3\\\\u0EBD\\\\u0EC0-\\\\u0EC4\\\\u0EC6\\\\u0EDC-\\\\u0EDF\\\\u0F00\\\\u0F40-\\\\u0F47\\\\u0F49-\\\\u0F6C\\\\u0F88-\\\\u0F8C\\\\u1000-\\\\u102A\\\\u103F\\\\u1050-\\\\u1055\\\\u105A-\\\\u105D\\\\u1061\\\\u1065\\\\u1066\\\\u106E-\\\\u1070\\\\u1075-\\\\u1081\\\\u108E\\\\u10A0-\\\\u10C5\\\\u10C7\\\\u10CD\\\\u10D0-\\\\u10FA\\\\u10FC-\\\\u1248\\\\u124A-\\\\u124D\\\\u1250-\\\\u1256\\\\u1258\\\\u125A-\\\\u125D\\\\u1260-\\\\u1288\\\\u128A-\\\\u128D\\\\u1290-\\\\u12B0\\\\u12B2-\\\\u12B5\\\\u12B8-\\\\u12BE\\\\u12C0\\\\u12C2-\\\\u12C5\\\\u12C8-\\\\u12D6\\\\u12D8-\\\\u1310\\\\u1312-\\\\u1315\\\\u1318-\\\\u135A\\\\u1380-\\\\u138F\\\\u13A0-\\\\u13F4\\\\u1401-\\\\u166C\\\\u166F-\\\\u167F\\\\u1681-\\\\u169A\\\\u16A0-\\\\u16EA\\\\u16EE-\\\\u16F8\\\\u1700-\\\\u170C\\\\u170E-\\\\u1711\\\\u1720-\\\\u1731\\\\u1740-\\\\u1751\\\\u1760-\\\\u176C\\\\u176E-\\\\u1770\\\\u1780-\\\\u17B3\\\\u17D7\\\\u17DC\\\\u1820-\\\\u1877\\\\u1880-\\\\u18A8\\\\u18AA\\\\u18B0-\\\\u18F5\\\\u1900-\\\\u191E\\\\u1950-\\\\u196D\\\\u1970-\\\\u1974\\\\u1980-\\\\u19AB\\\\u19C1-\\\\u19C7\\\\u1A00-\\\\u1A16\\\\u1A20-\\\\u1A54\\\\u1AA7\\\\u1B05-\\\\u1B33\\\\u1B45-\\\\u1B4B\\\\u1B83-\\\\u1BA0\\\\u1BAE\\\\u1BAF\\\\u1BBA-\\\\u1BE5\\\\u1C00-\\\\u1C23\\\\u1C4D-\\\\u1C4F\\\\u1C5A-\\\\u1C7D\\\\u1CE9-\\\\u1CEC\\\\u1CEE-\\\\u1CF1\\\\u1CF5\\\\u1CF6\\\\u1D00-\\\\u1DBF\\\\u1E00-\\\\u1F15\\\\u1F18-\\\\u1F1D\\\\u1F20-\\\\u1F45\\\\u1F48-\\\\u1F4D\\\\u1F50-\\\\u1F57\\\\u1F59\\\\u1F5B\\\\u1F5D\\\\u1F5F-\\\\u1F7D\\\\u1F80-\\\\u1FB4\\\\u1FB6-\\\\u1FBC\\\\u1FBE\\\\u1FC2-\\\\u1FC4\\\\u1FC6-\\\\u1FCC\\\\u1FD0-\\\\u1FD3\\\\u1FD6-\\\\u1FDB\\\\u1FE0-\\\\u1FEC\\\\u1FF2-\\\\u1FF4\\\\u1FF6-\\\\u1FFC\\\\u2071\\\\u207F\\\\u2090-\\\\u209C\\\\u2102\\\\u2107\\\\u210A-\\\\u2113\\\\u2115\\\\u2119-\\\\u211D\\\\u2124\\\\u2126\\\\u2128\\\\u212A-\\\\u212D\\\\u212F-\\\\u2139\\\\u213C-\\\\u213F\\\\u2145-\\\\u2149\\\\u214E\\\\u2160-\\\\u2188\\\\u2C00-\\\\u2C2E\\\\u2C30-\\\\u2C5E\\\\u2C60-\\\\u2CE4\\\\u2CEB-\\\\u2CEE\\\\u2CF2\\\\u2CF3\\\\u2D00-\\\\u2D25\\\\u2D27\\\\u2D2D\\\\u2D30-\\\\u2D67\\\\u2D6F\\\\u2D80-\\\\u2D96\\\\u2DA0-\\\\u2DA6\\\\u2DA8-\\\\u2DAE\\\\u2DB0-\\\\u2DB6\\\\u2DB8-\\\\u2DBE\\\\u2DC0-\\\\u2DC6\\\\u2DC8-\\\\u2DCE\\\\u2DD0-\\\\u2DD6\\\\u2DD8-\\\\u2DDE\\\\u2E2F\\\\u3005-\\\\u3007\\\\u3021-\\\\u3029\\\\u3031-\\\\u3035\\\\u3038-\\\\u303C\\\\u3041-\\\\u3096\\\\u309D-\\\\u309F\\\\u30A1-\\\\u30FA\\\\u30FC-\\\\u30FF\\\\u3105-\\\\u312D\\\\u3131-\\\\u318E\\\\u31A0-\\\\u31BA\\\\u31F0-\\\\u31FF\\\\u3400-\\\\u4DB5\\\\u4E00-\\\\u9FCC\\\\uA000-\\\\uA48C\\\\uA4D0-\\\\uA4FD\\\\uA500-\\\\uA60C\\\\uA610-\\\\uA61F\\\\uA62A\\\\uA62B\\\\uA640-\\\\uA66E\\\\uA67F-\\\\uA69D\\\\uA6A0-\\\\uA6EF\\\\uA717-\\\\uA71F\\\\uA722-\\\\uA788\\\\uA78B-\\\\uA78E\\\\uA790-\\\\uA7AD\\\\uA7B0\\\\uA7B1\\\\uA7F7-\\\\uA801\\\\uA803-\\\\uA805\\\\uA807-\\\\uA80A\\\\uA80C-\\\\uA822\\\\uA840-\\\\uA873\\\\uA882-\\\\uA8B3\\\\uA8F2-\\\\uA8F7\\\\uA8FB\\\\uA90A-\\\\uA925\\\\uA930-\\\\uA946\\\\uA960-\\\\uA97C\\\\uA984-\\\\uA9B2\\\\uA9CF\\\\uA9E0-\\\\uA9E4\\\\uA9E6-\\\\uA9EF\\\\uA9FA-\\\\uA9FE\\\\uAA00-\\\\uAA28\\\\uAA40-\\\\uAA42\\\\uAA44-\\\\uAA4B\\\\uAA60-\\\\uAA76\\\\uAA7A\\\\uAA7E-\\\\uAAAF\\\\uAAB1\\\\uAAB5\\\\uAAB6\\\\uAAB9-\\\\uAABD\\\\uAAC0\\\\uAAC2\\\\uAADB-\\\\uAADD\\\\uAAE0-\\\\uAAEA\\\\uAAF2-\\\\uAAF4\\\\uAB01-\\\\uAB06\\\\uAB09-\\\\uAB0E\\\\uAB11-\\\\uAB16\\\\uAB20-\\\\uAB26\\\\uAB28-\\\\uAB2E\\\\uAB30-\\\\uAB5A\\\\uAB5C-\\\\uAB5F\\\\uAB64\\\\uAB65\\\\uABC0-\\\\uABE2\\\\uAC00-\\\\uD7A3\\\\uD7B0-\\\\uD7C6\\\\uD7CB-\\\\uD7FB\\\\uF900-\\\\uFA6D\\\\uFA70-\\\\uFAD9\\\\uFB00-\\\\uFB06\\\\uFB13-\\\\uFB17\\\\uFB1D\\\\uFB1F-\\\\uFB28\\\\uFB2A-\\\\uFB36\\\\uFB38-\\\\uFB3C\\\\uFB3E\\\\uFB40\\\\uFB41\\\\uFB43\\\\uFB44\\\\uFB46-\\\\uFBB1\\\\uFBD3-\\\\uFD3D\\\\uFD50-\\\\uFD8F\\\\uFD92-\\\\uFDC7\\\\uFDF0-\\\\uFDFB\\\\uFE70-\\\\uFE74\\\\uFE76-\\\\uFEFC\\\\uFF21-\\\\uFF3A\\\\uFF41-\\\\uFF5A\\\\uFF66-\\\\uFFBE\\\\uFFC2-\\\\uFFC7\\\\uFFCA-\\\\uFFCF\\\\uFFD2-\\\\uFFD7\\\\uFFDA-\\\\uFFDC]');\n    }());\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('util/parse-xml', [\n        'kendo.core',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    var STRING = String.fromCharCode;\n    var ENTITIES = {\n        'amp': 38,\n        'lt': 60,\n        'gt': 62,\n        'quot': 34,\n        'apos': 39,\n        'nbsp': 160\n    };\n    function CODE(str) {\n        var out = [];\n        for (var i = 0; i < str.length; ++i) {\n            out.push(str.charCodeAt(i));\n        }\n        return out;\n    }\n    function UCS2(out, code) {\n        if (code > 65535) {\n            code -= 65536;\n            out.push(code >>> 10 & 1023 | 55296, 56320 | code & 1023);\n        } else {\n            out.push(code);\n        }\n    }\n    var START_CDATA = CODE('<![CDATA[');\n    var END_CDATA = CODE(']]>');\n    var END_COMMENT = CODE('-->');\n    var START_COMMENT = CODE('!--');\n    var END_SHORT_TAG = CODE('/>');\n    var END_TAG = CODE('</');\n    var END_DECLARATION = CODE('?>');\n    var QUESTION_MARK = CODE('?');\n    var LESS_THAN = CODE('<');\n    var GREATER_THAN = CODE('>');\n    var SEMICOLON = CODE(';');\n    var EQUAL = CODE('=');\n    var AMPERSAND = CODE('&');\n    var QUOTE = CODE('\"');\n    var APOSTROPHE = CODE('\\'');\n    var SHARP = CODE('#');\n    var LOWERCASE_X = CODE('x');\n    var UPPERCASE_X = CODE('X');\n    var EXIT = {};\n    function parse(data, callbacks) {\n        var index = 0;\n        var stack = [];\n        var object = {\n            is: function (selector) {\n                var i = stack.length, j = selector.length;\n                while (--i >= 0 && --j >= 0) {\n                    if (stack[i].$tag != selector[j] && selector[j] != '*') {\n                        return false;\n                    }\n                }\n                return j < 0 ? stack[stack.length - 1] : null;\n            },\n            exit: function () {\n                throw EXIT;\n            },\n            stack: stack\n        };\n        function readChar(body) {\n            var code = data[index++];\n            if (!(code & 240 ^ 240)) {\n                UCS2(body, (code & 3) << 18 | (data[index++] & 63) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 224 ^ 224)) {\n                UCS2(body, (code & 15) << 12 | (data[index++] & 63) << 6 | data[index++] & 63);\n            } else if (!(code & 192 ^ 192)) {\n                UCS2(body, (code & 31) << 6 | data[index++] & 63);\n            } else {\n                body.push(code);\n            }\n        }\n        function croak(msg) {\n            throw new Error(msg + ', at ' + index);\n        }\n        function readWhile(pred) {\n            var a = [];\n            while (index < data.length && pred(data[index])) {\n                a.push(data[index++]);\n            }\n            return a;\n        }\n        function readAsciiWhile(pred) {\n            return STRING.apply(0, readWhile(pred));\n        }\n        function skipWhitespace() {\n            readWhile(isWhitespace);\n        }\n        function eat(a) {\n            var save = index;\n            for (var i = 0; i < a.length; ++i) {\n                if (data[index++] != a[i]) {\n                    index = save;\n                    return false;\n                }\n            }\n            return a;\n        }\n        function skip(code) {\n            if (!eat(code)) {\n                croak('Expecting ' + code.join(', '));\n            }\n        }\n        function isWhitespace(code) {\n            return code == 9 || code == 10 || code == 13 || code == 32;\n        }\n        function isDigit(code) {\n            return code >= 48 && code <= 57;\n        }\n        function isHexDigit(code) {\n            return code >= 48 && code <= 57 || (code |= 32) >= 97 && code <= 102;\n        }\n        function isNameStart(code) {\n            return code == 58 || code == 95 || (code |= 32) >= 97 && code <= 122;\n        }\n        function isName(code) {\n            return code == 45 || isDigit(code) || isNameStart(code);\n        }\n        function xmlComment() {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_COMMENT)) {\n                    return call('comment', STRING.apply(0, body));\n                }\n                readChar(body);\n            }\n        }\n        function xmlTag() {\n            var name, attrs;\n            if (eat(QUESTION_MARK)) {\n                xmlDecl();\n            } else if (eat(START_COMMENT)) {\n                xmlComment();\n            } else {\n                name = xmlName();\n                attrs = xmlAttrs(name);\n                stack.push(attrs);\n                if (eat(END_SHORT_TAG)) {\n                    call('enter', name, attrs, true);\n                } else {\n                    skip(GREATER_THAN);\n                    call('enter', name, attrs);\n                    xmlContent(name);\n                    if (name != xmlName()) {\n                        croak('Bad closing tag');\n                    }\n                    call('leave', name, attrs);\n                    skipWhitespace();\n                    skip(GREATER_THAN);\n                }\n                stack.pop();\n            }\n        }\n        function xmlContent(name) {\n            var body = [];\n            while (index < data.length) {\n                if (eat(END_TAG)) {\n                    return body.length && call('text', STRING.apply(0, body));\n                } else if (eat(START_CDATA)) {\n                    while (index < data.length && !eat(END_CDATA)) {\n                        readChar(body);\n                    }\n                } else if (eat(LESS_THAN)) {\n                    if (body.length) {\n                        call('text', STRING.apply(0, body));\n                    }\n                    xmlTag();\n                    body = [];\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unclosed tag ' + name);\n        }\n        function xmlName() {\n            if (!isNameStart(data[index])) {\n                croak('Expecting XML name');\n            }\n            return readAsciiWhile(isName);\n        }\n        function xmlString() {\n            var quote = eat(QUOTE) || eat(APOSTROPHE);\n            if (!quote) {\n                croak('Expecting string');\n            }\n            var body = [];\n            while (index < data.length) {\n                if (eat(quote)) {\n                    return STRING.apply(0, body);\n                } else if (eat(AMPERSAND)) {\n                    xmlEntity(body);\n                } else {\n                    readChar(body);\n                }\n            }\n            croak('Unfinished string');\n        }\n        function xmlEntity(body) {\n            var code;\n            if (eat(SHARP)) {\n                if (eat(LOWERCASE_X) || eat(UPPERCASE_X)) {\n                    code = parseInt(readAsciiWhile(isHexDigit), 16);\n                } else {\n                    code = parseInt(readAsciiWhile(isDigit), 10);\n                }\n                if (isNaN(code)) {\n                    croak('Bad numeric entity');\n                }\n            } else {\n                var name = xmlName();\n                code = ENTITIES[name];\n                if (code === undefined) {\n                    croak('Unknown entity ' + name);\n                }\n            }\n            UCS2(body, code);\n            skip(SEMICOLON);\n        }\n        function xmlDecl() {\n            call('decl', xmlName(), xmlAttrs());\n            skip(END_DECLARATION);\n        }\n        function xmlAttrs(name) {\n            var map = { $tag: name };\n            while (index < data.length) {\n                skipWhitespace();\n                var code = data[index];\n                if (code == 63 || code == 62 || code == 47) {\n                    break;\n                }\n                map[xmlName()] = (skip(EQUAL), xmlString());\n            }\n            return map;\n        }\n        function call(what, thing, arg1, arg2) {\n            var f = callbacks && callbacks[what];\n            if (f) {\n                f.call(object, thing, arg1, arg2);\n            }\n        }\n        var tmp = [];\n        readChar(tmp);\n        if (tmp[0] != 65279) {\n            index = 0;\n        }\n        while (index < data.length) {\n            skipWhitespace();\n            skip(LESS_THAN);\n            xmlTag();\n            skipWhitespace();\n        }\n    }\n    kendo.util.parseXML = function parseXML() {\n        try {\n            return parse.apply(this, arguments);\n        } catch (ex) {\n            if (ex !== EXIT) {\n                throw ex;\n            }\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/commands', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.window',\n        'kendo.list',\n        'kendo.tabstrip'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Command = kendo.spreadsheet.Command = kendo.Class.extend({\n            init: function (options) {\n                this.options = options;\n                this._workbook = options.workbook;\n                this._property = options && options.property;\n                this._state = {};\n            },\n            range: function (range) {\n                if (range !== undefined) {\n                    this._setRange(range);\n                }\n                return this._range;\n            },\n            _setRange: function (range) {\n                this._range = range;\n            },\n            redo: function () {\n                this.range().select();\n                this.exec();\n            },\n            undo: function () {\n                this.setState(this._state);\n            },\n            getState: function () {\n                this._state = this.range().getState(this._property);\n            },\n            setState: function (state) {\n                this.range().setState(state);\n            },\n            _forEachCell: function (callback) {\n                var range = this.range();\n                var ref = range._ref;\n                ref.forEach(function (ref) {\n                    range.sheet().forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            }\n        });\n        var TargetValueCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._target = options.target;\n                this._value = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this.setState(this._value);\n            }\n        });\n        kendo.spreadsheet.ColumnWidthCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().columnWidth(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().columnWidth(this._target, state);\n            }\n        });\n        kendo.spreadsheet.RowHeightCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this.range().sheet().rowHeight(this._target);\n            },\n            setState: function (state) {\n                this.range().sheet().rowHeight(this._target, state);\n            }\n        });\n        kendo.spreadsheet.HyperlinkCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._link = options.link;\n            },\n            exec: function () {\n                var range = this.range();\n                this._prevLink = range.link();\n                this._prevUnderline = range.underline();\n                range.link(this._link);\n                range.underline(true);\n                if (range.value() == null) {\n                    this._hasSetValue = true;\n                    range.value(this._link);\n                }\n            },\n            undo: function () {\n                var range = this.range();\n                range.link(this._prevLink);\n                range.underline(this._prevUnderline);\n                if (this._hasSetValue) {\n                    range.value(null);\n                }\n            }\n        });\n        kendo.spreadsheet.GridLinesChangeCommand = TargetValueCommand.extend({\n            getState: function () {\n                this._state = this._range.sheet().showGridLines();\n            },\n            setState: function (v) {\n                this._range.sheet().showGridLines(v);\n            }\n        });\n        var PropertyChangeCommand = kendo.spreadsheet.PropertyChangeCommand = Command.extend({\n            _setRange: function (range) {\n                Command.prototype._setRange.call(this, range.skipHiddenCells());\n            },\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                var range = this.range();\n                if (range.enable()) {\n                    this.getState();\n                    if (this.options.property === 'format') {\n                        this._workbook.trigger('changeFormat', { range: range });\n                    }\n                    range[this._property](this._value);\n                }\n            }\n        });\n        kendo.spreadsheet.ClearContentCommand = Command.extend({\n            exec: function () {\n                if (!this.range().enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'cannotModifyDisabled'\n                    };\n                }\n                this.getState();\n                this.range().skipHiddenCells().clearContent();\n            }\n        });\n        kendo.spreadsheet.EditCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = options.property || 'input';\n                PropertyChangeCommand.fn.init.call(this, options);\n            },\n            rejectState: function (validationState) {\n                this.undo();\n                return {\n                    title: validationState.title,\n                    body: validationState.message,\n                    reason: 'error',\n                    type: 'validationError'\n                };\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            exec: function () {\n                var range = this.range();\n                if (!range.enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'rangeDisabled'\n                    };\n                }\n                var value = this._value;\n                this.getState();\n                if (this._property == 'value') {\n                    range.value(value);\n                    return;\n                }\n                try {\n                    range.link(null);\n                    if (value === '') {\n                        range.value(null);\n                    } else {\n                        range.input(value);\n                        if (/\\n/.test(range.value())) {\n                            range.wrap(true);\n                        }\n                    }\n                    range._adjustRowHeight();\n                    var validationState = range._getValidationState();\n                    if (validationState) {\n                        return this.rejectState(validationState);\n                    }\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.calc.ParseError) {\n                        return {\n                            title: 'Error in formula',\n                            body: ex + '',\n                            reason: 'error'\n                        };\n                    } else {\n                        throw ex;\n                    }\n                }\n            }\n        });\n        kendo.spreadsheet.TextWrapCommand = PropertyChangeCommand.extend({\n            init: function (options) {\n                options.property = 'wrap';\n                PropertyChangeCommand.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            getState: function () {\n                var rowHeight = {};\n                this.range().forEachRow(function (range) {\n                    var index = range.topLeft().row;\n                    rowHeight[index] = range.sheet().rowHeight(index);\n                });\n                this._state = this.range().getState(this._property);\n                this._rowHeight = rowHeight;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                var rowHeight = this._rowHeight;\n                this.range().setState(this._state);\n                for (var row in rowHeight) {\n                    sheet.rowHeight(row, rowHeight[row]);\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustDecimalsCommand = Command.extend({\n            init: function (options) {\n                this._decimals = options.value;\n                options.property = 'format';\n                Command.fn.init.call(this, options);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                var decimals = this._decimals;\n                var formatting = kendo.spreadsheet.formatting;\n                this.getState();\n                sheet.batch(function () {\n                    this.range().forEachCell(function (row, col, cell) {\n                        var format = cell.format;\n                        if (format || decimals > 0) {\n                            format = formatting.adjustDecimals(format || '#', decimals);\n                            sheet.range(row, col).format(format);\n                        }\n                    });\n                }.bind(this));\n            }\n        });\n        kendo.spreadsheet.BorderChangeCommand = Command.extend({\n            init: function (options) {\n                options.property = 'border';\n                Command.fn.init.call(this, options);\n                this._type = options.border;\n                this._style = options.style;\n            },\n            _batch: function (f) {\n                return this.range().sheet().batch(f, {});\n            },\n            exec: function () {\n                var self = this;\n                self.getState();\n                self._batch(function () {\n                    self[self._type](self._style);\n                });\n            },\n            noBorders: function () {\n                this.range().insideBorders(null);\n                this.outsideBorders(null);\n            },\n            allBorders: function (style) {\n                this.range().insideBorders(style);\n                this.outsideBorders(style);\n            },\n            leftBorder: function (style) {\n                this.range().leftColumn().borderLeft(style);\n            },\n            rightBorder: function (style) {\n                this.range().rightColumn().borderRight(style);\n            },\n            topBorder: function (style) {\n                this.range().topRow().borderTop(style);\n            },\n            bottomBorder: function (style) {\n                this.range().bottomRow().borderBottom(style);\n            },\n            outsideBorders: function (style) {\n                var range = this.range();\n                range.leftColumn().borderLeft(style);\n                range.topRow().borderTop(style);\n                range.rightColumn().borderRight(style);\n                range.bottomRow().borderBottom(style);\n            },\n            insideBorders: function (style) {\n                this.range().insideBorders(style);\n                this.outsideBorders(null);\n            },\n            insideHorizontalBorders: function (style) {\n                this.range().insideHorizontalBorders(style);\n            },\n            insideVerticalBorders: function (style) {\n                this.range().insideVerticalBorders(style);\n            }\n        });\n        kendo.spreadsheet.MergeCellCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this[this._type]();\n            },\n            activate: function (ref) {\n                this.range().sheet().activeCell(ref);\n            },\n            getState: function () {\n                this._state = this.range().getState();\n            },\n            undo: function () {\n                if (this._type !== 'unmerge') {\n                    this.range().unmerge();\n                    this.activate(this.range().topLeft());\n                }\n                this.range().setState(this._state);\n            },\n            cells: function () {\n                var range = this.range();\n                var ref = range._ref;\n                range.merge();\n                this.activate(ref);\n            },\n            horizontally: function () {\n                var ref = this.range().topRow()._ref;\n                this.range().forEachRow(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            vertically: function () {\n                var ref = this.range().leftColumn()._ref;\n                this.range().forEachColumn(function (range) {\n                    range.merge();\n                });\n                this.activate(ref);\n            },\n            unmerge: function () {\n                var range = this.range();\n                var ref = range._ref.topLeft;\n                range.unmerge();\n                this.activate(ref);\n            }\n        });\n        kendo.spreadsheet.FreezePanesCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._type = options.value;\n            },\n            exec: function () {\n                this.getState();\n                this._topLeft = this.range().topLeft();\n                this[this._type]();\n            },\n            getState: function () {\n                this._state = this.range().sheet().getState();\n            },\n            undo: function () {\n                this.range().sheet().setState(this._state);\n            },\n            panes: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col).frozenRows(topLeft.row);\n            },\n            rows: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenRows(topLeft.row);\n            },\n            columns: function () {\n                var topLeft = this._topLeft;\n                var sheet = this.range().sheet();\n                sheet.frozenColumns(topLeft.col);\n            },\n            unfreeze: function () {\n                var sheet = this.range().sheet();\n                sheet.frozenRows(0).frozenColumns(0);\n            }\n        });\n        kendo.spreadsheet.PasteCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            getState: function () {\n                this._range = this._workbook.activeSheet().range(this._clipboard.pasteRef());\n                this._state = this._range.getState();\n            },\n            exec: function () {\n                this.getState();\n                this._clipboard.parse();\n                var status = this._clipboard.canPaste();\n                if (!status.canPaste) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    }\n                    if (status.pasteOnMerged) {\n                        return {\n                            reason: 'error',\n                            type: 'modifyMerged'\n                        };\n                    }\n                    if (status.overflow) {\n                        return {\n                            reason: 'error',\n                            type: 'overflow'\n                        };\n                    }\n                    if (status.pasteOnDisabled) {\n                        this._event.preventDefault();\n                        return {\n                            reason: 'error',\n                            type: 'cannotModifyDisabled'\n                        };\n                    }\n                    return { reason: 'error' };\n                }\n                var range = this._workbook.activeSheet().selection();\n                var preventDefault = this._workbook.trigger('paste', { range: range });\n                if (preventDefault) {\n                    this._event.preventDefault();\n                } else {\n                    this._clipboard.paste();\n                    range._adjustRowHeight();\n                }\n            }\n        });\n        kendo.spreadsheet.AdjustRowHeightCommand = Command.extend({\n            exec: function () {\n                var options = this.options;\n                var sheet = this._workbook.activeSheet();\n                var range = options.range || sheet.range(options.rowIndex);\n                range._adjustRowHeight();\n            }\n        });\n        kendo.spreadsheet.ToolbarPasteCommand = Command.extend({\n            exec: function () {\n                if (kendo.support.clipboard.paste) {\n                    this._workbook._view.clipboard.focus().select();\n                    document.execCommand('paste');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.CopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            undo: $.noop,\n            exec: function () {\n                var status = this._clipboard.canCopy();\n                this._clipboard.menuInvoked = true;\n                if (!status.canCopy) {\n                    if (status.menuInvoked) {\n                        return {\n                            reason: 'error',\n                            type: 'useKeyboard'\n                        };\n                    } else if (status.multiSelection) {\n                        return {\n                            reason: 'error',\n                            type: 'unsupportedSelection'\n                        };\n                    }\n                    return;\n                }\n                var range = this._workbook.activeSheet().selection();\n                var preventDefault = this._workbook.trigger('copy', { range: range });\n                if (preventDefault) {\n                    this._event.preventDefault();\n                } else {\n                    this._clipboard.copy();\n                }\n            }\n        });\n        function copyToClipboard(html) {\n            var textarea = document.createElement('textarea');\n            $(textarea).addClass('k-spreadsheet-clipboard').val(html).appendTo(document.body).focus().select();\n            document.execCommand('copy');\n            $(textarea).remove();\n        }\n        kendo.spreadsheet.ToolbarCopyCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            undo: $.noop,\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    copyToClipboard(clipboard.html());\n                    clipboard.trigger('copy');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.CutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n                this._event = options.event;\n            },\n            exec: function () {\n                if (!(this.range().enable() && this._clipboard.canCopy())) {\n                    this._event.preventDefault();\n                    return {\n                        reason: 'error',\n                        type: 'cannotModifyDisabled'\n                    };\n                }\n                this.getState();\n                var range = this._workbook.activeSheet().selection();\n                var preventDefault = this._workbook.trigger('cut', { range: range });\n                if (preventDefault) {\n                    this._event.preventDefault();\n                    return;\n                }\n                this._clipboard.cut();\n            }\n        });\n        kendo.spreadsheet.AutoFillCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n            },\n            origin: function (origin) {\n                this._origin = origin;\n            },\n            exec: function () {\n                var range = this.range();\n                if (!range.enable()) {\n                    return {\n                        reason: 'error',\n                        type: 'rangeDisabled'\n                    };\n                }\n                this.getState();\n                try {\n                    range.fillFrom(this._origin);\n                } catch (ex) {\n                    if (ex instanceof kendo.spreadsheet.Range.FillError) {\n                        return {\n                            reason: 'error',\n                            type: ex.code\n                        };\n                    }\n                    throw ex;\n                }\n            }\n        });\n        kendo.spreadsheet.ToolbarCutCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._clipboard = options.workbook.clipboard();\n            },\n            exec: function () {\n                if (kendo.support.clipboard.copy) {\n                    var clipboard = this._workbook._view.clipboard;\n                    copyToClipboard(clipboard.html());\n                    clipboard.trigger('cut');\n                } else {\n                    return {\n                        reason: 'error',\n                        type: 'useKeyboard'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.FilterCommand = Command.extend({\n            undo: function () {\n                this.range().filter(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                this._state = range.hasFilter();\n                range.filter(!this._state);\n            }\n        });\n        kendo.spreadsheet.SortCommand = Command.extend({\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setState(this._state);\n            },\n            exec: function () {\n                var range = this.range();\n                var sheet = range.sheet();\n                var activeCell = sheet.activeCell();\n                var col = this.options.sheet ? activeCell.topLeft.col : this.options.column || 0;\n                var ascending = this.options.value === 'asc' ? true : false;\n                this._state = sheet.getState();\n                if (this.options.sheet) {\n                    range = this.expandRange();\n                }\n                var reason = range.cantSort();\n                if (reason) {\n                    return {\n                        reason: 'error',\n                        type: reason.code\n                    };\n                }\n                range.sort({\n                    column: col,\n                    ascending: ascending\n                });\n            },\n            expandRange: function () {\n                var sheet = this.range().sheet();\n                return new kendo.spreadsheet.Range(sheet._sheetRef, sheet);\n            }\n        });\n        var ApplyFilterCommand = kendo.spreadsheet.ApplyFilterCommand = Command.extend({\n            column: function () {\n                return this.options.column || 0;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.clearFilter(this.column());\n                if (this._state.length) {\n                    this.range().filter(this._state);\n                }\n            },\n            getState: function () {\n                var sheet = this.range().sheet();\n                var current = sheet.filter();\n                if (current) {\n                    this._state = current.columns.filter(function (c) {\n                        return c.index == this.column();\n                    }.bind(this));\n                }\n            },\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                var current = range.sheet().filter();\n                var options;\n                var filterRule;\n                var exists = false;\n                if (this.options.valueFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.ValueFilter(this.options.valueFilter)\n                    };\n                } else if (this.options.customFilter) {\n                    filterRule = {\n                        column: column,\n                        filter: new kendo.spreadsheet.CustomFilter(this.options.customFilter)\n                    };\n                }\n                this.getState();\n                if (current && current.ref.eq(range._ref) && current.columns.length) {\n                    current.columns.forEach(function (element) {\n                        if (element.index === column) {\n                            exists = true;\n                        }\n                    });\n                    options = current.columns.map(function (element) {\n                        return element.index === column ? filterRule : {\n                            column: element.index,\n                            filter: element.filter\n                        };\n                    });\n                    if (!exists) {\n                        options.push(filterRule);\n                    }\n                } else {\n                    options = filterRule;\n                }\n                range.filter(options);\n            }\n        });\n        kendo.spreadsheet.ClearFilterCommand = ApplyFilterCommand.extend({\n            exec: function () {\n                var range = this.range();\n                var column = this.column();\n                this.getState();\n                range.clearFilter(column);\n            }\n        });\n        kendo.spreadsheet.HideLineCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this.axis = options.axis;\n            },\n            undo: function () {\n                var sheet = this.range().sheet();\n                sheet.setAxisState(this._state);\n            },\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().hideSelectedRows();\n                } else {\n                    sheet.axisManager().hideSelectedColumns();\n                }\n            }\n        });\n        kendo.spreadsheet.UnHideLineCommand = kendo.spreadsheet.HideLineCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                this._state = sheet.getAxisState();\n                if (this.axis == 'row') {\n                    sheet.axisManager().unhideSelectedRows();\n                } else {\n                    sheet.axisManager().unhideSelectedColumns();\n                }\n            }\n        });\n        var DeleteCommand = Command.extend({\n            exec: function () {\n                this._expandedRange = this._expand(this.range());\n                this._state = this._expandedRange.getState();\n                this._indexes = this._exec(this._expandedRange.sheet());\n            },\n            undo: function () {\n                var self = this;\n                var range = self._expandedRange;\n                var sheet = range.sheet();\n                sheet.batch(function () {\n                    self._indexes.forEach(function (x) {\n                        self._undoOne(sheet, x);\n                        sheet._restoreModifiedFormulas(x.formulas);\n                    });\n                    range.setState(self._state);\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            }\n        });\n        kendo.spreadsheet.DeleteRowCommand = DeleteCommand.extend({\n            _expand: function (range) {\n                return range.resize({\n                    left: -Infinity,\n                    right: +Infinity\n                });\n            },\n            _exec: function (sheet) {\n                return sheet.axisManager().deleteSelectedRows();\n            },\n            _undoOne: function (sheet, x) {\n                sheet.insertRow(x.index);\n                sheet.rowHeight(x.index, x.height);\n            }\n        });\n        kendo.spreadsheet.DeleteColumnCommand = DeleteCommand.extend({\n            _expand: function (range) {\n                return range.resize({\n                    top: -Infinity,\n                    bottom: +Infinity\n                });\n            },\n            _exec: function (sheet) {\n                return sheet.axisManager().deleteSelectedColumns();\n            },\n            _undoOne: function (sheet, x) {\n                sheet.insertColumn(x.index);\n                sheet.columnWidth(x.index, x.width);\n            }\n        });\n        var AddCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            undo: function () {\n                var self = this;\n                var sheet = self.range().sheet();\n                sheet.batch(function () {\n                    for (var i = self._pos.count; --i >= 0;) {\n                        self._undoOne(sheet, self._pos.base);\n                    }\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            }\n        });\n        kendo.spreadsheet.AddColumnCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                var result = sheet.axisManager().preventAddColumn();\n                if (result) {\n                    return result;\n                }\n                if (this._value === 'left') {\n                    this._pos = sheet.axisManager().addColumnLeft();\n                } else {\n                    this._pos = sheet.axisManager().addColumnRight();\n                }\n            },\n            _undoOne: function (sheet, index) {\n                sheet.deleteColumn(index);\n            }\n        });\n        kendo.spreadsheet.AddRowCommand = AddCommand.extend({\n            exec: function () {\n                var sheet = this.range().sheet();\n                var result = sheet.axisManager().preventAddRow();\n                if (result) {\n                    return result;\n                }\n                if (this._value === 'above') {\n                    this._pos = sheet.axisManager().addRowAbove();\n                } else {\n                    this._pos = sheet.axisManager().addRowBelow();\n                }\n            },\n            _undoOne: function (sheet, index) {\n                sheet.deleteRow(index);\n            }\n        });\n        kendo.spreadsheet.EditValidationCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._value = options.value;\n            },\n            exec: function () {\n                this.range().validation(this._value);\n            }\n        });\n        kendo.spreadsheet.OpenCommand = Command.extend({\n            cannotUndo: true,\n            exec: function () {\n                var file = this.options.file;\n                if (file.name.match(/.xlsx$/i) === null) {\n                    return {\n                        reason: 'error',\n                        type: 'openUnsupported'\n                    };\n                }\n                var workbook = this.options.workbook;\n                workbook.fromFile(this.options.file).then(function () {\n                    var errors = workbook.excelImportErrors;\n                    if (errors && errors.length) {\n                        workbook._view.openDialog('importError', { errors: errors });\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.SaveAsCommand = Command.extend({\n            exec: function () {\n                var fileName = this.options.name + this.options.extension;\n                if (this.options.extension === '.xlsx') {\n                    this.options.workbook.saveAsExcel({ fileName: fileName });\n                } else if (this.options.extension === '.pdf') {\n                    this.options.workbook.saveAsPDF($.extend(this.options.pdf, {\n                        workbook: this.options.workbook,\n                        fileName: fileName\n                    }));\n                }\n            }\n        });\n        var NameCommand = Command.extend({\n            init: function (options) {\n                Command.fn.init.call(this, options);\n                this._name = options.name;\n                this._value = options.value;\n            },\n            getState: function () {\n                this._state = this._workbook.nameDefinition(this._name);\n            },\n            setState: function () {\n                this._workbook.nameDefinition(this._name, this._state);\n                this._workbook.trigger('change', { recalc: true });\n            }\n        });\n        kendo.spreadsheet.DefineNameCommand = NameCommand.extend({\n            exec: function () {\n                this.getState();\n                try {\n                    this._workbook.defineName(this._name, this._value);\n                    this._workbook.trigger('change', { recalc: true });\n                } catch (ex) {\n                    return {\n                        title: 'Error',\n                        body: ex + '',\n                        reason: 'error'\n                    };\n                }\n            }\n        });\n        kendo.spreadsheet.DeleteNameCommand = NameCommand.extend({\n            exec: function () {\n                this.getState();\n                this._workbook.undefineName(this._name);\n                this._workbook.trigger('change', { recalc: true });\n            }\n        });\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulabar', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var classNames = { wrapper: 'k-spreadsheet-formula-bar' };\n        var FormulaBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element.addClass(FormulaBar.classNames.wrapper);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput($('<div/>').appendTo(element));\n            },\n            destroy: function () {\n                if (this.formulaInput) {\n                    this.formulaInput.destroy();\n                }\n                this.formulaInput = null;\n            }\n        });\n        kendo.spreadsheet.FormulaBar = FormulaBar;\n        $.extend(true, FormulaBar, { classNames: classNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulainput', ['kendo.core'], f);\n}(function () {\n    (function (kendo, window) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var ns = '.kendoFormulaInput';\n        var keys = kendo.keys;\n        var classNames = {\n            wrapper: 'k-spreadsheet-formula-input',\n            listWrapper: 'k-spreadsheet-formula-list'\n        };\n        var styles = [\n            'font-family',\n            'font-size',\n            'font-stretch',\n            'font-style',\n            'font-weight',\n            'letter-spacing',\n            'text-transform',\n            'line-height'\n        ];\n        var KEY_NAMES = {\n            27: 'esc',\n            37: 'left',\n            39: 'right',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar'\n        };\n        var PRIVATE_FORMULA_CHECK = /(^_|[^a-z0-9]$)/i;\n        var FormulaInput = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(FormulaInput.classNames.wrapper).attr('contenteditable', true).attr('spellcheck', false).css('white-space', 'pre');\n                if (this.options.autoScale) {\n                    element.on('input', this.scale.bind(this));\n                }\n                this._highlightedRefs = [];\n                this._staticTokens = [];\n                this._formulaSource();\n                this._formulaList();\n                this._popup();\n                this._tooltip();\n                element.on('keydown', this._keydown.bind(this)).on('keyup', this._keyup.bind(this)).on('blur', this._blur.bind(this)).on('input click', this._input.bind(this)).on('focus', this._focus.bind(this)).on('paste', this._paste.bind(this));\n            },\n            options: {\n                name: 'FormulaInput',\n                autoScale: false,\n                filterOperator: 'startswith',\n                scalePadding: 30,\n                minLength: 1\n            },\n            events: [\n                'keyup',\n                'focus'\n            ],\n            enable: function (enable) {\n                if (enable === undefined) {\n                    return this.element.attr('contenteditable') === 'true';\n                }\n                if (enable) {\n                    this.element.attr('contenteditable', enable);\n                } else {\n                    this.element.removeAttr('contenteditable');\n                }\n                this.element.toggleClass('k-state-disabled', !enable);\n            },\n            getPos: function () {\n                var div = this.element[0];\n                var sel = window.getSelection();\n                var a = lookup(sel.focusNode, sel.focusOffset);\n                var b = lookup(sel.anchorNode, sel.anchorOffset);\n                if (a != null && b != null) {\n                    if (a > b) {\n                        var tmp = a;\n                        a = b;\n                        b = tmp;\n                    }\n                    return {\n                        begin: a,\n                        end: b,\n                        collapsed: a == b\n                    };\n                }\n                function lookup(lookupNode, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node === lookupNode) {\n                                throw pos;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            } else if (node.nodeType == 3) {\n                                pos += node.nodeValue.length;\n                            }\n                        }(div));\n                    } catch (index) {\n                        return index;\n                    }\n                }\n            },\n            setPos: function (begin, end) {\n                var eiv = this.element[0];\n                begin = lookup(eiv, begin);\n                if (end != null) {\n                    end = lookup(eiv, end);\n                } else {\n                    end = begin;\n                }\n                if (begin && end) {\n                    var range = document.createRange();\n                    range.setStart(begin.node, begin.pos);\n                    range.setEnd(end.node, end.pos);\n                    var sel = window.getSelection();\n                    var currentRange = sel.getRangeAt(0);\n                    if (differ(range, currentRange)) {\n                        sel.removeAllRanges();\n                        sel.addRange(range);\n                    }\n                }\n                function differ(a, b) {\n                    return a.startOffset != b.startOffset || a.endOffset != b.endOffset || a.startContainer != b.endContainer || a.endContainer != b.endContainer;\n                }\n                function lookup(node, pos) {\n                    try {\n                        (function loop(node) {\n                            if (node.nodeType == 3) {\n                                var len = node.nodeValue.length;\n                                if (len >= pos) {\n                                    throw node;\n                                }\n                                pos -= len;\n                            } else if (node.nodeType == 1) {\n                                for (var i = node.firstChild; i; i = i.nextSibling) {\n                                    loop(i);\n                                }\n                            }\n                        }(node));\n                    } catch (el) {\n                        return {\n                            node: el,\n                            pos: pos\n                        };\n                    }\n                }\n            },\n            end: function () {\n                this.setPos(this.length());\n            },\n            home: function () {\n                this.setPos(0);\n            },\n            select: function () {\n                this.setPos(0, this.length());\n            },\n            length: function () {\n                return this.value().length;\n            },\n            _formulaSource: function () {\n                var result = [];\n                var value;\n                for (var key in kendo.spreadsheet.calc.runtime.FUNCS) {\n                    if (!PRIVATE_FORMULA_CHECK.test(key)) {\n                        value = key.toUpperCase();\n                        result.push({\n                            value: value,\n                            text: value\n                        });\n                    }\n                }\n                this.formulaSource = new kendo.data.DataSource({ data: result });\n            },\n            _formulaList: function () {\n                this.list = new kendo.ui.StaticList($('<ul />').addClass(FormulaInput.classNames.listWrapper).insertAfter(this.element), {\n                    autoBind: false,\n                    selectable: true,\n                    change: this._formulaListChange.bind(this),\n                    dataSource: this.formulaSource,\n                    dataValueField: 'value',\n                    template: '#:data.value#'\n                });\n                this.list.element.on('mousedown', function (e) {\n                    e.preventDefault();\n                });\n            },\n            _formulaListChange: function () {\n                var tokenCtx = this._tokenContext();\n                if (!tokenCtx || this._mute) {\n                    return;\n                }\n                var activeToken = tokenCtx.token;\n                var completion = this.list.value()[0];\n                var ctx = {\n                    replace: true,\n                    token: activeToken,\n                    end: activeToken.end\n                };\n                if (!tokenCtx.nextToken || tokenCtx.nextToken.value != '(') {\n                    completion += '(';\n                }\n                this._replaceAt(ctx, completion);\n                this.popup.close();\n            },\n            _popup: function () {\n                this.popup = new kendo.ui.Popup(this.list.element, { anchor: this.element });\n            },\n            _blur: function () {\n                this.popup.close();\n                clearTimeout(this._focusId);\n                this.trigger('blur');\n            },\n            _isFormula: function () {\n                return /^=/.test(this.value());\n            },\n            _keydown: function (e) {\n                var key = e.keyCode;\n                if (KEY_NAMES[key]) {\n                    this.popup.close();\n                    this._navigated = true;\n                } else if (this._move(key)) {\n                    this._navigated = true;\n                    e.preventDefault();\n                }\n                this._keyDownTimeout = setTimeout(this._syntaxHighlight.bind(this));\n            },\n            _keyup: function () {\n                var popup = this.popup;\n                var value;\n                if (this._isFormula() && !this._navigated) {\n                    value = ((this._tokenContext() || {}).token || {}).value;\n                    this.filter(value);\n                    if (!value || !this.formulaSource.view().length) {\n                        popup.close();\n                    } else {\n                        popup[popup.visible() ? 'position' : 'open']();\n                        this.list.focusFirst();\n                    }\n                }\n                this._navigated = false;\n                this._syntaxHighlight();\n                this.trigger('keyup');\n            },\n            _input: function () {\n                this._syntaxHighlight();\n            },\n            _focus: function () {\n                this._focusTimeout = setTimeout(this._syntaxHighlight.bind(this));\n                this.trigger('focus');\n            },\n            _paste: function (ev) {\n                ev.preventDefault();\n                var pos = this.getPos();\n                var text;\n                if (kendo.support.browser.msie) {\n                    text = window.clipboardData.getData('Text');\n                } else {\n                    text = ev.originalEvent.clipboardData.getData('text/plain');\n                }\n                var val = this.value();\n                val = val.substr(0, pos.begin) + text + val.substr(pos.end);\n                this.value(val);\n                this.setPos(pos.begin + text.length);\n                this.scale();\n            },\n            _move: function (key) {\n                var list = this.list;\n                var popup = this.popup;\n                if (popup.visible()) {\n                    if (key === keys.DOWN) {\n                        list.focusNext();\n                        if (!list.focus()) {\n                            list.focusFirst();\n                        }\n                        return true;\n                    }\n                    if (key === keys.UP) {\n                        list.focusPrev();\n                        if (!list.focus()) {\n                            list.focusLast();\n                        }\n                        return true;\n                    }\n                    if (key === keys.ENTER) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.TAB) {\n                        list.select(list.focus());\n                        popup.close();\n                        return true;\n                    }\n                    if (key === keys.PAGEUP) {\n                        list.focusFirst();\n                        return true;\n                    }\n                    if (key === keys.PAGEDOWN) {\n                        list.focusLast();\n                        return true;\n                    }\n                }\n                return key === keys.ENTER || key === keys.TAB;\n            },\n            _tokenContext: function () {\n                var point = this.getPos();\n                var value = this.value();\n                if (!value || !point || !point.collapsed) {\n                    return null;\n                }\n                var tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                var tok;\n                for (var i = 0; i < tokens.length; ++i) {\n                    tok = tokens[i];\n                    if (touches(tok, point) && /^(?:str|sym|func)$/.test(tok.type)) {\n                        return {\n                            token: tok,\n                            nextToken: tokens[i + 1]\n                        };\n                    }\n                }\n                return null;\n            },\n            _sync: function () {\n                if (this._editorToSync && this.isActive()) {\n                    this._editorToSync.value(this.value());\n                }\n            },\n            _textContainer: function () {\n                var computedStyles = kendo.getComputedStyles(this.element[0], styles);\n                computedStyles.position = 'absolute';\n                computedStyles.visibility = 'hidden';\n                computedStyles.whiteSpace = 'pre';\n                computedStyles.top = -3333;\n                computedStyles.left = -3333;\n                this._span = $('<span style=\\'white-space: pre\\'/>').css(computedStyles).insertAfter(this.element);\n            },\n            _tooltip: function () {\n                this._cellTooltip = $('<div class=\"k-widget k-tooltip\" style=\"position:absolute; display:none\">A1</div>').insertAfter(this.element);\n            },\n            tooltip: function (value) {\n                this._cellTooltip.text(value);\n            },\n            toggleTooltip: function (show) {\n                this._cellTooltip.toggle(show);\n            },\n            isActive: function () {\n                return this.element[0] === kendo._activeElement();\n            },\n            filter: function (value) {\n                if (!value || value.length < this.options.minLength) {\n                    return;\n                }\n                this._mute = true;\n                this.list.select(-1);\n                this._mute = false;\n                this.formulaSource.filter({\n                    field: this.list.options.dataValueField,\n                    operator: this.options.filterOperator,\n                    value: value\n                });\n            },\n            hide: function () {\n                this.enable(false);\n                this.element.hide();\n                this._cellTooltip.hide();\n            },\n            show: function () {\n                this.enable(true);\n                this.element.show();\n            },\n            row: function () {\n                if (this.activeCell) {\n                    return this.activeCell.row;\n                }\n            },\n            col: function () {\n                if (this.activeCell) {\n                    return this.activeCell.col;\n                }\n            },\n            position: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.show();\n                this.element.css({\n                    'top': rectangle.top + 1 + 'px',\n                    'left': rectangle.left + 1 + 'px'\n                });\n                this._cellTooltip.css({\n                    'top': rectangle.top - this._cellTooltip.height() - 10 + 'px',\n                    'left': rectangle.left\n                });\n            },\n            resize: function (rectangle) {\n                if (!rectangle) {\n                    return;\n                }\n                this.element.css({\n                    width: rectangle.width - 1,\n                    height: rectangle.height - 1\n                });\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var result = this._canInsertRef(isKeyboardAction);\n                var token = result && result.token;\n                var idx;\n                if (token) {\n                    for (idx = 0; idx < this._staticTokens.length; idx++) {\n                        if (isEqualToken(token, this._staticTokens[idx])) {\n                            return null;\n                        }\n                    }\n                }\n                return result;\n            },\n            _canInsertRef: function (isKeyboardAction) {\n                if (this.popup.visible()) {\n                    return null;\n                }\n                var strictMode = isKeyboardAction;\n                var point = this.getPos();\n                var tokens, tok;\n                if (point && this._isFormula()) {\n                    if (point.begin === 0) {\n                        return null;\n                    }\n                    tokens = kendo.spreadsheet.calc.tokenize(this.value(), this.row(), this.col());\n                    for (var i = 0; i < tokens.length; ++i) {\n                        tok = tokens[i];\n                        if (touches(tok, point)) {\n                            return canReplace(tok);\n                        }\n                        if (afterPoint(tok)) {\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                    return canInsertBetween(tok, null);\n                }\n                return null;\n                function afterPoint(tok) {\n                    return tok.begin > point.begin;\n                }\n                function canReplace(tok) {\n                    if (tok) {\n                        if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                            return {\n                                replace: true,\n                                token: tok,\n                                end: tok.end\n                            };\n                        }\n                        if (/^(?:op|punc|startexp)$/.test(tok.type)) {\n                            if (tok.end == point.end) {\n                                return canInsertBetween(tok, tokens[i + 1]);\n                            }\n                            return canInsertBetween(tokens[i - 1], tok);\n                        }\n                    }\n                }\n                function canInsertBetween(left, right) {\n                    if (left == null) {\n                        return null;\n                    }\n                    if (right == null) {\n                        if (/^(?:op|startexp)$/.test(left.type) || isOpenParen(left.value)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        return null;\n                    }\n                    if (strictMode) {\n                        if (left.type == 'op' && /^(?:punc|op)$/.test(right.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                    } else {\n                        if (left.type == 'startexp') {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:ref|op|punc)$/.test(left.type)) {\n                            return {\n                                token: left,\n                                end: point.end\n                            };\n                        }\n                        if (/^(?:punc|op)$/.test(left.type)) {\n                            return /^[,;({]$/.test(left.value) ? {\n                                token: left,\n                                end: point.end\n                            } : null;\n                        }\n                    }\n                    return false;\n                }\n            },\n            refAtPoint: function (sheet) {\n                var x = this._canInsertRef();\n                if (x) {\n                    var ref = sheet.selection()._ref.simplify().clone().relative(0, 0, 3);\n                    if (sheet !== this.activeSheet) {\n                        ref = ref.setSheet(sheet.name(), true);\n                    }\n                    this._replaceAt(x, ref.print(0, 0));\n                }\n            },\n            _replaceAt: function (ctx, newValue) {\n                var value = this.value();\n                var tok = ctx.token;\n                var rest = value.substr(ctx.end);\n                value = value.substr(0, ctx.replace ? tok.begin : ctx.end) + newValue;\n                var point = value.length;\n                value += rest;\n                this._value(value);\n                this.setPos(point);\n                this.scale();\n                this._syntaxHighlight();\n                this._sync();\n            },\n            syncWith: function (formulaInput) {\n                var self = this;\n                var eventName = 'input' + ns;\n                var handler = self._sync.bind(self), iehandler;\n                if (kendo.support.browser.msie) {\n                    eventName = 'keydown' + ns;\n                    iehandler = function () {\n                        setTimeout(handler);\n                    };\n                }\n                self._editorToSync = formulaInput;\n                self.element.off(eventName).on(eventName, iehandler || handler);\n            },\n            scale: function () {\n                var element = this.element;\n                var width, height;\n                if (!this._span) {\n                    this._textContainer();\n                }\n                this._span.html(element.html());\n                width = this._span.width() + this.options.scalePadding;\n                height = this._span.height();\n                if (width > element.width()) {\n                    element.width(width);\n                }\n                if (height > element.height()) {\n                    element.height(height);\n                }\n            },\n            _value: function (value) {\n                this.element.text(value);\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    var txt = this.element[0].innerText;\n                    return txt.replace(/\\n$/, '');\n                }\n                this._value(value);\n                this._syntaxHighlight();\n            },\n            highlightedRefs: function () {\n                return this._highlightedRefs.slice();\n            },\n            _syntaxHighlight: function () {\n                var pos = this.getPos();\n                var value = this.value();\n                var refClasses = kendo.spreadsheet.Pane.classNames.series;\n                var highlightedRefs = [];\n                var refIndex = 0;\n                var parens = [];\n                var tokens = [];\n                var activeToken;\n                if (pos && !pos.collapsed) {\n                    return;\n                }\n                if (!/^=/.test(value)) {\n                    if (this._staticTokens.length || this._highlightedRefs.length) {\n                        this._staticTokens = [];\n                        this._highlightedRefs = [];\n                        this.element.text(value);\n                    }\n                    if (this.popup) {\n                        this.popup.close();\n                    }\n                    return;\n                } else {\n                    tokens = kendo.spreadsheet.calc.tokenize(value, this.row(), this.col());\n                    tokens.forEach(function (tok) {\n                        tok.active = false;\n                        tok.cls = ['k-syntax-' + tok.type];\n                        if (tok.type == 'ref') {\n                            tok.colorClass = refClasses[refIndex++ % refClasses.length];\n                            tok.cls.push(tok.colorClass);\n                            highlightedRefs.push(tok);\n                        }\n                        if (pos && tok.type == 'punc') {\n                            if (isOpenParen(tok.value)) {\n                                parens.unshift(tok);\n                            } else if (isCloseParen(tok.value)) {\n                                var open = parens.shift();\n                                if (open) {\n                                    if (isMatchingParen(tok.value, open.value)) {\n                                        if (touches(tok, pos) || touches(open, pos)) {\n                                            tok.cls.push('k-syntax-paren-match');\n                                            open.cls.push('k-syntax-paren-match');\n                                        }\n                                    } else {\n                                        tok.cls.push('k-syntax-error');\n                                        open.cls.push('k-syntax-error');\n                                    }\n                                } else {\n                                    tok.cls.push('k-syntax-error');\n                                }\n                            }\n                        }\n                        if (pos && touches(tok, pos)) {\n                            tok.cls.push('k-syntax-at-point');\n                            tok.active = true;\n                            activeToken = tok;\n                        }\n                        if (tok.type == 'func' && !knownFunction(tok.value) && (!pos || !touches(tok, pos))) {\n                            tok.cls.push('k-syntax-error');\n                        }\n                    });\n                    tokens.reverse().forEach(function (tok) {\n                        var begin = tok.begin, end = tok.end;\n                        var text = kendo.htmlEncode(value.substring(begin, end));\n                        value = value.substr(0, begin) + '<span class=\\'' + tok.cls.join(' ') + '\\'>' + text + '</span>' + value.substr(end);\n                    });\n                    this.element.html(value);\n                }\n                if (pos) {\n                    this.setPos(pos.begin, pos.end);\n                }\n                if (activeToken && /^(?:startexp|op|punc)$/.test(activeToken.type)) {\n                    this._setStaticTokens(tokens);\n                }\n                this._highlightedRefs = highlightedRefs;\n            },\n            _setStaticTokens: function (tokens) {\n                var idx, tok;\n                this._staticTokens = [];\n                for (idx = 0; idx < tokens.length; idx++) {\n                    tok = tokens[idx];\n                    if (/^(?:num|str|bool|sym|ref)$/.test(tok.type)) {\n                        this._staticTokens.push(tok);\n                    }\n                }\n            },\n            destroy: function () {\n                this._editorToSync = null;\n                this.element.off(ns);\n                clearTimeout(this._focusTimeout);\n                clearTimeout(this._keyDownTimeout);\n                this._cellTooltip = null;\n                this._span = null;\n                this.popup.destroy();\n                this.popup = null;\n                Widget.fn.destroy.call(this);\n            },\n            insertNewline: function () {\n                var val = this.value();\n                var pos = this.getPos();\n                var eof = pos.end == val.length;\n                val = val.substr(0, pos.begin) + (eof ? '\\n\\n' : '\\n' + val.substr(pos.end));\n                this.value(val);\n                this.setPos(pos.begin + 1);\n            }\n        });\n        function isOpenParen(ch) {\n            return ch == '(' || ch == '[' || ch == '{';\n        }\n        function isCloseParen(ch) {\n            return ch == ')' || ch == ']' || ch == '}';\n        }\n        function isMatchingParen(close, open) {\n            return open == '(' ? close == ')' : open == '[' ? close == ']' : open == '{' ? close == '}' : false;\n        }\n        function touches(pos, target) {\n            return pos.begin <= target.begin && pos.end >= target.end;\n        }\n        function knownFunction(name) {\n            return kendo.spreadsheet.calc.runtime.FUNCS[name.toLowerCase()];\n        }\n        function isEqualToken(tok1, tok2) {\n            if (!tok1 || !tok2) {\n                return false;\n            }\n            if (tok1.type == 'ref' && tok2.type == 'ref') {\n                return tok1.ref.eq(tok2.ref);\n            } else {\n                return tok1.value === tok2.value;\n            }\n        }\n        kendo.spreadsheet.FormulaInput = FormulaInput;\n        $.extend(true, FormulaInput, { classNames: classNames });\n    }(kendo, window));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/eventlistener', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var KEY_NAMES = {\n            8: 'backspace',\n            9: 'tab',\n            13: 'enter',\n            27: 'esc',\n            37: 'left',\n            38: 'up',\n            39: 'right',\n            40: 'down',\n            35: 'end',\n            36: 'home',\n            32: 'spacebar',\n            33: 'pageup',\n            34: 'pagedown',\n            46: 'delete',\n            113: ':edit'\n        };\n        var Mac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n        var isAlphaNum = function (keyCode) {\n            if (keyCode > 47 && keyCode < 58 || keyCode > 64 && keyCode < 91 || keyCode > 95 && keyCode < 112 || keyCode > 185 && keyCode < 193 || keyCode > 218 && keyCode < 223) {\n                return true;\n            }\n            return false;\n        };\n        var keyName = function (event) {\n            var keyCode = event.keyCode;\n            var name = KEY_NAMES[keyCode];\n            if (!name && isAlphaNum(keyCode)) {\n                name = ':alphanum';\n            }\n            if (!name && event.key && event.key.length == 1) {\n                name = ':alphanum';\n            }\n            return name;\n        };\n        var EventListener = kendo.Class.extend({\n            init: function (target, observer, handlers) {\n                this._handlers = {};\n                this.target = target;\n                this._observer = observer || window;\n                this.keyDownProxy = this.keyDown.bind(this);\n                this.mouseProxy = this.mouse.bind(this);\n                this.threshold = 5;\n                this._pressLocation = null;\n                target.on('keydown', this.keyDownProxy);\n                target.on('contextmenu mousedown cut copy paste scroll wheel click dblclick focus', this.mouseProxy);\n                $(document.documentElement).on('mousemove mouseup', this.mouseProxy);\n                if (handlers) {\n                    for (var key in handlers) {\n                        this.on(key, handlers[key]);\n                    }\n                }\n            },\n            keyDown: function (e) {\n                this.handleEvent(e, keyName(e.originalEvent));\n            },\n            mouse: function (e) {\n                var rightClick;\n                if (e.which) {\n                    rightClick = e.which == 3;\n                } else if (e.button) {\n                    rightClick = e.button == 2;\n                }\n                var type = e.type;\n                if (type === 'mousedown') {\n                    if (rightClick) {\n                        type = 'rightmousedown';\n                    } else {\n                        this._pressLocation = {\n                            x: e.pageX,\n                            y: e.pageY\n                        };\n                    }\n                }\n                if (type === 'mouseup') {\n                    if (!rightClick) {\n                        this._pressLocation = null;\n                    }\n                }\n                if (type === 'mousemove' && this._pressLocation) {\n                    var dx = this._pressLocation.x - e.pageX;\n                    var dy = this._pressLocation.y - e.pageY;\n                    var distance = Math.sqrt(dx * dx + dy * dy);\n                    if (distance > this.threshold) {\n                        type = 'mousedrag';\n                    }\n                }\n                this.handleEvent(e, type);\n            },\n            handleEvent: function (e, name) {\n                var eventKey = '';\n                e.mod = Mac ? e.metaKey : e.ctrlKey && !e.altKey;\n                if (e.altKey) {\n                    eventKey += 'alt+';\n                }\n                if (e.shiftKey) {\n                    eventKey += 'shift+';\n                }\n                if (e.ctrlKey) {\n                    eventKey += 'ctrl+';\n                }\n                eventKey += name;\n                var catchAllHandler = this._handlers['*+' + name];\n                if (catchAllHandler) {\n                    catchAllHandler.call(this._observer, e, eventKey);\n                }\n                var handler = this._handlers[eventKey];\n                if (handler) {\n                    handler.call(this._observer, e, eventKey);\n                }\n            },\n            on: function (event, callback) {\n                var handlers = this._handlers;\n                if (typeof callback === 'string') {\n                    callback = this._observer[callback];\n                }\n                if (typeof event === 'string') {\n                    event = event.split(',');\n                }\n                event.forEach(function (e) {\n                    handlers[e] = callback;\n                });\n            },\n            destroy: function () {\n                this.target.off('keydown', this.keyDownProxy);\n                this.target.off('keydown', this.mouseProxy);\n                $(document.documentElement).off('mousemove mouseup', this.mouseProxy);\n            }\n        });\n        kendo.spreadsheet.EventListener = EventListener;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/rangelist', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeTreeNode = kendo.Class.extend({\n            init: function Node(level, value, left, right) {\n                this.level = level;\n                this.value = value;\n                this.left = left;\n                this.right = right;\n            }\n        });\n        var NilNode = new function NIL() {\n            this.left = this;\n            this.right = this;\n            this.level = 0;\n        }();\n        function skew(node) {\n            if (node.left.level === node.level) {\n                var temp = node;\n                node = node.left;\n                temp.left = node.right;\n                node.right = temp;\n            }\n            return node;\n        }\n        function split(node) {\n            if (node.right.right.level === node.level) {\n                var temp = node;\n                node = node.right;\n                temp.right = node.left;\n                node.left = temp;\n                node.level += 1;\n            }\n            return node;\n        }\n        function insert(node, value) {\n            if (node === NilNode) {\n                return new RangeTreeNode(1, value, NilNode, NilNode);\n            } else if (node.value.start > value.start) {\n                node.left = insert(node.left, value);\n            } else {\n                node.right = insert(node.right, value);\n            }\n            return split(skew(node));\n        }\n        function remove(node, value) {\n            if (node === NilNode) {\n                return node;\n            }\n            var diff = node.value.start - value.start;\n            if (diff === 0) {\n                if (node.left !== NilNode && node.right !== NilNode) {\n                    var heir = node.left;\n                    while (heir.right !== NilNode) {\n                        heir = heir.right;\n                    }\n                    node.value = heir.value;\n                    node.left = remove(node.left, node.value);\n                } else if (node.left === NilNode) {\n                    node = node.right;\n                } else {\n                    node = node.left;\n                }\n            } else if (diff > 0) {\n                node.left = remove(node.left, value);\n            } else {\n                node.right = remove(node.right, value);\n            }\n            if (node.left.level < node.level - 1 || node.right.level < node.level - 1) {\n                node.level -= 1;\n                if (node.right.level > node.level) {\n                    node.right.level = node.level;\n                }\n                node = skew(node);\n                node.right = skew(node.right);\n                node.right.right = skew(node.right.right);\n                node = split(node);\n                node.right = split(node.right);\n            }\n            return node;\n        }\n        var Range = kendo.Class.extend({\n            init: function ValueRange(start, end, value) {\n                this.start = start;\n                this.end = end;\n                this.value = value;\n            },\n            intersects: function (range) {\n                return range.start <= this.end && range.end >= this.start;\n            },\n            clone: function () {\n                return new Range(this.start, this.end, this.value);\n            }\n        });\n        var RangeTree = kendo.Class.extend({\n            init: function () {\n                this.root = NilNode;\n            },\n            insert: function (value) {\n                this.root = insert(this.root, value);\n            },\n            remove: function (value) {\n                this.root = remove(this.root, value);\n            },\n            findrange: function (value) {\n                var node = this.root;\n                while (node != NilNode) {\n                    if (value < node.value.start) {\n                        node = node.left;\n                    } else if (value > node.value.end) {\n                        node = node.right;\n                    } else {\n                        return node.value;\n                    }\n                }\n                return null;\n            },\n            values: function () {\n                var result = [];\n                values(this.root, result);\n                return result;\n            },\n            intersecting: function (start, end) {\n                var ranges = [];\n                intersecting(this.root, new Range(start, end), ranges);\n                return ranges;\n            },\n            map: function (callback) {\n                var tree = new RangeTree();\n                map(tree, this.root, callback);\n                return tree;\n            },\n            clone: function () {\n                return this.map(function (value) {\n                    return value.clone();\n                });\n            },\n            first: function () {\n                var first = this.root;\n                while (first.left != NilNode) {\n                    first = first.left;\n                }\n                return first;\n            },\n            last: function () {\n                var last = this.root;\n                while (last.right != NilNode) {\n                    last = last.right;\n                }\n                return last;\n            }\n        });\n        function values(node, result) {\n            if (node === NilNode) {\n                return;\n            }\n            values(node.left, result);\n            result.push(node.value);\n            values(node.right, result);\n        }\n        function intersecting(node, range, ranges) {\n            if (node === NilNode) {\n                return;\n            }\n            var value = node.value;\n            if (range.start < value.start) {\n                intersecting(node.left, range, ranges);\n            }\n            if (value.intersects(range)) {\n                ranges.push(value);\n            }\n            if (range.end > value.end) {\n                intersecting(node.right, range, ranges);\n            }\n        }\n        function map(tree, root, callback) {\n            if (root === NilNode) {\n                return;\n            }\n            map(tree, root.left, callback);\n            tree.insert(callback(root.value));\n            map(tree, root.right, callback);\n        }\n        var RangeList = kendo.Class.extend({\n            init: function (start, end, value) {\n                if (end === undefined) {\n                    this.tree = start;\n                } else {\n                    this.tree = new RangeTree();\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            values: function () {\n                return this.tree.values();\n            },\n            map: function (callback) {\n                return new RangeList(this.tree.map(callback));\n            },\n            intersecting: function (start, end) {\n                return this.tree.intersecting(start, end);\n            },\n            first: function () {\n                return this.tree.first().value;\n            },\n            last: function () {\n                return this.tree.last().value;\n            },\n            insert: function (start, end, value) {\n                return this.tree.insert(new Range(start, end, value));\n            },\n            value: function (start, end, value) {\n                if (value === undefined) {\n                    if (end === undefined) {\n                        end = start;\n                    }\n                    return this.intersecting(start, end)[0].value;\n                }\n                var ranges = this.tree.intersecting(start - 1, end + 1);\n                if (ranges.length) {\n                    var firstRange = ranges[0], lastRange = ranges[ranges.length - 1];\n                    if (firstRange.end < start) {\n                        if (firstRange.value === value) {\n                            start = firstRange.start;\n                        } else {\n                            ranges.shift();\n                        }\n                    }\n                    if (lastRange.start > end) {\n                        if (lastRange.value === value) {\n                            end = lastRange.end;\n                        } else {\n                            ranges.pop();\n                        }\n                    }\n                    for (var i = 0, length = ranges.length; i < length; i++) {\n                        var range = ranges[i];\n                        var rangeValue = range.value;\n                        var rangeStart = range.start;\n                        var rangeEnd = range.end;\n                        this.tree.remove(range);\n                        if (rangeStart < start) {\n                            if (rangeValue !== value) {\n                                this.insert(rangeStart, start - 1, rangeValue);\n                            } else {\n                                start = rangeStart;\n                            }\n                        }\n                        if (rangeEnd > end) {\n                            if (rangeValue !== value) {\n                                this.insert(end + 1, rangeEnd, rangeValue);\n                            } else {\n                                end = rangeEnd;\n                            }\n                        }\n                    }\n                }\n                this.insert(start, end, value);\n            },\n            expandedValues: function (start, end) {\n                var ranges = this.intersecting(start, end);\n                var result = [];\n                var rangeIndex = 0;\n                for (var i = start; i <= end; i++) {\n                    if (ranges[rangeIndex].end < i) {\n                        rangeIndex++;\n                    }\n                    result.push({\n                        index: i - start,\n                        value: ranges[rangeIndex].value\n                    });\n                }\n                return result;\n            },\n            sortedIndices: function (start, end, valueComparer, indices) {\n                var result = this.expandedValues(start, end);\n                var comparer = function (a, b) {\n                    if (a.value === b.value) {\n                        return a.index - b.index;\n                    }\n                    return valueComparer(a.value, b.value);\n                };\n                if (indices) {\n                    comparer = function (a, b) {\n                        var x = indices[a.index];\n                        var y = indices[b.index];\n                        if (x.value === y.value) {\n                            return valueComparer(a.value, b.value);\n                        }\n                        return a.index - b.index;\n                    };\n                }\n                result.sort(comparer);\n                return result;\n            },\n            sort: function (start, end, indices) {\n                if (this.intersecting(start, end).length === 1) {\n                    return;\n                }\n                var values = this.expandedValues(start, end);\n                for (var i = 0, len = indices.length; i < len; i++) {\n                    this.value(i + start, i + start, values[indices[i].index].value);\n                }\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                var values = this.intersecting(sourceStart, sourceEnd);\n                var start = targetStart;\n                var end;\n                for (var i = 0, len = values.length; i < len; i++) {\n                    var rangeStart = values[i].start;\n                    if (rangeStart < sourceStart) {\n                        rangeStart = sourceStart;\n                    }\n                    var rangeEnd = values[i].end;\n                    if (rangeEnd > sourceEnd) {\n                        rangeEnd = sourceEnd;\n                    }\n                    end = start + (rangeEnd - rangeStart);\n                    this.value(start, end, values[i].value);\n                    start = ++end;\n                }\n            },\n            iterator: function (start, end) {\n                return new Iterator(start, end, this.intersecting(start, end));\n            },\n            getState: function () {\n                return this.tree.clone();\n            },\n            setState: function (state) {\n                this.tree = state.clone();\n            }\n        });\n        var Iterator = kendo.Class.extend({\n            init: function (start, end, ranges) {\n                this.start = start;\n                this.end = end;\n                this.index = 0;\n                this.ranges = ranges;\n            },\n            unique: function () {\n                return this.ranges.map(function (range) {\n                    return range.value;\n                });\n            },\n            at: function (index) {\n                while (this.ranges[this.index].end < index) {\n                    this.index++;\n                }\n                return this.ranges[this.index].value;\n            },\n            forEach: function (callback) {\n                for (var i = this.start; i <= this.end; i++) {\n                    callback(this.at(i), i);\n                }\n                this.index = 0;\n            }\n        });\n        var SparseRangeList = RangeList.extend({\n            init: function (start, end, value) {\n                this.tree = new RangeTree();\n                this.range = new Range(start, end, value);\n            },\n            intersecting: function (start, end) {\n                var ranges = this.tree.intersecting(start, end);\n                var result = [];\n                var range;\n                if (!ranges.length) {\n                    return [this.range];\n                }\n                for (var i = 0, len = ranges.length; i < len; i++) {\n                    range = ranges[i];\n                    if (range.start > start) {\n                        result.push(new Range(start, range.start - 1, this.range.value));\n                    }\n                    result.push(range);\n                    start = range.end + 1;\n                }\n                if (range.end < end) {\n                    result.push(new Range(range.end + 1, end, this.range.value));\n                }\n                return result;\n            },\n            insert: function (start, end, value) {\n                if (value !== this.range.value) {\n                    this.tree.insert(new Range(start, end, value));\n                }\n            },\n            lastRangeStart: function () {\n                var node = this.tree.root;\n                if (node === NilNode) {\n                    return this.range.start;\n                }\n                while (node.right !== NilNode) {\n                    node = node.right;\n                }\n                return node.value.end + 1;\n            }\n        });\n        kendo.spreadsheet.RangeTree = RangeTree;\n        kendo.spreadsheet.RangeList = RangeList;\n        kendo.spreadsheet.SparseRangeList = SparseRangeList;\n        kendo.spreadsheet.ValueRange = Range;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/propertybag', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Property = kendo.Class.extend({\n            init: function (list) {\n                this.list = list;\n            },\n            get: function (index) {\n                return this.parse(this.list.value(index, index));\n            },\n            set: function (start, end, value) {\n                if (value === undefined) {\n                    value = end;\n                    end = start;\n                }\n                this.list.value(start, end, value);\n            },\n            parse: function (value) {\n                return value;\n            },\n            copy: function (start, end, dst) {\n                this.list.copy(start, end, dst);\n            },\n            iterator: function (start, end) {\n                return this.list.iterator(start, end);\n            }\n        });\n        var JsonProperty = Property.extend({\n            set: function (start, end, value) {\n                this.list.value(start, end, JSON.stringify(value));\n            },\n            parse: function (value) {\n                return JSON.parse(value);\n            }\n        });\n        var ValueProperty = Property.extend({\n            init: function (values, formats) {\n                Property.prototype.init.call(this, values);\n                this.formats = formats;\n            },\n            set: function (start, end, value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                    if (!this.formats.value(start, end)) {\n                        this.formats.value(start, end, toExcelFormat(kendo.culture().calendar.patterns.d));\n                    }\n                }\n                this.list.value(start, end, value);\n            }\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        kendo.spreadsheet.PropertyBag = kendo.Class.extend({\n            specs: [\n                {\n                    property: Property,\n                    name: 'format',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: ValueProperty,\n                    name: 'value',\n                    value: null,\n                    sortable: true,\n                    serializable: true,\n                    depends: 'format'\n                },\n                {\n                    property: Property,\n                    name: 'formula',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'background',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: JsonProperty,\n                    name: 'vBorders',\n                    value: null,\n                    sortable: false,\n                    serializable: false\n                },\n                {\n                    property: JsonProperty,\n                    name: 'hBorders',\n                    value: null,\n                    sortable: false,\n                    serializable: false\n                },\n                {\n                    property: Property,\n                    name: 'color',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontFamily',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'underline',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'fontSize',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'italic',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'bold',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'textAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'verticalAlign',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'wrap',\n                    value: null,\n                    sortable: true,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'validation',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'enable',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'link',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                },\n                {\n                    property: Property,\n                    name: 'editor',\n                    value: null,\n                    sortable: false,\n                    serializable: true\n                }\n            ],\n            init: function (rowCount, columnCount, defaultValues) {\n                defaultValues = defaultValues || {};\n                var cellCount = rowCount * columnCount - 1;\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this.cellCount = cellCount;\n                this.properties = {};\n                this.lists = {};\n                this.specs.forEach(function (spec) {\n                    var name = spec.name;\n                    var value = defaultValues[name];\n                    if (value === undefined) {\n                        value = spec.value;\n                    }\n                    this.lists[name] = new kendo.spreadsheet.SparseRangeList(0, cellCount, value);\n                    var prop = this.properties[name] = new spec.property(this.lists[name], this.lists[spec.depends]);\n                    prop.spec = spec;\n                }, this);\n                this.lists.formula.tree.clone = cloneFormulaTree;\n                this.lists.validation.tree.clone = cloneFormulaTree;\n            },\n            getState: function () {\n                var state = {};\n                this.specs.forEach(function (spec) {\n                    state[spec.name] = this.lists[spec.name].getState();\n                }, this);\n                return state;\n            },\n            setState: function (state) {\n                this.specs.forEach(function (spec) {\n                    this.lists[spec.name].setState(state[spec.name]);\n                }, this);\n            },\n            get: function (name, index) {\n                if (index === undefined) {\n                    return this.lists[name];\n                }\n                switch (name) {\n                case 'borderRight':\n                    index += this.rowCount;\n                case 'borderLeft':\n                    name = 'vBorders';\n                    break;\n                case 'borderBottom':\n                    index++;\n                case 'borderTop':\n                    name = 'hBorders';\n                    break;\n                }\n                return index > this.cellCount ? null : this.properties[name].get(index);\n            },\n            set: function (name, start, end, value) {\n                switch (name) {\n                case 'borderRight':\n                    start += this.rowCount;\n                    end += this.rowCount;\n                case 'borderLeft':\n                    name = 'vBorders';\n                    break;\n                case 'borderBottom':\n                    start++;\n                    end++;\n                case 'borderTop':\n                    name = 'hBorders';\n                    break;\n                }\n                if (start <= end && end <= this.cellCount) {\n                    this.properties[name].set(start, end, value);\n                }\n            },\n            fromJSON: function (index, value) {\n                for (var si = 0; si < this.specs.length; si++) {\n                    var spec = this.specs[si];\n                    if (spec.serializable) {\n                        if (value[spec.name] !== undefined) {\n                            this.set(spec.name, index, index, value[spec.name], false);\n                        }\n                    }\n                }\n                [\n                    'borderLeft',\n                    'borderRight',\n                    'borderTop',\n                    'borderBottom'\n                ].forEach(function (b) {\n                    if (value[b] !== undefined) {\n                        this.set(b, index, index, value[b]);\n                    }\n                }, this);\n            },\n            copy: function (sourceStart, sourceEnd, targetStart) {\n                this.specs.forEach(function (spec) {\n                    this.properties[spec.name].copy(sourceStart, sourceEnd, targetStart);\n                }, this);\n            },\n            iterator: function (name, start, end) {\n                var prop = this.properties[name];\n                var iter = prop.iterator(start, end), at = iter.at;\n                var cellCount = this.cellCount;\n                iter.at = function (index) {\n                    return index > cellCount ? null : prop.parse(at.call(iter, index));\n                };\n                iter.name = name;\n                iter.value = prop.spec.value;\n                return iter;\n            },\n            sortable: function () {\n                return this.specs.filter(function (spec) {\n                    return spec.sortable;\n                }).map(function (spec) {\n                    return this.lists[spec.name];\n                }, this);\n            },\n            iterators: function (start, end) {\n                return this.specs.reduce(function (ret, spec) {\n                    if (spec.serializable) {\n                        ret.push(this.iterator(spec.name, start, end));\n                    }\n                    return ret;\n                }.bind(this), []);\n            },\n            forEach: function (start, end, callback) {\n                var iterators = this.iterators(start, end);\n                var hBorders = this.iterator('hBorders', start, end + 1);\n                var leftBorders = this.iterator('vBorders', start, end);\n                var rightBorders = this.iterator('vBorders', start + this.rowCount, end + this.rowCount);\n                var values, index;\n                function addBorder(name, iterator, index) {\n                    var val = iterator.at(index);\n                    if (val !== iterator.value) {\n                        values[name] = val;\n                    }\n                }\n                for (index = start; index <= end; index++) {\n                    values = {};\n                    for (var i = 0; i < iterators.length; i++) {\n                        var iterator = iterators[i];\n                        var value = iterator.at(index);\n                        if (value !== iterator.value) {\n                            values[iterator.name] = value;\n                        }\n                    }\n                    addBorder('borderLeft', leftBorders, index);\n                    addBorder('borderRight', rightBorders, index + this.rowCount);\n                    addBorder('borderTop', hBorders, index);\n                    if ((index + 1) % this.rowCount) {\n                        addBorder('borderBottom', hBorders, index + 1);\n                    }\n                    callback(values);\n                }\n            },\n            forEachProperty: function (callback) {\n                for (var name in this.properties) {\n                    callback(this.properties[name]);\n                }\n            }\n        });\n        function cloneFormulaValue(x) {\n            x = x.clone();\n            x.value = x.value.deepClone();\n            return x;\n        }\n        function cloneFormulaTree() {\n            var tree = this.map(cloneFormulaValue);\n            tree.clone = cloneFormulaTree;\n            return tree;\n        }\n        kendo.spreadsheet.ALL_PROPERTIES = kendo.spreadsheet.PropertyBag.prototype.specs.reduce(function (a, spec) {\n            if (spec.serializable) {\n                a.push(spec.name);\n            }\n            return a;\n        }, [\n            'borderTop',\n            'borderRight',\n            'borderBottom',\n            'borderLeft'\n        ]);\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/references', ['kendo.core'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Class = kendo.Class;\n    function columnName(colIndex) {\n        var letter = Math.floor(colIndex / 26) - 1;\n        return (letter >= 0 ? columnName(letter) : '') + String.fromCharCode(65 + colIndex % 26);\n    }\n    function displaySheet(sheet) {\n        if (/^[a-z0-9_]*$/i.test(sheet)) {\n            return sheet;\n        }\n        return '\\'' + sheet.replace(/\\x27/g, '\\\\\\'') + '\\'';\n    }\n    function displayRef(sheet, row, col, rel) {\n        var aa = '';\n        ++row;\n        if (!isFinite(row)) {\n            row = '';\n        } else if (rel != null && !(rel & 2)) {\n            row = '$' + row;\n        }\n        if (!isFinite(col)) {\n            col = '';\n        } else {\n            aa = columnName(col);\n            if (rel != null && !(rel & 1)) {\n                aa = '$' + aa;\n            }\n        }\n        if (sheet) {\n            return displaySheet(sheet) + '!' + aa + row;\n        } else {\n            return aa + row;\n        }\n    }\n    var Ref = Class.extend({\n        type: 'ref',\n        sheet: '',\n        clone: function () {\n            return this;\n        },\n        hasSheet: function () {\n            return this._hasSheet;\n        },\n        simplify: function () {\n            return this;\n        },\n        setSheet: function (sheet, hasSheet) {\n            this.sheet = sheet;\n            if (hasSheet != null) {\n                this._hasSheet = hasSheet;\n            }\n            return this;\n        },\n        absolute: function () {\n            return this;\n        },\n        relative: function () {\n            return this;\n        },\n        adjust: function () {\n            return this;\n        },\n        toString: function () {\n            return this.relative(0, 0, 3, 3).print(0, 0);\n        },\n        forEach: function (callback, obj) {\n            callback.call(obj, this);\n        },\n        map: function (callback, obj) {\n            return callback.call(obj, this);\n        },\n        intersects: function (ref) {\n            return this.intersect(ref) !== NULL;\n        },\n        isCell: function () {\n            return false;\n        },\n        toRow: function () {\n            return this;\n        },\n        toColumn: function () {\n            return this;\n        },\n        first: function () {\n            return this;\n        },\n        lastRange: function () {\n            return this;\n        },\n        size: function () {\n            return 1;\n        },\n        rangeAt: function () {\n            return this;\n        },\n        nextRangeIndex: function () {\n            return 0;\n        },\n        previousRangeIndex: function () {\n            return 0;\n        },\n        eq: function (reference) {\n            var r1 = this;\n            var r2 = reference;\n            if (r1 === NULL || r2 === NULL) {\n                return r1 === r2;\n            }\n            if (r2 instanceof CellRef || r2 instanceof RangeRef && !(r1 instanceof CellRef)) {\n                r1 = reference;\n                r2 = this;\n            }\n            if (r1 instanceof CellRef) {\n                r2 = r2.simplify();\n                return r2 instanceof CellRef && r1.row == r2.row && r1.col == r2.col && r1.sheet == r2.sheet;\n            } else if (r1 instanceof RangeRef) {\n                if (r2 instanceof RangeRef) {\n                    return r2.topLeft.eq(r1.topLeft) && r2.bottomRight.eq(r1.bottomRight);\n                }\n                if (r2 instanceof UnionRef) {\n                    return r2.single() && r1.eq(r2.refs[0]);\n                }\n            } else if (r1 instanceof UnionRef && r2 instanceof UnionRef) {\n                var refs1 = r1.refs;\n                var refs2 = r2.refs;\n                if (refs1.length != refs2.length) {\n                    return false;\n                }\n                for (var i = 0, len = refs1.length; i < len; i++) {\n                    if (!refs1[i].eq(refs2[i])) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            return r1 === r2;\n        },\n        concat: function (ref) {\n            return new UnionRef([\n                this,\n                ref\n            ]);\n        },\n        replaceAt: function (index, ref) {\n            return ref;\n        },\n        forEachColumnIndex: function (callback) {\n            this.forEachAxisIndex('col', callback);\n        },\n        forEachRowIndex: function (callback) {\n            this.forEachAxisIndex('row', callback);\n        },\n        forEachAxisIndex: function (axis, callback) {\n            var sorted = [];\n            var method = axis === 'row' ? 'forEachRow' : 'forEachColumn';\n            this[method](function (ref) {\n                var index = ref.first()[axis];\n                if (sorted.indexOf(index) === -1) {\n                    sorted.push(index);\n                }\n            });\n            sorted.sort(function (a, b) {\n                return a > b ? 1 : a < b ? -1 : 0;\n            }).forEach(callback);\n        },\n        valid: function () {\n            return false;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            if (this.sheet && this.sheet.toLowerCase() == oldSheetName.toLowerCase()) {\n                this.sheet = newSheetName;\n                return true;\n            }\n        }\n    });\n    Ref.display = displayRef;\n    var NULL = new (Ref.extend({\n        init: function NullRef() {\n        },\n        print: function () {\n            return '#NULL!';\n        },\n        eq: function (ref) {\n            return ref === this;\n        },\n        forEach: function () {\n        }\n    }))();\n    var NameRef = Ref.extend({\n        ref: 'name',\n        init: function NameRef(name) {\n            this.name = name;\n        },\n        clone: function () {\n            return new NameRef(this.name).setSheet(this.sheet, this.hasSheet());\n        },\n        print: function () {\n            var ret = displaySheet(this.name);\n            if (this.hasSheet()) {\n                ret = displaySheet(this.sheet) + '!' + ret;\n            }\n            return ret;\n        }\n    });\n    var CellRef = Ref.extend({\n        ref: 'cell',\n        init: function CellRef(row, col, rel) {\n            this.row = row;\n            this.col = col;\n            this.rel = rel || 0;\n        },\n        clone: function () {\n            return new CellRef(this.row, this.col, this.rel).setSheet(this.sheet, this.hasSheet());\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                if (this.eq(ref)) {\n                    return this;\n                } else {\n                    return NULL;\n                }\n            }\n            return ref.intersect(this);\n        },\n        print: function (trow, tcol, mod) {\n            var col = this.col, row = this.row, rel = this.rel, abs;\n            if (trow == null && rel) {\n                var sheet = this.hasSheet() ? displaySheet(this.sheet) + '!' : '';\n                if (isFinite(col)) {\n                    col = rel & 1 ? 'C[' + col + ']' : 'C' + (col + 1);\n                } else {\n                    col = '';\n                }\n                if (isFinite(row)) {\n                    row = rel & 2 ? 'R[' + row + ']' : 'R' + (row + 1);\n                } else {\n                    row = '';\n                }\n                return sheet + row + col;\n            } else {\n                abs = this.absolute(trow, tcol);\n                if (mod) {\n                    row = abs.row % 1048576;\n                    col = abs.col % 16384;\n                    if (row < 0) {\n                        row += 1048576;\n                    }\n                    if (col < 0) {\n                        col += 16384;\n                    }\n                    return displayRef(this._hasSheet && this.sheet, row, col, rel);\n                }\n                return abs.valid() ? displayRef(this._hasSheet && this.sheet, abs.row, abs.col, rel) : '#REF!';\n            }\n        },\n        absolute: function (arow, acol) {\n            var ret = this.clone();\n            if (ret.rel & 3 === 0) {\n                return ret;\n            }\n            if (ret.rel & 1) {\n                ret.col = (ret.col + acol) % 16384;\n            }\n            if (ret.rel & 2) {\n                ret.row = (ret.row + arow) % 1048576;\n            }\n            ret.rel = 0;\n            return ret;\n        },\n        toRangeRef: function () {\n            return new RangeRef(this, this);\n        },\n        relative: function (arow, acol, rel) {\n            if (rel == null) {\n                rel = this.rel;\n            }\n            var row = rel & 2 ? this.row - arow : this.row;\n            var col = rel & 1 ? this.col - acol : this.col;\n            return new CellRef(row, col, rel).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            return 1;\n        },\n        width: function () {\n            return 1;\n        },\n        toString: function () {\n            return displayRef(null, this.row, this.col, 3);\n        },\n        isCell: function () {\n            return true;\n        },\n        leftColumn: function () {\n            return this;\n        },\n        rightColumn: function () {\n            return this;\n        },\n        topRow: function () {\n            return this;\n        },\n        bottomRow: function () {\n            return this;\n        },\n        forEachRow: function (callback) {\n            callback(this.toRangeRef());\n        },\n        forEachColumn: function (callback) {\n            callback(this.toRangeRef());\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var ref = this.absolute(row, col);\n            if (forRow) {\n                if (ref.row >= start) {\n                    if (delta < 0 && ref.row < start - delta) {\n                        return NULL;\n                    }\n                    ref.row += delta;\n                }\n            } else {\n                if (ref.col >= start) {\n                    if (delta < 0 && ref.col < start - delta) {\n                        return NULL;\n                    }\n                    ref.col += delta;\n                }\n            }\n            if (trow != null && tcol != null) {\n                ref = ref.relative(trow, tcol, this.rel);\n            }\n            return ref;\n        },\n        valid: function () {\n            if (this.rel) {\n                throw new Error('valid() called on relative reference');\n            }\n            var col = this.col, row = this.row;\n            return !(isFinite(col) && col < 0 || isFinite(row) && row < 0);\n        }\n    });\n    var RangeRef = Ref.extend({\n        ref: 'range',\n        init: function RangeRef(tl, br) {\n            if (tl._hasSheet && br._hasSheet && tl.sheet.toLowerCase() != br.sheet.toLowerCase()) {\n                this.endSheet = br.sheet;\n            }\n            this.topLeft = new CellRef(tl.row, tl.col, tl.rel);\n            this.bottomRight = new CellRef(br.row, br.col, br.rel);\n            this.normalize();\n        },\n        clone: function () {\n            return new RangeRef(this.topLeft.clone(), this.bottomRight.clone()).setSheet(this.sheet, this.hasSheet());\n        },\n        _containsRange: function (range) {\n            return this._containsCell(range.topLeft) && this._containsCell(range.bottomRight);\n        },\n        _containsCell: function (cell) {\n            return cell.sheet == this.sheet && cell.row >= this.topLeft.row && cell.col >= this.topLeft.col && cell.row <= this.bottomRight.row && cell.col <= this.bottomRight.col;\n        },\n        contains: function (ref) {\n            if (ref instanceof Array) {\n                var that = this;\n                return ref.some(function (_ref) {\n                    return that.contains(_ref);\n                });\n            }\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref);\n            }\n            if (ref instanceof RangeRef) {\n                return this._containsRange(ref);\n            }\n            return false;\n        },\n        _intersectRange: function (ref) {\n            if (this.sheet != ref.sheet) {\n                return NULL;\n            }\n            var a_left = this.topLeft.col;\n            var a_top = this.topLeft.row;\n            var a_right = this.bottomRight.col;\n            var a_bottom = this.bottomRight.row;\n            var b_left = ref.topLeft.col;\n            var b_top = ref.topLeft.row;\n            var b_right = ref.bottomRight.col;\n            var b_bottom = ref.bottomRight.row;\n            if (a_left <= b_right && b_left <= a_right && a_top <= b_bottom && b_top <= a_bottom) {\n                return new RangeRef(new CellRef(Math.max(a_top, b_top), Math.max(a_left, b_left)), new CellRef(Math.min(a_bottom, b_bottom), Math.min(a_right, b_right))).setSheet(this.sheet, this.hasSheet());\n            } else {\n                return NULL;\n            }\n        },\n        intersect: function (ref) {\n            if (ref instanceof CellRef) {\n                return this._containsCell(ref) ? ref : NULL;\n            }\n            if (ref instanceof RangeRef) {\n                return this._intersectRange(ref).simplify();\n            }\n            if (ref instanceof UnionRef) {\n                return ref.intersect(this);\n            }\n            return NULL;\n        },\n        simplify: function () {\n            if (this.isCell()) {\n                return new CellRef(this.topLeft.row, this.topLeft.col, this.topLeft.rel).setSheet(this.sheet, this.hasSheet());\n            }\n            return this;\n        },\n        normalize: function () {\n            var a = this.topLeft, b = this.bottomRight;\n            var r1 = a.row, c1 = a.col, r2 = b.row, c2 = b.col;\n            var rr1 = a.rel & 2, rc1 = a.rel & 1;\n            var rr2 = b.rel & 2, rc2 = b.rel & 1;\n            var tmp, changes = false;\n            if (r1 > r2) {\n                changes = true;\n                tmp = r1;\n                r1 = r2;\n                r2 = tmp;\n                tmp = rr1;\n                rr1 = rr2;\n                rr2 = tmp;\n            }\n            if (c1 > c2) {\n                changes = true;\n                tmp = c1;\n                c1 = c2;\n                c2 = tmp;\n                tmp = rc1;\n                rc1 = rc2;\n                rc2 = tmp;\n            }\n            if (changes) {\n                this.topLeft = new CellRef(r1, c1, rc1 | rr1);\n                this.bottomRight = new CellRef(r2, c2, rc2 | rr2);\n            }\n            return this;\n        },\n        print: function (trow, tcol, mod) {\n            if (mod || this.absolute(trow, tcol).valid()) {\n                var ret = this.topLeft.print(trow, tcol, mod) + ':' + this.bottomRight.print(trow, tcol, mod);\n                if (this.hasSheet()) {\n                    ret = displaySheet(this.sheet) + (this.endSheet ? ':' + displaySheet(this.endSheet) : '') + '!' + ret;\n                }\n                return ret;\n            }\n            return '#REF!';\n        },\n        absolute: function (arow, acol) {\n            return new RangeRef(this.topLeft.absolute(arow, acol), this.bottomRight.absolute(arow, acol)).setSheet(this.sheet, this.hasSheet());\n        },\n        relative: function (arow, acol, relTL, relBR) {\n            if (relBR == null) {\n                relBR = relTL;\n            }\n            return new RangeRef(this.topLeft.relative(arow, acol, relTL), this.bottomRight.relative(arow, acol, relBR)).setSheet(this.sheet, this.hasSheet());\n        },\n        height: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.row - this.topLeft.row + 1;\n        },\n        width: function () {\n            if (this.topLeft.rel != this.bottomRight.rel) {\n                throw new Error('Mixed relative/absolute references');\n            }\n            return this.bottomRight.col - this.topLeft.col + 1;\n        },\n        collapse: function () {\n            return this.topLeft.toRangeRef();\n        },\n        leftColumn: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.bottomRight.row, this.topLeft.col));\n        },\n        rightColumn: function () {\n            return new RangeRef(new CellRef(this.topLeft.row, this.bottomRight.col), this.bottomRight);\n        },\n        topRow: function () {\n            return new RangeRef(this.topLeft, new CellRef(this.topLeft.row, this.bottomRight.col));\n        },\n        bottomRow: function () {\n            return new RangeRef(new CellRef(this.bottomRight.row, this.topLeft.col), this.bottomRight);\n        },\n        toRangeRef: function () {\n            return this;\n        },\n        toRow: function (row) {\n            row += Math.max(0, this.topLeft.row);\n            return new RangeRef(new CellRef(row, this.topLeft.col), new CellRef(row, this.bottomRight.col)).setSheet(this.sheet, this.hasSheet());\n        },\n        toColumn: function (col) {\n            col += Math.max(0, this.topLeft.col);\n            return new RangeRef(new CellRef(this.topLeft.row, col), new CellRef(this.bottomRight.row, col)).setSheet(this.sheet, this.hasSheet());\n        },\n        toCell: function (row, col) {\n            row += Math.max(0, this.topLeft.row);\n            col += Math.max(0, this.topLeft.col);\n            return new CellRef(row, col, 0).setSheet(this.sheet, this.hasSheet());\n        },\n        forEachRow: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startRow; i <= endRow; i++) {\n                callback(new RangeRef(new CellRef(i, startCol), new CellRef(i, endCol)));\n            }\n        },\n        forEachColumn: function (callback) {\n            var startRow = this.topLeft.row;\n            var endRow = this.bottomRight.row;\n            var startCol = this.topLeft.col;\n            var endCol = this.bottomRight.col;\n            for (var i = startCol; i <= endCol; i++) {\n                callback(new RangeRef(new CellRef(startRow, i), new CellRef(endRow, i)));\n            }\n        },\n        intersecting: function (refs) {\n            return refs.filter(function (ref) {\n                return ref.toRangeRef().intersects(this);\n            }, this);\n        },\n        union: function (refs, callback) {\n            var intersecting = this.intersecting(refs);\n            var topLeftRow = this.topLeft.row;\n            var topLeftCol = this.topLeft.col;\n            var bottomRightRow = this.bottomRight.row;\n            var bottomRightCol = this.bottomRight.col;\n            var modified = false;\n            intersecting.forEach(function (ref) {\n                ref = ref.toRangeRef();\n                if (ref.topLeft.row < topLeftRow) {\n                    modified = true;\n                    topLeftRow = ref.topLeft.row;\n                }\n                if (ref.topLeft.col < topLeftCol) {\n                    modified = true;\n                    topLeftCol = ref.topLeft.col;\n                }\n                if (ref.bottomRight.row > bottomRightRow) {\n                    modified = true;\n                    bottomRightRow = ref.bottomRight.row;\n                }\n                if (ref.bottomRight.col > bottomRightCol) {\n                    modified = true;\n                    bottomRightCol = ref.bottomRight.col;\n                }\n                if (callback) {\n                    callback(ref);\n                }\n            });\n            var result = new RangeRef(new CellRef(topLeftRow, topLeftCol), new CellRef(bottomRightRow, bottomRightCol));\n            if (modified) {\n                return result.union(refs, callback);\n            } else {\n                return result;\n            }\n        },\n        resize: function (options) {\n            var limit = Math.max.bind(Math, 0);\n            function num(value) {\n                return value || 0;\n            }\n            var top = this.topLeft.row + num(options.top);\n            var left = this.topLeft.col + num(options.left);\n            var bottom = this.bottomRight.row + num(options.bottom);\n            var right = this.bottomRight.col + num(options.right);\n            if (left < 0 && right < 0 || top < 0 && bottom < 0) {\n                return NULL;\n            } else if (top <= bottom && left <= right) {\n                return new RangeRef(new CellRef(limit(top), limit(left)), new CellRef(limit(bottom), limit(right)));\n            } else {\n                return NULL;\n            }\n        },\n        move: function (rows, cols) {\n            return new RangeRef(new CellRef(this.topLeft.row + rows, this.topLeft.col + cols), new CellRef(this.bottomRight.row + rows, this.bottomRight.col + cols));\n        },\n        first: function () {\n            return this.topLeft;\n        },\n        isCell: function () {\n            return !this.endSheet && this.topLeft.eq(this.bottomRight);\n        },\n        toString: function () {\n            return this.topLeft + ':' + this.bottomRight;\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            var tl = this.topLeft.adjust(row, col, trow, tcol, forRow, start, delta);\n            var tr = this.bottomRight.adjust(row, col, trow, tcol, forRow, start, delta);\n            if (tl === NULL && tr === NULL) {\n                return NULL;\n            }\n            if (tl === NULL) {\n                tl = this.topLeft.absolute(row, col);\n                if (forRow) {\n                    tl.row = start;\n                } else {\n                    tl.col = start;\n                }\n                if (trow != null && tcol != null) {\n                    tl = tl.relative(trow, tcol, this.topLeft.rel);\n                }\n            } else if (tr === NULL) {\n                tr = this.bottomRight.absolute(row, col);\n                if (forRow) {\n                    tr.row = start - 1;\n                } else {\n                    tr.col = start - 1;\n                }\n                if (trow != null && tcol != null) {\n                    tr = tr.relative(trow, tcol, this.bottomRight.rel);\n                }\n            }\n            return new RangeRef(tl, tr).setSheet(this.sheet, this.hasSheet()).simplify();\n        },\n        valid: function () {\n            return this.topLeft.valid() && this.bottomRight.valid();\n        }\n    });\n    var UnionRef = Ref.extend({\n        init: function UnionRef(refs) {\n            this.refs = refs;\n            this.length = refs.length;\n        },\n        clone: function () {\n            return new UnionRef(this.refs.slice());\n        },\n        intersect: function (ref) {\n            var a = [];\n            for (var i = 0; i < this.length; ++i) {\n                var x = ref.intersect(this.refs[i]);\n                if (x !== NULL) {\n                    a.push(x);\n                }\n            }\n            if (a.length > 0) {\n                return new UnionRef(a).simplify();\n            }\n            return NULL;\n        },\n        simplify: function () {\n            var u = new UnionRef(this.refs.reduce(function (a, ref) {\n                ref = ref.simplify();\n                if (ref !== NULL) {\n                    a.push(ref);\n                }\n                return a;\n            }, []));\n            if (u.empty()) {\n                return NULL;\n            }\n            if (u.single()) {\n                return u.refs[0];\n            }\n            return u;\n        },\n        absolute: function (arow, acol) {\n            return new UnionRef(this.refs.map(function (ref) {\n                return ref.absolute(arow, acol);\n            }));\n        },\n        forEach: function (callback, obj) {\n            this.refs.forEach(function (ref) {\n                if (ref instanceof UnionRef) {\n                    ref.forEach(callback, obj);\n                } else {\n                    callback.call(obj, ref);\n                }\n            }, obj);\n        },\n        toRangeRef: function () {\n            return this.refs[0].toRangeRef();\n        },\n        contains: function (theRef) {\n            return this.refs.some(function (ref) {\n                return ref.contains(theRef);\n            });\n        },\n        map: function (callback, obj) {\n            var refs = [];\n            this.forEach(function (ref) {\n                refs.push(callback.call(obj, ref));\n            });\n            return new UnionRef(refs);\n        },\n        first: function () {\n            return this.refs[0].first();\n        },\n        lastRange: function () {\n            return this.refs[this.length - 1];\n        },\n        size: function () {\n            return this.length;\n        },\n        single: function () {\n            return this.length == 1;\n        },\n        empty: function () {\n            return this.length === 0;\n        },\n        isCell: function () {\n            return this.single() && this.refs[0].isCell();\n        },\n        rangeAt: function (index) {\n            return this.refs[index];\n        },\n        nextRangeIndex: function (index) {\n            if (index === this.length - 1) {\n                return 0;\n            } else {\n                return index + 1;\n            }\n        },\n        previousRangeIndex: function (index) {\n            if (index === 0) {\n                return this.length - 1;\n            } else {\n                return index - 1;\n            }\n        },\n        concat: function (ref) {\n            return new UnionRef(this.refs.concat([ref]));\n        },\n        print: function (row, col, mod) {\n            return this.refs.map(function (ref) {\n                return ref.print(row, col, mod);\n            }).join(',');\n        },\n        replaceAt: function (index, ref) {\n            var newRefs = this.refs.slice();\n            newRefs.splice(index, 1, ref);\n            return new UnionRef(newRefs);\n        },\n        leftColumn: function () {\n            return this.map(function (ref) {\n                return ref.leftColumn();\n            });\n        },\n        rightColumn: function () {\n            return this.map(function (ref) {\n                return ref.rightColumn();\n            });\n        },\n        topRow: function () {\n            return this.map(function (ref) {\n                return ref.topRow();\n            });\n        },\n        bottomRow: function () {\n            return this.map(function (ref) {\n                return ref.bottomRow();\n            });\n        },\n        forEachRow: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachRow(callback);\n            });\n        },\n        forEachColumn: function (callback) {\n            this.forEach(function (ref) {\n                ref.forEachColumn(callback);\n            });\n        },\n        adjust: function (row, col, trow, tcol, forRow, start, delta) {\n            return this.map(function (ref) {\n                return ref.adjust(row, col, trow, tcol, forRow, start, delta);\n            }).simplify();\n        },\n        toString: function () {\n            return this.refs.map(function (ref) {\n                return ref.toString();\n            }).join(', ');\n        },\n        valid: function () {\n            for (var i = this.refs.length; --i >= 0;) {\n                if (this.refs[i].valid()) {\n                    return false;\n                }\n            }\n            return true;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            this.refs.forEach(function (ref) {\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        }\n    });\n    spreadsheet.NULLREF = NULL;\n    spreadsheet.SHEETREF = new RangeRef(new CellRef(0, 0), new CellRef(Infinity, Infinity));\n    spreadsheet.FIRSTREF = new CellRef(0, 0);\n    spreadsheet.Ref = Ref;\n    spreadsheet.NameRef = NameRef;\n    spreadsheet.CellRef = CellRef;\n    spreadsheet.RangeRef = RangeRef;\n    spreadsheet.UnionRef = UnionRef;\n    spreadsheet.SHEETREF.print = function () {\n        return '#SHEET';\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofillcalculator', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var AutoFillCalculator = kendo.Class.extend({\n            init: function (grid) {\n                this._grid = grid;\n            },\n            rectIsVertical: function (start, end, x, y) {\n                var startRect = this._grid.rectangle(start.toRangeRef());\n                var endRect = this._grid.rectangle(end.toRangeRef());\n                return Math.abs(endRect[y] - startRect[y]) > Math.abs(startRect[x] - endRect[x]);\n            },\n            autoFillDest: function (selection, cursor) {\n                var topLeft = selection.topLeft;\n                var bottomRight = selection.bottomRight;\n                var quadrant;\n                var lower = cursor.row >= topLeft.row;\n                var further = cursor.col >= topLeft.col;\n                if (lower) {\n                    quadrant = further ? 4 : 3;\n                } else {\n                    quadrant = further ? 2 : 1;\n                }\n                var pivot, opposite, cornerResult, expanding;\n                if (quadrant === 4) {\n                    pivot = topLeft;\n                    opposite = bottomRight;\n                    expanding = cursor.row > opposite.row || cursor.col > opposite.col;\n                    if (expanding) {\n                        cursor = new CellRef(Math.max(cursor.row, opposite.row), Math.max(cursor.col, opposite.col));\n                    }\n                    if (this.rectIsVertical(opposite, cursor, 'right', 'bottom')) {\n                        cornerResult = new CellRef(cursor.row, opposite.col);\n                    } else {\n                        cornerResult = new CellRef(opposite.row, cursor.col);\n                    }\n                } else if (quadrant === 3) {\n                    var bottomLeft = new CellRef(topLeft.col, bottomRight.row);\n                    if (cursor.row > bottomRight.row && this.rectIsVertical(bottomLeft, cursor, 'left', 'bottom')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(cursor.row, bottomRight.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                } else if (quadrant === 2) {\n                    var topRight = new CellRef(topLeft.row, bottomRight.col);\n                    if (cursor.col > bottomRight.col && !this.rectIsVertical(topRight, cursor, 'right', 'top')) {\n                        pivot = topLeft;\n                        cornerResult = new CellRef(bottomRight.row, cursor.col);\n                    } else {\n                        pivot = bottomRight;\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    }\n                } else {\n                    pivot = bottomRight;\n                    if (this.rectIsVertical(topLeft, cursor, 'left', 'top')) {\n                        cornerResult = new CellRef(cursor.row, topLeft.col);\n                    } else {\n                        cornerResult = new CellRef(topLeft.row, cursor.col);\n                    }\n                }\n                return this._grid.normalize(new RangeRef(pivot, cornerResult));\n            }\n        });\n        kendo.spreadsheet.AutoFillCalculator = AutoFillCalculator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/navigator', [\n        'kendo.core',\n        'spreadsheet/autofillcalculator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var EdgeNavigator = kendo.Class.extend({\n            init: function (field, axis, rangeGetter, union) {\n                this.rangeGetter = rangeGetter;\n                this.prevLeft = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.prevVisible(current.topLeft[field]));\n                    return union(range).topLeft[field];\n                };\n                this.nextRight = function (index) {\n                    var current = union(this.range(index));\n                    var range = this.range(axis.nextVisible(current.bottomRight[field]));\n                    return union(range).bottomRight[field];\n                };\n                this.nextLeft = function (index) {\n                    var range = union(this.range(index));\n                    return axis.nextVisible(range.bottomRight[field]);\n                };\n                this.prevRight = function (index) {\n                    var range = union(this.range(index));\n                    return axis.prevVisible(range.topLeft[field]);\n                };\n            },\n            boundary: function (top, bottom) {\n                this.top = top;\n                this.bottom = bottom;\n            },\n            range: function (index) {\n                return this.rangeGetter(index, this.top, this.bottom);\n            }\n        });\n        var SheetNavigator = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.columns = this._sheet._grid._columns;\n                this.autoFillCalculator = new kendo.spreadsheet.AutoFillCalculator(sheet._grid);\n                this.colEdge = new EdgeNavigator('col', this._sheet._grid._columns, this.columnRange.bind(this), this.union.bind(this));\n                this.rowEdge = new EdgeNavigator('row', this._sheet._grid._rows, this.rowRange.bind(this), this.union.bind(this));\n            },\n            height: function (height) {\n                this._viewPortHeight = height;\n            },\n            union: function (ref) {\n                return this._sheet.unionWithMerged(ref);\n            },\n            columnRange: function (col, topRow, bottomRow) {\n                return this._sheet._ref(topRow, col, bottomRow - topRow, 1);\n            },\n            rowRange: function (row, leftCol, rightCol) {\n                return this._sheet._ref(row, leftCol, 1, rightCol - leftCol);\n            },\n            selectionIncludesMergedCells: function () {\n                return this._sheet.select().contains(this._sheet._mergedCells);\n            },\n            setSelectionValue: function (value) {\n                var selection = this._sheet.selection();\n                setTimeout(function () {\n                    selection.value(value());\n                });\n            },\n            selectAll: function () {\n                this._sheet.select(this._sheet._sheetRef);\n            },\n            select: function (ref, mode, addToExisting) {\n                ref = this.refForMode(ref, mode);\n                if (addToExisting) {\n                    ref = this._sheet.select().concat(ref);\n                }\n                this._sheet.select(ref);\n            },\n            refForMode: function (ref, mode) {\n                var grid = this._sheet._grid;\n                switch (mode) {\n                case 'range':\n                    ref = grid.normalize(ref);\n                    break;\n                case 'row':\n                    ref = grid.rowRef(ref.row);\n                    break;\n                case 'column':\n                    ref = grid.colRef(ref.col);\n                    break;\n                case 'sheet':\n                    ref = this._sheet._sheetRef;\n                    break;\n                }\n                return ref;\n            },\n            startSelection: function (ref, mode, addToExisting, shiftKey) {\n                if (mode == 'autofill') {\n                    this._sheet.startAutoFill();\n                } else if (shiftKey && mode == 'range') {\n                    var range = new RangeRef(this._sheet.activeCell().first(), ref);\n                    this._sheet.select(range, false, false);\n                    this._sheet.startSelection();\n                } else {\n                    this._sheet.startSelection();\n                    this.select(ref, mode, addToExisting);\n                }\n            },\n            completeSelection: function () {\n                this._sheet.completeSelection();\n            },\n            selectForContextMenu: function (ref, mode) {\n                var sheet = this._sheet;\n                if (!sheet.select().contains(this.refForMode(ref, mode))) {\n                    this.select(ref, mode);\n                }\n            },\n            modifySelection: function (action) {\n                var direction = this.determineDirection(action);\n                var sheet = this._sheet;\n                var viewPortHeight = this._viewPortHeight;\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var originalSelection = sheet.currentOriginalSelectionRange();\n                var selection = sheet.select().toRangeRef();\n                var activeCell = sheet.activeCell();\n                var topLeft = originalSelection.topLeft.clone();\n                var bottomRight = originalSelection.bottomRight.clone();\n                var scrollInto;\n                this.colEdge.boundary(selection.topLeft.row, selection.bottomRight.row);\n                this.rowEdge.boundary(selection.topLeft.col, selection.bottomRight.col);\n                switch (direction) {\n                case 'expand-left':\n                    topLeft.col = this.colEdge.prevLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-right':\n                    topLeft.col = this.colEdge.nextLeft(topLeft.col);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-right':\n                    bottomRight.col = this.colEdge.nextRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-left':\n                    bottomRight.col = this.colEdge.prevRight(bottomRight.col);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-up':\n                    topLeft.row = this.rowEdge.prevLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'shrink-down':\n                    topLeft.row = this.rowEdge.nextLeft(topLeft.row);\n                    scrollInto = topLeft;\n                    break;\n                case 'expand-down':\n                    bottomRight.row = this.rowEdge.nextRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'shrink-up':\n                    bottomRight.row = this.rowEdge.prevRight(bottomRight.row);\n                    scrollInto = bottomRight;\n                    break;\n                case 'expand-page-up':\n                    topLeft.row = rows.prevPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'shrink-page-up':\n                    bottomRight.row = rows.prevPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'expand-page-down':\n                    bottomRight.row = rows.nextPage(bottomRight.row, viewPortHeight);\n                    break;\n                case 'shrink-page-down':\n                    topLeft.row = rows.nextPage(topLeft.row, viewPortHeight);\n                    break;\n                case 'first-col':\n                    topLeft.col = columns.firstVisible();\n                    bottomRight.col = activeCell.bottomRight.col;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-col':\n                    bottomRight.col = columns.lastVisible();\n                    topLeft.col = activeCell.topLeft.col;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first-row':\n                    topLeft.row = rows.firstVisible();\n                    bottomRight.row = activeCell.bottomRight.row;\n                    scrollInto = topLeft;\n                    break;\n                case 'last-row':\n                    bottomRight.row = rows.lastVisible();\n                    topLeft.row = activeCell.topLeft.row;\n                    scrollInto = bottomRight;\n                    break;\n                case 'last':\n                    bottomRight.row = rows.lastVisible();\n                    bottomRight.col = columns.lastVisible();\n                    topLeft = activeCell.topLeft;\n                    scrollInto = bottomRight;\n                    break;\n                case 'first':\n                    topLeft.row = rows.firstVisible();\n                    topLeft.col = columns.firstVisible();\n                    bottomRight = activeCell.bottomRight;\n                    scrollInto = topLeft;\n                    break;\n                }\n                var newSelection = new RangeRef(topLeft, bottomRight);\n                if (!this.union(newSelection).intersects(activeCell)) {\n                    this.modifySelection(direction.replace('shrink', 'expand'));\n                    return;\n                }\n                if (scrollInto) {\n                    sheet.focus(scrollInto);\n                }\n                this.updateCurrentSelectionRange(newSelection);\n            },\n            moveActiveCell: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var bottomRight = activeCell.bottomRight;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                switch (direction) {\n                case 'left':\n                    column = columns.prevVisible(topLeft.col);\n                    break;\n                case 'up':\n                    row = rows.prevVisible(topLeft.row);\n                    break;\n                case 'right':\n                    column = columns.nextVisible(bottomRight.col);\n                    break;\n                case 'down':\n                    row = rows.nextVisible(bottomRight.row);\n                    break;\n                case 'first-col':\n                    column = columns.firstVisible();\n                    break;\n                case 'last-col':\n                    column = columns.lastVisible();\n                    break;\n                case 'first-row':\n                    row = rows.firstVisible();\n                    break;\n                case 'last-row':\n                    row = rows.lastVisible();\n                    break;\n                case 'last':\n                    row = rows.lastVisible();\n                    column = columns.lastVisible();\n                    break;\n                case 'first':\n                    row = rows.firstVisible();\n                    column = columns.firstVisible();\n                    break;\n                case 'next-page':\n                    row = rows.nextPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                case 'prev-page':\n                    row = rows.prevPage(bottomRight.row, this._viewPortHeight);\n                    break;\n                }\n                sheet.select(new CellRef(row, column));\n            },\n            navigateInSelection: function (direction) {\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell();\n                var topLeft = activeCell.topLeft;\n                var cell = sheet.originalActiveCell();\n                var rows = sheet._grid._rows;\n                var columns = sheet._grid._columns;\n                var row = cell.row;\n                var column = cell.col;\n                var selection = sheet.currentNavigationRange();\n                var selTopLeft = selection.topLeft;\n                var selBottomRight = selection.bottomRight;\n                var done = false;\n                var topLeftCol = topLeft.col;\n                var topLeftRow = topLeft.row;\n                while (!done) {\n                    var current = new CellRef(row, column);\n                    switch (direction) {\n                    case 'next':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            column = columns.nextVisible(topLeftCol, true);\n                            if (column > selBottomRight.col) {\n                                column = selTopLeft.col;\n                                row = rows.nextVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'previous':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            column = columns.prevVisible(topLeftCol, true);\n                            if (column < selTopLeft.col) {\n                                column = selBottomRight.col;\n                                row = rows.prevVisible(row, true);\n                            }\n                        }\n                        break;\n                    case 'lower':\n                        if (selBottomRight.eq(current)) {\n                            selection = sheet.nextNavigationRange();\n                            row = selection.topLeft.row;\n                            column = selection.topLeft.col;\n                        } else {\n                            row = rows.nextVisible(topLeftRow, true);\n                            if (row > selBottomRight.row) {\n                                row = selTopLeft.row;\n                                column = columns.nextVisible(column, true);\n                            }\n                        }\n                        break;\n                    case 'upper':\n                        if (selTopLeft.eq(current)) {\n                            selection = sheet.previousNavigationRange();\n                            row = selection.bottomRight.row;\n                            column = selection.bottomRight.col;\n                        } else {\n                            row = rows.prevVisible(topLeftRow, true);\n                            if (row < selTopLeft.row) {\n                                row = selBottomRight.row;\n                                column = columns.prevVisible(column, true);\n                            }\n                        }\n                        break;\n                    default:\n                        throw new Error('Unknown entry navigation: ' + direction);\n                    }\n                    done = !this.shouldSkip(row, column);\n                    topLeftCol = column;\n                    topLeftRow = row;\n                }\n                if (sheet.singleCellSelection()) {\n                    sheet.select(new CellRef(row, column));\n                } else {\n                    sheet.activeCell(new CellRef(row, column));\n                }\n            },\n            extendSelection: function (ref, mode) {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                if (mode === 'autofill') {\n                    this.resizeAutoFill(ref);\n                    return;\n                }\n                if (mode === 'range') {\n                    ref = grid.normalize(ref);\n                } else if (mode === 'row') {\n                    ref = grid.rowRef(ref.row).bottomRight;\n                } else if (mode === 'column') {\n                    ref = grid.colRef(ref.col).bottomRight;\n                }\n                var activeCell = sheet.originalActiveCell().toRangeRef();\n                this.updateCurrentSelectionRange(new RangeRef(activeCell.topLeft, ref));\n            },\n            shouldSkip: function (row, col) {\n                var ref = new CellRef(row, col);\n                var isMerged = false;\n                this._sheet.forEachMergedCell(function (merged) {\n                    if (merged.intersects(ref) && !merged.collapse().eq(ref)) {\n                        isMerged = true;\n                    }\n                });\n                return isMerged;\n            },\n            resizeAutoFill: function (ref) {\n                var sheet = this._sheet;\n                var selection = sheet.select();\n                var origin = sheet._autoFillOrigin;\n                var dest = this.autoFillCalculator.autoFillDest(selection, ref);\n                var punch = this.punch(selection, dest);\n                var hint, direction, row;\n                if (!punch) {\n                    var preview = sheet.range(dest)._previewFillFrom(sheet.range(origin));\n                    if (preview) {\n                        direction = preview.direction;\n                        var props = preview.props;\n                        if (direction === 0 || direction == 1) {\n                            row = props[props.length - 1];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 2) {\n                            row = props[0];\n                            hint = row[row.length - 1].value;\n                        } else if (direction === 3) {\n                            row = props[props.length - 1];\n                            hint = row[0].value;\n                        }\n                    }\n                }\n                sheet.updateAutoFill(dest, punch, hint, direction);\n            },\n            determineDirection: function (action) {\n                var selection = this._sheet.currentSelectionRange();\n                var activeCell = this._sheet.activeCell();\n                var leftMode = activeCell.topLeft.col == selection.topLeft.col;\n                var rightMode = activeCell.bottomRight.col == selection.bottomRight.col;\n                var topMode = activeCell.topLeft.row == selection.topLeft.row;\n                var bottomMode = activeCell.bottomRight.row == selection.bottomRight.row;\n                switch (action) {\n                case 'left':\n                    action = rightMode ? 'expand-left' : 'shrink-left';\n                    break;\n                case 'right':\n                    action = leftMode ? 'expand-right' : 'shrink-right';\n                    break;\n                case 'up':\n                    action = bottomMode ? 'expand-up' : 'shrink-up';\n                    break;\n                case 'down':\n                    action = topMode ? 'expand-down' : 'shrink-down';\n                    break;\n                case 'prev-page':\n                    action = bottomMode ? 'expand-page-up' : 'shrink-page-up';\n                    break;\n                case 'next-page':\n                    action = topMode ? 'expand-page-down' : 'shrink-page-down';\n                    break;\n                }\n                return action;\n            },\n            updateCurrentSelectionRange: function (ref) {\n                var sheet = this._sheet;\n                sheet.select(sheet.originalSelect().replaceAt(sheet.selectionRangeIndex(), ref), false);\n            },\n            punch: function (selection, subset) {\n                var punch;\n                if (subset.topLeft.eq(selection.topLeft)) {\n                    if (subset.bottomRight.row < selection.bottomRight.row) {\n                        var bottomRow = this.rowEdge.nextRight(subset.bottomRight.row);\n                        punch = new RangeRef(new CellRef(bottomRow, selection.topLeft.col), selection.bottomRight);\n                    } else if (subset.bottomRight.col < selection.bottomRight.col) {\n                        var bottomCol = this.colEdge.nextRight(subset.bottomRight.col);\n                        punch = new RangeRef(new CellRef(selection.topLeft.row, bottomCol), selection.bottomRight);\n                    }\n                }\n                return punch;\n            }\n        });\n        kendo.spreadsheet.SheetNavigator = SheetNavigator;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axismanager', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var AxisManager = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n            },\n            forEachSelectedColumn: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            forEachSelectedRow: function (callback) {\n                var sheet = this._sheet;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index, i) {\n                        callback(sheet, index, i);\n                    });\n                }, {\n                    layout: true,\n                    recalc: true\n                });\n            },\n            includesHiddenColumns: function (ref) {\n                return this._sheet._grid._columns.includesHidden(ref.topLeft.col, ref.bottomRight.col);\n            },\n            includesHiddenRows: function (ref) {\n                return this._sheet._grid._rows.includesHidden(ref.topLeft.row, ref.bottomRight.row);\n            },\n            selectionIncludesHiddenColumns: function () {\n                return this.includesHiddenColumns(this._sheet.select());\n            },\n            selectionIncludesHiddenRows: function () {\n                return this.includesHiddenRows(this._sheet.select());\n            },\n            deleteSelectedColumns: function () {\n                var indexes = [];\n                this.forEachSelectedColumn(function (sheet, index, i) {\n                    index -= i;\n                    var formulas = [];\n                    indexes.unshift({\n                        index: index,\n                        formulas: formulas,\n                        width: sheet.columnWidth(index)\n                    });\n                    sheet._saveModifiedFormulas(formulas, function () {\n                        sheet.deleteColumn(index);\n                    });\n                });\n                return indexes;\n            },\n            deleteSelectedRows: function () {\n                var indexes = [];\n                this.forEachSelectedRow(function (sheet, index, i) {\n                    index -= i;\n                    var formulas = [];\n                    indexes.unshift({\n                        index: index,\n                        formulas: formulas,\n                        height: sheet.rowHeight(index)\n                    });\n                    sheet._saveModifiedFormulas(formulas, function () {\n                        sheet.deleteRow(index);\n                    });\n                });\n                return indexes;\n            },\n            hideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.hideColumn(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var left = ref.topLeft.col;\n                var right = ref.bottomRight.col;\n                var sel = null;\n                while (true) {\n                    var hasRight = right < sheet._columns._count;\n                    var hasLeft = left >= 0;\n                    if (!hasLeft && !hasRight) {\n                        break;\n                    }\n                    if (hasRight && !sheet.isHiddenColumn(right)) {\n                        sel = right;\n                        break;\n                    }\n                    if (hasLeft && !sheet.isHiddenColumn(left)) {\n                        sel = left;\n                        break;\n                    }\n                    left--;\n                    right++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(0, sel), new kendo.spreadsheet.CellRef(sheet._rows._count - 1, sel));\n                    sheet.range(ref).select();\n                }\n            },\n            hideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.hideRow(index);\n                });\n                var sheet = this._sheet;\n                var ref = sheet.select().toRangeRef();\n                var top = ref.topLeft.row;\n                var bottom = ref.bottomRight.row;\n                var sel = null;\n                while (true) {\n                    var hasBottom = bottom < sheet._rows._count;\n                    var hasTop = top >= 0;\n                    if (!hasTop && !hasBottom) {\n                        break;\n                    }\n                    if (hasBottom && !sheet.isHiddenRow(bottom)) {\n                        sel = bottom;\n                        break;\n                    }\n                    if (hasTop && !sheet.isHiddenRow(top)) {\n                        sel = top;\n                        break;\n                    }\n                    top--;\n                    bottom++;\n                }\n                if (sel !== null) {\n                    ref = new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(sel, 0), new kendo.spreadsheet.CellRef(sel, sheet._columns._count - 1));\n                    sheet.range(ref).select();\n                }\n            },\n            unhideSelectedColumns: function () {\n                this.forEachSelectedColumn(function (sheet, index) {\n                    sheet.unhideColumn(index);\n                });\n            },\n            unhideSelectedRows: function () {\n                this.forEachSelectedRow(function (sheet, index) {\n                    sheet.unhideRow(index);\n                });\n            },\n            preventAddRow: function () {\n                var range = this._sheet.select().toRangeRef();\n                var rowCount = range.height();\n                return this._sheet.preventInsertRow(0, rowCount);\n            },\n            preventAddColumn: function () {\n                var range = this._sheet.select().toRangeRef();\n                var columnCount = range.width();\n                return this._sheet.preventInsertColumn(0, columnCount);\n            },\n            addColumnLeft: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index) {\n                        if (!base) {\n                            base = index;\n                        }\n                        sheet.insertColumn(base);\n                        ++count;\n                    });\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            },\n            addColumnRight: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachColumnIndex(function (index) {\n                        base = index + 1;\n                        ++count;\n                    });\n                    for (var i = 0; i < count; ++i) {\n                        sheet.insertColumn(base);\n                    }\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            },\n            addRowAbove: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index) {\n                        if (!base) {\n                            base = index;\n                        }\n                        sheet.insertRow(base);\n                        ++count;\n                    });\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            },\n            addRowBelow: function () {\n                var sheet = this._sheet;\n                var base, count = 0;\n                sheet.batch(function () {\n                    sheet.select().forEachRowIndex(function (index) {\n                        base = index + 1;\n                        ++count;\n                    });\n                    for (var i = 0; i < count; ++i) {\n                        sheet.insertRow(base);\n                    }\n                }, {\n                    recalc: true,\n                    layout: true\n                });\n                return {\n                    base: base,\n                    count: count\n                };\n            }\n        });\n        kendo.spreadsheet.AxisManager = AxisManager;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/clipboard', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Clipboard = kendo.Class.extend({\n            init: function (workbook) {\n                this._content = {};\n                this._externalContent = {};\n                this._internalContent = {};\n                this.workbook = workbook;\n                this.origin = kendo.spreadsheet.NULLREF;\n                this.iframe = document.createElement('iframe');\n                this.iframe.className = 'k-spreadsheet-clipboard-paste';\n                this.menuInvoked = true;\n                this._uid = kendo.guid();\n                document.body.appendChild(this.iframe);\n            },\n            destroy: function () {\n                document.body.removeChild(this.iframe);\n            },\n            canCopy: function () {\n                var status = { canCopy: true };\n                var selection = this.workbook.activeSheet().select();\n                if (selection === kendo.spreadsheet.NULLREF) {\n                    status.canCopy = false;\n                }\n                if (selection instanceof kendo.spreadsheet.UnionRef) {\n                    status.canCopy = false;\n                    status.multiSelection = true;\n                }\n                if (this.menuInvoked) {\n                    status.canCopy = false;\n                    status.menuInvoked = true;\n                }\n                return status;\n            },\n            canPaste: function () {\n                var sheet = this.workbook.activeSheet();\n                var ref = this.pasteRef();\n                var range = sheet.range(ref);\n                var status = {\n                    canPaste: true,\n                    pasteOnMerged: false,\n                    pasteOnDisabled: false\n                };\n                if (!range.enable()) {\n                    status.canPaste = false;\n                    status.pasteOnDisabled = true;\n                }\n                if (!ref.eq(sheet.unionWithMerged(ref))) {\n                    status.canPaste = false;\n                    status.pasteOnMerged = true;\n                }\n                if (this.menuInvoked) {\n                    status.canPaste = false;\n                    status.menuInvoked = true;\n                }\n                if (ref.bottomRight.row >= sheet._rows._count || ref.bottomRight.col >= sheet._columns._count) {\n                    status.canPaste = false;\n                    status.overflow = true;\n                }\n                return status;\n            },\n            intersectsMerged: function () {\n                var sheet = this.workbook.activeSheet();\n                this.parse();\n                this.origin = this._content.origRef;\n                var ref = this.pasteRef();\n                return !ref.eq(sheet.unionWithMerged(ref));\n            },\n            copy: function () {\n                var sheet = this.workbook.activeSheet();\n                this.origin = sheet.select();\n                this._internalContent = sheet.selection().getState();\n                delete this._externalContent.html;\n                delete this._externalContent.plain;\n            },\n            cut: function () {\n                var sheet = this.workbook.activeSheet();\n                this.copy();\n                sheet.range(sheet.select()).clear();\n            },\n            pasteRef: function () {\n                var sheet = this.workbook.activeSheet();\n                if (this.origin === kendo.spreadsheet.NULLREF) {\n                    return sheet.select();\n                }\n                var destination = sheet.activeCell().first();\n                var originActiveCell = this.origin.first();\n                var rowDelta = originActiveCell.row - destination.row;\n                var colDelta = originActiveCell.col - destination.col;\n                return this.origin.relative(rowDelta, colDelta, 3);\n            },\n            paste: function () {\n                var sheet = this.workbook.activeSheet();\n                var pasteRef = this.pasteRef();\n                sheet.range(pasteRef).setState(this._content, this);\n                sheet.triggerChange({\n                    recalc: true,\n                    ref: pasteRef\n                });\n            },\n            external: function (data) {\n                if (data && (data.html || data.plain)) {\n                    this._externalContent = data;\n                } else {\n                    return this._externalContent;\n                }\n            },\n            isExternal: function () {\n                return !this._isInternal();\n            },\n            parse: function () {\n                var state = newState();\n                if (this._isInternal()) {\n                    state = this._internalContent;\n                } else {\n                    var data = this._externalContent;\n                    if (data.html) {\n                        var doc = this.iframe.contentWindow.document;\n                        doc.open();\n                        doc.write(data.html);\n                        doc.close();\n                        var table = doc.querySelector('table');\n                        if (table) {\n                            state = parseHTML(table);\n                        } else {\n                            state = parseTSV(data.plain);\n                        }\n                    } else {\n                        state = parseTSV(data.plain);\n                    }\n                    this.origin = state.origRef;\n                }\n                this._content = state;\n            },\n            _isInternal: function () {\n                if (this._externalContent.html === undefined) {\n                    return true;\n                }\n                var internalHTML = $('<div/>').html(this._externalContent.html).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                var internalPlain = $('<div/>').html(this._externalContent.plain).find('table.kendo-clipboard-' + this._uid).length ? true : false;\n                return internalHTML || internalPlain;\n            }\n        });\n        kendo.spreadsheet.Clipboard = Clipboard;\n        function newState() {\n            var ref = new CellRef(0, 0, 0);\n            return {\n                ref: ref,\n                mergedCells: [],\n                data: [],\n                foreign: true,\n                origRef: ref.toRangeRef()\n            };\n        }\n        function setStateData(state, row, col, value) {\n            var data = state.data || (state.data = []);\n            if (!data[row]) {\n                data[row] = [];\n            }\n            data[row][col] = value;\n            var br = state.origRef.bottomRight;\n            br.row = Math.max(br.row, row);\n            br.col = Math.max(br.col, col);\n        }\n        function stripStyle(style) {\n            return style.replace(/^-(?:ms|moz|webkit)-/, '');\n        }\n        function borderObject(styles) {\n            var obj = {};\n            [\n                'borderBottom',\n                'borderRight',\n                'borderLeft',\n                'borderTop'\n            ].forEach(function (key) {\n                obj[key] = styles[key + 'Style'] == 'none' ? null : {\n                    size: 1,\n                    color: styles[key + 'Color']\n                };\n            });\n            return obj;\n        }\n        function cellState(element) {\n            var styles = window.getComputedStyle(element);\n            var text = element.innerText;\n            var borders = borderObject(styles);\n            var state = {\n                value: text === '' ? null : text,\n                borderBottom: borders.borderBottom,\n                borderRight: borders.borderRight,\n                borderLeft: borders.borderLeft,\n                borderTop: borders.borderTop,\n                fontSize: parseInt(styles['font-size'], 10)\n            };\n            if (styles['background-color'] !== 'rgb(0, 0, 0)' && styles['background-color'] !== 'rgba(0, 0, 0, 0)') {\n                state.background = styles['background-color'];\n            }\n            if (styles.color !== 'rgb(0, 0, 0)' && styles.color !== 'rgba(0, 0, 0, 0)') {\n                state.color = styles.color;\n            }\n            if (styles['text-decoration'] == 'underline') {\n                state.underline = true;\n            }\n            if (styles['font-style'] == 'italic') {\n                state.italic = true;\n            }\n            if (styles['font-weight'] == 'bold') {\n                state.bold = true;\n            }\n            if (stripStyle(styles['text-align']) !== 'right') {\n                state.textAlign = stripStyle(styles['text-align']);\n            }\n            if (styles['vertical-align'] !== 'middle') {\n                state.verticalAlign = styles['vertical-align'];\n            }\n            if (styles['word-wrap'] !== 'normal') {\n                state.wrap = true;\n            }\n            return state;\n        }\n        function parseHTML(table) {\n            var state = newState();\n            var done = [], row = 0, col = 0;\n            for (var i = 0; i < table.rows.length; ++i) {\n                done.push([]);\n            }\n            for (var ri = 0; ri < table.rows.length; ++ri, ++row) {\n                var tr = table.rows[ri];\n                col = 0;\n                for (var ci = 0; ci < tr.cells.length; ++ci) {\n                    var td = tr.cells[ci];\n                    var rowSpan = td.rowSpan;\n                    var colSpan = td.colSpan;\n                    while (done[row][col]) {\n                        col++;\n                    }\n                    setStateData(state, row, col, cellState(td));\n                    if (rowSpan > 1 || colSpan > 1) {\n                        state.mergedCells.push(new kendo.spreadsheet.RangeRef(new CellRef(row, col), new CellRef(row + rowSpan - 1, col + colSpan - 1)).toString());\n                    }\n                    for (var dr = row + rowSpan; --dr >= row;) {\n                        for (var dc = col + colSpan; --dc >= col;) {\n                            if (dr < done.length) {\n                                done[dr][dc] = true;\n                                if (!(dr == row && dc == col)) {\n                                    setStateData(state, dr, dc, {});\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            return state;\n        }\n        function parseTSV(data) {\n            var state = newState();\n            if (data.indexOf('\\t') === -1 && data.indexOf('\\n') == -1) {\n                setStateData(state, 0, 0, { value: data });\n            } else {\n                var rows = data.split('\\n');\n                for (var ri = 0; ri < rows.length; ri++) {\n                    var cols = rows[ri].split('\\t');\n                    for (var ci = 0; ci < cols.length; ci++) {\n                        setStateData(state, ri, ci, { value: cols[ci] });\n                    }\n                }\n            }\n            return state;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/range', [\n        'kendo.core',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var PROPERTIES = [\n            'color',\n            'fontFamily',\n            'underline',\n            'italic',\n            'bold',\n            'textAlign',\n            'verticalAlign',\n            'background',\n            'format',\n            'link',\n            'editor',\n            'borderTop',\n            'borderRight',\n            'borderBottom',\n            'borderLeft'\n        ];\n        var Range = kendo.Class.extend({\n            init: function (ref, sheet) {\n                this._sheet = sheet;\n                this._ref = ref;\n            },\n            clone: function () {\n                return new Range(this._ref.clone(), this._sheet);\n            },\n            skipHiddenCells: function () {\n                var refs = [];\n                var self = this, sheet = self._sheet;\n                var skipHiddenRows = sheet.isHiddenRow.bind(sheet);\n                var skipHiddenCols = sheet.isHiddenColumn.bind(sheet);\n                self._ref.forEach(function (ref) {\n                    ref = self._normalize(ref.toRangeRef());\n                    var tl = ref.topLeft, br = ref.bottomRight;\n                    var rows = partition(tl.row, br.row, skipHiddenRows);\n                    var cols = partition(tl.col, br.col, skipHiddenCols);\n                    for (var i = 0; i < rows.length; ++i) {\n                        for (var j = 0; j < cols.length; ++j) {\n                            refs.push(new RangeRef(new CellRef(rows[i].begin, cols[j].begin), new CellRef(rows[i].end, cols[j].end)));\n                        }\n                    }\n                });\n                return sheet.range(refs.length > 1 ? new UnionRef(refs) : refs[0]);\n            },\n            _normalize: function (ref) {\n                return this._sheet._grid.normalize(ref);\n            },\n            _set: function (name, value, noTrigger) {\n                var self = this;\n                var sheet = self._sheet;\n                self._ref.forEach(function (ref) {\n                    sheet._set(ref.toRangeRef(), name, value);\n                });\n                if (!noTrigger) {\n                    sheet.triggerChange({\n                        recalc: name == 'formula' || name == 'value' || name == 'validation',\n                        value: value,\n                        range: self,\n                        ref: self._ref\n                    });\n                }\n                return self;\n            },\n            _get: function (name) {\n                return this._sheet._get(this._ref.toRangeRef(), name);\n            },\n            _property: function (name, value) {\n                if (value === undefined) {\n                    return this._get(name);\n                } else {\n                    return this._set(name, value);\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this._set('formula', null, true);\n                }\n                return this._property('value', value);\n            },\n            resize: function (direction) {\n                var ref = this._resizedRef(direction);\n                return new Range(ref, this._sheet);\n            },\n            _resizedRef: function (direction) {\n                return this._ref.map(function (ref) {\n                    return ref.toRangeRef().resize(direction);\n                });\n            },\n            input: function (value) {\n                var existingFormat = this._get('format'), x;\n                if (value !== undefined) {\n                    var tl = this._ref.toRangeRef().topLeft;\n                    x = kendo.spreadsheet.calc.parse(this._sheet.name(), tl.row, tl.col, value, existingFormat);\n                    this._sheet.batch(function () {\n                        var formula = null;\n                        if (x.type == 'exp') {\n                            formula = kendo.spreadsheet.calc.compile(x);\n                        } else if (existingFormat != '@') {\n                            var existingFormatType = existingFormat && kendo.spreadsheet.formatting.type(x.value, existingFormat);\n                            if (x.type == 'date' && existingFormatType != 'date') {\n                                this.format(x.format || toExcelFormat(kendo.culture().calendar.patterns.d));\n                            } else if (x.type == 'percent' && existingFormatType != 'percent') {\n                                this.format(x.value * 100 == (x.value * 100 | 0) ? '0%' : '0.00%');\n                            } else if (x.format) {\n                                if (!existingFormat || x.currency || existingFormatType == 'number' && x.type == 'number' && x.format.length > existingFormat.length) {\n                                    this.format(x.format);\n                                }\n                            }\n                        } else if (x.type != 'string') {\n                            x.value = value;\n                        }\n                        this.formula(formula);\n                        if (!formula) {\n                            this.value(x.value);\n                        }\n                    }.bind(this), {\n                        recalc: true,\n                        value: value,\n                        ref: this._ref,\n                        editorChange: this._sheet.isInEditMode()\n                    });\n                    return this;\n                } else {\n                    value = this._get('value');\n                    var formula = this._get('formula');\n                    var type = existingFormat && !formula && kendo.spreadsheet.formatting.type(value, existingFormat);\n                    if (formula) {\n                        value = '=' + formula;\n                    } else\n                        OUT: {\n                            if (existingFormat && type == 'date') {\n                                var t1 = kendo.spreadsheet.formatting.text(value, existingFormat);\n                                x = kendo.spreadsheet.calc.parse(null, null, null, t1, existingFormat);\n                                var t2 = kendo.spreadsheet.formatting.text(x.value, existingFormat);\n                                if (t1 == t2) {\n                                    value = t1;\n                                    break OUT;\n                                }\n                            }\n                            if (type === 'date') {\n                                value = kendo.toString(kendo.spreadsheet.numberToDate(value), kendo.culture().calendar.patterns.d);\n                            } else if (type === 'percent') {\n                                value = value * 100 + '%';\n                            } else if (typeof value == 'string' && (/^[=']/.test(value) || /^(?:true|false)$/i.test(value) || looksLikeANumber(value))) {\n                                value = '\\'' + value;\n                            }\n                        }\n                    return value;\n                }\n            },\n            enable: function (value) {\n                if (value === undefined) {\n                    value = true;\n                    this._sheet.forEach(this._ref.toRangeRef(), function (_, __, data) {\n                        if (data.enable === false) {\n                            value = false;\n                        }\n                    });\n                    return value;\n                }\n                return this._property('enable', value);\n            },\n            formula: function (value) {\n                if (value === undefined) {\n                    var f = this._get('formula');\n                    return f ? '' + f : null;\n                }\n                return this._property('formula', value);\n            },\n            validation: function (value) {\n                if (value === undefined) {\n                    var f = this._get('validation');\n                    return f ? f.toJSON() : null;\n                }\n                return this._property('validation', value);\n            },\n            _getValidationState: function () {\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                    for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                        var validation = this._sheet._validation(ri, ci);\n                        if (validation && validation.type === 'reject' && validation.value === false) {\n                            return validation;\n                        }\n                    }\n                }\n                return false;\n            },\n            merge: function () {\n                this._ref = this._sheet._merge(this._ref);\n                return this;\n            },\n            unmerge: function () {\n                var mergedCells = this._sheet._mergedCells;\n                this._ref.forEach(function (ref) {\n                    ref.toRangeRef().intersecting(mergedCells).forEach(function (mergedRef) {\n                        mergedCells.splice(mergedCells.indexOf(mergedRef), 1);\n                    });\n                });\n                this._sheet.triggerChange({});\n                return this;\n            },\n            select: function () {\n                this._sheet.select(this._ref);\n                return this;\n            },\n            values: function (values) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (values !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                if (values === undefined) {\n                    values = new Array(ref.height());\n                    for (var vi = 0; vi < values.length; vi++) {\n                        values[vi] = new Array(ref.width());\n                    }\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            values[ri - topLeftRow][ci - topLeftCol] = this._sheet._value(ri, ci);\n                        }\n                    }\n                    return values;\n                } else {\n                    this._sheet._set(ref, 'formula', null);\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = values[ri - topLeftRow];\n                            if (row) {\n                                var value = row[ci - topLeftCol];\n                                if (value !== undefined) {\n                                    this._sheet._value(ri, ci, value);\n                                }\n                            }\n                        }\n                    }\n                    this._sheet.triggerChange({\n                        recalc: true,\n                        ref: ref\n                    });\n                    return this;\n                }\n            },\n            _properties: function (props) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    if (props !== undefined) {\n                        throw new Error('Unsupported for NULLREF.');\n                    } else {\n                        return [];\n                    }\n                }\n                var ref = this._ref.toRangeRef();\n                var topLeftRow = ref.topLeft.row;\n                var topLeftCol = ref.topLeft.col;\n                var bottomRightRow = ref.bottomRight.row;\n                var bottomRightCol = ref.bottomRight.col;\n                var ci, ri;\n                var sheet = this._sheet;\n                if (props === undefined) {\n                    props = new Array(ref.height());\n                    sheet.forEach(ref, function (row, col, data) {\n                        row -= topLeftRow;\n                        col -= topLeftCol;\n                        var line = props[row] || (props[row] = []);\n                        line[col] = data;\n                    });\n                    return props;\n                } else {\n                    var data;\n                    ref = ref.clone();\n                    var setProp = function (propName) {\n                        var propValue = data[propName];\n                        ref.topLeft.row = ref.bottomRight.row = ri;\n                        ref.topLeft.col = ref.bottomRight.col = ci;\n                        if (propName == 'value') {\n                            sheet._set(ref, 'formula', null);\n                        }\n                        sheet._set(ref, propName, propValue);\n                    };\n                    for (ci = topLeftCol; ci <= bottomRightCol; ci++) {\n                        if (sheet.isHiddenColumn(ci)) {\n                            continue;\n                        }\n                        for (ri = topLeftRow; ri <= bottomRightRow; ri++) {\n                            var row = props[ri - topLeftRow];\n                            if (row && !sheet.isHiddenRow(ri)) {\n                                data = row[ci - topLeftCol];\n                                if (data) {\n                                    Object.keys(data).forEach(setProp);\n                                }\n                            }\n                        }\n                    }\n                    sheet.triggerChange({\n                        recalc: true,\n                        ref: this._ref\n                    });\n                    return this;\n                }\n            },\n            clear: function (options) {\n                options = options || {};\n                var clearAll = options.clearAll || !Object.keys(options).length;\n                var sheet = this._sheet;\n                var reason = {\n                    recalc: clearAll || options.contentsOnly,\n                    ref: this._ref\n                };\n                sheet.batch(function () {\n                    if (reason.recalc) {\n                        this.formula(null);\n                    }\n                    if (clearAll) {\n                        this.validation(null);\n                    }\n                    if (clearAll || options.formatOnly) {\n                        PROPERTIES.forEach(function (x) {\n                            if (!(options.keepBorders && /^border/i.test(x))) {\n                                this[x](null);\n                            }\n                        }.bind(this));\n                        this.unmerge();\n                    }\n                }.bind(this), reason);\n                return this;\n            },\n            clearContent: function () {\n                return this.clear({ contentsOnly: true });\n            },\n            clearFormat: function () {\n                return this.clear({ formatOnly: true });\n            },\n            isSortable: function () {\n                return !this.cantSort();\n            },\n            cantSort: function () {\n                if (this._ref instanceof UnionRef) {\n                    return {\n                        code: 'cantSortMultipleSelection',\n                        message: 'Unsupported for multiple ranges.'\n                    };\n                }\n                if (this._ref === kendo.spreadsheet.NULLREF) {\n                    return {\n                        code: 'cantSortNullRef',\n                        message: 'Unsupported for NULLREF.'\n                    };\n                }\n                var mc = this._sheet._getMergedCells(this._ref.toRangeRef());\n                var primary = mc.primary;\n                var secondary = mc.secondary;\n                var width = null, height = null;\n                var cant = {};\n                try {\n                    this._sheet.forEach(this, function (row, col) {\n                        var id = new CellRef(row, col).print();\n                        var merged = primary[id];\n                        if (merged) {\n                            if (width === null) {\n                                width = merged.width();\n                                height = merged.height();\n                            } else if (!(width == merged.width() && height == merged.height())) {\n                                throw cant;\n                            }\n                        } else if (!secondary[id] && mc.hasMerged) {\n                            throw cant;\n                        }\n                    });\n                } catch (ex) {\n                    if (ex !== cant) {\n                        throw ex;\n                    }\n                    return {\n                        code: 'cantSortMixedCells',\n                        message: 'Unsupported for range containing cells of different shapes.'\n                    };\n                }\n                return false;\n            },\n            sort: function (spec) {\n                var reason = this.cantSort();\n                if (reason) {\n                    throw new Error(reason.message);\n                }\n                if (spec === undefined) {\n                    spec = { column: 0 };\n                }\n                spec = spec instanceof Array ? spec : [spec];\n                this._sheet._sortBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                    if (typeof spec === 'number') {\n                        spec = { column: spec };\n                    }\n                    return {\n                        index: spec.column === undefined ? index : spec.column,\n                        ascending: spec.ascending === undefined ? true : spec.ascending\n                    };\n                }));\n                return this;\n            },\n            isFilterable: function () {\n                return !(this._ref instanceof UnionRef);\n            },\n            filter: function (spec) {\n                if (this._ref instanceof UnionRef) {\n                    throw new Error('Unsupported for multiple ranges.');\n                }\n                if (spec === false) {\n                    this.clearFilters();\n                } else {\n                    spec = spec === true ? [] : spec instanceof Array ? spec : [spec];\n                    this._sheet._filterBy(this._ref.toRangeRef(), spec.map(function (spec, index) {\n                        return {\n                            index: spec.column === undefined ? index : spec.column,\n                            filter: spec.filter\n                        };\n                    }));\n                }\n                return this;\n            },\n            clearFilter: function (spec) {\n                this._sheet.clearFilter(spec);\n            },\n            clearFilters: function () {\n                var filter = this._sheet.filter();\n                var spec = [];\n                if (filter) {\n                    for (var i = 0; i < filter.columns.length; i++) {\n                        spec.push(i);\n                    }\n                    this._sheet.batch(function () {\n                        this.clearFilter(spec);\n                        this._filter = null;\n                    }, {\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            hasFilter: function () {\n                var filter = this._sheet.filter();\n                return !!filter;\n            },\n            leftColumn: function () {\n                return new Range(this._ref.leftColumn(), this._sheet);\n            },\n            rightColumn: function () {\n                return new Range(this._ref.rightColumn(), this._sheet);\n            },\n            topRow: function () {\n                return new Range(this._ref.topRow(), this._sheet);\n            },\n            bottomRow: function () {\n                return new Range(this._ref.bottomRow(), this._sheet);\n            },\n            column: function (column) {\n                return new Range(this._ref.toColumn(column), this._sheet);\n            },\n            row: function (row) {\n                return new Range(this._ref.toRow(row), this._sheet);\n            },\n            forEachRow: function (callback) {\n                this._ref.forEachRow(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            forEachColumn: function (callback) {\n                this._ref.forEachColumn(function (ref) {\n                    callback(new Range(ref, this._sheet));\n                }.bind(this));\n            },\n            sheet: function () {\n                return this._sheet;\n            },\n            topLeft: function () {\n                return this._ref.toRangeRef().topLeft;\n            },\n            intersectingMerged: function () {\n                var sheet = this._sheet;\n                var mergedCells = [];\n                sheet._mergedCells.forEach(function (ref) {\n                    if (ref.intersects(this._ref)) {\n                        mergedCells.push(ref.toString());\n                    }\n                }.bind(this));\n                return mergedCells;\n            },\n            getState: function (propertyName) {\n                var topLeft = this._ref.first();\n                var state = {\n                    ref: topLeft,\n                    data: [],\n                    origRef: this._ref\n                };\n                var properties;\n                if (!propertyName) {\n                    properties = kendo.spreadsheet.ALL_PROPERTIES;\n                    state.mergedCells = this.intersectingMerged();\n                } else if (propertyName === 'input') {\n                    properties = [\n                        'value',\n                        'formula'\n                    ];\n                } else if (propertyName === 'border') {\n                    properties = [\n                        'borderLeft',\n                        'borderTop',\n                        'borderRight',\n                        'borderBottom'\n                    ];\n                } else {\n                    properties = [propertyName];\n                }\n                var data = state.data;\n                this.forEachCell(function (row, col, cell) {\n                    var cellState = {};\n                    var dr = row - topLeft.row;\n                    var dc = col - topLeft.col;\n                    if (!data[dr]) {\n                        data[dr] = [];\n                    }\n                    data[dr][dc] = cellState;\n                    properties.forEach(function (property) {\n                        var value = typeof cell[property] == 'undefined' ? null : cell[property];\n                        if (value instanceof kendo.spreadsheet.calc.runtime.Formula || value instanceof kendo.spreadsheet.validation.Validation) {\n                            value = value.deepClone();\n                        }\n                        cellState[property] = value;\n                    });\n                });\n                return state;\n            },\n            setState: function (state, clipboard) {\n                var sheet = this._sheet;\n                var origin = this._ref.first();\n                var rowDelta = state.ref.row - origin.row;\n                var colDelta = state.ref.col - origin.col;\n                var internalClipboard = clipboard && !clipboard.isExternal();\n                var externalClipboard = clipboard && !internalClipboard;\n                sheet.batch(function () {\n                    if (state.mergedCells) {\n                        this.unmerge();\n                    }\n                    var row = origin.row;\n                    var hasFilter = this.hasFilter();\n                    state.data.forEach(function (data, dr) {\n                        if (hasFilter && internalClipboard && sheet.isHiddenRow(state.ref.row + dr)) {\n                            return;\n                        }\n                        var col = origin.col;\n                        data.forEach(function (cellState, dc) {\n                            if (hasFilter && internalClipboard && sheet.isHiddenColumn(state.ref.col + dc)) {\n                                return;\n                            }\n                            var range = clipboard ? sheet.range(row, col) : sheet.range(origin.row + dr, origin.col + dc);\n                            if (range.enable()) {\n                                for (var property in cellState) {\n                                    if (property != 'value') {\n                                        if (!(clipboard && property == 'enable')) {\n                                            range._set(property, cellState[property]);\n                                        }\n                                    }\n                                }\n                                if (!cellState.formula) {\n                                    if (externalClipboard) {\n                                        try {\n                                            if (cellState.value == null) {\n                                                range._set('value', null);\n                                            } else {\n                                                range.input(cellState.value);\n                                            }\n                                        } catch (ex) {\n                                            range._set('value', cellState.value);\n                                        }\n                                    } else {\n                                        range._set('value', cellState.value);\n                                    }\n                                }\n                            }\n                            col++;\n                        });\n                        row++;\n                    });\n                    if (state.mergedCells) {\n                        state.mergedCells.forEach(function (merged) {\n                            merged = sheet._ref(merged).relative(rowDelta, colDelta, 3);\n                            sheet.range(merged).merge();\n                        }, this);\n                    }\n                }.bind(this), {\n                    recalc: true,\n                    ref: this._ref\n                });\n            },\n            _adjustRowHeight: function () {\n                var sheet = this._sheet;\n                var state = this.getState();\n                var mergedCells = [];\n                for (var i = 0; i < state.mergedCells.length; i++) {\n                    mergedCells.push(sheet.range(state.mergedCells[i]));\n                }\n                this.forEachRow(function (row) {\n                    if (row.topLeft().row >= row.sheet()._rows._count) {\n                        return;\n                    }\n                    var maxHeight = row.sheet().rowHeight(row.topLeft().row);\n                    row.forEachCell(function (rowIndex, colIndex, cell) {\n                        var cellRange = sheet.range(rowIndex, colIndex);\n                        var totalWidth = 0;\n                        for (var i = 0; i < mergedCells.length; i++) {\n                            if (cellRange._ref.intersects(mergedCells[i]._ref)) {\n                                totalWidth += cell.width;\n                                break;\n                            }\n                        }\n                        var width = Math.max(sheet.columnWidth(colIndex), totalWidth);\n                        maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, cell.wrap));\n                    });\n                    sheet.rowHeight(row.topLeft().row, Math.max(sheet.rowHeight(row.topLeft().row), maxHeight));\n                });\n            },\n            forEachCell: function (callback) {\n                this._ref.forEach(function (ref) {\n                    this._sheet.forEach(ref.toRangeRef(), callback.bind(this));\n                }.bind(this));\n            },\n            hasValue: function () {\n                var yesItHas = {};\n                var defStyle = this._sheet._defaultCellStyle;\n                try {\n                    this.forEachCell(function (row, col, cell) {\n                        for (var key in cell) {\n                            var val = cell[key];\n                            if (val !== undefined && val !== null && val !== defStyle[key]) {\n                                throw yesItHas;\n                            }\n                        }\n                    });\n                } catch (ex) {\n                    if (ex === yesItHas) {\n                        return true;\n                    } else {\n                        throw ex;\n                    }\n                }\n                return false;\n            },\n            wrap: function (flag) {\n                if (flag === undefined) {\n                    return !!this._property('wrap');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, cell.fontSize, true));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('wrap', flag);\n                return this;\n            },\n            fontSize: function (size) {\n                if (size === undefined) {\n                    return this._property('fontSize');\n                }\n                this.forEachRow(function (range) {\n                    var maxHeight = range.sheet().rowHeight(range.topLeft().row);\n                    range.forEachCell(function (row, col, cell) {\n                        var width = this._sheet.columnWidth(col);\n                        if (cell.value !== null && cell.value !== undefined) {\n                            maxHeight = Math.max(maxHeight, kendo.spreadsheet.util.getTextHeight(cell.value, width, size, cell.wrap));\n                        }\n                    });\n                    range.sheet().rowHeight(range.topLeft().row, maxHeight);\n                }.bind(this));\n                this._property('fontSize', size);\n                return this;\n            },\n            draw: function (options, callback) {\n                this._sheet.draw(this, options, callback);\n            },\n            insideBorders: function (value) {\n                return this.insideVerticalBorders(value).insideHorizontalBorders(value);\n            },\n            insideVerticalBorders: function (value) {\n                this._ref.forEach(function (ref) {\n                    if (ref instanceof RangeRef && ref.width() > 1) {\n                        ref = ref.clone();\n                        ref.topLeft.col++;\n                        this._sheet.range(ref)._set('vBorders', value);\n                    }\n                }, this);\n                return this;\n            },\n            insideHorizontalBorders: function (value) {\n                this._ref.forEach(function (ref) {\n                    if (ref instanceof RangeRef && ref.height() > 1) {\n                        ref = ref.clone();\n                        ref.topLeft.row++;\n                        this._sheet.range(ref)._set('hBorders', value);\n                    }\n                }, this);\n                return this;\n            }\n        });\n        function partition(begin, end, predicate) {\n            while (begin <= end && predicate(begin)) {\n                begin++;\n            }\n            if (begin > end) {\n                return [];\n            }\n            for (var i = begin + 1; i <= end; ++i) {\n                if (predicate(i)) {\n                    return [{\n                            begin: begin,\n                            end: i - 1\n                        }].concat(partition(i + 1, end, predicate));\n                }\n            }\n            return [{\n                    begin: begin,\n                    end: end\n                }];\n        }\n        $.each(PROPERTIES, function (i, property) {\n            Range.prototype[property] = function (value) {\n                return this._property(property, value);\n            };\n        });\n        function toExcelFormat(format) {\n            return format.replace(/M/g, 'm').replace(/'/g, '\"').replace(/tt/, 'am/pm');\n        }\n        function looksLikeANumber(str) {\n            return !/^=/.test(str) && /number|percent/.test(kendo.spreadsheet.calc.parse(null, 0, 0, str).type);\n        }\n        var measureBox = $('<div style=\"position: absolute !important; top: -4000px !important; height: auto !important;' + 'padding: 1px !important; margin: 0 !important; border: 1px solid black !important;' + 'line-height: normal !important; visibility: hidden !important;' + 'white-space: pre-wrap; word-break: break-all;\" />')[0];\n        function getTextHeight(text, width, fontSize, wrap) {\n            var styles = {\n                'baselineMarkerSize': 0,\n                'width': wrap === true ? width + 'px' : 'auto',\n                'font-size': (fontSize || 12) + 'px',\n                'word-break': wrap === true ? 'break-all' : 'normal',\n                'white-space': wrap === true ? 'pre-wrap' : 'pre'\n            };\n            return kendo.util.measureText(text, styles, {\n                box: measureBox,\n                normalizeText: false\n            }).height;\n        }\n        kendo.spreadsheet.util = { getTextHeight: getTextHeight };\n        kendo.spreadsheet.Range = Range;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime', ['spreadsheet/references'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = {};\n    var spreadsheet = kendo.spreadsheet;\n    spreadsheet.calc = calc;\n    var exports = calc.runtime = {};\n    var Class = kendo.Class;\n    var Ref = spreadsheet.Ref;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NULL = spreadsheet.NULLREF;\n    function CalcError(code) {\n        if (code instanceof CalcError) {\n            return code;\n        }\n        this.code = code;\n    }\n    CalcError.prototype.toString = function () {\n        return '#' + this.code + (this.code == 'NAME' ? '?' : '!');\n    };\n    var Context = Class.extend({\n        init: function Context(callback, formula, ss, parent) {\n            this.callback = callback;\n            this.formula = formula;\n            this.ss = ss;\n            this.parent = parent;\n        },\n        resolve: function (val) {\n            var self = this;\n            if (val instanceof Ref) {\n                self.resolveCells([val], function () {\n                    self._resolve(val);\n                });\n            } else {\n                self._resolve(val);\n            }\n        },\n        error: function (val) {\n            return new CalcError(val);\n        },\n        _resolve: function (val) {\n            if (val === undefined) {\n                val = null;\n            } else if (Array.isArray(val)) {\n                val = this.asMatrix(val);\n            } else {\n                val = maybeRoundFloatErrors(val);\n            }\n            var f = this.formula;\n            f.value = val;\n            if (this.ss.onFormula(f) && this.callback) {\n                this.callback.call(f, val);\n            }\n        },\n        resolveCells: function (a, f) {\n            var context = this, formulas = [];\n            (function loop(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var x = a[i];\n                    if (x instanceof Ref) {\n                        add(context.getRefCells(x));\n                    }\n                    if (Array.isArray(x)) {\n                        loop(x);\n                    }\n                }\n            }(a));\n            if (!formulas.length) {\n                return f.call(context);\n            }\n            for (var pending = formulas.length, i = 0; i < formulas.length; ++i) {\n                fetch(formulas[i]);\n            }\n            function fetch(formula) {\n                formula.exec(context.ss, function () {\n                    if (!--pending) {\n                        f.call(context);\n                    }\n                }, context);\n            }\n            function add(a) {\n                for (var i = 0; i < a.length; ++i) {\n                    var cell = a[i];\n                    if (cell.formula) {\n                        formulas.push(cell.formula);\n                    }\n                }\n                return true;\n            }\n        },\n        cellValues: function (a, f) {\n            var ret = [];\n            for (var i = 0; i < a.length; ++i) {\n                var val = a[i];\n                if (val instanceof Ref) {\n                    val = this.getRefData(val);\n                    ret = ret.concat(val);\n                } else if (Array.isArray(val)) {\n                    ret = ret.concat(this.cellValues(val));\n                } else if (val instanceof Matrix) {\n                    ret = ret.concat(this.cellValues(val.data));\n                } else {\n                    ret.push(val);\n                }\n            }\n            if (f) {\n                return f.apply(this, ret);\n            }\n            return ret;\n        },\n        fetchName: function (ref, callback) {\n            var f = this.formula;\n            var val = this.ss.nameValue(ref, f.sheet, f.row, f.col);\n            if (val instanceof Formula) {\n                val = val.clone(f.sheet, f.row, f.col, true);\n                var ss = new spreadsheet.ValidationFormulaContext(this.ss.workbook);\n                val.exec(ss, callback, this);\n            } else {\n                if (val instanceof Ref) {\n                    val = val.absolute(f.row, f.col);\n                    if (!val.sheet) {\n                        val.sheet = f.sheet;\n                    }\n                }\n                callback(val == null ? new CalcError('NAME') : val);\n            }\n        },\n        force: function (val) {\n            if (val instanceof Ref) {\n                return this.getRefData(val);\n            }\n            return val;\n        },\n        func: function (fname, callback, args) {\n            fname = fname.toLowerCase();\n            var f = FUNCS[fname];\n            if (f) {\n                return f.call(this, callback, args);\n            }\n            callback(new CalcError('NAME'));\n        },\n        bool: function (val) {\n            if (val instanceof Ref) {\n                val = this.getRefData(val);\n            }\n            if (typeof val == 'string') {\n                return val.toLowerCase() == 'true';\n            }\n            if (typeof val == 'number') {\n                return val !== 0;\n            }\n            if (typeof val == 'boolean') {\n                return val;\n            }\n            return val != null;\n        },\n        asMatrix: function (range) {\n            if (range instanceof Matrix) {\n                return range;\n            }\n            var self = this;\n            if (range instanceof RangeRef) {\n                var tl = range.topLeft;\n                var top = tl.row, left = tl.col;\n                var cells = self.getRefCells(range);\n                var m = new Matrix(self);\n                if (isFinite(range.width())) {\n                    m.width = range.width();\n                }\n                if (isFinite(range.height())) {\n                    m.height = range.height();\n                }\n                if (!isFinite(top)) {\n                    top = 0;\n                }\n                if (!isFinite(left)) {\n                    left = 0;\n                }\n                cells.forEach(function (cell) {\n                    m.set(cell.row - top, cell.col - left, cell.value);\n                });\n                return m;\n            }\n            if (Array.isArray(range) && range.length > 0) {\n                var m = new Matrix(self), row = 0;\n                range.forEach(function (line) {\n                    var col = 0;\n                    var h = 1;\n                    line.forEach(function (el) {\n                        var isRange = el instanceof RangeRef;\n                        if (el instanceof Ref && !isRange) {\n                            el = self.getRefData(el);\n                        }\n                        if (isRange || Array.isArray(el)) {\n                            el = self.asMatrix(el);\n                        }\n                        if (el instanceof Matrix) {\n                            el.each(function (el, r, c) {\n                                m.set(row + r, col + c, el);\n                            });\n                            h = Math.max(h, el.height);\n                            col += el.width;\n                        } else {\n                            m.set(row, col++, el);\n                        }\n                    });\n                    row += h;\n                });\n                return m;\n            }\n        },\n        getRefCells: function (refs, hiddenInfo) {\n            var f = this.formula;\n            return this.ss.getRefCells(refs, hiddenInfo, f.sheet, f.row, f.col);\n        },\n        getRefData: function (ref) {\n            var f = this.formula;\n            return this.ss.getData(ref, f.sheet, f.row, f.col);\n        },\n        workbook: function () {\n            return this.ss.workbook;\n        }\n    });\n    var Matrix = Class.extend({\n        init: function Matrix(context) {\n            this.context = context;\n            this.height = 0;\n            this.width = 0;\n            this.data = [];\n        },\n        clone: function () {\n            var m = new Matrix(this.context);\n            m.height = this.height;\n            m.width = this.width;\n            m.data = this.data.map(function (row) {\n                return row.slice();\n            });\n            return m;\n        },\n        get: function (row, col) {\n            var line = this.data[row];\n            var val = line ? line[col] : null;\n            return val instanceof Ref ? this.context.getRefData(val) : val;\n        },\n        set: function (row, col, data) {\n            var line = this.data[row];\n            if (line == null) {\n                line = this.data[row] = [];\n            }\n            line[col] = data;\n            if (row >= this.height) {\n                this.height = row + 1;\n            }\n            if (col >= this.width) {\n                this.width = col + 1;\n            }\n        },\n        each: function (f, includeEmpty) {\n            for (var row = 0; row < this.height; ++row) {\n                for (var col = 0; col < this.width; ++col) {\n                    var val = this.get(row, col);\n                    if (includeEmpty || val != null) {\n                        val = f.call(this.context, val, row, col);\n                        if (val !== undefined) {\n                            return val;\n                        }\n                    }\n                }\n            }\n        },\n        map: function (f, includeEmpty) {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(row, col, f.call(this, el, row, col));\n            }, includeEmpty);\n            return m;\n        },\n        eachRow: function (f) {\n            for (var row = 0; row < this.height; ++row) {\n                var val = f.call(this.context, row);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        eachCol: function (f) {\n            for (var col = 0; col < this.width; ++col) {\n                var val = f.call(this.context, col);\n                if (val !== undefined) {\n                    return val;\n                }\n            }\n        },\n        mapRow: function (f) {\n            var m = new Matrix(this.context);\n            this.eachRow(function (row) {\n                m.set(row, 0, f.call(this.context, row));\n            });\n            return m;\n        },\n        mapCol: function (f) {\n            var m = new Matrix(this.context);\n            this.eachCol(function (col) {\n                m.set(0, col, f.call(this.context, col));\n            });\n            return m;\n        },\n        toString: function () {\n            return JSON.stringify(this.data);\n        },\n        transpose: function () {\n            var m = new Matrix(this.context);\n            this.each(function (el, row, col) {\n                m.set(col, row, el);\n            });\n            return m;\n        },\n        unit: function (n) {\n            this.width = this.height = n;\n            var a = this.data = new Array(n);\n            for (var i = n; --i >= 0;) {\n                var row = a[i] = new Array(n);\n                for (var j = n; --j >= 0;) {\n                    row[j] = i == j ? 1 : 0;\n                }\n            }\n            return this;\n        },\n        multiply: function (b) {\n            var a = this, m = new Matrix(a.context);\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < b.width; ++col) {\n                    var s = 0;\n                    for (var i = 0; i < a.width; ++i) {\n                        var va = a.get(row, i);\n                        var vb = b.get(i, col);\n                        if (typeof va != 'number' || typeof vb != 'number') {\n                            throw new CalcError('VALUE');\n                        }\n                        s += va * vb;\n                    }\n                    m.set(row, col, s);\n                }\n            }\n            return m;\n        },\n        adds: function (b, s) {\n            var a = this, m = new Matrix(a.context);\n            var sign = s ? -1 : 1;\n            for (var row = 0; row < a.height; ++row) {\n                for (var col = 0; col < a.width; ++col) {\n                    var x = a.get(row, col), y = b.get(row, col);\n                    m.set(row, col, x + sign * y);\n                }\n            }\n            return m;\n        },\n        determinant: function () {\n            var a = this.clone().data;\n            var n = a.length;\n            var d = 1, C, L, i, k;\n            for (C = 0; C < n; C++) {\n                for (L = C; L < n && !a[L][C]; L++) {\n                }\n                if (L == n) {\n                    return 0;\n                }\n                if (L != C) {\n                    d = -d;\n                    for (k = C; k < n; k++) {\n                        var t = a[C][k];\n                        a[C][k] = a[L][k];\n                        a[L][k] = t;\n                    }\n                }\n                for (i = C + 1; i < n; i++) {\n                    for (k = C + 1; k < n; k++) {\n                        a[i][k] -= a[C][k] * a[i][C] / a[C][C];\n                    }\n                }\n                d *= a[C][C];\n            }\n            return d;\n        },\n        inverse: function () {\n            var n = this.width;\n            var m = this.augment(new Matrix(this.context).unit(n));\n            var a = m.data;\n            var tmp;\n            for (var k = 0; k < n; ++k) {\n                var imax = argmax(k, n, function (i) {\n                    return a[i][k];\n                });\n                if (!a[imax][k]) {\n                    return null;\n                }\n                if (k != imax) {\n                    tmp = a[k];\n                    a[k] = a[imax];\n                    a[imax] = tmp;\n                }\n                for (var i = k + 1; i < n; ++i) {\n                    for (var j = k + 1; j < 2 * n; ++j) {\n                        a[i][j] -= a[k][j] * a[i][k] / a[k][k];\n                    }\n                    a[i][k] = 0;\n                }\n            }\n            for (var i = 0; i < n; ++i) {\n                for (var f = a[i][i], j = 0; j < 2 * n; ++j) {\n                    a[i][j] /= f;\n                }\n            }\n            for (var k = n; --k >= 0;) {\n                for (var i = k; --i >= 0;) {\n                    if (a[i][k]) {\n                        for (var j = 2 * n; --j >= n;) {\n                            a[i][j] -= a[k][j] * a[i][k];\n                        }\n                    }\n                }\n            }\n            return m.slice(0, n, n, n);\n        },\n        augment: function (m) {\n            var ret = this.clone(), n = ret.width;\n            m.each(function (val, row, col) {\n                ret.set(row, col + n, val);\n            });\n            return ret;\n        },\n        slice: function (row, col, height, width) {\n            var m = new Matrix(this.context);\n            for (var i = 0; i < height; ++i) {\n                for (var j = 0; j < width; ++j) {\n                    m.set(i, j, this.get(row + i, col + j));\n                }\n            }\n            return m;\n        }\n    });\n    function argmax(i, end, f) {\n        var max = f(i), pos = i;\n        while (++i < end) {\n            var v = f(i);\n            if (v > max) {\n                max = v;\n                pos = i;\n            }\n        }\n        return pos;\n    }\n    var Formula = Class.extend({\n        init: function Formula(refs, handler, printer, sheet, row, col) {\n            this.refs = refs;\n            this.handler = handler;\n            this.print = printer;\n            this.absrefs = null;\n            this.sheet = sheet;\n            this.row = row;\n            this.col = col;\n            this.onReady = [];\n            this.pending = false;\n        },\n        clone: function (sheet, row, col, forceRefs) {\n            var lcsheet = sheet.toLowerCase();\n            var refs = this.refs;\n            if (forceRefs || lcsheet != this.sheet.toLowerCase()) {\n                refs = refs.map(function (ref) {\n                    if (!ref.hasSheet() && (!ref.sheet || ref.sheet.toLowerCase() != lcsheet)) {\n                        ref = ref.clone().setSheet(sheet);\n                    }\n                    return ref;\n                });\n            }\n            return new Formula(refs, this.handler, this.print, sheet, row, col);\n        },\n        deepClone: function () {\n            var refs = this.refs.map(function (ref) {\n                return ref.clone();\n            });\n            return new Formula(refs, this.handler, this.print, this.sheet, this.row, this.col);\n        },\n        resolve: function (val) {\n            this.pending = false;\n            this.onReady.forEach(function (callback) {\n                callback(val);\n            });\n        },\n        exec: function (ss, callback, parentContext) {\n            if ('value' in this) {\n                if (callback) {\n                    callback(this.value);\n                }\n            } else {\n                if (callback) {\n                    this.onReady.push(callback);\n                }\n                var ctx = new Context(this.resolve, this, ss, parentContext);\n                var level = 0;\n                while (parentContext) {\n                    if (parentContext.formula === this) {\n                        this.pending = false;\n                        ctx.resolve(new CalcError('CIRCULAR'));\n                        return;\n                    }\n                    parentContext = parentContext.parent;\n                    ++level;\n                }\n                if (this.pending) {\n                    return;\n                }\n                this.pending = true;\n                var next = function () {\n                    if (!this.absrefs) {\n                        this.absrefs = this.refs.map(function (ref) {\n                            return ref.absolute(this.row, this.col);\n                        }, this);\n                    }\n                    this.handler.call(ctx);\n                }.bind(this);\n                if (level < 20) {\n                    next();\n                } else {\n                    setTimeout(next, 0);\n                }\n            }\n        },\n        reset: function () {\n            this.onReady = [];\n            this.pending = false;\n            delete this.value;\n        },\n        renameSheet: function (oldSheetName, newSheetName) {\n            oldSheetName = oldSheetName.toLowerCase();\n            this.absrefs = null;\n            if (this.sheet.toLowerCase() == oldSheetName) {\n                this.sheet = newSheetName;\n            }\n            this.refs.forEach(function (ref) {\n                ref.renameSheet(oldSheetName, newSheetName);\n            });\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            affectedSheet = affectedSheet.toLowerCase();\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            var formulaSheet = this.sheet.toLowerCase();\n            var formulaMoves = false;\n            if (formulaSheet == affectedSheet) {\n                if (operation == 'row' && formulaRow >= start) {\n                    this.row += delta;\n                    formulaMoves = true;\n                }\n                if (operation == 'col' && formulaCol >= start) {\n                    this.col += delta;\n                    formulaMoves = true;\n                }\n            }\n            var newFormulaRow = this.row;\n            var newFormulaCol = this.col;\n            this.absrefs = null;\n            var prevRefs = this.refs;\n            var modified = formulaMoves;\n            this.refs = prevRefs.map(function (ref) {\n                var newRef = adjust(ref);\n                if (!modified && !sameRef(newRef, ref)) {\n                    modified = true;\n                }\n                return newRef;\n            });\n            if (modified) {\n                return new Formula(prevRefs, this.handler, this.print, this.sheet, formulaRow, formulaCol);\n            }\n            function adjust(ref) {\n                if (ref === NULL) {\n                    return ref;\n                }\n                if (ref.sheet.toLowerCase() != affectedSheet) {\n                    if (formulaMoves) {\n                        if (operation == 'row' && formulaRow >= start) {\n                            ref = ref.relative(delta, 0);\n                        }\n                        if (operation == 'col' && formulaCol >= start) {\n                            ref = ref.relative(0, delta);\n                        }\n                    }\n                    return ref;\n                }\n                return ref.adjust(formulaRow, formulaCol, newFormulaRow, newFormulaCol, operation == 'row', start, delta);\n            }\n        },\n        toString: function () {\n            return this.print(this.row, this.col);\n        }\n    });\n    function sameRef(r1, r2) {\n        if (r1.constructor !== r2.constructor) {\n            return false;\n        }\n        if (r1 instanceof CellRef) {\n            return r1.sheet == r2.sheet && r1.row == r2.row && r1.col == r2.col && r1.rel == r2.rel;\n        }\n        if (r1 instanceof RangeRef) {\n            return sameRef(r1.topLeft, r2.topLeft) && sameRef(r1.bottomRight, r2.bottomRight) && r1.endSheet == r2.endSheet;\n        }\n        if (r1 instanceof UnionRef) {\n            var i = r1.refs.length;\n            if (i != r2.refs.length) {\n                return false;\n            }\n            while (--i >= 0) {\n                if (!sameRef(r1.refs[i], r2.refs[i])) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    }\n    var FUNCS = Object.create(null);\n    FUNCS['if'] = function (callback, args) {\n        var self = this;\n        var co = args[0], th = args[1], el = args[2];\n        this.resolveCells([co], function () {\n            var comatrix = self.asMatrix(co);\n            if (comatrix) {\n                th(function (th) {\n                    el(function (el) {\n                        var thmatrix = self.asMatrix(th);\n                        var elmatrix = self.asMatrix(el);\n                        callback(comatrix.map(function (val, row, col) {\n                            if (val instanceof CalcError) {\n                                return val;\n                            } else if (self.bool(val)) {\n                                return thmatrix ? thmatrix.get(row, col) : th;\n                            } else {\n                                return elmatrix ? elmatrix.get(row, col) : el;\n                            }\n                        }));\n                    });\n                });\n            } else {\n                co = this.force(co);\n                if (co instanceof CalcError) {\n                    callback(co);\n                } else if (self.bool(co)) {\n                    th(callback);\n                } else {\n                    el(callback);\n                }\n            }\n        });\n    };\n    FUNCS[''] = function (callback) {\n        callback((1 + Math.sqrt(5)) / 2);\n    };\n    function compileArgumentChecks(functionName, args) {\n        var arrayArgs = 'function arrayArgs(args) { var xargs = [], width = 0, height = 0, arrays = [], i = 0; ';\n        var resolve = 'function resolve(args, callback) { var toResolve = [], i = 0; ';\n        var name, forced, main = '\\'use strict\\'; function check(args) { var stack = [], tmp, xargs = [], i = 0, m, err = \\'VALUE\\'; ', haveForced = false;\n        var canBeArrayArg = false, hasArrayArgs = false;\n        main += args.map(comp).join('');\n        main += 'if (i < args.length) return new CalcError(\\'N/A\\'); ';\n        main += 'return xargs; } ';\n        arrayArgs += 'return { args: xargs, width: width, height: height, arrays: arrays }; } ';\n        var f;\n        if (haveForced) {\n            resolve += 'this.resolveCells(toResolve, callback); } ';\n            f = new Function('CalcError', 'round', main + resolve + arrayArgs + ' return { resolve: resolve, check: check, arrayArgs: arrayArgs };');\n        } else {\n            f = new Function('CalcError', 'round', main + ' return { check: check };');\n        }\n        f = f(CalcError, roundFloatErrors);\n        if (!hasArrayArgs) {\n            delete f.arrayArgs;\n        }\n        return f;\n        function comp(x) {\n            name = x[0];\n            var code = '{ ';\n            if (Array.isArray(name)) {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'while (i < args.length) { ';\n                code += x.map(comp).join('');\n                code += '} ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '+') {\n                arrayArgs += 'while (i < args.length) { ';\n                resolve += 'while (i < args.length) { ';\n                code += 'if (i >= args.length) return new CalcError(\\'N/A\\'); ';\n                code += 'xargs.push(tmp = []); stack.push(xargs); xargs = tmp; ';\n                code += 'do { ';\n                code += x.slice(1).map(comp).join('');\n                code += '} while (i < args.length); ';\n                code += 'xargs = stack.pop(); ';\n                resolve += '} ';\n                arrayArgs += '} ';\n            } else if (name == '?') {\n                code += 'if (!(' + cond(x[1]) + ')) return new CalcError(err); ';\n            } else {\n                var type = x[1];\n                if (Array.isArray(type) && /^#?collect/.test(type[0])) {\n                    var n = type[2];\n                    force();\n                    code += 'try {' + 'var $' + name + ' = this.cellValues(args.slice(i';\n                    if (n) {\n                        code += ', i + ' + n;\n                    }\n                    code += ')).filter(function($' + name + '){ ';\n                    if (type[0] == 'collect') {\n                        code += 'if ($' + name + ' instanceof CalcError) throw $' + name + '; ';\n                    }\n                    code += 'return ' + cond(type[1]) + '; }, this); ';\n                    if (n) {\n                        code += 'i += ' + n + '; ';\n                    } else {\n                        code += 'i = args.length; ';\n                    }\n                    code += 'xargs.push($' + name + ')' + '} catch(ex) { if (ex instanceof CalcError) return ex; throw ex; } ';\n                    resolve += 'toResolve.push(args.slice(i)); ';\n                } else if (type == 'rest') {\n                    code += 'xargs.push(args.slice(i)); i = args.length; ';\n                } else {\n                    if (canBeArrayArg = /^\\*/.test(name)) {\n                        hasArrayArgs = true;\n                        name = name.substr(1);\n                    }\n                    code += 'var $' + name + ' = args[i++]; ';\n                    var allowError = false;\n                    if (/!$/.test(type)) {\n                        type = type.substr(0, type.length - 1);\n                        allowError = true;\n                    } else {\n                        code += 'if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n                    }\n                    code += typeCheck(type, allowError) + 'xargs.push($' + name + '); ';\n                }\n            }\n            code += '} ';\n            return code;\n        }\n        function force() {\n            if (forced) {\n                return '$' + name + '';\n            }\n            haveForced = true;\n            forced = true;\n            resolve += 'toResolve.push(args[i++]); ';\n            return '($' + name + ' = this.force($' + name + '))';\n        }\n        function forceNum(round) {\n            return '(' + (round ? '(typeof ' + force() + ' == \\'number\\' ? ($' + name + ' = round($' + name + '), true) : false) || ' : '(typeof ' + force() + ' == \\'number\\') || ') + '(typeof $' + name + ' == \\'boolean\\') || ' + '(typeof $' + name + ' == \\'string\\' && !/^(?:=|true|false)/i.test($' + name + ') ? (' + 'tmp = kendo.spreadsheet.calc.parse(0, 0, 0, $' + name + '), ' + '/^date|number|percent$/.test(tmp.type) ? ($' + name + ' = +tmp.value, true) : false' + ') : false)' + ')';\n        }\n        function typeCheck(type, allowError) {\n            forced = false;\n            var ret = 'if (!(' + cond(type) + ')) { ';\n            if (forced && !allowError) {\n                ret += ' if ($' + name + ' instanceof CalcError) return $' + name + '; ';\n            }\n            ret += 'return new CalcError(err); } ';\n            if (!forced) {\n                resolve += 'i++; ';\n            }\n            if (canBeArrayArg) {\n                arrayArgs += 'var $' + name + ' = this.asMatrix(args[i]); ' + 'if ($' + name + ') { ' + 'xargs.push($' + name + '); ' + 'width = Math.max(width, $' + name + '.width); ' + 'height = Math.max(height, $' + name + '.height); ' + 'arrays.push(true) } else { ' + 'xargs.push(args[i]); ' + 'arrays.push(false); } i++; ';\n            } else {\n                arrayArgs += 'xargs.push(args[i++]); arrays.push(false); ';\n            }\n            return ret;\n        }\n        function cond(type) {\n            if (Array.isArray(type)) {\n                if (type[0] == 'or') {\n                    return '(' + type.slice(1).map(cond).join(') || (') + ')';\n                }\n                if (type[0] == 'and') {\n                    return '(' + type.slice(1).map(cond).join(') && (') + ')';\n                }\n                if (type[0] == 'values') {\n                    return '(' + type.slice(1).map(function (val) {\n                        return force() + ' === ' + val;\n                    }).join(') || (') + ')';\n                }\n                if (type[0] == 'null') {\n                    return '(' + cond('null') + ' ? (($' + name + ' = ' + type[1] + '), true) : false)';\n                }\n                if (type[0] == 'between' || type[0] == '[between]') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between)') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '(between]') {\n                    return '(' + force() + ' > ' + type[1] + ' && ' + '$' + name + ' <= ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == '[between)') {\n                    return '(' + force() + ' >= ' + type[1] + ' && ' + '$' + name + ' < ' + type[2] + ' ? true : ((err = \\'NUM\\'), false))';\n                }\n                if (type[0] == 'assert') {\n                    var err = type[2] || 'N/A';\n                    return '((' + type[1] + ') ? true : (err = ' + JSON.stringify(err) + ', false))';\n                }\n                if (type[0] == 'not') {\n                    return '!(' + cond(type[1]) + ')';\n                }\n                throw new Error('Unknown array type condition: ' + type[0]);\n            }\n            if (type == 'number' || type == 'datetime') {\n                return forceNum(true);\n            }\n            if (type == 'integer' || type == 'date') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0), true))';\n            }\n            if (type == 'divisor') {\n                return '(' + forceNum(true) + ' && ($' + name + ' == 0 ? ((err = \\'DIV/0\\'), false) : true))';\n            }\n            if (type == 'number+') {\n                return '(' + forceNum(true) + ' && ($' + name + ' >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer+') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) >= 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'number++') {\n                return '(' + forceNum(true) + ' && ($' + name + ' > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'integer++') {\n                return '(' + forceNum() + ' && (($' + name + ' |= 0) > 0 ? true : ((err = \\'NUM\\'), false)))';\n            }\n            if (type == 'string') {\n                return '((typeof ' + force() + ' == \\'string\\' || typeof $' + name + ' == \\'boolean\\' || typeof $' + name + ' == \\'number\\') ? ($' + name + ' += \\'\\', true) : ($' + name + ' === undefined ? (($' + name + ' = \\'\\'), true) : false))';\n            }\n            if (type == 'boolean') {\n                return '(typeof ' + force() + ' == \\'boolean\\')';\n            }\n            if (type == 'logical') {\n                return '(typeof ' + force() + ' == \\'boolean\\' || (typeof $' + name + ' == \\'number\\' ? ($' + name + ' = !!$' + name + ', true) : false))';\n            }\n            if (type == 'matrix') {\n                force();\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == '#matrix') {\n                return '((m = this.asMatrix($' + name + ')) ? ($' + name + ' = m) : false)';\n            }\n            if (type == 'ref') {\n                return '($' + name + ' instanceof kendo.spreadsheet.Ref)';\n            }\n            if (type == 'area') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef || $' + name + ' instanceof kendo.spreadsheet.RangeRef)';\n            }\n            if (type == 'cell') {\n                return '($' + name + ' instanceof kendo.spreadsheet.CellRef)';\n            }\n            if (type == 'null') {\n                return '(' + force() + ' == null)';\n            }\n            if (type == 'anyvalue') {\n                return '(' + force() + ' != null && i <= args.length)';\n            }\n            if (type == 'forced') {\n                return '(' + force() + ', i <= args.length)';\n            }\n            if (type == 'anything') {\n                return '(i <= args.length)';\n            }\n            if (type == 'blank') {\n                return '(' + force() + ' == null || $' + name + ' === \\'\\')';\n            }\n            throw new Error('Can\\'t check for type: ' + type);\n        }\n    }\n    function roundFloatErrors(num) {\n        var integer = num < 0 ? Math.ceil(num) : Math.floor(num);\n        var decimal = num - integer;\n        return integer + Math.round(decimal * 100000000000000) / 100000000000000;\n    }\n    function maybeRoundFloatErrors(num) {\n        if (typeof num == 'number') {\n            return roundFloatErrors(num);\n        } else {\n            return num;\n        }\n    }\n    function withErrorHandling(obj, f, args) {\n        if (args instanceof CalcError) {\n            return args;\n        }\n        try {\n            return f.apply(obj, args);\n        } catch (ex) {\n            if (ex instanceof CalcError) {\n                return ex;\n            } else {\n                throw ex;\n            }\n        }\n    }\n    function makeSyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        for (var row = 0; row < x.height; ++row) {\n                            for (var col = 0; col < x.width; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        var m = args[i];\n                                        xargs[i] = m.get(row % m.height, col % m.width);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                result.set(row, col, withErrorHandling(this, handler, xargs));\n                            }\n                        }\n                        return callback(result);\n                    }\n                }\n                var xargs = check.call(this, args);\n                callback(withErrorHandling(this, handler, xargs));\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function makeAsyncFunction(handler, resolve, check, arrayArgs) {\n        return function (callback, args) {\n            function doit() {\n                if (arrayArgs) {\n                    var x = arrayArgs.call(this, args);\n                    args = x.args;\n                    if (x.width > 0 && x.height > 0) {\n                        var result = new Matrix(this);\n                        var count = x.width * x.height;\n                        var makeCallback = function (row, col) {\n                            return function (value) {\n                                result.set(row, col, value);\n                                --count;\n                                if (count === 0) {\n                                    return callback(result);\n                                }\n                            };\n                        };\n                        for (var row = 0; row < x.height && count > 0; ++row) {\n                            for (var col = 0; col < x.width && count > 0; ++col) {\n                                var xargs = [];\n                                for (var i = 0; i < args.length; ++i) {\n                                    if (x.arrays[i]) {\n                                        var m = args[i];\n                                        xargs[i] = m.get(row % m.height, col % m.width);\n                                    } else {\n                                        xargs[i] = args[i];\n                                    }\n                                }\n                                xargs = check.call(this, xargs);\n                                if (xargs instanceof CalcError) {\n                                    result.set(row, col, xargs);\n                                    --count;\n                                    if (count === 0) {\n                                        return callback(result);\n                                    }\n                                } else {\n                                    xargs.unshift(makeCallback(row, col));\n                                    handler.apply(this, xargs);\n                                }\n                            }\n                        }\n                        return;\n                    }\n                }\n                var x = check.call(this, args);\n                if (x instanceof CalcError) {\n                    callback(x);\n                } else {\n                    x.unshift(callback);\n                    handler.apply(this, x);\n                }\n            }\n            if (resolve) {\n                resolve.call(this, args, doit);\n            } else {\n                doit.call(this);\n            }\n        };\n    }\n    function defineFunction(name, func) {\n        name = name.toLowerCase();\n        FUNCS[name] = func;\n        return {\n            args: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeSyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            },\n            argsAsync: function (args, log) {\n                var code = compileArgumentChecks(name, args);\n                if (log) {\n                    if (code.arrayArgs) {\n                        console.log(code.arrayArgs.toString());\n                    }\n                    if (code.resolve) {\n                        console.log(code.resolve.toString());\n                    }\n                    if (code.check) {\n                        console.log(code.check.toString());\n                    }\n                }\n                var f = FUNCS[name] = makeAsyncFunction(func, code.resolve, code.check, code.arrayArgs);\n                f.kendoSpreadsheetArgs = args;\n                return this;\n            }\n        };\n    }\n    function dateToJulianDays(y, m, d) {\n        m++;\n        return (1461 * (y + 4800 + ((m - 14) / 12 | 0)) / 4 | 0) + (367 * (m - 2 - 12 * ((m - 14) / 12 | 0)) / 12 | 0) - (3 * ((y + 4900 + ((m - 14) / 12 | 0)) / 100 | 0) / 4 | 0) + d - 32075;\n    }\n    function julianDaysToDate(jd) {\n        var l, n, j, i, m, d, y;\n        l = jd + 68569;\n        n = 4 * l / 146097 | 0;\n        l = l - ((146097 * n + 3) / 4 | 0);\n        i = 4000 * (l + 1) / 1461001 | 0;\n        l = l - (1461 * i / 4 | 0) + 31;\n        j = 80 * l / 2447 | 0;\n        d = l - (2447 * j / 80 | 0);\n        l = j / 11 | 0;\n        m = j + 2 - 12 * l;\n        y = 100 * (n - 49) + i + l;\n        m--;\n        return {\n            year: y,\n            month: m,\n            date: d,\n            day: (jd + 1) % 7,\n            ord: ORDINAL_ADD_DAYS[isLeapYear(y)][m] + d\n        };\n    }\n    var BASE_DATE = dateToJulianDays(1900, 0, -1);\n    var DAYS_IN_MONTH = [\n        31,\n        28,\n        31,\n        30,\n        31,\n        30,\n        31,\n        31,\n        30,\n        31,\n        30,\n        31\n    ];\n    var ORDINAL_ADD_DAYS = [\n        [\n            0,\n            31,\n            59,\n            90,\n            120,\n            151,\n            181,\n            212,\n            243,\n            273,\n            304,\n            334\n        ],\n        [\n            0,\n            31,\n            60,\n            91,\n            121,\n            152,\n            182,\n            213,\n            244,\n            274,\n            305,\n            335\n        ]\n    ];\n    function isLeapYear(yr) {\n        if (yr % 4) {\n            return 0;\n        }\n        if (yr % 100) {\n            return 1;\n        }\n        if (yr % 400) {\n            return 0;\n        }\n        return 1;\n    }\n    function daysInYear(yr) {\n        return isLeapYear(yr) ? 366 : 365;\n    }\n    function daysInMonth(yr, mo) {\n        return isLeapYear(yr) && mo == 1 ? 29 : DAYS_IN_MONTH[mo];\n    }\n    function unpackDate(serial) {\n        return julianDaysToDate((serial | 0) + BASE_DATE);\n    }\n    function packDate(year, month, date) {\n        return dateToJulianDays(year, month, date) - BASE_DATE;\n    }\n    var MS_IN_MIN = 60 * 1000;\n    var MS_IN_HOUR = 60 * MS_IN_MIN;\n    var MS_IN_DAY = 24 * MS_IN_HOUR;\n    function unpackTime(serial) {\n        var frac = serial - (serial | 0);\n        if (frac < 0) {\n            frac++;\n        }\n        var ms = Math.round(MS_IN_DAY * frac);\n        var hours = Math.floor(ms / MS_IN_HOUR);\n        ms -= hours * MS_IN_HOUR;\n        var minutes = Math.floor(ms / MS_IN_MIN);\n        ms -= minutes * MS_IN_MIN;\n        var seconds = Math.floor(ms / 1000);\n        ms -= seconds * 1000;\n        return {\n            hours: hours,\n            minutes: minutes,\n            seconds: seconds,\n            milliseconds: ms\n        };\n    }\n    function serialToDate(serial) {\n        var d = unpackDate(serial), t = unpackTime(serial);\n        return new Date(d.year, d.month, d.date, t.hours, t.minutes, t.seconds, t.milliseconds);\n    }\n    function packTime(hh, mm, ss, ms) {\n        return (hh + (mm + (ss + ms / 1000) / 60) / 60) / 24;\n    }\n    function dateToSerial(date) {\n        var time = packTime(date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n        date = packDate(date.getFullYear(), date.getMonth(), date.getDate());\n        if (date < 0) {\n            return date - 1 + time;\n        } else {\n            return date + time;\n        }\n    }\n    function parseDate(str, format) {\n        if (format) {\n            return kendo.parseExactDate(str, format) || kendo.parseExactDate(str, format.replace(/h/g, 'H')) || kendo.parseExactDate(str);\n        }\n        return kendo.parseExactDate(str) || kendo.parseExactDate(str, [\n            'MMMM dd yyyy',\n            'MMMM dd yy',\n            'MMM dd yyyy',\n            'MMM dd yy',\n            'dd MMMM yyyy',\n            'dd MMMM yy',\n            'dd MMM yyyy',\n            'dd MMM yy',\n            'MMMM dd, yyyy',\n            'MMMM dd, yy',\n            'MMM dd, yyyy',\n            'MMM dd, yy',\n            'MMMM dd',\n            'MMM dd',\n            'MMMM yyyy',\n            'MMM yyyy',\n            'dd MMMM',\n            'dd MMM'\n        ]);\n    }\n    exports.CalcError = CalcError;\n    exports.Formula = Formula;\n    exports.Matrix = Matrix;\n    exports.packDate = packDate;\n    exports.unpackDate = unpackDate;\n    exports.packTime = packTime;\n    exports.unpackTime = unpackTime;\n    exports.serialToDate = serialToDate;\n    exports.dateToSerial = dateToSerial;\n    exports.daysInMonth = daysInMonth;\n    exports.isLeapYear = isLeapYear;\n    exports.daysInYear = daysInYear;\n    exports.parseDate = parseDate;\n    exports.limitPrecision = roundFloatErrors;\n    spreadsheet.dateToNumber = dateToSerial;\n    spreadsheet.numberToDate = serialToDate;\n    spreadsheet.defineFunction = defineFunction;\n    spreadsheet.CalcError = CalcError;\n    exports.defineFunction = defineFunction;\n    exports.defineAlias = function (alias, name) {\n        var orig = FUNCS[name];\n        if (!orig) {\n            throw new Error('Function ' + name + ' is not yet defined');\n        }\n        if (!orig.kendoSpreadsheetAliases) {\n            orig.kendoSpreadsheetAliases = [name];\n        }\n        orig.kendoSpreadsheetAliases.push(alias);\n        FUNCS[alias] = orig;\n    };\n    exports.FUNCS = FUNCS;\n    var NUMBER_OR_ZERO = [\n        'or',\n        'number',\n        [\n            'null',\n            0\n        ]\n    ];\n    var ARGS_NUMERIC = [\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            NUMBER_OR_ZERO\n        ]\n    ];\n    var ARGS_ANYVALUE = [\n        [\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ];\n    defineFunction('binary+', function (a, b) {\n        return a + b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary-', function (a, b) {\n        return a - b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary*', function (a, b) {\n        return a * b;\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary/', function (a, b) {\n        return a / b;\n    }).args([\n        [\n            '*a',\n            NUMBER_OR_ZERO\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('binary^', function (a, b) {\n        return Math.pow(a, b);\n    }).args(ARGS_NUMERIC);\n    defineFunction('binary&', function (a, b) {\n        if (a == null) {\n            a = '';\n        }\n        if (b == null) {\n            b = '';\n        }\n        return '' + a + b;\n    }).args([\n        [\n            '*a',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ],\n        [\n            '*b',\n            [\n                'or',\n                'number',\n                'string',\n                'boolean',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('binary=', function (a, b) {\n        return a === b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<>', function (a, b) {\n        return a !== b;\n    }).args(ARGS_ANYVALUE);\n    defineFunction('binary<', binaryCompare(function (a, b) {\n        return a < b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary<=', binaryCompare(function (a, b) {\n        return a <= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>', binaryCompare(function (a, b) {\n        return a > b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('binary>=', binaryCompare(function (a, b) {\n        return a >= b;\n    })).args(ARGS_ANYVALUE);\n    defineFunction('unary+', function (a) {\n        return a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary-', function (a) {\n        return -a;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('unary%', function (a) {\n        return a / 100;\n    }).args([[\n            '*a',\n            NUMBER_OR_ZERO\n        ]]);\n    defineFunction('binary:', function (a, b) {\n        return new RangeRef(a, b).setSheet(a.sheet || this.formula.sheet, a.hasSheet());\n    }).args([\n        [\n            'a',\n            'cell'\n        ],\n        [\n            'b',\n            'cell'\n        ]\n    ]);\n    defineFunction('binary,', function (a, b) {\n        return new UnionRef([\n            a,\n            b\n        ]);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('binary ', function (a, b) {\n        return a.intersect(b);\n    }).args([\n        [\n            'a',\n            'ref'\n        ],\n        [\n            'b',\n            'ref'\n        ]\n    ]);\n    defineFunction('not', function (a) {\n        return !this.bool(a);\n    }).args([[\n            '*a',\n            [\n                'or',\n                'anyvalue',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]]);\n    defineFunction('isblank', function (val) {\n        if (val instanceof CellRef) {\n            val = this.getRefData(val);\n            return val == null;\n        }\n        return false;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    defineFunction('iserror', function (val) {\n        return val instanceof CalcError;\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('iserr', function (val) {\n        return val instanceof CalcError && val.code != 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isna', function (val) {\n        return val instanceof CalcError && val.code == 'N/A';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('islogical', function (val) {\n        return typeof val == 'boolean';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnontext', function (val) {\n        return typeof val != 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('istext', function (val) {\n        return typeof val == 'string';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isnumber', function (val) {\n        return typeof val == 'number';\n    }).args([[\n            '*value',\n            'forced!'\n        ]]);\n    defineFunction('isref', function (val) {\n        return val instanceof CellRef || val instanceof RangeRef;\n    }).args([[\n            '*value',\n            'anything!'\n        ]]);\n    FUNCS[',getname'] = function (callback, args) {\n        this.fetchName(args[0], callback);\n    };\n    function binaryCompare(func) {\n        return function (left, right) {\n            if (typeof left == 'string' && typeof right != 'string') {\n                right = right == null ? '' : right + '';\n            }\n            if (typeof left != 'string' && typeof right == 'string') {\n                left = left == null ? '' : left + '';\n            }\n            if (typeof left == 'number' && right == null) {\n                right = 0;\n            }\n            if (typeof right == 'number' && left == null) {\n                left = 0;\n            }\n            if (typeof left == 'string' && typeof right == 'string') {\n                left = left.toLowerCase();\n                right = right.toLowerCase();\n            }\n            if (typeof right == typeof left) {\n                return func(left, right);\n            } else {\n                return new CalcError('VALUE');\n            }\n        };\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/validation', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    var $ = kendo.jQuery;\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var exports = {};\n    spreadsheet.validation = exports;\n    var calc = spreadsheet.calc;\n    var Class = kendo.Class;\n    var TRANSPOSE_FORMAT = '_matrix({0})';\n    var DATE_FORMAT = 'DATEVALUE(\"{0}\")';\n    calc.runtime.defineFunction('_matrix', function (m) {\n        if (typeof m == 'string') {\n            m = this.asMatrix([m.split(/\\s*,\\s*/)]);\n        }\n        return m;\n    }).args([[\n            'm',\n            [\n                'or',\n                'matrix',\n                'string'\n            ]\n        ]]);\n    function compileValidation(sheet, row, col, validation) {\n        var validationHandler;\n        var comparer;\n        var parsedFromDate;\n        var parsedToDate;\n        if (typeof validation === 'string') {\n            validation = JSON.parse(validation);\n        }\n        if (validation.from) {\n            if (validation.dataType === 'list' && !validation.fromIsListValue) {\n                validation.from = kendo.format(TRANSPOSE_FORMAT, validation.from);\n                validation.fromIsListValue = true;\n            }\n            if (validation.dataType === 'date') {\n                parsedFromDate = calc.runtime.parseDate(validation.from);\n                if (parsedFromDate) {\n                    validation.from = kendo.format(DATE_FORMAT, validation.from);\n                    validation.fromIsDateValue = true;\n                }\n            }\n            validation.from = calc.compile(calc.parseFormula(sheet, row, col, validation.from));\n        }\n        if (validation.to) {\n            if (validation.dataType === 'date') {\n                parsedToDate = calc.runtime.parseDate(validation.to);\n                if (parsedToDate) {\n                    validation.to = kendo.format(DATE_FORMAT, validation.to);\n                    validation.toIsDateValue = true;\n                }\n            }\n            validation.to = calc.compile(calc.parseFormula(sheet, row, col, validation.to));\n        }\n        if (validation.dataType == 'custom') {\n            comparer = exports.validationComparers.custom;\n        } else if (validation.dataType == 'list') {\n            comparer = exports.validationComparers.list;\n        } else {\n            comparer = exports.validationComparers[validation.comparerType];\n        }\n        if (!comparer) {\n            throw kendo.format('\\'{0}\\' comparer is not implemented.', validation.comparerType);\n        }\n        validationHandler = function (valueToCompare) {\n            var toValue = this.to && this.to_value ? this.to_value : undefined;\n            if (valueToCompare === null || valueToCompare === '') {\n                if (this.allowNulls) {\n                    this.value = true;\n                } else {\n                    this.value = false;\n                }\n            } else if (this.dataType == 'custom') {\n                this.value = comparer(valueToCompare, this.from_value, toValue);\n            } else if (this.dataType == 'list') {\n                var data = this._getListData();\n                this.value = comparer(valueToCompare, data, toValue);\n            } else {\n                this.value = comparer(valueToCompare, this.from_value, toValue);\n            }\n            return this.value;\n        };\n        return new kendo.spreadsheet.validation.Validation($.extend(validation, {\n            handler: validationHandler,\n            sheet: sheet,\n            row: row,\n            col: col\n        }));\n    }\n    var Validation = Class.extend({\n        init: function Validation(options) {\n            this.handler = options.handler;\n            this.from = options.from;\n            this.to = options.to;\n            this.dataType = options.dataType;\n            this.comparerType = options.comparerType;\n            this.type = options.type ? options.type : 'warning';\n            this.allowNulls = options.allowNulls ? true : false;\n            this.fromIsDateValue = options.fromIsDateValue ? true : false;\n            this.toIsDateValue = options.toIsDateValue ? true : false;\n            this.showButton = options.showButton;\n            this.fromIsListValue = options.fromIsListValue ? true : false;\n            this.sheet = options.sheet;\n            this.row = options.row;\n            this.col = options.col;\n            if (options.tooltipMessageTemplate) {\n                this.tooltipMessageTemplate = options.tooltipMessageTemplate;\n            }\n            if (options.tooltipTitleTemplate) {\n                this.tooltipTitleTemplate = options.tooltipTitleTemplate;\n            }\n            if (options.messageTemplate) {\n                this.messageTemplate = options.messageTemplate;\n            }\n            if (options.titleTemplate) {\n                this.titleTemplate = options.titleTemplate;\n            }\n        },\n        _formatMessages: function (format) {\n            var from = this.from ? this.from_value : '';\n            var to = this.to ? this.to_value : '';\n            var fromFormula = this.from ? this.from.toString() : '';\n            var toFormula = this.to ? this.to.toString() : '';\n            var dataType = this.dataType;\n            var type = this.type;\n            var comparerType = this.comparerType;\n            return kendo.format(format, from, to, fromFormula, toFormula, dataType, type, comparerType);\n        },\n        _setMessages: function () {\n            this.title = '';\n            this.message = '';\n            if (this.tooltipTitleTemplate) {\n                this.tooltipTitle = this._formatMessages(this.tooltipTitleTemplate);\n            }\n            if (this.tooltipMessageTemplate) {\n                this.tooltipMessage = this._formatMessages(this.tooltipMessageTemplate);\n            }\n            if (this.titleTemplate) {\n                this.title = this._formatMessages(this.titleTemplate);\n            }\n            if (this.messageTemplate) {\n                this.message = this._formatMessages(this.messageTemplate);\n            }\n        },\n        _getListData: function () {\n            if (!this.from_value || !this.from_value.data) {\n                return [];\n            }\n            var cube = this.from_value.data;\n            var i;\n            var y;\n            var data = [];\n            for (i = 0; i < cube.length; i++) {\n                var array = cube[i];\n                if (array) {\n                    for (y = 0; y < array.length; y++) {\n                        data.push(array[y]);\n                    }\n                }\n            }\n            return data;\n        },\n        clone: function (sheet, row, col) {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.clone(sheet, row, col);\n            }\n            if (options.to) {\n                options.to = options.to.clone(sheet, row, col);\n            }\n            return new Validation($.extend(options, { handler: this.handler }, {\n                sheet: sheet,\n                row: row,\n                col: col\n            }));\n        },\n        deepClone: function () {\n            var v = new Validation(this);\n            v.from = v.from.deepClone();\n            if (v.to) {\n                v.to = v.to.deepClone();\n            }\n            return v;\n        },\n        exec: function (ss, compareValue, compareFormat, callback) {\n            var self = this;\n            function getValue(val) {\n                if (val instanceof kendo.spreadsheet.Ref) {\n                    val = ss.getData(val);\n                    if (Array.isArray(val)) {\n                        val = val[0];\n                    }\n                }\n                return val;\n            }\n            var calculateFromCallBack = function (val) {\n                self.from_value = getValue(val);\n                self.value = self.handler.call(self, compareValue, compareFormat);\n                self._setMessages();\n                if (callback) {\n                    callback(self.value);\n                }\n            };\n            if (self.to) {\n                self.to.exec(ss, function (val) {\n                    self.to_value = getValue(val);\n                    self.from.exec(ss, calculateFromCallBack);\n                });\n            } else {\n                self.from.exec(ss, calculateFromCallBack);\n            }\n        },\n        reset: function () {\n            if (this.from) {\n                this.from.reset();\n            }\n            if (this.to) {\n                this.to.reset();\n            }\n            delete this.value;\n        },\n        adjust: function (affectedSheet, operation, start, delta) {\n            var prevFrom, prevTo, modified;\n            var formulaRow = this.row;\n            var formulaCol = this.col;\n            if (this.from) {\n                prevFrom = this.from.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.to) {\n                prevTo = this.to.adjust(affectedSheet, operation, start, delta);\n            }\n            if (this.sheet.toLowerCase() == affectedSheet.toLowerCase()) {\n                switch (operation) {\n                case 'row':\n                    if (formulaRow >= start) {\n                        modified = true;\n                        this.row += delta;\n                    }\n                    break;\n                case 'col':\n                    if (formulaCol >= start) {\n                        modified = true;\n                        this.col += delta;\n                    }\n                    break;\n                }\n            }\n            if (modified || prevFrom || prevTo) {\n                var v = new Validation(this);\n                v.from = prevFrom;\n                v.to = prevTo;\n                v.row = formulaRow;\n                v.col = formulaCol;\n                return v;\n            }\n        },\n        toJSON: function () {\n            var options = this._getOptions();\n            if (options.from) {\n                options.from = options.from.toString();\n                if (options.dataType === 'list') {\n                    options.from = options.from.replace(/^_matrix\\((.*)\\)$/i, '$1');\n                    delete options.fromIsListValue;\n                }\n                if (options.dataType === 'date') {\n                    if (this.fromIsDateValue) {\n                        options.from = options.from.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                        delete options.fromIsDateValue;\n                    }\n                }\n            }\n            if (options.to) {\n                options.to = options.to.toString();\n                if (options.dataType === 'date') {\n                    if (this.toIsDateValue) {\n                        options.to = options.to.replace(/^DATEVALUE\\(\"(.*)\"\\)$/i, '$1');\n                        delete options.toIsDateValue;\n                    }\n                }\n            }\n            return options;\n        },\n        _getOptions: function () {\n            return {\n                from: this.from,\n                to: this.to,\n                dataType: this.dataType,\n                type: this.type,\n                comparerType: this.comparerType,\n                row: this.row,\n                col: this.col,\n                sheet: this.sheet,\n                allowNulls: this.allowNulls,\n                fromIsListValue: this.fromIsListValue,\n                fromIsDateValue: this.fromIsDateValue,\n                toIsDateValue: this.toIsDateValue,\n                tooltipMessageTemplate: this.tooltipMessageTemplate,\n                tooltipTitleTemplate: this.tooltipTitleTemplate,\n                messageTemplate: this.messageTemplate,\n                titleTemplate: this.titleTemplate,\n                showButton: this.showButton\n            };\n        }\n    });\n    exports.compile = compileValidation;\n    exports.validationComparers = {\n        greaterThan: function (valueToCompare, from) {\n            return valueToCompare > from;\n        },\n        lessThan: function (valueToCompare, from) {\n            return valueToCompare < from;\n        },\n        between: function (valueToCompare, from, to) {\n            return valueToCompare >= from && valueToCompare <= to;\n        },\n        equalTo: function (valueToCompare, from) {\n            return valueToCompare == from;\n        },\n        notEqualTo: function (valueToCompare, from) {\n            return valueToCompare != from;\n        },\n        greaterThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare >= from;\n        },\n        lessThanOrEqualTo: function (valueToCompare, from) {\n            return valueToCompare <= from;\n        },\n        notBetween: function (valueToCompare, from, to) {\n            return valueToCompare < from || valueToCompare > to;\n        },\n        custom: function (valueToCompare, from) {\n            return from;\n        },\n        list: function (valueToCompare, data) {\n            return data.indexOf(valueToCompare) > -1;\n        }\n    };\n    exports.Validation = Validation;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheet', [\n        'kendo.core',\n        'kendo.color',\n        'spreadsheet/runtime',\n        'spreadsheet/validation',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var Range = kendo.spreadsheet.Range;\n        var MODIFIED_FORMULAS;\n        var Selection = kendo.Class.extend({\n            init: function (sheet) {\n                this._sheet = sheet;\n                this.selection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalSelection = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this._activeCell = kendo.spreadsheet.FIRSTREF.toRangeRef();\n                this.originalActiveCell = kendo.spreadsheet.FIRSTREF;\n            },\n            currentSelectionRange: function () {\n                return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentOriginalNavigationRange: function () {\n                return this.originalSelection.rangeAt(this.selectionRangeIndex).toRangeRef();\n            },\n            currentNavigationRange: function () {\n                if (this.singleCellSelection()) {\n                    return this._sheet._sheetRef;\n                } else {\n                    return this.selection.rangeAt(this.selectionRangeIndex).toRangeRef();\n                }\n            },\n            nextNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.nextRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            previousNavigationRange: function () {\n                if (!this.singleCellSelection()) {\n                    this.selectionRangeIndex = this.selection.previousRangeIndex(this.selectionRangeIndex);\n                }\n                return this.currentNavigationRange();\n            },\n            activeCell: function (ref) {\n                if (ref) {\n                    this.originalActiveCell = ref.first();\n                    this._activeCell = this._sheet.unionWithMerged(ref.toRangeRef());\n                    this._sheet.focus(ref);\n                    this._sheet.triggerChange({\n                        activeCell: true,\n                        selection: true\n                    });\n                }\n                return this._activeCell;\n            },\n            select: function (ref, expanded, changeActiveCell) {\n                if (ref) {\n                    if (ref.eq(this.originalSelection)) {\n                        return;\n                    }\n                    this._sheet.triggerSelect(new Range(ref, this._sheet));\n                    this.originalSelection = ref;\n                    this.selection = expanded;\n                    if (changeActiveCell !== false) {\n                        if (ref.isCell()) {\n                            this.activeCell(ref);\n                        } else {\n                            this.activeCell(this.selection.lastRange().first());\n                        }\n                        this.selectionRangeIndex = this.selection.size() - 1;\n                    } else {\n                        this._sheet.triggerChange({ selection: true });\n                    }\n                }\n                return this.selection;\n            },\n            singleCellSelection: function () {\n                return this._activeCell.eq(this.selection);\n            }\n        });\n        var Sheet = kendo.Observable.extend({\n            init: function () {\n                kendo.Observable.prototype.init.call(this);\n                this._reinit.apply(this, arguments);\n            },\n            events: [\n                'commandRequest',\n                'afterInsertRow',\n                'afterDeleteRow',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select'\n            ],\n            _reinit: function (rowCount, columnCount, rowHeight, columnWidth, headerHeight, headerWidth, defaultCellStyle) {\n                defaultCellStyle = defaultCellStyle || {};\n                this._defaultCellStyle = {\n                    background: defaultCellStyle.background,\n                    color: defaultCellStyle.color,\n                    fontFamily: defaultCellStyle.fontFamily,\n                    fontSize: defaultCellStyle.fontSize,\n                    italic: defaultCellStyle.italic,\n                    bold: defaultCellStyle.bold,\n                    underline: defaultCellStyle.underline,\n                    wrap: defaultCellStyle.wrap\n                };\n                this._rows = new kendo.spreadsheet.Axis(rowCount, rowHeight);\n                this._columns = new kendo.spreadsheet.Axis(columnCount, columnWidth);\n                this._mergedCells = [];\n                this._frozenRows = 0;\n                this._frozenColumns = 0;\n                this._suspendChanges = false;\n                this._filter = null;\n                this._showGridLines = true;\n                this._gridLinesColor = null;\n                this._grid = new kendo.spreadsheet.Grid(this._rows, this._columns, rowCount, columnCount, headerHeight, headerWidth);\n                this._sheetRef = this._grid.normalize(kendo.spreadsheet.SHEETREF);\n                this._properties = new kendo.spreadsheet.PropertyBag(rowCount, columnCount, this._defaultCellStyle);\n                this._sorter = new kendo.spreadsheet.Sorter(this._grid, this._properties.sortable());\n                this._viewSelection = new Selection(this);\n                this._editSelection = new Selection(this);\n                this._formulaSelections = [];\n            },\n            _selectionState: function () {\n                return this._inEdit ? this._editSelection : this._viewSelection;\n            },\n            navigator: function () {\n                if (!this._navigator) {\n                    this._navigator = new kendo.spreadsheet.SheetNavigator(this);\n                }\n                return this._navigator;\n            },\n            axisManager: function () {\n                if (!this._axisManager) {\n                    this._axisManager = new kendo.spreadsheet.AxisManager(this);\n                }\n                return this._axisManager;\n            },\n            _name: function (value) {\n                if (!value) {\n                    return this._sheetName;\n                }\n                this._sheetName = value;\n                return this;\n            },\n            name: function () {\n                return this._name();\n            },\n            _property: function (accessor, value, reason) {\n                if (value === undefined) {\n                    return accessor();\n                } else {\n                    accessor(value);\n                    return this.triggerChange(reason);\n                }\n            },\n            _field: function (name, value, reason) {\n                if (value === undefined) {\n                    return this[name];\n                } else {\n                    this[name] = value;\n                    return this.triggerChange(reason);\n                }\n            },\n            suspendChanges: function (value) {\n                if (value === undefined) {\n                    return this._suspendChanges;\n                }\n                this._suspendChanges = value;\n                return this;\n            },\n            triggerChange: function (reason) {\n                if (!this._suspendChanges) {\n                    this.trigger('change', reason);\n                }\n                return this;\n            },\n            triggerSelect: function (range) {\n                this.trigger('select', { range: range });\n            },\n            setDataSource: function (dataSource, columns) {\n                if (this.dataSourceBinder) {\n                    this.dataSourceBinder.destroy();\n                }\n                this.dataSourceBinder = new kendo.spreadsheet.SheetDataSourceBinder({\n                    dataSource: dataSource,\n                    sheet: this,\n                    columns: columns\n                });\n                this.dataSource = this.dataSourceBinder.dataSource;\n            },\n            hideColumn: function (columnIndex) {\n                if (this.trigger('hideColumn', { index: columnIndex })) {\n                    return;\n                }\n                return this._property(this._columns.hide.bind(this._columns), columnIndex, { layout: true });\n            },\n            unhideColumn: function (columnIndex) {\n                if (this.trigger('unhideColumn', { index: columnIndex })) {\n                    return;\n                }\n                return this._property(this._columns.unhide.bind(this._columns), columnIndex, { layout: true });\n            },\n            isHiddenColumn: function (columnIndex) {\n                return this._grid._columns.hidden(columnIndex);\n            },\n            _copyRange: function (sourceRangeRef, targetRef) {\n                var grid = this._grid;\n                var rowCount = grid.rowCount;\n                var nextRefTopLeft = grid.normalize(sourceRangeRef.topLeft);\n                var nextRefBottomRight = grid.normalize(sourceRangeRef.bottomRight);\n                var nextIndex = nextRefTopLeft.col * rowCount + nextRefTopLeft.row;\n                var nextBottomIndex = nextRefBottomRight.col * rowCount + nextRefBottomRight.row;\n                var targetIndex = targetRef.col * rowCount + targetRef.row;\n                this._properties.copy(nextIndex, nextBottomIndex, targetIndex);\n            },\n            _saveModifiedFormulas: function (array, callback) {\n                var save = MODIFIED_FORMULAS;\n                MODIFIED_FORMULAS = array;\n                var ret = callback();\n                MODIFIED_FORMULAS = save;\n                return ret;\n            },\n            _restoreModifiedFormulas: function (array) {\n                var wb = this._workbook;\n                array.forEach(function (f) {\n                    var sheet = wb.sheetByName(f.sheet), index;\n                    if (f instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                        index = sheet._grid.cellRefIndex(f);\n                        sheet._properties.set('formula', index, index, f);\n                    }\n                    if (f instanceof kendo.spreadsheet.validation.Validation) {\n                        index = sheet._grid.cellRefIndex(f);\n                        sheet._properties.set('validation', index, index, f);\n                    }\n                });\n            },\n            _adjustReferences: function (operation, start, delta, mergedCells) {\n                this._mergedCells = mergedCells.reduce(function (a, ref) {\n                    ref = ref.adjust(null, null, null, null, operation == 'row', start, delta);\n                    if (ref instanceof RangeRef) {\n                        a.push(ref);\n                    }\n                    return a;\n                }, []);\n                if (this._workbook) {\n                    var affectedSheet = this._name();\n                    this._workbook._sheets.forEach(function (sheet) {\n                        sheet._forFormulas(function (formula) {\n                            var prev = formula.adjust(affectedSheet, operation, start, delta);\n                            if (prev && MODIFIED_FORMULAS) {\n                                MODIFIED_FORMULAS.push(prev);\n                            }\n                        });\n                        sheet._forValidations(function (validation) {\n                            var prev = validation.adjust(affectedSheet, operation, start, delta);\n                            if (prev && MODIFIED_FORMULAS) {\n                                MODIFIED_FORMULAS.push(prev);\n                            }\n                        });\n                    });\n                    this._workbook.adjustNames(affectedSheet, operation == 'row', start, delta);\n                }\n                var selection = this.select();\n                selection = selection.adjust(null, null, null, null, operation == 'row', start, delta);\n                if (selection !== kendo.spreadsheet.NULLREF) {\n                    this.select(selection);\n                }\n                var axis = operation == 'col' ? this._columns : this._rows;\n                axis.adjust(start, delta);\n            },\n            _forFormulas: function (callback) {\n                var props = this._properties;\n                var formulas = props.get('formula').values();\n                var n = formulas.length;\n                formulas.forEach(function (f, i) {\n                    callback.call(this, f.value, i, n);\n                }, this);\n            },\n            _forValidations: function (callback) {\n                var props = this._properties;\n                props.get('validation').values().forEach(function (v) {\n                    callback.call(this, v.value);\n                }, this);\n            },\n            preventInsertRow: function (rowIndex, count) {\n                if (this.selectedHeaders().allRows) {\n                    return {\n                        reason: 'error',\n                        type: 'insertRowWhenColumnIsSelected'\n                    };\n                }\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(grid.rowCount - count, 0, count, grid.columnCount);\n                if (range.hasValue()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                return false;\n            },\n            preventInsertColumn: function (colIndex, count) {\n                if (this.selectedHeaders().allCols) {\n                    return {\n                        reason: 'error',\n                        type: 'insertColumnWhenRowIsSelected'\n                    };\n                }\n                count = count || 1;\n                var grid = this._grid;\n                var range = this.range(0, grid.columnCount - count, grid.rowCount, count);\n                if (range.hasValue()) {\n                    return {\n                        reason: 'error',\n                        type: 'shiftingNonblankCells'\n                    };\n                }\n                return false;\n            },\n            insertRow: function (rowIndex) {\n                var result = this.preventInsertRow(rowIndex);\n                if (result) {\n                    throw new Error('Shifting nonblank cells off the worksheet is not supported!');\n                }\n                if (this.trigger('insertRow', { index: rowIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var rowCount = grid.rowCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col), new CellRef(rowCount - 2, bottomRight.col));\n                        this._copyRange(nextRef, new CellRef(topLeft.row + 1, topLeft.col));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                    }\n                    this._adjustReferences('row', rowIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                this.trigger('afterInsertRow', { index: rowIndex });\n                return this;\n            },\n            isEnabledRow: function (rowIndex) {\n                var ref = new RangeRef(new CellRef(rowIndex, 0), new CellRef(rowIndex, this._grid.columnCount));\n                return new Range(ref, this).enable();\n            },\n            deleteRow: function (rowIndex) {\n                if (!this.isEnabledRow(rowIndex)) {\n                    return this;\n                }\n                if (this.trigger('deleteRow', { index: rowIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenRows = this.frozenRows();\n                    if (rowIndex < frozenRows) {\n                        this.frozenRows(frozenRows - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = 0; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(rowIndex, ci), new CellRef(rowIndex, ci));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row + 1, topLeft.col), new CellRef(Infinity, bottomRight.col));\n                        this._copyRange(nextRef, topLeft);\n                        var nextRefBottomRight = grid.normalize(nextRef.bottomRight);\n                        new Range(new RangeRef(nextRefBottomRight, nextRefBottomRight), this).clear();\n                    }\n                    this._adjustReferences('row', rowIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteRow: { index: rowIndex },\n                    ref: new RangeRef(new CellRef(rowIndex, 0), new CellRef(Infinity, Infinity))\n                });\n                this.trigger('afterDeleteRow', { index: rowIndex });\n                return this;\n            },\n            insertColumn: function (columnIndex) {\n                if (this.trigger('insertColumn', { index: columnIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns + 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnCount; ci >= columnIndex; ci--) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                        if (ci == columnIndex) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col - 1), new CellRef(bottomRight.row, bottomRight.col - 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, 1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    insertColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            isEnabledColumn: function (columnIndex) {\n                var ref = new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, columnIndex));\n                return new Range(ref, this).enable();\n            },\n            deleteColumn: function (columnIndex) {\n                if (!this.isEnabledColumn(columnIndex)) {\n                    return this;\n                }\n                if (this.trigger('deleteColumn', { index: columnIndex })) {\n                    return;\n                }\n                this.batch(function () {\n                    var grid = this._grid;\n                    var columnCount = grid.columnCount;\n                    var frozenColumns = this.frozenColumns();\n                    if (columnIndex < frozenColumns) {\n                        this.frozenColumns(frozenColumns - 1);\n                    }\n                    var mergedCells = this._mergedCells.slice();\n                    for (var ci = columnIndex; ci < columnCount; ci++) {\n                        var ref = new RangeRef(new CellRef(0, ci), new CellRef(Infinity, ci));\n                        new Range(ref, this).clear({\n                            clearAll: true,\n                            keepBorders: true\n                        });\n                        if (ci == columnCount - 1) {\n                            break;\n                        }\n                        var topLeft = grid.normalize(ref.topLeft);\n                        var bottomRight = grid.normalize(ref.bottomRight);\n                        var nextRef = new RangeRef(new CellRef(topLeft.row, topLeft.col + 1), new CellRef(bottomRight.row, bottomRight.col + 1));\n                        this._copyRange(nextRef, topLeft);\n                    }\n                    this._adjustReferences('col', columnIndex, -1, mergedCells);\n                }, {\n                    recalc: true,\n                    layout: true,\n                    deleteColumn: { index: columnIndex },\n                    ref: new RangeRef(new CellRef(0, columnIndex), new CellRef(Infinity, Infinity))\n                });\n                return this;\n            },\n            hideRow: function (rowIndex) {\n                if (this.trigger('hideRow', { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.hide.bind(this._rows), rowIndex, { layout: true });\n            },\n            unhideRow: function (rowIndex) {\n                if (this.trigger('unhideRow', { index: rowIndex })) {\n                    return;\n                }\n                return this._property(this._rows.unhide.bind(this._rows), rowIndex, { layout: true });\n            },\n            isHiddenRow: function (rowIndex) {\n                return this._grid._rows.hidden(rowIndex);\n            },\n            columnWidth: function (columnIndex, width) {\n                return this._property(this._columns.value.bind(this._columns, columnIndex, columnIndex), width, { layout: true });\n            },\n            rowHeight: function (rowIndex, height) {\n                return this._property(this._rows.value.bind(this._rows, rowIndex, rowIndex), height, { layout: true });\n            },\n            frozenRows: function (value) {\n                return this._field('_frozenRows', value, { layout: true });\n            },\n            frozenColumns: function (value) {\n                return this._field('_frozenColumns', value, { layout: true });\n            },\n            showGridLines: function (value) {\n                return this._field('_showGridLines', value, { layout: true });\n            },\n            gridLinesColor: function (value) {\n                return this._field('_gridLinesColor', value, { layout: true });\n            },\n            _ref: function (row, column, numRows, numColumns) {\n                var ref = null;\n                if (row instanceof kendo.spreadsheet.Ref) {\n                    return row;\n                }\n                if (row instanceof kendo.spreadsheet.Range) {\n                    return row._ref.toRangeRef();\n                }\n                if (typeof row === 'string') {\n                    ref = kendo.spreadsheet.calc.parseReference(row);\n                } else {\n                    if (!numRows) {\n                        numRows = 1;\n                    }\n                    if (!numColumns) {\n                        numColumns = 1;\n                    }\n                    ref = new RangeRef(new CellRef(row, column), new CellRef(row + numRows - 1, column + numColumns - 1));\n                }\n                return ref;\n            },\n            range: function (row, column, numRows, numColumns) {\n                return new Range(this._ref(row, column, numRows, numColumns), this);\n            },\n            _getMergedCells: function (range) {\n                var grid = this._grid;\n                var primary = {};\n                var secondary = {};\n                var hasMerged = false;\n                this.forEachMergedCell(range, function (ref) {\n                    var topLeft = ref.topLeft;\n                    grid.forEach(ref, function (cellRef) {\n                        if (topLeft.eq(cellRef)) {\n                            primary[cellRef.print()] = ref;\n                            hasMerged = true;\n                        } else if (range.contains(cellRef)) {\n                            secondary[cellRef.print()] = topLeft;\n                            hasMerged = true;\n                        }\n                    });\n                });\n                return {\n                    primary: primary,\n                    secondary: secondary,\n                    hasMerged: hasMerged\n                };\n            },\n            forEachMergedCell: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                this._mergedCells.forEach(function (merged) {\n                    if (selectAll || merged.intersects(ref)) {\n                        callback(merged);\n                    }\n                });\n            },\n            forEachFilterHeader: function (ref, callback) {\n                var selectAll = false;\n                if (typeof callback === 'undefined') {\n                    callback = ref;\n                    selectAll = true;\n                }\n                if (this._filter) {\n                    var refs = [];\n                    this._filter.ref.forEachColumn(function (columnRef) {\n                        if (selectAll || columnRef.intersects(ref)) {\n                            refs.push(columnRef.topLeft);\n                        }\n                    });\n                    this._mergedCells.forEach(function (merged) {\n                        refs = refs.map(function (ref) {\n                            if (merged.intersects(ref)) {\n                                return merged;\n                            }\n                            return ref;\n                        });\n                    });\n                    refs.reduce(function unique(result, element) {\n                        if (result.indexOf(element) < 0) {\n                            result.push(element);\n                        }\n                        return result;\n                    }, []).forEach(callback);\n                }\n            },\n            forEach: function (ref, callback) {\n                if (!(ref instanceof RangeRef)) {\n                    ref = this._ref(ref);\n                }\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                function doIt(value) {\n                    callback(ri++, ci, value);\n                }\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var ri = topLeft.row;\n                    var startCellIndex = this._grid.index(ri, ci);\n                    var endCellIndex = this._grid.index(bottomRight.row, ci);\n                    this._properties.forEach(startCellIndex, endCellIndex, doIt);\n                }\n            },\n            startResizing: function (initialPosition) {\n                this._initialPosition = initialPosition;\n                this._resizeInProgress = true;\n            },\n            startAutoFill: function () {\n                this._autoFillInProgress = true;\n                var selection = this.select();\n                this._autoFillOrigin = selection;\n                this._autoFillDest = selection;\n                this.triggerChange({ selection: true });\n            },\n            updateAutoFill: function (dest, punch, hint, direction) {\n                this._autoFillDest = dest;\n                this._autoFillPunch = punch;\n                this._autoFillHint = hint;\n                this._autoFillDirection = direction;\n                this.triggerChange({ selection: true });\n            },\n            autoFillRef: function () {\n                return this._autoFillDest;\n            },\n            autoFillPunch: function () {\n                return this._autoFillPunch;\n            },\n            autoFillInProgress: function () {\n                return this._autoFillInProgress;\n            },\n            resizingInProgress: function () {\n                return this._resizeInProgress;\n            },\n            completeResizing: function () {\n                if (this._resizeInProgress) {\n                    this._resizeInProgress = false;\n                    var hintPosition = this.resizeHintPosition();\n                    if (this._initialPosition && hintPosition) {\n                        var handlePosition = this.resizeHandlePosition();\n                        if (handlePosition.col !== -Infinity) {\n                            this.trigger('commandRequest', {\n                                command: 'ColumnWidthCommand',\n                                options: {\n                                    target: handlePosition.col,\n                                    value: this.columnWidth(handlePosition.col) - (this._initialPosition.x - hintPosition.x)\n                                }\n                            });\n                        } else {\n                            this.trigger('commandRequest', {\n                                command: 'RowHeightCommand',\n                                options: {\n                                    target: handlePosition.row,\n                                    value: this.rowHeight(handlePosition.row) - (this._initialPosition.y - hintPosition.y)\n                                }\n                            });\n                        }\n                    } else {\n                        this.trigger('change', { resize: true });\n                    }\n                }\n            },\n            resizeHandlePosition: function () {\n                return this._resizeHandlePosition;\n            },\n            resizeHintPosition: function (location) {\n                if (location !== undefined) {\n                    this._resizeHintPosition = location;\n                    this.trigger('change', { resize: true });\n                }\n                return this._resizeHintPosition;\n            },\n            removeResizeHandle: function () {\n                if (this._resizeHandlePosition) {\n                    this._resizeHintPosition = undefined;\n                    this._resizeHandlePosition = undefined;\n                    this._initialPosition = undefined;\n                    this.trigger('change', { resize: true });\n                }\n            },\n            positionResizeHandle: function (ref) {\n                this._resizeHandlePosition = ref;\n                this.trigger('change', { resize: true });\n            },\n            startSelection: function () {\n                this._selectionInProgress = true;\n            },\n            completeSelection: function () {\n                if (this._selectionInProgress) {\n                    this._selectionInProgress = false;\n                    this._resizeHintPosition = undefined;\n                    this.trigger('change', { selection: true });\n                }\n                if (this._autoFillInProgress) {\n                    this._autoFillInProgress = false;\n                    var dest = this._autoFillDest;\n                    var origin = this._autoFillOrigin;\n                    if (this._autoFillPunch) {\n                        this.trigger('commandRequest', {\n                            command: 'ClearContentCommand',\n                            options: { operatingRange: this.range(this._autoFillPunch) }\n                        });\n                    } else {\n                        if (!dest.eq(origin)) {\n                            this.trigger('commandRequest', {\n                                command: 'AutoFillCommand',\n                                options: {\n                                    operatingRange: this.range(dest),\n                                    origin: this.range(origin)\n                                }\n                            });\n                        } else {\n                            this.triggerChange({ selection: true });\n                        }\n                    }\n                    this._autoFillDest = null;\n                    this._autoFillPunch = null;\n                    this._autoFillOrigin = null;\n                    this.select(dest);\n                }\n            },\n            selectionInProgress: function () {\n                return this._selectionInProgress;\n            },\n            select: function (ref, changeActiveCell) {\n                var selectionState = this._selectionState();\n                var expandedRef;\n                if (ref) {\n                    ref = this._ref(ref);\n                    ref = this._grid.normalize(ref);\n                    expandedRef = this._grid.isAxis(ref) ? ref : this.unionWithMerged(ref);\n                }\n                return selectionState.select(ref, expandedRef, changeActiveCell);\n            },\n            originalSelect: function () {\n                return this._selectionState().originalSelection;\n            },\n            currentSelectionRange: function () {\n                return this._selectionState().currentSelectionRange();\n            },\n            currentOriginalSelectionRange: function () {\n                return this._selectionState().currentOriginalNavigationRange();\n            },\n            currentNavigationRange: function () {\n                return this._selectionState().currentNavigationRange();\n            },\n            nextNavigationRange: function () {\n                return this._selectionState().nextNavigationRange();\n            },\n            previousNavigationRange: function () {\n                return this._selectionState().previousNavigationRange();\n            },\n            selectionRangeIndex: function () {\n                return this._selectionState().selectionRangeIndex;\n            },\n            activeCell: function (ref) {\n                return this._selectionState().activeCell(ref);\n            },\n            originalActiveCell: function () {\n                return this._selectionState().originalActiveCell;\n            },\n            singleCellSelection: function () {\n                return this._selectionState().singleCellSelection();\n            },\n            unionWithMerged: function (ref) {\n                var mergedCells = this._mergedCells;\n                return ref.map(function (ref) {\n                    return ref.toRangeRef().union(mergedCells);\n                });\n            },\n            trim: function (ref) {\n                var trims = [];\n                var grid = this._grid;\n                this._properties.forEachProperty(function (property) {\n                    trims.push(grid.trim(ref, property.list));\n                });\n                return this.unionWithMerged(ref.topLeft.toRangeRef().union(trims));\n            },\n            focus: function (ref) {\n                if (ref) {\n                    this._focus = ref.toRangeRef();\n                } else {\n                    var focus = this._focus;\n                    this._focus = null;\n                    return focus;\n                }\n            },\n            activeCellSelection: function () {\n                return new Range(this._grid.normalize(this.activeCell()), this);\n            },\n            selection: function () {\n                return new Range(this._grid.normalize(this._selectionState().selection), this);\n            },\n            selectedHeaders: function () {\n                var selection = this.select();\n                var rows = {};\n                var cols = {};\n                var allCols = false;\n                var allRows = false;\n                var maxRow = this._grid.rowCount - 1;\n                var maxCol = this._grid.columnCount - 1;\n                selection.forEach(function (ref) {\n                    var i;\n                    var rowState = 'partial';\n                    var colState = 'partial';\n                    ref = ref.toRangeRef();\n                    var bottomRight = ref.bottomRight;\n                    var topLeft = ref.topLeft;\n                    var rowSelection = topLeft.col <= 0 && bottomRight.col >= maxCol;\n                    var colSelection = topLeft.row <= 0 && bottomRight.row >= maxRow;\n                    if (colSelection) {\n                        allRows = true;\n                        colState = 'full';\n                    }\n                    if (rowSelection) {\n                        allCols = true;\n                        rowState = 'full';\n                    }\n                    if (!colSelection) {\n                        for (i = topLeft.row; i <= bottomRight.row; i++) {\n                            if (rows[i] !== 'full') {\n                                rows[i] = rowState;\n                            }\n                        }\n                    }\n                    if (!rowSelection) {\n                        for (i = topLeft.col; i <= bottomRight.col; i++) {\n                            if (cols[i] !== 'full') {\n                                cols[i] = colState;\n                            }\n                        }\n                    }\n                });\n                return {\n                    rows: rows,\n                    cols: cols,\n                    allRows: allRows,\n                    allCols: allCols,\n                    all: allRows && allCols\n                };\n            },\n            isInEditMode: function (isInEdit) {\n                if (isInEdit === undefined) {\n                    return this._inEdit;\n                }\n                this._inEdit = isInEdit;\n                if (isInEdit) {\n                    this._editSelection.selection = this._viewSelection.selection.clone();\n                    this._editSelection.originalSelection = this._viewSelection.originalSelection.clone();\n                    this._editSelection._activeCell = this._viewSelection._activeCell.clone();\n                    this._editSelection.originalActiveCell = this._viewSelection.originalActiveCell.clone();\n                }\n            },\n            _setFormulaSelections: function (selection) {\n                this._formulaSelections = (selection || []).slice();\n                this.triggerChange({ selection: true });\n            },\n            _viewActiveCell: function () {\n                return this._viewSelection._activeCell.toRangeRef();\n            },\n            toJSON: function () {\n                var positions = {};\n                var rows = this._rows.toJSON('height', positions);\n                var columns = this._columns.toJSON('width', {});\n                var viewSelection = this._viewSelection;\n                var hyperlinks = [];\n                var defaultCellStyle = this._defaultCellStyle || {};\n                function clearDefaultStyle(cell) {\n                    Object.keys(defaultCellStyle).forEach(function (key) {\n                        if (cell[key] === defaultCellStyle[key]) {\n                            delete cell[key];\n                        }\n                    });\n                }\n                this.forEach(kendo.spreadsheet.SHEETREF, function (row, col, cell) {\n                    clearDefaultStyle(cell);\n                    if (Object.keys(cell).length === 0) {\n                        return;\n                    }\n                    if (cell.link) {\n                        hyperlinks.push({\n                            ref: kendo.spreadsheet.Ref.display(null, row, col),\n                            target: cell.link\n                        });\n                    }\n                    var position = positions[row];\n                    if (position === undefined) {\n                        position = rows.length;\n                        rows.push({ index: row });\n                        positions[row] = position;\n                    }\n                    row = rows[position];\n                    cell.index = col;\n                    if (row.cells === undefined) {\n                        row.cells = [];\n                    }\n                    if (cell.formula) {\n                        cell.formula = cell.formula.toString();\n                    }\n                    if (cell.validation) {\n                        cell.validation = cell.validation.toJSON();\n                    }\n                    if (cell.color) {\n                        cell.color = kendo.parseColor(cell.color).toCss();\n                    }\n                    if (cell.background) {\n                        cell.background = kendo.parseColor(cell.background).toCss();\n                    }\n                    if (cell.borderTop && cell.borderTop.color) {\n                        cell.borderTop.color = kendo.parseColor(cell.borderTop.color).toCss();\n                    }\n                    if (cell.borderBottom && cell.borderBottom.color) {\n                        cell.borderBottom.color = kendo.parseColor(cell.borderBottom.color).toCss();\n                    }\n                    if (cell.borderRight && cell.borderRight.color) {\n                        cell.borderRight.color = kendo.parseColor(cell.borderRight.color).toCss();\n                    }\n                    if (cell.borderLeft && cell.borderLeft.color) {\n                        cell.borderLeft.color = kendo.parseColor(cell.borderLeft.color).toCss();\n                    }\n                    row.cells.push(cell);\n                });\n                var json = {\n                    name: this._name(),\n                    rows: rows,\n                    columns: columns,\n                    selection: viewSelection.selection.toString(),\n                    activeCell: viewSelection.activeCell().toString(),\n                    frozenRows: this.frozenRows(),\n                    frozenColumns: this.frozenColumns(),\n                    showGridLines: this.showGridLines(),\n                    gridLinesColor: this.gridLinesColor(),\n                    mergedCells: this._mergedCells.map(function (ref) {\n                        return ref.toString();\n                    }),\n                    hyperlinks: hyperlinks,\n                    defaultCellStyle: defaultCellStyle\n                };\n                if (this._sort) {\n                    json.sort = {\n                        ref: this._sort.ref.toString(),\n                        columns: this._sort.columns.map(function (column) {\n                            return {\n                                index: column.index,\n                                ascending: column.ascending\n                            };\n                        })\n                    };\n                }\n                if (this._filter) {\n                    json.filter = {\n                        ref: this._filter.ref.toString(),\n                        columns: this._filter.columns.map(function (column) {\n                            var filter = column.filter.toJSON();\n                            filter.index = column.index;\n                            return filter;\n                        })\n                    };\n                }\n                return json;\n            },\n            fromJSON: function (json) {\n                this.batch(function () {\n                    if (json.name !== undefined) {\n                        this._name(json.name);\n                    }\n                    if (json.frozenColumns !== undefined) {\n                        this.frozenColumns(json.frozenColumns);\n                    }\n                    if (json.frozenRows !== undefined) {\n                        this.frozenRows(json.frozenRows);\n                    }\n                    if (json.columns !== undefined) {\n                        this._columns.fromJSON('width', json.columns);\n                    }\n                    if (json.rows !== undefined) {\n                        this._rows.fromJSON('height', json.rows);\n                        for (var ri = 0; ri < json.rows.length; ri++) {\n                            var row = json.rows[ri];\n                            var rowIndex = row.index;\n                            if (rowIndex === undefined) {\n                                rowIndex = ri;\n                            }\n                            if (row.cells) {\n                                for (var ci = 0; ci < row.cells.length; ci++) {\n                                    var cell = row.cells[ci];\n                                    var columnIndex = cell.index;\n                                    if (columnIndex === undefined) {\n                                        columnIndex = ci;\n                                    }\n                                    if (cell.formula) {\n                                        cell.formula = this._compileFormula(rowIndex, columnIndex, cell.formula);\n                                    }\n                                    if (cell.validation) {\n                                        cell.validation = this._compileValidation(rowIndex, columnIndex, cell.validation);\n                                    }\n                                    this._properties.fromJSON(this._grid.index(rowIndex, columnIndex), cell);\n                                }\n                            }\n                        }\n                    }\n                    if (json.selection) {\n                        this._viewSelection.selection = this._viewSelection.originalSelection = this._ref(json.selection);\n                    }\n                    if (json.activeCell) {\n                        var activeCellRef = this._ref(json.activeCell);\n                        this._viewSelection._activeCell = activeCellRef.toRangeRef();\n                        this._viewSelection.originalActiveCell = activeCellRef;\n                    }\n                    if (json.mergedCells) {\n                        json.mergedCells.forEach(function (ref) {\n                            this.range(ref).merge();\n                        }, this);\n                    }\n                    if (json.sort) {\n                        this._sort = {\n                            ref: this._ref(json.sort.ref),\n                            columns: json.sort.columns.slice(0)\n                        };\n                    }\n                    if (json.filter) {\n                        var ref = json.filter.ref;\n                        var columns = json.filter.columns === undefined ? [] : json.filter.columns;\n                        if (!ref) {\n                            kendo.logToConsole('Dropping filter for sheet \\'' + json.name + '\\' due to missing ref');\n                        } else {\n                            this._filter = {\n                                ref: this._ref(ref),\n                                columns: columns.map(function (column) {\n                                    return {\n                                        index: column.index,\n                                        filter: kendo.spreadsheet.Filter.create(column)\n                                    };\n                                })\n                            };\n                            this._refreshFilter();\n                        }\n                    }\n                    if (json.showGridLines !== undefined) {\n                        this._showGridLines = json.showGridLines;\n                    }\n                    this._gridLinesColor = json.gridLinesColor;\n                });\n                this._rows._refresh();\n                this._columns._refresh();\n            },\n            formula: function (ref) {\n                return this._properties.get('formula', this._grid.cellRefIndex(ref));\n            },\n            validation: function (ref) {\n                return this._properties.get('validation', this._grid.cellRefIndex(ref));\n            },\n            resetFormulas: function () {\n                this._forFormulas(function (formula) {\n                    formula.reset();\n                });\n            },\n            resetValidations: function () {\n                this._forValidations(function (validation) {\n                    validation.reset();\n                });\n            },\n            recalc: function (context, callback) {\n                var formulas = this._properties.get('formula').values();\n                var count = formulas.length, pending = 0, i = 0;\n                if (!count && callback) {\n                    return callback();\n                }\n                function next() {\n                    pending--;\n                    if (i == count && !pending) {\n                        callback();\n                    }\n                }\n                while (i < count) {\n                    pending++;\n                    formulas[i++].value.exec(context, callback ? next : null);\n                }\n            },\n            revalidate: function (context) {\n                var self = this;\n                this._forValidations(function (validation) {\n                    var cellRef = new CellRef(validation.row, validation.col);\n                    var ref = new RangeRef(cellRef, cellRef);\n                    validation.exec(context, self._get(ref, 'value'), self._get(ref, 'format'));\n                });\n            },\n            _value: function (row, col, value) {\n                var index = this._grid.index(row, col);\n                if (value !== undefined) {\n                    this._properties.set('value', index, index, value);\n                } else {\n                    return this._properties.get('value', index);\n                }\n            },\n            _validation: function (row, col) {\n                var index = this._grid.index(row, col);\n                return this._properties.get('validation', index);\n            },\n            _compileValidation: function (row, col, validation) {\n                if (validation instanceof kendo.spreadsheet.validation.Validation) {\n                    return validation.clone(this._name(), row, col);\n                }\n                if (validation.from != null) {\n                    validation.from = (validation.from + '').replace(/^=/, '');\n                }\n                if (validation.to != null) {\n                    validation.to = (validation.to + '').replace(/^=/, '');\n                }\n                return kendo.spreadsheet.validation.compile(this._name(), row, col, validation);\n            },\n            _compileFormula: function (row, col, f) {\n                f = f.replace(/^=/, '');\n                f = kendo.spreadsheet.calc.parseFormula(this._name(), row, col, f);\n                return kendo.spreadsheet.calc.compile(f);\n            },\n            _copyValuesInRange: function (topLeft, bottomRight, value, property) {\n                var ci, start, end;\n                for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    start = this._grid.index(topLeft.row, ci);\n                    end = this._grid.index(bottomRight.row, ci);\n                    for (var index = start, row = topLeft.row; index <= end; ++index, ++row) {\n                        value = value.clone(this._name(), row, ci);\n                        this._properties.set(property, index, index, value);\n                    }\n                }\n                return value;\n            },\n            _set: function (ref, name, value) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var bottomRight = this._grid.normalize(ref.bottomRight);\n                var ci, start, end;\n                if (typeof value == 'number') {\n                    value = kendo.spreadsheet.calc.runtime.limitPrecision(value);\n                }\n                if (value && name == 'formula') {\n                    if (typeof value == 'string') {\n                        value = this._compileFormula(topLeft.row, topLeft.col, value);\n                    }\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'formula');\n                } else if (value && name == 'validation') {\n                    value = this._compileValidation(topLeft.row, topLeft.col, value);\n                    value = this._copyValuesInRange(topLeft, bottomRight, value, 'validation');\n                } else {\n                    for (ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                        start = this._grid.index(topLeft.row, ci);\n                        end = this._grid.index(bottomRight.row, ci);\n                        this._properties.set(name, start, end, value);\n                        if (name == 'formula') {\n                            this._properties.set('value', start, end, null);\n                        }\n                    }\n                }\n            },\n            _get: function (ref, name) {\n                var topLeft = this._grid.normalize(ref.topLeft);\n                var index = this._grid.index(topLeft.row, topLeft.col);\n                return this._properties.get(name, index);\n            },\n            batch: function (callback, reason) {\n                var suspended = this.suspendChanges();\n                this.suspendChanges(true);\n                callback.call(this);\n                return this.suspendChanges(suspended).triggerChange(reason || { recalc: true });\n            },\n            _sortBy: function (ref, columns) {\n                var indices = null;\n                columns.forEach(function (column) {\n                    indices = this._sorter.sortBy(ref, column.index, this._properties.get('value'), column.ascending, indices);\n                }, this);\n                this._sort = {\n                    ref: ref,\n                    columns: columns\n                };\n                this._refreshFilter();\n                this.forEach(ref, function (row, col, props) {\n                    var formula = props.formula;\n                    if (formula) {\n                        var diff = row - formula.row;\n                        if (diff !== 0) {\n                            var start = diff > 0 ? formula.row : formula.row + diff;\n                            formula.adjust(this.name(), 'row', start, diff);\n                        }\n                    }\n                }.bind(this));\n                this.triggerChange({ recalc: true });\n            },\n            _refreshFilter: function () {\n                if (this._filter) {\n                    this._filterBy(this._filter.ref, this._filter.columns);\n                }\n            },\n            _filterBy: function (ref, columns) {\n                this.batch(function () {\n                    for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                        if (this._rows.hidden(ri)) {\n                            this._rows.unhide(ri);\n                        }\n                    }\n                    columns.forEach(function (column) {\n                        var columnRef = ref.resize({ top: 1 }).toColumn(column.index);\n                        var cells = [];\n                        if (columnRef === kendo.spreadsheet.NULLREF) {\n                            return;\n                        }\n                        this.forEach(columnRef, function (row, col, cell) {\n                            cell.row = row;\n                            cells.push(cell);\n                        });\n                        column.filter.prepare(cells);\n                        for (var ci = 0; ci < cells.length; ci++) {\n                            var cell = cells[ci];\n                            var value = column.filter.value(cell);\n                            if (column.filter.matches(value) === false) {\n                                this.hideRow(cell.row);\n                            }\n                        }\n                    }, this);\n                    this._filter = {\n                        ref: ref,\n                        columns: columns\n                    };\n                }, {\n                    recalc: true,\n                    layout: true,\n                    filter: true\n                });\n            },\n            filterColumn: function (ref) {\n                var filterRef = this.filter().ref;\n                return ref.toRangeRef().topLeft.col - filterRef.topLeft.col;\n            },\n            filter: function () {\n                return this._filter;\n            },\n            clearFilter: function (spec) {\n                this._clearFilter(spec instanceof Array ? spec : [spec]);\n            },\n            _clearFilter: function (indices) {\n                if (this._filter) {\n                    this.batch(function () {\n                        this._filter.columns = this._filter.columns.filter(function (column) {\n                            return indices.indexOf(column.index) < 0;\n                        });\n                        this._refreshFilter();\n                    }, {\n                        recalc: true,\n                        layout: true,\n                        filter: true\n                    });\n                }\n            },\n            getAxisState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState()\n                };\n            },\n            setAxisState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this.triggerChange({ layout: true });\n            },\n            getState: function () {\n                return {\n                    rows: this._rows.getState(),\n                    columns: this._columns.getState(),\n                    mergedCells: this._mergedCells.map(function (cell) {\n                        return cell.clone();\n                    }),\n                    properties: this._properties.getState()\n                };\n            },\n            setState: function (state) {\n                this._rows.setState(state.rows);\n                this._columns.setState(state.columns);\n                this._mergedCells = state.mergedCells;\n                this._properties.setState(state.properties);\n                this.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            _merge: function (ref) {\n                var mergedCells = this._mergedCells;\n                var sheet = this;\n                var mergedRef;\n                this.batch(function () {\n                    mergedRef = ref.map(function (ref) {\n                        if (ref instanceof kendo.spreadsheet.CellRef) {\n                            return ref;\n                        }\n                        var currentRef = ref.toRangeRef().union(mergedCells, function (ref) {\n                            mergedCells.splice(mergedCells.indexOf(ref), 1);\n                        });\n                        var range = new Range(currentRef, sheet);\n                        var formula = range._get('formula');\n                        var value = range.value();\n                        var format = range.format();\n                        var background = range.background();\n                        range.value(null);\n                        range.format(null);\n                        range.background(null);\n                        var topLeft = new Range(currentRef.collapse(), sheet);\n                        if (formula) {\n                            topLeft._set('formula', formula);\n                        } else {\n                            topLeft.value(value);\n                        }\n                        topLeft.format(format);\n                        topLeft.background(background);\n                        mergedCells.push(currentRef);\n                        return currentRef;\n                    });\n                    var viewSelection = sheet._viewSelection;\n                    viewSelection.selection = sheet.unionWithMerged(viewSelection.originalSelection);\n                    viewSelection._activeCell = sheet.unionWithMerged(viewSelection.originalActiveCell);\n                }, {\n                    activeCell: true,\n                    selection: true\n                });\n                return mergedRef;\n            }\n        });\n        kendo.spreadsheet.Sheet = Sheet;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetsbar', [\n        'kendo.core',\n        'kendo.sortable'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var outerWidth = kendo._outerWidth;\n        var DOT = '.';\n        var EMPTYCHAR = ' ';\n        var sheetsBarClassNames = {\n            sheetsBarWrapper: 'k-widget k-header',\n            sheetsBarSheetsWrapper: 'k-tabstrip k-floatwrap k-tabstrip-bottom',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            sheetsBarAdd: 'k-spreadsheet-sheets-bar-add',\n            sheetsBarRemove: 'k-spreadsheet-sheets-remove',\n            sheetsBarItems: 'k-spreadsheet-sheets-items',\n            sheetsBarEditor: 'k-spreadsheet-sheets-editor',\n            sheetsBarScrollable: 'k-tabstrip-scrollable',\n            sheetsBarNext: 'k-tabstrip-next',\n            sheetsBarPrev: 'k-tabstrip-prev',\n            sheetsBarKItem: 'k-item k-state-default',\n            sheetsBarKActive: 'k-state-active k-state-tab-on-top',\n            sheetsBarKTextbox: 'k-textbox',\n            sheetsBarKLink: 'k-link',\n            sheetsBarKIcon: 'k-icon',\n            sheetsBarKFontIcon: 'k-icon',\n            sheetsBarKButton: 'k-button k-button-icon',\n            sheetsBarKButtonBare: 'k-bare',\n            sheetsBarKArrowW: 'k-i-arrow-60-left',\n            sheetsBarKArrowE: 'k-i-arrow-60-right',\n            sheetsBarKReset: 'k-reset k-tabstrip-items',\n            sheetsBarKIconX: 'k-i-close',\n            sheetsBarKSprite: 'k-sprite',\n            sheetsBarKIconPlus: 'k-i-plus',\n            sheetsBarHintWrapper: 'k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint',\n            sheetsBarKResetItems: 'k-reset k-tabstrip-items'\n        };\n        var SheetsBar = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                var classNames = SheetsBar.classNames;\n                kendo.ui.Widget.call(this, element, options);\n                element = this.element;\n                element.addClass(classNames.sheetsBarWrapper);\n                this._openDialog = options.openDialog;\n                this._tree = new kendo.dom.Tree(element[0]);\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper([])\n                ]);\n                this._toggleScrollEvents(true);\n                this._createSortable();\n                this._sortable.bind('start', this._onSheetReorderStart.bind(this));\n                this._sortable.bind('end', this._onSheetReorderEnd.bind(this));\n                element.on('click', DOT + classNames.sheetsBarRemove, this._onSheetRemove.bind(this));\n                element.on('click', 'li', this._onSheetSelect.bind(this));\n                element.on('dblclick', 'li' + DOT + classNames.sheetsBarActive, this._createEditor.bind(this));\n                element.on('click', DOT + classNames.sheetsBarAdd, this._onAddSelect.bind(this));\n            },\n            options: {\n                name: 'SheetsBar',\n                scrollable: { distance: 200 }\n            },\n            events: [\n                'select',\n                'reorder',\n                'rename'\n            ],\n            _createEditor: function () {\n                if (this._editor) {\n                    return;\n                }\n                this._renderSheets(this._sheets, this._selectedIndex, true);\n                this._editor = this.element.find(kendo.format('input{0}{1}', DOT, SheetsBar.classNames.sheetsBarEditor)).focus().on('keydown', this._onEditorKeydown.bind(this)).on('blur', this._onEditorBlur.bind(this));\n            },\n            _destroyEditor: function (canceled) {\n                var newSheetName = canceled ? null : this._editor.val();\n                this._editor.off();\n                this._editor = null;\n                this._renderSheets(this._sheets, this._selectedIndex, false);\n                this._onSheetRename(newSheetName);\n            },\n            renderSheets: function (sheets, selectedIndex) {\n                if (!sheets || selectedIndex < 0) {\n                    return;\n                }\n                this._renderSheets(sheets, selectedIndex, false);\n            },\n            _renderSheets: function (sheets, selectedIndex, isInEditMode) {\n                var that = this;\n                var wrapperOffsetWidth;\n                var sheetsGroupScrollWidth;\n                var classNames = SheetsBar.classNames;\n                that._isRtl = kendo.support.isRtl(that.element);\n                that._sheets = sheets;\n                that._selectedIndex = selectedIndex;\n                that._renderHtml(isInEditMode, true);\n                if (!that._scrollableAllowed()) {\n                    return;\n                }\n                var sheetsWrapper = that._sheetsWrapper();\n                var scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                var scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                var gapWidth = 2;\n                var addButton = that.element.find(DOT + classNames.sheetsBarAdd);\n                var addButtonWidth = outerWidth(addButton) + addButton.position().left + gapWidth;\n                var scrollPrevButtonWidth = outerWidth(scrollPrevButton) + gapWidth;\n                var sheetsGroup = that._sheetsGroup();\n                scrollPrevButton.css({ left: addButtonWidth });\n                sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n                sheetsGroup.css({ marginLeft: addButtonWidth });\n                wrapperOffsetWidth = sheetsWrapper[0].offsetWidth;\n                sheetsGroupScrollWidth = sheetsGroup[0].scrollWidth;\n                if (sheetsGroupScrollWidth + addButtonWidth > wrapperOffsetWidth) {\n                    var scrollNextButtonRight = Math.ceil(kendo.parseFloat(scrollNextButton.css('right')));\n                    if (!that._scrollableModeActive) {\n                        that._nowScrollingSheets = false;\n                        that._scrollableModeActive = true;\n                    }\n                    sheetsGroup.css({\n                        marginLeft: scrollPrevButtonWidth + addButtonWidth,\n                        marginRight: outerWidth(scrollNextButton) + scrollNextButtonRight + gapWidth\n                    });\n                } else {\n                    if (that._scrollableModeActive && sheetsGroupScrollWidth <= wrapperOffsetWidth) {\n                        that._scrollableModeActive = false;\n                        sheetsGroup.css({\n                            marginLeft: addButtonWidth,\n                            marginRight: ''\n                        });\n                    } else {\n                        sheetsGroup.css({ marginLeft: addButtonWidth });\n                    }\n                }\n                that._toggleScrollButtons();\n            },\n            _toggleScrollButtons: function (toggle) {\n                var that = this;\n                var ul = that._sheetsGroup();\n                var wrapper = that._sheetsWrapper();\n                var scrollLeft = ul.scrollLeft();\n                var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n                if (toggle === false) {\n                    prev.toggle(false);\n                    next.toggle(false);\n                } else {\n                    prev.toggle(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0);\n                    next.toggle(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1);\n                }\n            },\n            _toggleScrollEvents: function (toggle) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                var options = that.options;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                scrollPrevButton = sheetsWrapper.children(DOT + classNames.sheetsBarPrev);\n                scrollNextButton = sheetsWrapper.children(DOT + classNames.sheetsBarNext);\n                if (toggle) {\n                    scrollPrevButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                    });\n                    scrollNextButton.on('mousedown', function () {\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                    });\n                    scrollPrevButton.add(scrollNextButton).on('mouseup', function () {\n                        that._nowScrollingSheets = false;\n                    });\n                } else {\n                    scrollPrevButton.off();\n                    scrollNextButton.off();\n                }\n            },\n            _renderHtml: function (isInEditMode, renderScrollButtons) {\n                var idx;\n                var sheetElements = [];\n                var dom = kendo.dom;\n                var element = dom.element;\n                var sheets = this._sheets;\n                var selectedIndex = this._selectedIndex;\n                var classNames = SheetsBar.classNames;\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var sheet = sheets[idx];\n                    var isSelectedSheet = idx === selectedIndex;\n                    var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR };\n                    var elementContent = [];\n                    if (isSelectedSheet) {\n                        attr.className += classNames.sheetsBarKActive + EMPTYCHAR + classNames.sheetsBarActive;\n                    } else {\n                        attr.className += classNames.sheetsBarInactive;\n                    }\n                    if (isSelectedSheet && isInEditMode) {\n                        elementContent.push(element('input', {\n                            type: 'text',\n                            value: sheet.name(),\n                            className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                            maxlength: 50\n                        }, []));\n                    } else {\n                        elementContent.push(element('span', {\n                            className: classNames.sheetsBarKLink,\n                            title: sheet.name()\n                        }, [dom.text(sheet.name())]));\n                        if (sheets.length > 1) {\n                            var deleteIcon = element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconX }, []);\n                            elementContent.push(element('span', { className: classNames.sheetsBarKLink + EMPTYCHAR + classNames.sheetsBarRemove }, [deleteIcon]));\n                        }\n                    }\n                    sheetElements.push(element('li', attr, elementContent));\n                }\n                this._tree.render([\n                    this._addButton(),\n                    this._createSheetsWrapper(sheetElements, renderScrollButtons)\n                ]);\n            },\n            _createSheetsWrapper: function (sheetElements, renderScrollButtons) {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                var childrenElements = [element('ul', { className: classNames.sheetsBarKReset }, sheetElements)];\n                renderScrollButtons = true;\n                if (renderScrollButtons) {\n                    var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarPrev }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowW }, [])]));\n                    childrenElements.push(element('span', { className: baseButtonClass + classNames.sheetsBarNext }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKArrowE }, [])]));\n                }\n                return element('div', { className: classNames.sheetsBarItems }, childrenElements);\n            },\n            _createSortable: function () {\n                var classNames = SheetsBar.classNames;\n                this._sortable = new kendo.ui.Sortable(this.element, {\n                    filter: kendo.format('ul li.{0},ul li.{1}', classNames.sheetsBarActive, classNames.sheetsBarInactive),\n                    container: DOT + classNames.sheetsBarItems,\n                    axis: 'x',\n                    animation: false,\n                    ignore: 'input',\n                    end: function () {\n                        if (this.draggable.hint) {\n                            this.draggable.hint.remove();\n                        }\n                    },\n                    hint: function (element) {\n                        var hint = $(element).clone();\n                        return hint.wrap('<div class=\\'' + classNames.sheetsBarHintWrapper + '\\'><ul class=\\'' + classNames.sheetsBarKResetItems + '\\'></ul></div>').closest('div');\n                    }\n                });\n            },\n            _onEditorKeydown: function (e) {\n                if (this._editor) {\n                    if (e.which === 13) {\n                        this._destroyEditor();\n                    }\n                    if (e.which === 27) {\n                        this._destroyEditor(true);\n                    }\n                }\n            },\n            _onEditorBlur: function () {\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n            },\n            _onSheetReorderEnd: function (e) {\n                e.preventDefault();\n                this.trigger('reorder', {\n                    oldIndex: e.oldIndex,\n                    newIndex: e.newIndex\n                });\n            },\n            _onSheetReorderStart: function (e) {\n                if (this._editor) {\n                    e.preventDefault();\n                }\n            },\n            _onSheetRemove: function (e) {\n                var removedSheetName = $(e.target).closest('li').text();\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                var closeCallback = function (e) {\n                    var dlg = e.sender;\n                    if (dlg.isConfirmed()) {\n                        this.trigger('remove', {\n                            name: removedSheetName,\n                            confirmation: true\n                        });\n                    }\n                }.bind(this);\n                this._openDialog('confirmation', { close: closeCallback });\n            },\n            _onSheetSelect: function (e) {\n                var selectedSheetText = $(e.target).text();\n                if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                    e.preventDefault();\n                    return;\n                }\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n                this._scrollSheetsToItem($(e.target).closest('li'));\n                this.trigger('select', {\n                    name: selectedSheetText,\n                    isAddButton: false\n                });\n            },\n            _onSheetRename: function (newSheetName) {\n                if (this._sheets[this._selectedIndex].name() === newSheetName || newSheetName === null) {\n                    return;\n                }\n                this.trigger('rename', {\n                    name: newSheetName,\n                    sheetIndex: this._selectedIndex\n                });\n            },\n            _onAddSelect: function () {\n                this.trigger('select', { isAddButton: true });\n            },\n            _addButton: function () {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                return element('a', { className: classNames.sheetsBarAdd + EMPTYCHAR + classNames.sheetsBarKButton }, [element('span', { className: classNames.sheetsBarKIcon + EMPTYCHAR + classNames.sheetsBarKFontIcon + EMPTYCHAR + classNames.sheetsBarKIconPlus }, [])]);\n            },\n            destroy: function () {\n                this._sortable.destroy();\n            },\n            _scrollableAllowed: function () {\n                var options = this.options;\n                return options.scrollable && !isNaN(options.scrollable.distance);\n            },\n            _scrollSheetsToItem: function (item) {\n                var that = this;\n                if (!that._scrollableModeActive) {\n                    return;\n                }\n                var sheetsGroup = that._sheetsGroup();\n                var currentScrollOffset = sheetsGroup.scrollLeft();\n                var itemWidth = outerWidth(item);\n                var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                var sheetsGroupPadding = Math.ceil(parseFloat(sheetsGroup.css('padding-left')));\n                var itemPosition;\n                if (that._isRtl) {\n                    if (itemOffset < 0) {\n                        itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset) - sheetsGroupPadding;\n                    } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                        itemPosition = currentScrollOffset + itemOffset - itemWidth + sheetsGroupPadding * 2;\n                    }\n                } else {\n                    if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                        itemPosition = itemOffset + itemWidth - sheetsGroupWidth + sheetsGroupPadding * 2;\n                    } else if (currentScrollOffset > itemOffset) {\n                        itemPosition = itemOffset - sheetsGroupPadding;\n                    }\n                }\n                sheetsGroup.finish().animate({ 'scrollLeft': itemPosition }, 'fast', 'linear', function () {\n                    that._toggleScrollButtons();\n                });\n            },\n            _sheetsGroup: function () {\n                return this._sheetsWrapper().children('ul');\n            },\n            _sheetsWrapper: function () {\n                return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n            },\n            _scrollSheetsByDelta: function (delta) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var scrLeft = sheetsGroup.scrollLeft();\n                sheetsGroup.finish().animate({ 'scrollLeft': scrLeft + delta }, 'fast', 'linear', function () {\n                    if (that._nowScrollingSheets) {\n                        that._scrollSheetsByDelta(delta);\n                    } else {\n                        that._toggleScrollButtons();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.SheetsBar = SheetsBar;\n        $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/calc', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var Ref = spreadsheet.Ref;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var NameRef = spreadsheet.NameRef;\n    var exports = spreadsheet.calc;\n    var runtime = exports.runtime;\n    var OPERATORS = Object.create(null);\n    var ParseError = kendo.Class.extend({\n        init: function ParseError(message, pos) {\n            this.message = message;\n            this.pos = pos;\n        },\n        toString: function () {\n            return this.message;\n        }\n    });\n    (function (ops) {\n        ops.forEach(function (cls, i) {\n            cls.forEach(function (op) {\n                OPERATORS[op] = ops.length - i;\n            });\n        });\n    }([\n        [':'],\n        [' '],\n        [','],\n        ['%'],\n        ['^'],\n        [\n            '*',\n            '/'\n        ],\n        [\n            '+',\n            '-'\n        ],\n        ['&'],\n        [\n            '=',\n            '<',\n            '>',\n            '<=',\n            '>=',\n            '<>'\n        ]\n    ]));\n    var TRUE = {\n        type: 'bool',\n        value: true\n    };\n    var FALSE = {\n        type: 'bool',\n        value: false\n    };\n    function getcol(str) {\n        str = str.toUpperCase();\n        for (var col = 0, i = 0; i < str.length; ++i) {\n            col = col * 26 + str.charCodeAt(i) - 64;\n        }\n        return col - 1;\n    }\n    function getrow(str) {\n        return parseInt(str, 10) - 1;\n    }\n    function parseReference(name, noThrow) {\n        if (name.toLowerCase() == '#sheet') {\n            return spreadsheet.SHEETREF;\n        }\n        OUT: {\n            var m;\n            if (m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name)) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row < 1048576 && col < 16384) {\n                    return new CellRef(getrow(m[4]), getcol(m[2]));\n                }\n                break OUT;\n            }\n            var stream = TokenStream(name, {});\n            var a = [];\n            while (true) {\n                var ref = stream.next();\n                if (ref instanceof CellRef) {\n                    ref.rel = 0;\n                } else if (ref instanceof RangeRef) {\n                    ref.topLeft.rel = 0;\n                    ref.bottomRight.rel = 0;\n                } else {\n                    break OUT;\n                }\n                a.push(ref);\n                if (stream.eof()) {\n                    break;\n                }\n                if (!stream.is('op', ',')) {\n                    break OUT;\n                }\n                stream.next();\n            }\n            return a.length == 1 ? a[0] : new spreadsheet.UnionRef(a);\n        }\n        if (!noThrow) {\n            throw new Error('Cannot parse reference: ' + name);\n        }\n    }\n    function parseFormula(sheet, row, col, input) {\n        var refs = [];\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var is = input.is;\n        return {\n            type: 'exp',\n            ast: parseExpression(true),\n            refs: refs,\n            sheet: sheet,\n            row: row,\n            col: col\n        };\n        function addReference(ref) {\n            ref.index = refs.length;\n            refs.push(ref);\n            return ref;\n        }\n        function skip(type, value, allowEOF) {\n            if (is(type, value)) {\n                return input.next();\n            } else {\n                var tok = input.peek();\n                if (tok) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB but found ' + tok.type + ' \\xAB' + tok.value + '\\xBB');\n                } else if (!allowEOF) {\n                    input.croak('Expected ' + type + ' \\xAB' + value + '\\xBB');\n                }\n            }\n        }\n        function parseExpression(commas) {\n            return maybeBinary(maybeIntersect(parseAtom(commas)), 0, commas);\n        }\n        function parseSymbol(tok) {\n            if (tok.upper == 'TRUE' || tok.upper == 'FALSE') {\n                return tok.upper == 'TRUE' ? TRUE : FALSE;\n            }\n            return addReference(new NameRef(tok.value));\n        }\n        function parseFuncall() {\n            var fname = input.next();\n            fname = fname.value;\n            skip('punc', '(');\n            var args = [];\n            while (1) {\n                if (is('punc', ')')) {\n                    break;\n                }\n                if (is('op', ',')) {\n                    args.push({ type: 'null' });\n                    input.next();\n                    continue;\n                }\n                args.push(parseExpression(false));\n                if (input.eof() || is('punc', ')')) {\n                    break;\n                }\n                skip('op', ',');\n            }\n            skip('punc', ')', true);\n            return {\n                type: 'func',\n                func: fname,\n                args: args\n            };\n        }\n        function fixReference(ref) {\n            if (!ref.hasSheet()) {\n                ref.setSheet(sheet);\n            }\n            return addReference(ref);\n        }\n        function parseAtom(commas) {\n            var exp;\n            if (is('ref')) {\n                exp = fixReference(input.next());\n            } else if (is('func')) {\n                exp = parseFuncall();\n            } else if (is('punc', '(')) {\n                input.next();\n                exp = parseExpression(true);\n                skip('punc', ')', true);\n            } else if (is('punc', '{')) {\n                input.next();\n                exp = parseArray();\n                skip('punc', '}', true);\n            } else if (is('num') || is('str') || is('error')) {\n                exp = input.next();\n            } else if (is('sym')) {\n                exp = parseSymbol(input.next());\n            } else if (is('op', '+') || is('op', '-')) {\n                exp = {\n                    type: 'prefix',\n                    op: input.next().value,\n                    exp: parseAtom(commas)\n                };\n            } else if (!input.peek()) {\n                input.croak('Incomplete expression');\n            } else if (is('punc', '[')) {\n                input.croak('External reference not supported');\n            } else {\n                input.croak('Parse error');\n            }\n            return maybePercent(exp);\n        }\n        function parseArray() {\n            var row = [], value = [row], first = true;\n            while (!input.eof() && !is('punc', '}')) {\n                if (first) {\n                    first = false;\n                } else if (is('punc', ';')) {\n                    value.push(row = []);\n                    input.next();\n                } else {\n                    skip('op', ',');\n                }\n                row.push(parseExpression(false));\n            }\n            return {\n                type: 'matrix',\n                value: value\n            };\n        }\n        function maybeIntersect(exp) {\n            if (is('punc', '(') || is('ref') || is('num') || is('func')) {\n                return {\n                    type: 'binary',\n                    op: ' ',\n                    left: exp,\n                    right: parseExpression(false)\n                };\n            } else {\n                return exp;\n            }\n        }\n        function maybePercent(exp) {\n            if (is('op', '%')) {\n                input.next();\n                return maybePercent({\n                    type: 'postfix',\n                    op: '%',\n                    exp: exp\n                });\n            } else {\n                return exp;\n            }\n        }\n        function maybeBinary(left, my_prec, commas) {\n            var tok = is('op');\n            if (tok && (commas || tok.value != ',')) {\n                var his_prec = OPERATORS[tok.value];\n                if (his_prec > my_prec) {\n                    input.next();\n                    var right = maybeBinary(parseAtom(commas), his_prec, commas);\n                    return maybeBinary({\n                        type: 'binary',\n                        op: tok.value,\n                        left: left,\n                        right: right\n                    }, my_prec, commas);\n                }\n            }\n            return left;\n        }\n    }\n    function parseNameDefinition(name, def) {\n        var nameRef = parseFormula(null, 0, 0, name);\n        if (!(nameRef.ast instanceof NameRef)) {\n            throw new ParseError('Invalid name: ' + name);\n        }\n        nameRef = nameRef.ast;\n        if (!(def instanceof Ref)) {\n            var defAST = parseFormula(nameRef.sheet, 0, 0, def);\n            if (defAST.ast instanceof Ref) {\n                def = defAST.ast;\n            } else if (/^(?:str|num|bool|error)$/.test(defAST.ast.type)) {\n                def = defAST.ast.value;\n            } else {\n                def = makeFormula(defAST);\n            }\n        }\n        return {\n            name: nameRef,\n            value: def\n        };\n    }\n    function makePrinter(exp) {\n        return makeClosure('function(row, col, mod){return(' + print(exp.ast, exp, 0) + ')}');\n        function print(node, parent, prec) {\n            switch (node.type) {\n            case 'num':\n            case 'bool':\n                return JSON.stringify(node.value);\n            case 'error':\n                return JSON.stringify('#' + node.value);\n            case 'str':\n                return JSON.stringify(JSON.stringify(node.value));\n            case 'ref':\n                return 'this.refs[' + node.index + '].print(row, col, mod)';\n            case 'prefix':\n                return withParens(function () {\n                    return JSON.stringify(node.op) + ' + ' + print(node.exp, node, OPERATORS[node.op]);\n                });\n            case 'postfix':\n                return withParens(function () {\n                    return print(node.exp, node, OPERATORS[node.op]) + ' + ' + JSON.stringify(node.op);\n                });\n            case 'binary':\n                return withParens(function () {\n                    var left = parenthesize(print(node.left, node, OPERATORS[node.op]), node.left instanceof NameRef && node.op == ':');\n                    var right = parenthesize(print(node.right, node, OPERATORS[node.op]), node.right instanceof NameRef && node.op == ':');\n                    return left + ' + ' + JSON.stringify(node.op) + ' + ' + right;\n                });\n            case 'func':\n                return JSON.stringify(node.func + '(') + ' + ' + (node.args.length > 0 ? node.args.map(function (arg) {\n                    return print(arg, node, 0);\n                }).join(' + \\', \\' + ') : '\\'\\'') + ' + \\')\\'';\n            case 'matrix':\n                return '\\'{ \\' + ' + node.value.map(function (el) {\n                    return el.map(function (el) {\n                        return print(el, node, 0);\n                    }).join(' + \\', \\' + ');\n                }).join(' + \\'; \\' + ') + '+ \\' }\\'';\n            case 'null':\n                return '\\'\\'';\n            }\n            throw new Error('Cannot make printer for node ' + node.type);\n            function withParens(f) {\n                var op = node.op;\n                var needParens = OPERATORS[op] < prec || !prec && op == ',' || parent.type == 'prefix' && prec == OPERATORS[op] && parent.op == '-' || parent.type == 'binary' && prec == OPERATORS[op] && node === parent.right;\n                return parenthesize(f(), needParens);\n            }\n        }\n        function parenthesize(code, cond) {\n            return cond ? '\\'(\\' + ' + code + ' + \\')\\'' : code;\n        }\n    }\n    function toCPS(ast, k) {\n        var GENSYM = 0;\n        return cps(ast, k);\n        function cps(node, k) {\n            switch (node.type) {\n            case 'ref':\n                return cpsRef(node, k);\n            case 'num':\n            case 'str':\n            case 'null':\n            case 'error':\n            case 'bool':\n                return cpsAtom(node, k);\n            case 'prefix':\n            case 'postfix':\n                return cpsUnary(node, k);\n            case 'binary':\n                return cpsBinary(node, k);\n            case 'func':\n                return cpsFunc(node, k);\n            case 'lambda':\n                return cpsLambda(node, k);\n            case 'matrix':\n                return cpsMatrix(node.value, k, true);\n            }\n            throw new Error('Cannot CPS ' + node.type);\n        }\n        function cpsRef(node, k) {\n            return node.ref == 'name' ? cpsNameRef(node, k) : cpsAtom(node, k);\n        }\n        function cpsAtom(node, k) {\n            return k(node);\n        }\n        function cpsNameRef(node, k) {\n            return {\n                type: 'func',\n                func: ',getname',\n                args: [\n                    makeContinuation(k),\n                    node\n                ]\n            };\n        }\n        function cpsUnary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'unary' + node.op,\n                args: [node.exp]\n            }, k);\n        }\n        function cpsBinary(node, k) {\n            return cps({\n                type: 'func',\n                func: 'binary' + node.op,\n                args: [\n                    node.left,\n                    node.right\n                ]\n            }, k);\n        }\n        function cpsIf(co, th, el, k) {\n            return cps(co, function (co) {\n                var rest = makeContinuation(k);\n                var thenK = gensym('T');\n                var elseK = gensym('E');\n                return {\n                    type: 'func',\n                    func: 'if',\n                    args: [\n                        rest,\n                        co,\n                        {\n                            type: 'lambda',\n                            vars: [thenK],\n                            body: cps(th || TRUE, function (th) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: thenK\n                                    },\n                                    args: [th]\n                                };\n                            })\n                        },\n                        {\n                            type: 'lambda',\n                            vars: [elseK],\n                            body: cps(el || FALSE, function (el) {\n                                return {\n                                    type: 'call',\n                                    func: {\n                                        type: 'var',\n                                        name: elseK\n                                    },\n                                    args: [el]\n                                };\n                            })\n                        }\n                    ]\n                };\n            });\n        }\n        function cpsAnd(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(TRUE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    {\n                        type: 'func',\n                        func: 'AND',\n                        args: args.slice(1)\n                    },\n                    FALSE\n                ]\n            }, k);\n        }\n        function cpsOr(args, k) {\n            if (args.length === 0) {\n                return cpsAtom(FALSE, k);\n            }\n            return cps({\n                type: 'func',\n                func: 'IF',\n                args: [\n                    args[0],\n                    TRUE,\n                    {\n                        type: 'func',\n                        func: 'OR',\n                        args: args.slice(1)\n                    }\n                ]\n            }, k);\n        }\n        function cpsFunc(node, k) {\n            switch (node.func.toLowerCase()) {\n            case 'if':\n                return cpsIf(node.args[0], node.args[1], node.args[2], k);\n            case 'and':\n                return cpsAnd(node.args, k);\n            case 'or':\n                return cpsOr(node.args, k);\n            case 'true':\n                return k(TRUE);\n            case 'false':\n                return k(FALSE);\n            }\n            return function loop(args, i) {\n                if (i == node.args.length) {\n                    return {\n                        type: 'func',\n                        func: node.func,\n                        args: args\n                    };\n                } else {\n                    return cps(node.args[i], function (value) {\n                        return loop(args.concat([value]), i + 1);\n                    });\n                }\n            }([makeContinuation(k)], 0);\n        }\n        function cpsLambda(node, k) {\n            var cont = gensym('K');\n            var body = cps(node.body, function (body) {\n                return {\n                    type: 'call',\n                    func: {\n                        type: 'var',\n                        value: cont\n                    },\n                    args: [body]\n                };\n            });\n            return k({\n                type: 'lambda',\n                vars: [cont].concat(node.vars),\n                body: body\n            });\n        }\n        function cpsMatrix(elements, k, isMatrix) {\n            var a = [];\n            return function loop(i) {\n                if (i == elements.length) {\n                    return k({\n                        type: 'matrix',\n                        value: a\n                    });\n                } else {\n                    return (isMatrix ? cpsMatrix : cps)(elements[i], function (val) {\n                        a[i] = val;\n                        return loop(i + 1);\n                    });\n                }\n            }(0);\n        }\n        function makeContinuation(k) {\n            var cont = gensym('R');\n            return {\n                type: 'lambda',\n                vars: [cont],\n                body: k({\n                    type: 'var',\n                    name: cont\n                })\n            };\n        }\n        function gensym(name) {\n            if (!name) {\n                name = '';\n            }\n            name = '_' + name;\n            return name + ++GENSYM;\n        }\n    }\n    var makeClosure = function (cache) {\n        return function (code) {\n            var f = cache[code];\n            if (!f) {\n                f = cache[code] = new Function('\\'use strict\\';return(' + code + ')')();\n            }\n            return f;\n        };\n    }(Object.create(null));\n    var FORMULA_CACHE = Object.create(null);\n    function makeFormula(exp) {\n        var printer = makePrinter(exp);\n        var hash = printer.call(exp);\n        var formula = FORMULA_CACHE[hash];\n        if (formula) {\n            return formula.clone(exp.sheet, exp.row, exp.col);\n        }\n        var code = js(toCPS(exp.ast, function (ret) {\n            return {\n                type: 'return',\n                value: ret\n            };\n        }));\n        code = [\n            'function(){',\n            'var context = this, refs = context.formula.absrefs',\n            code,\n            '}'\n        ].join(';\\n');\n        formula = new runtime.Formula(exp.refs, makeClosure(code), printer, exp.sheet, exp.row, exp.col);\n        FORMULA_CACHE[hash] = formula.clone(exp.sheet, exp.row, exp.col);\n        return formula;\n        function js(node) {\n            var type = node.type;\n            if (type == 'num') {\n                return node.value + '';\n            } else if (type == 'str') {\n                return JSON.stringify(node.value);\n            } else if (type == 'error') {\n                return 'context.error(' + JSON.stringify(node.value) + ')';\n            } else if (type == 'return') {\n                return 'context.resolve(' + js(node.value) + ')';\n            } else if (type == 'func') {\n                return 'context.func(' + JSON.stringify(node.func) + ', ' + js(node.args[0]) + ', ' + jsArray(node.args.slice(1)) + ')';\n            } else if (type == 'call') {\n                return js(node.func) + '(' + node.args.map(js).join(', ') + ')';\n            } else if (type == 'ref') {\n                return 'refs[' + node.index + ']';\n            } else if (type == 'bool') {\n                return '' + node.value;\n            } else if (type == 'if') {\n                return '(context.bool(' + js(node.co) + ') ? ' + js(node.th) + ' : ' + js(node.el) + ')';\n            } else if (type == 'lambda') {\n                return '(function(' + node.vars.join(', ') + '){ return(' + js(node.body) + ') })';\n            } else if (type == 'var') {\n                return node.name;\n            } else if (type == 'matrix') {\n                return jsArray(node.value);\n            } else if (type == 'null') {\n                return 'null';\n            } else {\n                throw new Error('Cannot compile expression ' + type);\n            }\n        }\n        function jsArray(a) {\n            return '[ ' + a.map(js).join(', ') + ' ]';\n        }\n    }\n    function identity(x) {\n        return x;\n    }\n    function TokenStream(input, options) {\n        input = RawTokenStream(InputStream(input), options);\n        var ahead = input.ahead;\n        var skip = input.skip;\n        var token = null;\n        var fixCell = options.row != null && options.col != null ? function (cell) {\n            if (cell.rel & 1) {\n                cell.col -= options.col;\n            }\n            if (cell.rel & 2) {\n                cell.row -= options.row;\n            }\n            return cell;\n        } : identity;\n        var addPos = options.forEditor ? function (thing, startToken, endToken) {\n            thing.begin = startToken.begin;\n            thing.end = endToken.end;\n            return thing;\n        } : identity;\n        return {\n            peek: peek,\n            next: next,\n            croak: input.croak,\n            eof: input.eof,\n            is: is\n        };\n        function is(type, value) {\n            var tok = peek();\n            return tok != null && (type == null || tok.type === type) && (value == null || tok.value === value) ? tok : null;\n        }\n        function peek() {\n            if (token == null) {\n                token = readNext();\n            }\n            return token;\n        }\n        function next() {\n            if (token != null) {\n                var tmp = token;\n                token = null;\n                return tmp;\n            }\n            return readNext();\n        }\n        function readNext() {\n            var ret;\n            var t = input.peek();\n            if (t) {\n                if (t.type == 'sym' || t.type == 'rc' || t.type == 'num') {\n                    ret = ahead(8, refRange3D) || ahead(6, refCell3D) || ahead(6, refSheetRange) || ahead(4, refSheetCell) || ahead(4, refRange) || ahead(2, refCell) || ahead(2, funcall);\n                }\n                if (!ret) {\n                    ret = input.next();\n                }\n            }\n            return ret;\n        }\n        function toCell(tok, isFirst) {\n            if (tok.type == 'rc') {\n                if (tok.rel && !options.forEditor && (options.row == null || options.col == null)) {\n                    input.croak('Cannot read relative cell in RC notation');\n                }\n                return new CellRef(tok.row, tok.col, tok.rel);\n            }\n            if (tok.type == 'num') {\n                if (tok.value <= 1048577) {\n                    return fixCell(new CellRef(getrow(tok.value), isFirst ? -Infinity : +Infinity, 2));\n                } else {\n                    return null;\n                }\n            }\n            var name = tok.value;\n            var m = /^(\\$)?([a-z]+)(\\$)?(\\d+)$/i.exec(name);\n            if (m) {\n                var row = getrow(m[4]), col = getcol(m[2]);\n                if (row <= 1048576 && col <= 16383) {\n                    return fixCell(new CellRef(getrow(m[4]), getcol(m[2]), (m[1] ? 0 : 1) | (m[3] ? 0 : 2)));\n                } else {\n                    return null;\n                }\n            }\n            var abs = name.charAt(0) == '$';\n            if (abs) {\n                name = name.substr(1);\n            }\n            if (/^\\d+$/.test(name)) {\n                var row = getrow(name);\n                if (row <= 1048576) {\n                    return fixCell(new CellRef(getrow(name), isFirst ? -Infinity : +Infinity, abs ? 0 : 2));\n                }\n            } else {\n                var col = getcol(name);\n                if (col <= 16383) {\n                    return fixCell(new CellRef(isFirst ? -Infinity : +Infinity, getcol(name), abs ? 0 : 1));\n                }\n            }\n        }\n        function refRange3D(a, b, c, d, e, f, g, h) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && f.type == 'op' && f.value == ':' && (g.type == 'sym' || g.type == 'rc' || g.type == 'num' && g.value == g.value | 0) && g.type == e.type && !(h.type == 'punc' && h.value == '(' && !g.space)) {\n                var tl = toCell(e, true), br = toCell(g, false);\n                if (tl && br) {\n                    skip(7);\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, g);\n                }\n            }\n        }\n        function refCell3D(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'op' && b.value == ':' && c.type == 'sym' && d.type == 'punc' && d.value == '!' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(e);\n                if (tl) {\n                    skip(5);\n                    var br = tl.clone();\n                    return addPos(new RangeRef(tl.setSheet(a.value, true), br.setSheet(c.value, true)).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetRange(a, b, c, d, e, f) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && d.type == 'op' && d.value == ':' && (e.type == 'sym' || e.type == 'rc' || e.type == 'num' && e.value == e.value | 0) && !(f.type == 'punc' && f.value == '(' && !e.space)) {\n                var tl = toCell(c, true), br = toCell(e, false);\n                if (tl && br) {\n                    skip(5);\n                    return addPos(new RangeRef(tl, br).setSheet(a.value, true), a, e);\n                }\n            }\n        }\n        function refSheetCell(a, b, c, d) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '!' && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                skip(3);\n                var x = toCell(c);\n                if (!x || !isFinite(x.row)) {\n                    x = new NameRef(c.value);\n                }\n                return addPos(x.setSheet(a.value, true), a, c);\n            }\n        }\n        function refRange(a, b, c, d) {\n            if ((a.type == 'sym' || a.type == 'rc' || a.type == 'num' && a.value == a.value | 0) && (b.type == 'op' && b.value == ':') && (c.type == 'sym' || c.type == 'rc' || c.type == 'num' && c.value == c.value | 0) && !(d.type == 'punc' && d.value == '(' && !c.space)) {\n                var tl = toCell(a, true), br = toCell(c, false);\n                if (tl && br) {\n                    skip(3);\n                    return addPos(new RangeRef(tl, br), a, c);\n                }\n            }\n        }\n        function refCell(a, b) {\n            if ((a.type == 'sym' || a.type == 'rc') && !(b.type == 'punc' && b.value == '(' && !a.space)) {\n                var x = toCell(a);\n                if (x && isFinite(x.row) && isFinite(x.col)) {\n                    skip(1);\n                    return addPos(x, a, a);\n                }\n            }\n        }\n        function funcall(a, b) {\n            if (a.type == 'sym' && b.type == 'punc' && b.value == '(' && !a.space) {\n                a.type = 'func';\n                skip(1);\n                return a;\n            }\n        }\n    }\n    function isWhitespace(ch) {\n        return ' \\t\\n\\xA0\\u200B'.indexOf(ch) >= 0;\n    }\n    function RawTokenStream(input, options) {\n        var tokens = [], index = 0;\n        var readWhile = input.readWhile;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: input.croak,\n            ahead: ahead,\n            skip: skip\n        };\n        function isDigit(ch) {\n            return /[0-9]/i.test(ch);\n        }\n        function isIdStart(ch) {\n            return /[a-z$_]/i.test(ch) || util.isUnicodeLetter(ch);\n        }\n        function isId(ch) {\n            return isIdStart(ch) || isDigit(ch) || ch == '.';\n        }\n        function isOpChar(ch) {\n            return ch in OPERATORS;\n        }\n        function isPunc(ch) {\n            return '!;(){}[]'.indexOf(ch) >= 0;\n        }\n        function readNumber() {\n            var has_dot = false;\n            var number = readWhile(function (ch) {\n                if (ch == '.') {\n                    if (has_dot) {\n                        return false;\n                    }\n                    has_dot = true;\n                    return true;\n                }\n                return isDigit(ch);\n            });\n            return {\n                type: 'num',\n                value: parseFloat(number)\n            };\n        }\n        function symbol(id, quote) {\n            return {\n                type: 'sym',\n                value: id,\n                upper: id.toUpperCase(),\n                space: isWhitespace(input.peek()),\n                quote: quote\n            };\n        }\n        function getRC(a, b, c) {\n            if (!a && !b && !c) {\n                return null;\n            }\n            if (!a && !c || a && c) {\n                var num = b ? parseInt(b, 10) : 0;\n                return a ? num : num - 1;\n            }\n        }\n        function readSymbol() {\n            var m = input.lookingAt(/^R(\\[)?(-?[0-9]+)?(\\])?C(\\[)?(-?[0-9]+)?(\\])?/i);\n            if (m) {\n                var row = getRC(m[1], m[2], m[3]);\n                var col = getRC(m[4], m[5], m[6]);\n                if (row != null && col != null) {\n                    input.skip(m);\n                    return {\n                        type: 'rc',\n                        row: row,\n                        col: col,\n                        rel: (m[4] || !(m[4] || m[5] || m[6]) ? 1 : 0) | (m[1] || !(m[1] || m[2] || m[3]) ? 2 : 0)\n                    };\n                }\n            }\n            return symbol(readWhile(isId));\n        }\n        function readString() {\n            input.next();\n            return {\n                type: 'str',\n                value: input.readEscaped('\"')\n            };\n        }\n        function readSheetName() {\n            input.next();\n            return symbol(input.readEscaped('\\''), true);\n        }\n        function readOperator() {\n            return {\n                type: 'op',\n                value: readWhile(function (ch, op) {\n                    return op + ch in OPERATORS;\n                })\n            };\n        }\n        function readPunc() {\n            return {\n                type: 'punc',\n                value: input.next()\n            };\n        }\n        function readNext() {\n            if (input.eof()) {\n                return null;\n            }\n            var ch = input.peek(), m;\n            if (ch == '\"') {\n                return readString();\n            }\n            if (ch == '\\'') {\n                return readSheetName();\n            }\n            if (isDigit(ch) || ch == '.') {\n                return readNumber();\n            }\n            if (isIdStart(ch)) {\n                return readSymbol();\n            }\n            if (isOpChar(ch)) {\n                return readOperator();\n            }\n            if (isPunc(ch)) {\n                return readPunc();\n            }\n            if (m = input.lookingAt(/^#([a-z\\/]+)[?!]?/i)) {\n                input.skip(m);\n                return {\n                    type: 'error',\n                    value: m[1]\n                };\n            }\n            if (!options.forEditor) {\n                input.croak('Can\\'t handle character: ' + ch);\n            }\n            return {\n                type: 'error',\n                value: input.next()\n            };\n        }\n        function peek() {\n            while (tokens.length <= index) {\n                readWhile(isWhitespace);\n                var begin = input.pos();\n                var tok = readNext();\n                if (options.forEditor && tok) {\n                    tok.begin = begin;\n                    tok.end = input.pos();\n                }\n                tokens.push(tok);\n            }\n            return tokens[index];\n        }\n        function next() {\n            var tok = peek();\n            if (tok) {\n                index++;\n            }\n            return tok;\n        }\n        function ahead(n, f) {\n            var pos = index, a = [];\n            while (n-- > 0) {\n                a.push(next() || EOF);\n            }\n            index = pos;\n            return f.apply(a, a);\n        }\n        function skip(n) {\n            index += n;\n        }\n        function eof() {\n            return peek() == null;\n        }\n    }\n    var EOF = { type: 'eof' };\n    function InputStream(input) {\n        var pos = 0, line = 1, col = 0;\n        return {\n            next: next,\n            peek: peek,\n            eof: eof,\n            croak: croak,\n            readWhile: readWhile,\n            readEscaped: readEscaped,\n            lookingAt: lookingAt,\n            skip: skip,\n            forward: forward,\n            pos: location\n        };\n        function location() {\n            return pos;\n        }\n        function next() {\n            var ch = input.charAt(pos++);\n            if (ch == '\\n') {\n                line++;\n                col = 0;\n            } else {\n                col++;\n            }\n            return ch;\n        }\n        function peek() {\n            return input.charAt(pos);\n        }\n        function eof() {\n            return peek() === '';\n        }\n        function croak(msg) {\n            throw new ParseError(msg + ' (input: ' + input + ')', pos);\n        }\n        function skip(ch) {\n            if (typeof ch == 'string') {\n                if (input.substr(pos, ch.length) != ch) {\n                    croak('Expected ' + ch);\n                }\n                forward(ch.length);\n            } else if (ch instanceof RegExp) {\n                var m = ch.exec(input.substr(pos));\n                if (m) {\n                    forward(m[0].length);\n                    return m;\n                }\n            } else {\n                forward(ch[0].length);\n            }\n        }\n        function forward(n) {\n            while (n-- > 0) {\n                next();\n            }\n        }\n        function readEscaped(end) {\n            var escaped = false, str = '';\n            while (!eof()) {\n                var ch = next();\n                if (escaped) {\n                    str += ch;\n                    escaped = false;\n                } else if (ch == '\\\\') {\n                    escaped = true;\n                } else if (ch == end) {\n                    break;\n                } else {\n                    str += ch;\n                }\n            }\n            return str;\n        }\n        function readWhile(predicate) {\n            var str = '';\n            while (!eof() && predicate(peek(), str)) {\n                str += next();\n            }\n            return str;\n        }\n        function lookingAt(rx) {\n            return rx.exec(input.substr(pos));\n        }\n    }\n    var FORMAT_PARSERS = [];\n    var registerFormatParser = exports.registerFormatParser = function (p) {\n        FORMAT_PARSERS.push(p);\n    };\n    exports.parse = function (sheet, row, col, input, format) {\n        if (input instanceof Date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(input)\n            };\n        }\n        if (typeof input == 'number') {\n            return {\n                type: 'number',\n                value: input\n            };\n        }\n        if (typeof input == 'boolean') {\n            return {\n                type: 'boolean',\n                value: input\n            };\n        }\n        input += '';\n        if (/^'/.test(input)) {\n            return {\n                type: 'string',\n                value: input.substr(1)\n            };\n        }\n        if (/^[0-9.]+%$/.test(input)) {\n            var str = input.substr(0, input.length - 1);\n            var num = parseFloat(str);\n            if (!isNaN(num) && num == str) {\n                return {\n                    type: 'percent',\n                    value: num / 100\n                };\n            }\n        }\n        if (/^=/.test(input)) {\n            input = input.substr(1);\n            if (/\\S/.test(input)) {\n                return parseFormula(sheet, row, col, input);\n            } else {\n                return {\n                    type: 'string',\n                    value: '=' + input\n                };\n            }\n        }\n        for (var i = 0; i < FORMAT_PARSERS.length; ++i) {\n            var result = FORMAT_PARSERS[i](input);\n            if (result) {\n                return result;\n            }\n        }\n        if (input.toLowerCase() == 'true') {\n            return {\n                type: 'boolean',\n                value: true\n            };\n        }\n        if (input.toLowerCase() == 'false') {\n            return {\n                type: 'boolean',\n                value: false\n            };\n        }\n        var date = runtime.parseDate(input, format);\n        if (date) {\n            return {\n                type: 'date',\n                value: runtime.dateToSerial(date)\n            };\n        }\n        var num = parseFloat(input);\n        if (!isNaN(num) && input.length > 0 && num == input) {\n            return {\n                type: 'number',\n                value: num\n            };\n        }\n        return {\n            type: 'string',\n            value: input\n        };\n    };\n    function tokenize(input, row, col) {\n        var tokens = [];\n        input = TokenStream(input, {\n            forEditor: true,\n            row: row,\n            col: col\n        });\n        while (!input.eof()) {\n            tokens.push(next());\n        }\n        var tok = tokens[0];\n        if (tok.type == 'op' && tok.value == '=') {\n            tok.type = 'startexp';\n        }\n        return tokens;\n        function next() {\n            var tok = input.next();\n            if (tok.type == 'sym') {\n                if (tok.upper == 'TRUE') {\n                    tok.type = 'bool';\n                    tok.value = true;\n                } else if (tok.upper == 'FALSE') {\n                    tok.type = 'bool';\n                    tok.value = false;\n                }\n            } else if (tok.type == 'ref') {\n                tok = {\n                    type: 'ref',\n                    ref: row != null && col != null ? tok.absolute(row, col) : tok,\n                    begin: tok.begin,\n                    end: tok.end\n                };\n            }\n            return tok;\n        }\n    }\n    function parseSqref(input, row, col) {\n        row = row || 0;\n        col = col || 0;\n        input = TokenStream(input, {\n            row: row,\n            col: col\n        });\n        var refs = [];\n        while (!input.eof()) {\n            var ref = input.next();\n            if (ref.type != 'ref') {\n                throw new ParseError('Expecting a reference but got: ' + JSON.stringify(ref));\n            }\n            refs.push(ref.absolute(row, col));\n        }\n        return refs;\n    }\n    exports.parseNameDefinition = parseNameDefinition;\n    exports.parseFormula = parseFormula;\n    exports.parseReference = parseReference;\n    exports.compile = makeFormula;\n    exports.parseSqref = parseSqref;\n    exports.InputStream = InputStream;\n    exports.ParseError = ParseError;\n    exports.tokenize = tokenize;\n    registerFormatParser(function (input) {\n        var m;\n        if (m = /^(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            return {\n                type: 'date',\n                format: 'hh:mm',\n                value: runtime.packTime(hh, mm, 0, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var mm = parseInt(m[1], 10);\n            var ss = parseInt(m[2], 10);\n            var ms = parseFloat(m[3]) * 1000;\n            return {\n                type: 'date',\n                format: 'mm:ss.00',\n                value: runtime.packTime(0, mm, ss, ms)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            return {\n                type: 'date',\n                format: 'hh:mm:ss',\n                value: runtime.packTime(hh, mm, ss, 0)\n            };\n        }\n        if (m = /^(\\d+):(\\d+):(\\d+)(\\.\\d+)$/.exec(input)) {\n            var hh = parseInt(m[1], 10);\n            var mm = parseInt(m[2], 10);\n            var ss = parseInt(m[3], 10);\n            var ms = parseFloat(m[4]) * 1000;\n            return {\n                type: 'date',\n                format: 'hh:mm:ss.00',\n                value: runtime.packTime(hh, mm, ss, ms)\n            };\n        }\n    });\n    registerFormatParser(function (input) {\n        var m, n;\n        var culture = kendo.culture();\n        var comma = culture.numberFormat[','];\n        var dot = culture.numberFormat['.'];\n        var currency = culture.numberFormat.currency.symbol;\n        var rxnum = getNumberRegexp(comma, dot);\n        var rxcur = new RegExp('^\\\\s*\\\\' + currency + '\\\\s*');\n        var sign = 1;\n        var format = '';\n        var suffix = '';\n        var has_currency = false;\n        input = InputStream(input.replace(/^\\s+|\\s+$/g, ''));\n        if (input.skip(/^-\\s*/)) {\n            sign = -1;\n        }\n        if (m = input.skip(rxcur)) {\n            has_currency = true;\n            format += '\"' + m[0] + '\"';\n        }\n        if (input.skip(/^-\\s*/)) {\n            if (sign < 0) {\n                return null;\n            }\n            sign = -1;\n        }\n        if (!(n = input.skip(rxnum))) {\n            return null;\n        }\n        format += '#';\n        if (m = input.skip(rxcur)) {\n            if (has_currency) {\n                return null;\n            }\n            has_currency = true;\n            suffix = '\"' + m[0] + '\"';\n        }\n        if (!input.eof()) {\n            return null;\n        }\n        if (n[2] || has_currency) {\n            format += ',#';\n        }\n        if (n[3]) {\n            format += '.' + repeat('0', n[3].length - 1);\n        }\n        var value = n[0].replace(new RegExp('\\\\' + comma, 'g'), '').replace(new RegExp('\\\\' + dot, 'g'), '.');\n        format += suffix;\n        if (has_currency) {\n            format += ';-' + format;\n        }\n        return {\n            type: 'number',\n            currency: has_currency,\n            format: format,\n            value: sign * parseFloat(value)\n        };\n    });\n    var NUMBER_FORMAT_RX = {};\n    function getNumberRegexp(comma, dot) {\n        var id = comma + dot;\n        var rx = NUMBER_FORMAT_RX[id];\n        if (!rx) {\n            rx = '^(\\\\d+(COM\\\\d{3})*(DOT\\\\d+)?)';\n            rx = rx.replace(/DOT/g, '\\\\' + dot).replace(/COM/g, '\\\\' + comma);\n            rx = new RegExp(rx);\n            NUMBER_FORMAT_RX[id] = rx;\n        }\n        return rx;\n    }\n    function repeat(str, len) {\n        var out = '';\n        while (len-- > 0) {\n            out += str;\n        }\n        return out;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/excel-reader', [\n        'kendo.core',\n        'kendo.color',\n        'util/parse-xml',\n        'spreadsheet/calc'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var $ = kendo.jQuery;\n    var parseXML = kendo.util.parseXML;\n    var parseReference = kendo.spreadsheet.calc.parseReference;\n    var MAP_EXCEL_OPERATOR = {\n        greaterThanOrEqual: 'greaterThanOrEqualTo',\n        lessThanOrEqual: 'lessThanOrEqualTo'\n    };\n    var ERROR_LOG = null;\n    function readExcel(file, workbook, deferred) {\n        var reader = new FileReader();\n        reader.onload = function (e) {\n            var zip = new JSZip(e.target.result);\n            readWorkbook(zip, workbook, deferred);\n        };\n        reader.readAsArrayBuffer(file);\n    }\n    var SEL_CELL = [\n        'sheetData',\n        'row',\n        'c'\n    ];\n    var SEL_COL = [\n        'cols',\n        'col'\n    ];\n    var SEL_DEFINED_NAME = [\n        'definedNames',\n        'definedName'\n    ];\n    var SEL_FORMULA = [\n        'sheetData',\n        'row',\n        'c',\n        'f'\n    ];\n    var SEL_MERGE = [\n        'mergeCells',\n        'mergeCell'\n    ];\n    var SEL_PANE = [\n        'sheetViews',\n        'sheetView',\n        'pane'\n    ];\n    var SEL_ROW = [\n        'sheetData',\n        'row'\n    ];\n    var SEL_SELECTION = [\n        'sheetViews',\n        'sheetView',\n        'selection'\n    ];\n    var SEL_SHEET = [\n        'sheets',\n        'sheet'\n    ];\n    var SEL_STRING = [\n        'sheetData',\n        'row',\n        'c',\n        'is'\n    ];\n    var SEL_TEXT = ['t'];\n    var SEL_SHARED_STRING = ['si'];\n    var SEL_VALUE = [\n        'sheetData',\n        'row',\n        'c',\n        'v'\n    ];\n    var SEL_VIEW = [\n        'bookViews',\n        'workbookView'\n    ];\n    var SEL_SHEET_VIEW = [\n        'sheetViews',\n        'sheetView'\n    ];\n    var SEL_HYPERLINK = [\n        'hyperlinks',\n        'hyperlink'\n    ];\n    var SEL_VALIDATION = [\n        'dataValidations',\n        'dataValidation'\n    ];\n    var SEL_VALIDATION_FORMULA1 = [\n        'dataValidations',\n        'dataValidation',\n        'formula1'\n    ];\n    var SEL_VALIDATION_FORMULA2 = [\n        'dataValidations',\n        'dataValidation',\n        'formula2'\n    ];\n    function xl(file) {\n        if (!/^\\//.test(file)) {\n            file = 'xl/' + file;\n        } else {\n            file = file.substr(1);\n        }\n        return file;\n    }\n    function readWorkbook(zip, workbook, progress) {\n        ERROR_LOG = workbook.excelImportErrors = [];\n        var strings = readStrings(zip);\n        var relationships = readRelationships(zip, '_rels/workbook.xml');\n        var theme = readTheme(zip, relationships.byType.theme[0]);\n        var styles = readStyles(zip, theme);\n        var items = [];\n        var activeSheet = 0;\n        parse(zip, 'xl/workbook.xml', {\n            enter: function (tag, attrs) {\n                if (this.is(SEL_SHEET)) {\n                    var relId = attrs['r:id'];\n                    var file = relationships.byId[relId];\n                    var name = attrs.name;\n                    var dim = sheetDimensions(zip, file);\n                    items.push({\n                        workbook: workbook,\n                        zip: zip,\n                        strings: strings,\n                        styles: styles,\n                        file: file,\n                        options: {\n                            name: name,\n                            rows: Math.max(workbook.options.rows || 0, dim.rows),\n                            columns: Math.max(workbook.options.columns || 0, dim.cols),\n                            columnWidth: dim.columnWidth,\n                            rowHeight: dim.rowHeight\n                        }\n                    });\n                } else if (this.is(SEL_VIEW)) {\n                    if (attrs.activeTab) {\n                        activeSheet = integer(attrs.activeTab);\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs = this.is(SEL_DEFINED_NAME);\n                if (attrs && !(bool(attrs['function']) || bool(attrs.vbProcedure))) {\n                    var localSheetId = attrs.localSheetId;\n                    var sheet = null;\n                    if (localSheetId != null) {\n                        sheet = items[localSheetId].options.name;\n                    }\n                    var name = attrs.name;\n                    if (sheet) {\n                        name = '\\'' + sheet.replace(/\\'/g, '\\\\\\'') + '\\'!' + name;\n                    }\n                    withErrorLog(sheet, null, function () {\n                        workbook.defineName(name, text, bool(attrs.hidden));\n                    }, 'reading user-defined name: ' + name);\n                }\n            }\n        });\n        var loading = new $.Deferred();\n        loading.progress(function (args) {\n            if (progress) {\n                progress.notify(args);\n            }\n        }).then(function () {\n            var sheets = workbook.sheets();\n            recalcSheets(sheets);\n            workbook.activeSheet(sheets[activeSheet]);\n            if (progress) {\n                progress.resolve();\n            }\n        });\n        loadSheets(items, workbook, loading);\n    }\n    function loadSheets(items, workbook, progress) {\n        var ready = new $.Deferred().resolve();\n        for (var i = 0; i < items.length; i++) {\n            (function (entry, i) {\n                ready = ready.then(function () {\n                    var sheet = workbook.insertSheet(entry.options);\n                    sheet.suspendChanges(true);\n                    var promise = queueSheet(sheet, entry);\n                    var args = {\n                        sheet: sheet,\n                        progress: i / (items.length - 1)\n                    };\n                    promise.then(function () {\n                        progress.notify(args);\n                    });\n                    return promise;\n                });\n            }(items[i], i));\n        }\n        ready.then(function () {\n            progress.resolve();\n        });\n    }\n    function queueSheet(sheet, ctx) {\n        var deferred = new $.Deferred();\n        setTimeout(function () {\n            readSheet(ctx.zip, ctx.file, sheet, ctx.strings, ctx.styles);\n            deferred.resolve();\n        }, 0);\n        return deferred;\n    }\n    function recalcSheets(sheets) {\n        for (var i = 0; i < sheets.length; i++) {\n            sheets[i].suspendChanges(false).triggerChange({ recalc: true });\n        }\n    }\n    function sheetDimensions(zip, file) {\n        var dim = {\n            rows: 0,\n            cols: 0\n        };\n        parse(zip, xl(file), {\n            enter: function (tag, attrs) {\n                if (tag == 'dimension') {\n                    var ref = parseReference(attrs.ref);\n                    if (ref.bottomRight) {\n                        dim.cols = ref.bottomRight.col + 1;\n                        dim.rows = ref.bottomRight.row + 1;\n                    }\n                } else if (tag === 'sheetFormatPr') {\n                    if (attrs.defaultColWidth) {\n                        dim.columnWidth = toColWidth(parseFloat(attrs.defaultColWidth));\n                    }\n                    if (attrs.defaultRowHeight) {\n                        dim.rowHeight = toRowHeight(parseFloat(attrs.defaultRowHeight));\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    this.exit();\n                }\n            }\n        });\n        return dim;\n    }\n    function toColWidth(size) {\n        var maximumDigitWidth = 7;\n        var fraction = (256 * size + Math.floor(128 / maximumDigitWidth)) / 256;\n        return Math.floor(fraction) * maximumDigitWidth;\n    }\n    function toRowHeight(pts) {\n        return pts * 1.5625;\n    }\n    function readSheet(zip, file, sheet, strings, styles) {\n        var ref, type, value, formula, formulaRange;\n        var nCols = sheet._columns._count;\n        var prevCellRef = null;\n        var relsFile = file.replace(/worksheets\\//, 'worksheets/_rels/');\n        var relationships = readRelationships(zip, relsFile);\n        var formula1, formula2;\n        var filterRef;\n        var filterColumn;\n        var customFilterLogic;\n        var customFilterCriteria;\n        var valueFilterBlanks;\n        var valueFilterValues;\n        var filters = [];\n        ERROR_LOG = sheet._workbook.excelImportErrors;\n        parse(zip, xl(file), {\n            enter: function (tag, attrs) {\n                var tmp;\n                if (this.is(SEL_CELL)) {\n                    value = null;\n                    formula = null;\n                    formulaRange = null;\n                    ref = attrs.r;\n                    if (ref == null) {\n                        ref = parseReference(prevCellRef);\n                        ref.col++;\n                        ref = ref.toString();\n                    }\n                    prevCellRef = ref;\n                    type = attrs.t;\n                    var styleIndex = attrs.s;\n                    if (styleIndex != null) {\n                        applyStyle(sheet, ref, styles, styleIndex);\n                    }\n                } else if (this.is(SEL_MERGE)) {\n                    sheet.range(attrs.ref).merge();\n                } else if (this.is(SEL_COL)) {\n                    var start = integer(attrs.min) - 1;\n                    var stop = Math.min(nCols, integer(attrs.max)) - 1;\n                    var width;\n                    if (attrs.width) {\n                        width = toColWidth(parseFloat(attrs.width));\n                        if (width !== 0) {\n                            sheet._columns.values.value(start, stop, width);\n                        }\n                    }\n                    if (attrs.hidden === '1' || width === 0) {\n                        for (var ci = start; ci <= stop; ci++) {\n                            sheet.hideColumn(ci);\n                        }\n                    }\n                    if (attrs.style != null) {\n                        applyStyle(sheet, new kendo.spreadsheet.RangeRef(new kendo.spreadsheet.CellRef(-Infinity, start), new kendo.spreadsheet.CellRef(+Infinity, stop)), styles, attrs.style);\n                    }\n                } else if (this.is(SEL_ROW)) {\n                    var row = integer(attrs.r) - 1;\n                    var height;\n                    if (attrs.ht) {\n                        height = toRowHeight(parseFloat(attrs.ht));\n                        if (height !== 0) {\n                            sheet._rows.values.value(row, row, height);\n                        }\n                    }\n                    if (attrs.hidden === '1' || height === 0) {\n                        sheet.hideRow(row);\n                    }\n                } else if (this.is(SEL_SELECTION)) {\n                    if (attrs.activeCell) {\n                        var acRef = parseReference(attrs.activeCell);\n                        sheet.select(acRef, true);\n                    }\n                } else if (this.is(SEL_PANE)) {\n                    if (attrs.state == 'frozen') {\n                        if (attrs.xSplit) {\n                            sheet.frozenColumns(integer(attrs.xSplit));\n                        }\n                        if (attrs.ySplit) {\n                            sheet.frozenRows(integer(attrs.ySplit));\n                        }\n                    }\n                } else if (this.is(SEL_SHEET_VIEW)) {\n                    sheet.showGridLines(bool(attrs.showGridLines, true));\n                } else if (this.is(SEL_HYPERLINK)) {\n                    var relId = attrs['r:id'];\n                    var target = relationships.byId[relId];\n                    if (target) {\n                        sheet.range(attrs.ref).link(target);\n                    }\n                } else if (this.is(['autoFilter'])) {\n                    filterRef = attrs.ref;\n                } else if (filterRef) {\n                    if (this.is(['filterColumn'])) {\n                        filterColumn = parseInt(attrs.colId, 10);\n                    } else if (this.is(['customFilters'])) {\n                        customFilterLogic = bool(attrs.and) ? 'and' : 'or';\n                        customFilterCriteria = [];\n                    } else if (this.is(['customFilter'])) {\n                        tmp = getCustomFilter(attrs.operator, attrs.val);\n                        if (tmp) {\n                            customFilterCriteria.push({\n                                operator: tmp.operator,\n                                value: tmp.value\n                            });\n                        }\n                    } else if (this.is(['dynamicFilter'])) {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.DynamicFilter({ type: dynamicFilterType(attrs.type) })\n                        });\n                    } else if (this.is(['top10'])) {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.TopFilter({\n                                value: getFilterVal(attrs.val),\n                                type: function (percent, top) {\n                                    return percent && top ? 'topPercent' : top ? 'topNumber' : percent ? 'bottomPercent' : 'bottomNumber';\n                                }(bool(attrs.percent), bool(attrs.top))\n                            })\n                        });\n                    } else if (this.is(['filters'])) {\n                        valueFilterBlanks = bool(attrs.blank);\n                        valueFilterValues = [];\n                    } else if (this.is(['filter'])) {\n                        valueFilterValues.push(getFilterVal(attrs.val));\n                    }\n                }\n            },\n            leave: function (tag, attrs) {\n                if (this.is(SEL_CELL)) {\n                    if (formula != null) {\n                        var failed = withErrorLog(sheet, formulaRange || ref, function () {\n                            sheet.range(formulaRange || ref).formula(formula);\n                        }, 'parsing formula');\n                        if (failed) {\n                            sheet.range(formulaRange || ref).value(formula).background('#ffaaaa');\n                        }\n                    } else if (value != null) {\n                        var range = sheet.range(ref);\n                        if (!range._get('formula')) {\n                            if (!type || type == 'n') {\n                                value = parseFloat(value);\n                            } else if (type == 's') {\n                                value = strings[integer(value)];\n                            } else if (type == 'b') {\n                                value = value === '1';\n                            } else if (type == 'd') {\n                                value = kendo.parseDate(value);\n                            }\n                            if (value != null) {\n                                range.value(value);\n                            }\n                        }\n                    }\n                } else if (this.is(SEL_VALIDATION)) {\n                    (function () {\n                        var refs = kendo.spreadsheet.calc.parseSqref(attrs.sqref);\n                        var type = attrs.type.toLowerCase();\n                        var operator = attrs.operator;\n                        if (/^(?:whole|decimal)$/.test(type)) {\n                            type = 'number';\n                        } else if (type == 'list') {\n                            operator = 'list';\n                        }\n                        if (!operator && /^(?:number|date)$/.test(type)) {\n                            operator = 'between';\n                        }\n                        refs.forEach(function (ref) {\n                            withErrorLog(sheet, ref, function () {\n                                sheet.range(ref).validation({\n                                    type: bool(attrs.showErrorMessage, true) ? 'reject' : 'warning',\n                                    from: formula1,\n                                    to: formula2,\n                                    dataType: type,\n                                    comparerType: MAP_EXCEL_OPERATOR[operator] || operator,\n                                    allowNulls: bool(attrs.allowBlank),\n                                    showButton: bool(attrs.showDropDown) || type == 'date' || type == 'list',\n                                    messageTemplate: attrs.error,\n                                    titleTemplate: attrs.errorTitle\n                                });\n                            }, 'parsing validation');\n                        });\n                    }());\n                } else if (tag == 'cols') {\n                    sheet._columns._refresh();\n                } else if (tag == 'sheetData') {\n                    sheet._rows._refresh();\n                } else if (tag == 'autoFilter') {\n                    sheet.range(filterRef).filter(filters);\n                    filterRef = null;\n                } else if (filterRef) {\n                    if (tag == 'customFilters') {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.CustomFilter({\n                                logic: customFilterLogic,\n                                criteria: customFilterCriteria\n                            })\n                        });\n                    } else if (tag == 'filters') {\n                        filters.push({\n                            column: filterColumn,\n                            filter: new kendo.spreadsheet.ValueFilter({\n                                values: valueFilterValues,\n                                blanks: valueFilterBlanks\n                            })\n                        });\n                    }\n                }\n            },\n            text: function (text) {\n                var attrs;\n                if (this.is(SEL_VALUE) || this.is(SEL_STRING)) {\n                    value = text;\n                } else if (attrs = this.is(SEL_FORMULA)) {\n                    formula = text;\n                    if (attrs.t == 'shared') {\n                        formulaRange = attrs.ref;\n                    }\n                } else if (this.is(SEL_VALIDATION_FORMULA1)) {\n                    formula1 = text;\n                } else if (this.is(SEL_VALIDATION_FORMULA2)) {\n                    formula2 = text;\n                }\n            }\n        });\n    }\n    function getCustomFilter(op, value) {\n        var ourOp = {\n            equal: 'eq',\n            notEqual: 'ne',\n            greaterThan: 'gt',\n            greaterThanOrEqual: 'gte',\n            lessThan: 'lt',\n            lessThanOrEqual: 'lte'\n        }[op];\n        value = getFilterVal(value);\n        if (ourOp && typeof value == 'number') {\n            return {\n                operator: ourOp,\n                value: value\n            };\n        }\n        if ((op == 'notEqual' || !op) && typeof value == 'string') {\n            return {\n                operator: op ? 'doesnotmatch' : 'matches',\n                value: value\n            };\n        }\n    }\n    function dynamicFilterType(type) {\n        return {\n            Q1: 'quarter1',\n            Q2: 'quarter2',\n            Q3: 'quarter3',\n            Q4: 'quarter4',\n            M1: 'january',\n            M2: 'february',\n            M3: 'march',\n            M4: 'april',\n            M5: 'may',\n            M6: 'june',\n            M7: 'july',\n            M8: 'august',\n            M9: 'september',\n            M10: 'october',\n            M11: 'november',\n            M12: 'december'\n        }[type.toUpperCase()] || type;\n    }\n    function getFilterVal(val) {\n        var tmp = parseFloat(val);\n        if (!isNaN(tmp) && tmp == val) {\n            return tmp;\n        }\n        return val;\n    }\n    function withErrorLog(sheet, ref, func, context) {\n        try {\n            func();\n            return false;\n        } catch (ex) {\n            var err = {\n                context: context,\n                error: String(ex)\n            };\n            if (sheet) {\n                err.sheet = sheet.name();\n            }\n            if (ref) {\n                err.location = String(ref);\n            }\n            ERROR_LOG.push(err);\n            return true;\n        }\n    }\n    var BORDER_WIDTHS = {\n        'none': 0,\n        'thin': 1,\n        'medium': 2,\n        'dashed': 1,\n        'dotted': 1,\n        'thick': 3,\n        'double': 3,\n        'hair': 1,\n        'mediumDashed': 2,\n        'dashDot': 1,\n        'mediumDashDot': 2,\n        'dashDotDot': 1,\n        'mediumDashDotDot': 2,\n        'slantDashDot': 1\n    };\n    var DEFAULT_FORMATS = {\n        0: 'General',\n        1: '0',\n        2: '0.00',\n        3: '#,##0',\n        4: '#,##0.00',\n        9: '0%',\n        10: '0.00%',\n        11: '0.00E+00',\n        12: '# ?/?',\n        13: '# ??/??',\n        14: 'mm-dd-yy',\n        15: 'd-mmm-yy',\n        16: 'd-mmm',\n        17: 'mmm-yy',\n        18: 'h:mm AM/PM',\n        19: 'h:mm:ss AM/PM',\n        20: 'h:mm',\n        21: 'h:mm:ss',\n        22: 'm/d/yy h:mm',\n        37: '#,##0 ;(#,##0)',\n        38: '#,##0 ;[Red](#,##0)',\n        39: '#,##0.00;(#,##0.00)',\n        40: '#,##0.00;[Red](#,##0.00)',\n        45: 'mm:ss',\n        46: '[h]:mm:ss',\n        47: 'mmss.0',\n        48: '##0.0E+0',\n        49: '@'\n    };\n    function applyStyle(sheet, ref, styles, styleIndex) {\n        var range = sheet.range(ref);\n        var xf = styles.inlineStyles[styleIndex], base, value;\n        if (xf.xfId) {\n            base = styles.namedStyles[xf.xfId];\n        }\n        if (shouldSet('applyBorder', 'borderId')) {\n            setBorder(styles.borders[value]);\n        }\n        if (shouldSet('applyFont', 'fontId')) {\n            setFont(styles.fonts[value]);\n        }\n        if (shouldSet('applyAlignment', 'textAlign')) {\n            range.textAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'verticalAlign')) {\n            range.verticalAlign(value);\n        }\n        if (shouldSet('applyAlignment', 'wrapText')) {\n            range._property('wrap', value);\n        }\n        if (shouldSet('applyFill', 'fillId')) {\n            setFill(styles.fills[value]);\n        }\n        if (shouldSet('applyNumberFormat', 'numFmtId')) {\n            setFormat(styles.numFmts[value] || DEFAULT_FORMATS[value]);\n        }\n        function setFormat(f) {\n            var format = typeof f == 'string' ? f : f.formatCode;\n            if (format != null && !/^general$/i.test(format)) {\n                format = format.replace(/^\\[\\$-[0-9]+\\]/, '');\n                range.format(format);\n            }\n        }\n        function setFill(f) {\n            if (f.type == 'solid') {\n                range.background(f.color);\n            }\n        }\n        function setFont(f) {\n            range.fontFamily(f.name);\n            range._property('fontSize', f.size);\n            if (f.bold) {\n                range.bold(true);\n            }\n            if (f.italic) {\n                range.italic(true);\n            }\n        }\n        function setBorder(b) {\n            function set(side, prop) {\n                var border = b[side];\n                if (!border) {\n                    return;\n                }\n                var width = BORDER_WIDTHS[border.style];\n                if (width === 0) {\n                    return;\n                }\n                var color = border.color;\n                if (color == null) {\n                    color = '#000';\n                }\n                range._property(prop, {\n                    size: width,\n                    color: color\n                });\n            }\n            set('left', 'borderLeft');\n            set('top', 'borderTop');\n            set('right', 'borderRight');\n            set('bottom', 'borderBottom');\n        }\n        function shouldSet(applyName, propName) {\n            var t = xf[applyName];\n            if (t != null && !t) {\n                return false;\n            }\n            value = xf[propName];\n            if (base && value == null) {\n                t = base[applyName];\n                if (t != null && !t) {\n                    return false;\n                }\n                value = base[propName];\n            }\n            return value != null;\n        }\n    }\n    function parse(zip, file, callbacks) {\n        var part = zip.files[file];\n        if (part) {\n            parseXML(part.asUint8Array(), callbacks);\n        }\n    }\n    function readStrings(zip) {\n        var strings = [];\n        var current = null;\n        parse(zip, 'xl/sharedStrings.xml', {\n            leave: function () {\n                if (this.is(SEL_SHARED_STRING)) {\n                    strings.push(current);\n                    current = null;\n                }\n            },\n            text: function (text) {\n                if (this.is(SEL_TEXT)) {\n                    if (current == null) {\n                        current = '';\n                    }\n                    current += text;\n                }\n            }\n        });\n        return strings;\n    }\n    function readRelationships(zip, file) {\n        var map = {\n            byId: {},\n            byType: { theme: [] }\n        };\n        parse(zip, xl(file) + '.rels', {\n            enter: function (tag, attrs) {\n                if (tag == 'Relationship') {\n                    map.byId[attrs.Id] = attrs.Target;\n                    var type = attrs.Type.match(/\\w+$/)[0];\n                    var entries = map.byType[type] || [];\n                    entries.push(attrs.Target);\n                    map.byType[type] = entries;\n                }\n            }\n        });\n        return map;\n    }\n    var SEL_BORDER = [\n        'borders',\n        'border'\n    ];\n    var SEL_FILL = [\n        'fills',\n        'fill'\n    ];\n    var SEL_FONT = [\n        'fonts',\n        'font'\n    ];\n    var SEL_INLINE_STYLE = [\n        'cellXfs',\n        'xf'\n    ];\n    var SEL_NAMED_STYLE = [\n        'cellStyleXfs',\n        'xf'\n    ];\n    var SEL_NUM_FMT = [\n        'numFmts',\n        'numFmt'\n    ];\n    var INDEXED_COLORS = [\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF'),\n        toCSSColor('FFFF0000'),\n        toCSSColor('FF00FF00'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008000'),\n        toCSSColor('FF000080'),\n        toCSSColor('FF808000'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF008080'),\n        toCSSColor('FFC0C0C0'),\n        toCSSColor('FF808080'),\n        toCSSColor('FF9999FF'),\n        toCSSColor('FF993366'),\n        toCSSColor('FFFFFFCC'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FF660066'),\n        toCSSColor('FFFF8080'),\n        toCSSColor('FF0066CC'),\n        toCSSColor('FFCCCCFF'),\n        toCSSColor('FF000080'),\n        toCSSColor('FFFF00FF'),\n        toCSSColor('FFFFFF00'),\n        toCSSColor('FF00FFFF'),\n        toCSSColor('FF800080'),\n        toCSSColor('FF800000'),\n        toCSSColor('FF008080'),\n        toCSSColor('FF0000FF'),\n        toCSSColor('FF00CCFF'),\n        toCSSColor('FFCCFFFF'),\n        toCSSColor('FFCCFFCC'),\n        toCSSColor('FFFFFF99'),\n        toCSSColor('FF99CCFF'),\n        toCSSColor('FFFF99CC'),\n        toCSSColor('FFCC99FF'),\n        toCSSColor('FFFFCC99'),\n        toCSSColor('FF3366FF'),\n        toCSSColor('FF33CCCC'),\n        toCSSColor('FF99CC00'),\n        toCSSColor('FFFFCC00'),\n        toCSSColor('FFFF9900'),\n        toCSSColor('FFFF6600'),\n        toCSSColor('FF666699'),\n        toCSSColor('FF969696'),\n        toCSSColor('FF003366'),\n        toCSSColor('FF339966'),\n        toCSSColor('FF003300'),\n        toCSSColor('FF333300'),\n        toCSSColor('FF993300'),\n        toCSSColor('FF993366'),\n        toCSSColor('FF333399'),\n        toCSSColor('FF333333'),\n        toCSSColor('FF000000'),\n        toCSSColor('FFFFFFFF')\n    ];\n    function readStyles(zip, theme) {\n        var styles = {\n            fonts: [],\n            numFmts: {},\n            fills: [],\n            borders: [],\n            namedStyles: [],\n            inlineStyles: []\n        };\n        var font = null;\n        var fill = null;\n        var border = null;\n        var xf = null;\n        parse(zip, 'xl/styles.xml', {\n            enter: function (tag, attrs, closed) {\n                if (this.is(SEL_NUM_FMT)) {\n                    styles.numFmts[attrs.numFmtId] = attrs;\n                } else if (this.is(SEL_FONT)) {\n                    styles.fonts.push(font = {});\n                } else if (font) {\n                    if (tag == 'sz') {\n                        font.size = parseFloat(attrs.val);\n                    } else if (tag == 'name') {\n                        font.name = attrs.val;\n                    } else if (tag == 'b') {\n                        font.bold = bool(attrs.val, true);\n                    } else if (tag == 'i') {\n                        font.italic = bool(attrs.val, true);\n                    }\n                } else if (this.is(SEL_FILL)) {\n                    styles.fills.push(fill = {});\n                } else if (fill) {\n                    if (tag == 'patternFill') {\n                        fill.type = attrs.patternType;\n                    } else if (tag == 'fgColor' && fill.type === 'solid') {\n                        fill.color = getColor(attrs);\n                    } else if (tag == 'bgColor' && fill.type !== 'solid') {\n                        fill.color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_BORDER)) {\n                    styles.borders.push(border = {});\n                } else if (border) {\n                    if (/^(?:left|top|right|bottom)$/.test(tag) && attrs.style) {\n                        border[tag] = { style: attrs.style };\n                    }\n                    if (tag == 'color') {\n                        var side = this.stack[this.stack.length - 2].$tag;\n                        border[side].color = getColor(attrs);\n                    }\n                } else if (this.is(SEL_NAMED_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.namedStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (this.is(SEL_INLINE_STYLE)) {\n                    xf = getXf(attrs);\n                    styles.inlineStyles.push(xf);\n                    if (closed) {\n                        xf = null;\n                    }\n                } else if (xf) {\n                    if (tag == 'alignment') {\n                        if (/^(?:left|center|right|justify)$/.test(attrs.horizontal)) {\n                            xf.textAlign = attrs.horizontal;\n                        }\n                        if (/^(?:top|center|bottom)$/.test(attrs.vertical)) {\n                            xf.verticalAlign = attrs.vertical;\n                        }\n                        if (attrs.wrapText != null) {\n                            xf.wrapText = bool(attrs.wrapText);\n                        }\n                    }\n                }\n            },\n            leave: function (tag) {\n                if (this.is(SEL_FONT)) {\n                    font = null;\n                } else if (this.is(SEL_FILL)) {\n                    fill = null;\n                } else if (this.is(SEL_BORDER)) {\n                    border = null;\n                } else if (tag == 'xf') {\n                    xf = null;\n                }\n            }\n        });\n        function getXf(attrs) {\n            var xf = {\n                borderId: integer(attrs.borderId),\n                fillId: integer(attrs.fillId),\n                fontId: integer(attrs.fontId),\n                numFmtId: integer(attrs.numFmtId),\n                pivotButton: bool(attrs.pivotButton),\n                quotePrefix: bool(attrs.quotePrefix),\n                xfId: integer(attrs.xfId)\n            };\n            addBool('applyAlignment');\n            addBool('applyBorder');\n            addBool('applyFill');\n            addBool('applyFont');\n            addBool('applyNumberFormat');\n            addBool('applyProtection');\n            function addBool(name) {\n                if (attrs[name] != null) {\n                    xf[name] = bool(attrs[name]);\n                }\n            }\n            return xf;\n        }\n        function getColor(attrs) {\n            if (attrs.rgb) {\n                return toCSSColor(attrs.rgb);\n            } else if (attrs.indexed) {\n                return INDEXED_COLORS[integer(attrs.indexed)];\n            } else if (attrs.theme) {\n                var themeColor = theme.colorScheme[integer(attrs.theme)];\n                if (!themeColor) {\n                    return INDEXED_COLORS[0];\n                }\n                var color = kendo.parseColor(themeColor);\n                if (attrs.tint) {\n                    color = color.toHSL();\n                    var tint = parseFloat(attrs.tint);\n                    if (tint < 0) {\n                        color.l = color.l * (1 + tint);\n                    } else {\n                        color.l = color.l * (1 - tint) + (100 - 100 * (1 - tint));\n                    }\n                }\n                return color.toCssRgba();\n            }\n        }\n        return styles;\n    }\n    var SEL_SCHEME_RGBCLR = [\n        'a:clrScheme',\n        '*',\n        'a:srgbClr'\n    ];\n    var SEL_SCHEME_SYSCLR = [\n        'a:clrScheme',\n        '*',\n        'a:sysClr'\n    ];\n    function readTheme(zip, rel) {\n        var scheme = [];\n        var theme = { colorScheme: scheme };\n        var file = xl(rel);\n        if (zip.files[file]) {\n            parse(zip, file, {\n                enter: function (tag, attrs) {\n                    if (this.is(SEL_SCHEME_SYSCLR)) {\n                        scheme.push(toCSSColor(attrs.val == 'window' ? 'FFFFFFFF' : 'FF000000'));\n                    } else if (this.is(SEL_SCHEME_RGBCLR)) {\n                        scheme.push(toCSSColor('FF' + attrs.val));\n                    }\n                }\n            });\n            if (scheme.length > 3) {\n                swap(scheme, 0, 1);\n                swap(scheme, 2, 3);\n            }\n        }\n        function swap(arr, a, b) {\n            var tmp = arr[a];\n            arr[a] = arr[b];\n            arr[b] = tmp;\n        }\n        return theme;\n    }\n    function integer(val) {\n        return val == null ? null : parseInt(val, 10);\n    }\n    function bool(val, def) {\n        if (val == null) {\n            return def;\n        }\n        return val == 'true' || val === true || val == 1;\n    }\n    function toCSSColor(rgb) {\n        var m = /^([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(rgb);\n        return 'rgba(' + parseInt(m[2], 16) + ', ' + parseInt(m[3], 16) + ', ' + parseInt(m[4], 16) + ', ' + parseInt(m[1], 16) / 255 + ')';\n    }\n    kendo.spreadsheet.readExcel = readExcel;\n    kendo.spreadsheet._readSheet = readSheet;\n    kendo.spreadsheet._readStrings = readStrings;\n    kendo.spreadsheet._readStyles = readStyles;\n    kendo.spreadsheet._readTheme = readTheme;\n    kendo.spreadsheet._readWorkbook = readWorkbook;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/workbook', [\n        'kendo.core',\n        'spreadsheet/runtime',\n        'spreadsheet/references',\n        'spreadsheet/excel-reader'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Formula = kendo.spreadsheet.calc.runtime.Formula;\n        var Ref = kendo.spreadsheet.Ref;\n        var CalcError = kendo.spreadsheet.CalcError;\n        var Workbook = kendo.Observable.extend({\n            init: function (options, view) {\n                kendo.Observable.fn.init.call(this);\n                this.options = options;\n                this._view = view;\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._sheet = this.insertSheet({\n                    rows: this.options.rows,\n                    columns: this.options.columns,\n                    rowHeight: this.options.rowHeight,\n                    columnWidth: this.options.columnWidth,\n                    headerHeight: this.options.headerHeight,\n                    headerWidth: this.options.headerWidth,\n                    dataSource: this.options.dataSource\n                });\n                this.undoRedoStack = new kendo.util.UndoRedoStack();\n                this.undoRedoStack.bind([\n                    'undo',\n                    'redo'\n                ], this._onUndoRedo.bind(this));\n                this._context = new kendo.spreadsheet.FormulaContext(this);\n                this._validationContext = new kendo.spreadsheet.ValidationFormulaContext(this);\n                this._names = Object.create(null);\n                this.fromJSON(this.options);\n            },\n            clipboard: function () {\n                if (!this._clipboard) {\n                    this._clipboard = new kendo.spreadsheet.Clipboard(this);\n                }\n                return this._clipboard;\n            },\n            destroy: function () {\n                this.unbind();\n                if (this._clipboard) {\n                    this._clipboard.destroy();\n                }\n            },\n            events: [\n                'cut',\n                'copy',\n                'paste',\n                'change',\n                'excelImport',\n                'excelExport',\n                'insertSheet',\n                'removeSheet',\n                'selectSheet',\n                'renameSheet',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select',\n                'changeFormat'\n            ],\n            _sheetChange: function (e) {\n                this.trigger('change', e);\n            },\n            _sheetInsertRow: function (e) {\n                if (this.trigger('insertRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetInsertColumn: function (e) {\n                if (this.trigger('insertColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (this.trigger('deleteRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetDeleteColumn: function (e) {\n                if (this.trigger('deleteColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetHideRow: function (e) {\n                if (this.trigger('hideRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetHideColumn: function (e) {\n                if (this.trigger('hideColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetUnhideRow: function (e) {\n                if (this.trigger('unhideRow', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetUnhideColumn: function (e) {\n                if (this.trigger('unhideColumn', {\n                        sheet: e.sender,\n                        index: e.index\n                    })) {\n                    e.preventDefault();\n                }\n            },\n            _sheetSelect: function (e) {\n                this.trigger('select', e);\n            },\n            _sheetCommandRequest: function (e) {\n                this.trigger('commandRequest', e);\n            },\n            _inputForRef: function (ref) {\n                return new kendo.spreadsheet.Range(ref, this._sheet).input();\n            },\n            _onUndoRedo: function (e) {\n                e.command.range().select();\n            },\n            execute: function (options) {\n                var commandOptions = $.extend({ workbook: this }, options.options);\n                var command = new kendo.spreadsheet[options.command](commandOptions);\n                var sheet = this.activeSheet();\n                if (commandOptions.origin) {\n                    command.origin(commandOptions.origin);\n                }\n                if (commandOptions.operatingRange) {\n                    command.range(commandOptions.operatingRange);\n                } else if (commandOptions.editActiveCell) {\n                    command.range(sheet.activeCellSelection());\n                } else {\n                    command.range(sheet.selection());\n                }\n                var result = command.exec();\n                if (!result || result.reason !== 'error') {\n                    if (command.cannotUndo) {\n                        this.undoRedoStack.clear();\n                    } else {\n                        this.undoRedoStack.push(command);\n                    }\n                }\n                return result;\n            },\n            resetFormulas: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetFormulas();\n                });\n            },\n            resetValidations: function () {\n                this._sheets.forEach(function (sheet) {\n                    sheet.resetValidations();\n                });\n            },\n            refresh: function (reason) {\n                if (reason.recalc) {\n                    this.resetFormulas();\n                    this.resetValidations();\n                    this._sheet.recalc(this._context);\n                    this._sheet.revalidate(this._validationContext);\n                }\n            },\n            activeSheet: function (sheet) {\n                if (sheet === undefined) {\n                    return this._sheet;\n                }\n                if (!this.sheetByName(sheet.name())) {\n                    return;\n                }\n                this._sheet = sheet;\n                sheet.triggerChange(kendo.spreadsheet.ALL_REASONS);\n            },\n            moveSheetToIndex: function (sheet, toIndex) {\n                var fromIndex = this.sheetIndex(sheet);\n                var sheets = this._sheets;\n                if (fromIndex === -1) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheets.splice(toIndex, 0, sheets.splice(fromIndex, 1)[0]);\n                this.trigger('change', { sheetSelection: true });\n            },\n            insertSheet: function (options) {\n                options = options || {};\n                var that = this;\n                var insertIndex = typeof options.index === 'number' ? options.index : that._sheets.length;\n                var sheetName;\n                var sheets = that._sheets;\n                var getUniqueSheetName = function (sheetNameSuffix) {\n                    sheetNameSuffix = sheetNameSuffix ? sheetNameSuffix : 1;\n                    var name = 'Sheet' + sheetNameSuffix;\n                    if (!that.sheetByName(name)) {\n                        return name;\n                    }\n                    return getUniqueSheetName(sheetNameSuffix + 1);\n                };\n                if (options.name && that.sheetByName(options.name)) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                sheetName = options.name || getUniqueSheetName();\n                var sheet = new kendo.spreadsheet.Sheet(options.rows || this.options.rows, options.columns || this.options.columns, options.rowHeight || this.options.rowHeight, options.columnWidth || this.options.columnWidth, options.headerHeight || this.options.headerHeight, options.headerWidth || this.options.headerWidth, options.defaultCellStyle || this.options.defaultCellStyle);\n                sheet._workbook = this;\n                sheet._name(sheetName);\n                this._bindSheetEvents(sheet);\n                sheets.splice(insertIndex, 0, sheet);\n                if (options.data) {\n                    sheet.fromJSON(options.data);\n                }\n                if (options.dataSource) {\n                    sheet.setDataSource(options.dataSource);\n                }\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            _bindSheetEvents: function (sheet) {\n                sheet.bind('change', this._sheetChange.bind(this));\n                sheet.bind('insertRow', this._sheetInsertRow.bind(this));\n                sheet.bind('insertColumn', this._sheetInsertColumn.bind(this));\n                sheet.bind('deleteRow', this._sheetDeleteRow.bind(this));\n                sheet.bind('deleteColumn', this._sheetDeleteColumn.bind(this));\n                sheet.bind('hideRow', this._sheetHideRow.bind(this));\n                sheet.bind('hideColumn', this._sheetHideColumn.bind(this));\n                sheet.bind('unhideRow', this._sheetUnhideRow.bind(this));\n                sheet.bind('unhideColumn', this._sheetUnhideColumn.bind(this));\n                sheet.bind('select', this._sheetSelect.bind(this));\n                sheet.bind('commandRequest', this._sheetCommandRequest.bind(this));\n            },\n            sheets: function () {\n                return this._sheets.slice();\n            },\n            sheetByName: function (sheetName) {\n                return this._sheets[this.sheetIndex(sheetName)];\n            },\n            sheetByIndex: function (index) {\n                return this._sheets[index];\n            },\n            sheetIndex: function (sheet) {\n                var sheets = this._sheets;\n                var sheetName = (typeof sheet == 'string' ? sheet : sheet.name()).toLowerCase();\n                var idx = this._sheetsSearchCache[sheetName];\n                if (idx >= 0) {\n                    return idx;\n                }\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var name = sheets[idx].name().toLowerCase();\n                    this._sheetsSearchCache[name] = idx;\n                    if (name === sheetName) {\n                        return idx;\n                    }\n                }\n                return -1;\n            },\n            renameSheet: function (sheet, newSheetName) {\n                var oldSheetName = sheet.name().toLowerCase();\n                if (!newSheetName || oldSheetName === newSheetName.toLowerCase() || this.sheetByName(newSheetName)) {\n                    return;\n                }\n                sheet = this.sheetByName(oldSheetName);\n                if (!sheet) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (this.trigger('renameSheet', {\n                        sheet: sheet,\n                        newSheetName: newSheetName\n                    })) {\n                    return;\n                }\n                this._sheets.forEach(function (sheet) {\n                    sheet._forFormulas(function (formula) {\n                        formula.renameSheet(oldSheetName, newSheetName);\n                    });\n                });\n                this.forEachName(function (def, name) {\n                    if (def.nameref.renameSheet(oldSheetName, newSheetName)) {\n                        this.undefineName(name);\n                        def.name = def.nameref.print();\n                        this.nameDefinition(def.name, def);\n                    }\n                    if (def.value instanceof Ref || def.value instanceof Formula) {\n                        def.value.renameSheet(oldSheetName, newSheetName);\n                    }\n                }.bind(this));\n                sheet._name(newSheetName);\n                this.trigger('change', { sheetSelection: true });\n                return sheet;\n            },\n            removeSheet: function (sheet) {\n                var that = this;\n                var sheets = that._sheets;\n                var name = sheet.name();\n                var index = that.sheetIndex(sheet);\n                if (sheets.length === 1) {\n                    return;\n                }\n                if (this.trigger('removeSheet', { sheet: sheet })) {\n                    return;\n                }\n                this._sheetsSearchCache = {};\n                if (index > -1) {\n                    sheet.unbind();\n                    sheets.splice(index, 1);\n                    if (that.activeSheet().name() === name) {\n                        var newSheet = sheets[index === sheets.length ? index - 1 : index];\n                        that.activeSheet(newSheet);\n                    } else {\n                        this.trigger('change', {\n                            recalc: true,\n                            sheetSelection: true\n                        });\n                    }\n                }\n            },\n            _clearSheets: function () {\n                for (var i = 0; i < this._sheets.length; i++) {\n                    this._sheets[i].unbind();\n                }\n                this._sheets = [];\n                this._sheetsSearchCache = {};\n                this._names = {};\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._clearSheets();\n                    for (var idx = 0; idx < json.sheets.length; idx++) {\n                        var data = json.sheets[idx];\n                        var args = sheetParamsFromJSON(data, this.options);\n                        var sheet = this.insertSheet({\n                            rows: args.rowCount,\n                            columns: args.columnCount,\n                            rowHeight: args.rowHeight,\n                            columnWidth: args.columnWidth,\n                            headerHeight: args.headerHeight,\n                            headerWidth: args.headerWidth,\n                            data: data\n                        });\n                        if (data.dataSource) {\n                            sheet.setDataSource(data.dataSource);\n                        }\n                    }\n                }\n                if (json.activeSheet) {\n                    this.activeSheet(this.sheetByName(json.activeSheet));\n                } else {\n                    this.activeSheet(this._sheets[0]);\n                }\n                if (json.names) {\n                    json.names.forEach(function (def) {\n                        this.defineName(def.name, def.value, def.hidden);\n                    }, this);\n                }\n            },\n            toJSON: function () {\n                this.resetFormulas();\n                this.resetValidations();\n                var names = Object.keys(this._names).map(function (name) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref || val instanceof Formula) {\n                        val = val.print(0, 0, true);\n                    } else if (val instanceof CalcError) {\n                        val = val + '';\n                    } else {\n                        val = JSON.stringify(val);\n                    }\n                    return {\n                        value: val,\n                        hidden: def.hidden,\n                        name: def.name,\n                        sheet: def.nameref.sheet,\n                        localName: def.nameref.name\n                    };\n                }, this);\n                return {\n                    activeSheet: this.activeSheet().name(),\n                    sheets: this._sheets.map(function (sheet) {\n                        sheet.recalc(this._context);\n                        sheet.revalidate(this._validationContext);\n                        return sheet.toJSON();\n                    }, this),\n                    names: names,\n                    columnWidth: this.options.columnWidth,\n                    rowHeight: this.options.rowHeight\n                };\n            },\n            fromFile: function (file) {\n                var deferred = new $.Deferred();\n                var promise = deferred.promise();\n                var args = {\n                    file: file,\n                    promise: promise\n                };\n                if (file && !this.trigger('excelImport', args)) {\n                    this._clearSheets();\n                    kendo.spreadsheet.readExcel(file, this, deferred);\n                } else {\n                    deferred.reject();\n                }\n                return promise;\n            },\n            saveAsExcel: function (options) {\n                options = $.extend({}, this.options.excel, options);\n                var data = this.toJSON();\n                if (!this.trigger('excelExport', { workbook: data })) {\n                    var workbook = new kendo.ooxml.Workbook(data);\n                    kendo.saveAs({\n                        dataURI: workbook.toDataURL(),\n                        fileName: data.fileName || options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy\n                    });\n                }\n            },\n            draw: function (options, callback) {\n                if (typeof options == 'function' && !callback) {\n                    callback = options;\n                    options = {};\n                }\n                var parts = [], sheets = this._sheets;\n                (function loop(i) {\n                    if (i < sheets.length) {\n                        sheets[i].draw(kendo.spreadsheet.SHEETREF, options, function (group) {\n                            parts.push(group);\n                            loop(i + 1);\n                        });\n                    } else {\n                        var group = parts[0];\n                        for (i = 1; i < parts.length; ++i) {\n                            group.children = group.children.concat(parts[i].children);\n                        }\n                        callback(group);\n                    }\n                }(0));\n            },\n            nameForRef: function (ref, sheet) {\n                if (sheet === undefined) {\n                    sheet = ref.sheet;\n                }\n                sheet = sheet.toLowerCase();\n                var str = ref + '';\n                for (var name in this._names) {\n                    var def = this._names[name];\n                    var val = def.value;\n                    if (val instanceof Ref) {\n                        if (!val.sheet || val.sheet && sheet == val.sheet.toLowerCase()) {\n                            if (val + '' == str) {\n                                return def;\n                            }\n                        }\n                    }\n                }\n                return { name: str };\n            },\n            defineName: function (name, value, hidden) {\n                var x = kendo.spreadsheet.calc.parseNameDefinition(name, value);\n                name = x.name.print();\n                this._names[name.toLowerCase()] = {\n                    value: x.value,\n                    hidden: hidden,\n                    name: name,\n                    nameref: x.name\n                };\n            },\n            undefineName: function (name) {\n                delete this._names[name.toLowerCase()];\n            },\n            nameValue: function (name) {\n                name = name.toLowerCase();\n                if (name in this._names) {\n                    return this._names[name].value;\n                }\n                return null;\n            },\n            nameDefinition: function (name, def) {\n                name = name.toLowerCase();\n                if (arguments.length > 1) {\n                    if (def === undefined) {\n                        delete this._names[name];\n                    } else {\n                        this._names[name] = def;\n                    }\n                }\n                return this._names[name];\n            },\n            forEachName: function (func) {\n                Object.keys(this._names).forEach(function (name) {\n                    func(this._names[name], name);\n                }, this);\n            },\n            adjustNames: function (affectedSheet, forRow, start, delta) {\n                affectedSheet = affectedSheet.toLowerCase();\n                Object.keys(this._names).forEach(function (name) {\n                    var def = this._names[name];\n                    var x = def.value;\n                    if (x instanceof Ref && x.sheet.toLowerCase() == affectedSheet) {\n                        def.value = x.adjust(null, null, null, null, forRow, start, delta);\n                    } else if (x instanceof Formula) {\n                        x.adjust(affectedSheet, forRow ? 'row' : 'col', start, delta);\n                    }\n                }, this);\n            },\n            options: {}\n        });\n        function sheetParamsFromJSON(data, options) {\n            function or(a, b, c) {\n                return a !== undefined ? a : b !== undefined ? b : c;\n            }\n            var rowCount = or(data.rowCount, options.rows, 200), columnCount = or(data.columnCount, options.columns, 50), rowHeight = or(data.rowHeight, options.rowHeight, 20), columnWidth = or(data.columnWidth, options.columnWidth, 64), headerHeight = or(data.headerHeight, options.headerHeight, 20), headerWidth = or(data.headerWidth, options.headerWidth, 32);\n            if (data.rows !== undefined) {\n                for (var i = 0; i < data.rows.length; ++i) {\n                    var row = data.rows[i];\n                    var ri = or(row.index, i);\n                    if (ri >= rowCount) {\n                        rowCount = ri + 1;\n                    }\n                    if (row.cells) {\n                        for (var j = 0; j < row.cells.length; ++j) {\n                            var cell = row.cells[j];\n                            var ci = or(cell.index, j);\n                            if (ci >= columnCount) {\n                                columnCount = ci + 1;\n                            }\n                        }\n                    }\n                }\n            }\n            return {\n                rowCount: rowCount,\n                columnCount: columnCount,\n                rowHeight: rowHeight,\n                columnWidth: columnWidth,\n                headerHeight: headerHeight,\n                headerWidth: headerWidth\n            };\n        }\n        kendo.spreadsheet.Workbook = Workbook;\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(Workbook.prototype);\n            Workbook.prototype.saveAsPDF = function (options) {\n                var progress = new $.Deferred();\n                var promise = progress.promise();\n                var args = { promise: promise };\n                if (this.trigger('pdfExport', args)) {\n                    return;\n                }\n                this._drawPDF(options, progress).then(function (root) {\n                    return kendo.drawing.exportPDF(root);\n                }).done(function (dataURI) {\n                    kendo.saveAs({\n                        dataURI: dataURI,\n                        fileName: options.fileName,\n                        proxyURL: options.proxyURL,\n                        forceProxy: options.forceProxy,\n                        proxyTarget: options.proxyTarget\n                    });\n                    progress.resolve();\n                }).fail(function (err) {\n                    progress.reject(err);\n                });\n                return promise;\n            };\n            Workbook.prototype._drawPDF = function (options) {\n                var result = new $.Deferred();\n                var callback = function (group) {\n                    result.resolve(group);\n                };\n                switch (options.area) {\n                case 'workbook':\n                    options.workbook.draw(options, callback);\n                    break;\n                case 'sheet':\n                    options.workbook.activeSheet().draw(options, callback);\n                    break;\n                case 'selection':\n                    options.workbook.activeSheet().selection().draw(options, callback);\n                    break;\n                }\n                return result.promise();\n            };\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/formulacontext', ['kendo.core'], f);\n}(function () {\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var RangeRef = spreadsheet.RangeRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var NameRef = spreadsheet.NameRef;\n    var Ref = spreadsheet.Ref;\n    var FormulaContext = kendo.Class.extend({\n        init: function (workbook) {\n            this.workbook = workbook;\n        },\n        getRefCells: function (ref, hiddenInfo, fsheet, frow, fcol) {\n            var sheet, formula, value, i;\n            if (ref instanceof CellRef) {\n                sheet = this.workbook.sheetByName(ref.sheet);\n                if (!sheet || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                formula = sheet.formula(ref);\n                value = sheet.range(ref.row, ref.col).value();\n                if (formula != null || value != null) {\n                    return [{\n                            formula: formula,\n                            value: value,\n                            row: ref.row,\n                            col: ref.col,\n                            sheet: ref.sheet,\n                            hidden: hiddenInfo ? sheet.columnWidth(ref.col) === 0 || sheet.rowHeight(ref.row) === 0 : false\n                        }];\n                } else {\n                    return [];\n                }\n            }\n            if (ref instanceof RangeRef) {\n                i = this.workbook.sheetIndex(ref.sheet);\n                var states = [], n = i;\n                if (ref.endSheet) {\n                    n = this.workbook.sheetIndex(ref.endSheet);\n                    if (i > n) {\n                        var tmp = i;\n                        i = n;\n                        n = tmp;\n                    }\n                }\n                if (i < 0 || n < 0 || !ref.valid()) {\n                    return [{ value: new kendo.spreadsheet.calc.runtime.CalcError('REF') }];\n                }\n                while (i <= n) {\n                    sheet = this.workbook.sheetByIndex(i++);\n                    var tl = sheet._grid.normalize(ref.topLeft);\n                    var br = sheet._grid.normalize(ref.bottomRight);\n                    var startCellIndex = sheet._grid.cellRefIndex(tl);\n                    var endCellIndex = sheet._grid.cellRefIndex(br);\n                    var values = sheet._properties.iterator('value', startCellIndex, endCellIndex);\n                    for (var col = tl.col; col <= br.col; ++col) {\n                        for (var row = tl.row; row <= br.row; ++row) {\n                            var index = sheet._grid.index(row, col);\n                            formula = sheet._properties.get('formula', index);\n                            value = values.at(index);\n                            if (formula != null || value != null) {\n                                states.push({\n                                    formula: formula,\n                                    value: value,\n                                    row: row,\n                                    col: col,\n                                    sheet: sheet.name(),\n                                    hidden: hiddenInfo ? sheet.columnWidth(col) === 0 || sheet.rowHeight(row) === 0 : false\n                                });\n                            }\n                        }\n                    }\n                }\n                return states;\n            }\n            if (ref instanceof UnionRef) {\n                var a = [];\n                for (i = 0; i < ref.refs.length; ++i) {\n                    a = a.concat(this.getRefCells(ref.refs[i], hiddenInfo, fsheet, frow, fcol));\n                }\n                return a;\n            }\n            if (ref instanceof NameRef) {\n                var val = this.nameValue(ref, fsheet, frow, fcol);\n                if (val instanceof Ref) {\n                    return this.getRefCells(val, hiddenInfo, fsheet, frow, fcol);\n                }\n                return [{ value: val == null ? new kendo.spreadsheet.calc.runtime.CalcError('NAME') : val }];\n            }\n            return [];\n        },\n        nameValue: function (ref, fsheet, frow, fcol) {\n            var val;\n            if (ref.hasSheet()) {\n                val = this.workbook.nameValue(ref.print());\n            } else {\n                ref = ref.clone().setSheet(fsheet, true);\n                val = this.workbook.nameValue(ref.print());\n                if (val == null) {\n                    val = this.workbook.nameValue(ref.name);\n                }\n            }\n            if (val instanceof Ref) {\n                val = val.absolute(frow, fcol);\n            }\n            return val;\n        },\n        getData: function (ref, fsheet, frow, fcol) {\n            var single = ref instanceof CellRef;\n            if (ref instanceof NameRef) {\n                single = this.workbook.nameValue(ref.name) instanceof CellRef;\n            }\n            var data = this.getRefCells(ref, false, fsheet, frow, fcol).map(function (cell) {\n                var val = cell.value;\n                if (val instanceof kendo.spreadsheet.calc.runtime.Formula) {\n                    val = val.value;\n                }\n                return val;\n            });\n            return single ? data[0] : data;\n        },\n        onFormula: function (f) {\n            var sheet = this.workbook.sheetByName(f.sheet);\n            var row = f.row, col = f.col, value = f.value;\n            var currentFormula = sheet.formula({\n                row: row,\n                col: col\n            });\n            if (currentFormula !== f) {\n                return false;\n            }\n            if (value instanceof Ref) {\n                value = this.getData(value, f.sheet, row, col);\n                if (Array.isArray(value)) {\n                    value = value[0];\n                }\n                if (value === undefined) {\n                    value = null;\n                }\n            }\n            if (value instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                value.each(function (value, r, c) {\n                    sheet._value(row + r, col + c, value);\n                });\n            } else {\n                sheet._value(row, col, value);\n            }\n            clearTimeout(sheet._formulaContextRefresh);\n            sheet._formulaContextRefresh = setTimeout(function () {\n                sheet.batch(function () {\n                }, { layout: true });\n            }, 50);\n            return true;\n        }\n    });\n    var ValidationFormulaContext = FormulaContext.extend({\n        onFormula: function () {\n            return true;\n        }\n    });\n    spreadsheet.FormulaContext = FormulaContext;\n    spreadsheet.ValidationFormulaContext = ValidationFormulaContext;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/controller', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var alphaNumRegExp = /:alphanum$/;\n        var ACTIONS = {\n            'up': 'up',\n            'down': 'down',\n            'left': 'left',\n            'right': 'right',\n            'home': 'first-col',\n            'ctrl+left': 'first-col',\n            'end': 'last-col',\n            'ctrl+right': 'last-col',\n            'ctrl+up': 'first-row',\n            'ctrl+down': 'last-row',\n            'ctrl+home': 'first',\n            'ctrl+end': 'last',\n            'pageup': 'prev-page',\n            'pagedown': 'next-page'\n        };\n        var ENTRY_ACTIONS = {\n            'tab': 'next',\n            'shift+tab': 'previous',\n            'enter': 'lower',\n            'shift+enter': 'upper',\n            'delete': 'clearContents',\n            'backspace': 'clearContents',\n            'shift+:alphanum': 'edit',\n            ':alphanum': 'edit',\n            'ctrl+:alphanum': 'ctrl',\n            'alt+ctrl+:alphanum': 'edit',\n            ':edit': 'edit'\n        };\n        var CONTAINER_EVENTS = {\n            'wheel': 'onWheel',\n            '*+mousedown': 'onMouseDown',\n            'contextmenu': 'onContextMenu',\n            '*+mousedrag': 'onMouseDrag',\n            '*+mouseup': 'onMouseUp',\n            '*+dblclick': 'onDblClick',\n            'mousemove': 'onMouseMove'\n        };\n        var CLIPBOARD_EVENTS = {\n            'pageup': 'onPageUp',\n            'pagedown': 'onPageDown',\n            'mouseup': 'onMouseUp',\n            '*+cut': 'onCut',\n            '*+paste': 'onPaste',\n            '*+copy': 'onCopy'\n        };\n        var EDITOR_EVENTS = {\n            'esc': 'onEditorEsc',\n            'enter': 'onEditorBlur',\n            'alt+enter': 'insertNewline',\n            'shift+enter': 'onEditorBlur',\n            'tab': 'onEditorBlur',\n            'shift+tab': 'onEditorBlur'\n        };\n        var FORMULABAR_EVENTS = $.extend({ focus: 'onEditorBarFocus' }, EDITOR_EVENTS);\n        var FORMULAINPUT_EVENTS = $.extend({ focus: 'onEditorCellFocus' }, EDITOR_EVENTS);\n        var SELECTION_MODES = {\n            cell: 'range',\n            rowheader: 'row',\n            columnheader: 'column',\n            topcorner: 'sheet',\n            autofill: 'autofill'\n        };\n        function toActionSelector(selectors) {\n            return selectors.map(function (action) {\n                return '[data-action=\"' + action + '\"]';\n            }).join(',');\n        }\n        var COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector([\n            'cut',\n            'copy',\n            'paste',\n            'insert-left',\n            'insert-right',\n            'insert-above',\n            'insert-below'\n        ]);\n        var UNHIDE_ACTION_SELECTORS = toActionSelector([\n            'unhide-row',\n            'unhide-column'\n        ]);\n        var ACTION_KEYS = [];\n        var SHIFT_ACTION_KEYS = [];\n        var ENTRY_ACTION_KEYS = [];\n        for (var key in ACTIONS) {\n            ACTION_KEYS.push(key);\n            SHIFT_ACTION_KEYS.push('shift+' + key);\n        }\n        for (key in ENTRY_ACTIONS) {\n            ENTRY_ACTION_KEYS.push(key);\n        }\n        CLIPBOARD_EVENTS[ACTION_KEYS] = 'onAction';\n        CLIPBOARD_EVENTS[SHIFT_ACTION_KEYS] = 'onShiftAction';\n        CLIPBOARD_EVENTS[ENTRY_ACTION_KEYS] = 'onEntryAction';\n        FORMULAINPUT_EVENTS[ACTION_KEYS] = 'onEditorAction';\n        FORMULAINPUT_EVENTS[SHIFT_ACTION_KEYS] = 'onEditorShiftAction';\n        var Controller = kendo.Class.extend({\n            init: function (view, workbook) {\n                this.view = view;\n                this.workbook(workbook);\n                this.container = $(view.container);\n                this.clipboardElement = $(view.clipboard);\n                this.cellContextMenu = view.cellContextMenu;\n                this.rowHeaderContextMenu = view.rowHeaderContextMenu;\n                this.colHeaderContextMenu = view.colHeaderContextMenu;\n                this.scroller = view.scroller;\n                this.tabstrip = view.tabstrip;\n                this.sheetsbar = view.sheetsbar;\n                view.nameEditor.bind('enter', this.onNameEditorEnter.bind(this));\n                view.nameEditor.bind('cancel', this.onNameEditorCancel.bind(this));\n                view.nameEditor.bind('select', this.onNameEditorSelect.bind(this));\n                view.nameEditor.bind('delete', this.onNameEditorDelete.bind(this));\n                this.editor = view.editor;\n                this.editor.bind('change', this.onEditorChange.bind(this));\n                this.editor.bind('activate', this.onEditorActivate.bind(this));\n                this.editor.bind('deactivate', this.onEditorDeactivate.bind(this));\n                this.editor.bind('update', this.onEditorUpdate.bind(this));\n                $(view.scroller).on('scroll', this.onScroll.bind(this));\n                this.listener = new kendo.spreadsheet.EventListener(this.container, this, CONTAINER_EVENTS);\n                this._enableEditorEvents();\n                if (this.sheetsbar) {\n                    this.sheetsbar.bind('select', this.onSheetBarSelect.bind(this));\n                    this.sheetsbar.bind('reorder', this.onSheetBarReorder.bind(this));\n                    this.sheetsbar.bind('rename', this.onSheetBarRename.bind(this));\n                    this.sheetsbar.bind('remove', this.onSheetBarRemove.bind(this));\n                }\n                this.cellContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.rowHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.colHeaderContextMenu.bind('select', this.onContextMenuSelect.bind(this));\n                this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).on('contextmenu', false);\n                if (this.tabstrip) {\n                    this.tabstrip.bind('action', this.onCommandRequest.bind(this));\n                    this.tabstrip.bind('dialog', this.onDialogRequest.bind(this));\n                }\n            },\n            _enableEditorEvents: function (enable) {\n                if (enable === undefined || enable) {\n                    this.keyListener = new kendo.spreadsheet.EventListener(this.clipboardElement, this, CLIPBOARD_EVENTS);\n                    this.barKeyListener = new kendo.spreadsheet.EventListener(this.editor.barElement(), this, FORMULABAR_EVENTS);\n                    this.inputKeyListener = new kendo.spreadsheet.EventListener(this.editor.cellElement(), this, FORMULAINPUT_EVENTS);\n                } else {\n                    this.keyListener.destroy();\n                    this.barKeyListener.destroy();\n                    this.inputKeyListener.destroy();\n                }\n            },\n            _execute: function (options) {\n                var result = this._workbook.execute(options);\n                if (options.command === 'EditCommand' && !result) {\n                    this._workbook.trigger('change', { editorClose: true });\n                }\n                if (result) {\n                    this._preventNavigation = true;\n                    if (result.reason === 'error') {\n                        this.view.showError(result, function () {\n                            this.activateEditor();\n                            this.editor.value(this._lastEditorValue);\n                            this.editor._value = this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell());\n                            this.editor.select();\n                        }.bind(this));\n                    } else {\n                        this.view.openDialog(result.reason);\n                    }\n                }\n                return result;\n            },\n            _activeTooltip: function () {\n                return this._workbook.activeSheet().activeCell().simplify().toString();\n            },\n            onContextMenuSelect: function (e) {\n                var action = $(e.item).data('action');\n                var command;\n                switch (action) {\n                case 'cut':\n                    command = {\n                        command: 'ToolbarCutCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'copy':\n                    command = {\n                        command: 'ToolbarCopyCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'paste':\n                    command = {\n                        command: 'ToolbarPasteCommand',\n                        options: { workbook: this._workbook }\n                    };\n                    break;\n                case 'unmerge':\n                    command = {\n                        command: 'MergeCellCommand',\n                        options: { value: 'unmerge' }\n                    };\n                    break;\n                case 'merge':\n                    this.view.openDialog('merge');\n                    break;\n                case 'hide-row':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'hide-column':\n                    command = {\n                        command: 'HideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'unhide-row':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'row' }\n                    };\n                    break;\n                case 'unhide-column':\n                    command = {\n                        command: 'UnHideLineCommand',\n                        options: { axis: 'column' }\n                    };\n                    break;\n                case 'delete-row':\n                    command = { command: 'DeleteRowCommand' };\n                    break;\n                case 'delete-column':\n                    command = { command: 'DeleteColumnCommand' };\n                    break;\n                }\n                if (command) {\n                    this._execute(command);\n                }\n            },\n            onSheetBarRemove: function (e) {\n                var sheet = this._workbook.sheetByName(e.name);\n                if (!sheet) {\n                    return;\n                }\n                this._workbook.removeSheet(sheet);\n            },\n            destroy: function () {\n                this.listener.destroy();\n                this._enableEditorEvents(false);\n                this.keyListener.destroy();\n                this.inputKeyListener.destroy();\n            },\n            onSheetBarSelect: function (e) {\n                var sheet;\n                var workbook = this._workbook;\n                if (e.isAddButton) {\n                    if (this._workbook.trigger('insertSheet')) {\n                        return;\n                    }\n                    sheet = workbook.insertSheet();\n                } else {\n                    sheet = workbook.sheetByName(e.name);\n                }\n                if (workbook.activeSheet().name() !== sheet.name()) {\n                    if (this._workbook.trigger('selectSheet', { sheet: sheet })) {\n                        return;\n                    }\n                    workbook.activeSheet(sheet);\n                }\n            },\n            onSheetBarReorder: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.oldIndex);\n                this._workbook.moveSheetToIndex(sheet, e.newIndex);\n                this._workbook.activeSheet(sheet);\n            },\n            onSheetBarRename: function (e) {\n                var sheet = this._workbook.sheetByIndex(e.sheetIndex);\n                if (this._workbook.sheetByName(e.name)) {\n                    this.view.showError({\n                        reason: 'error',\n                        type: 'duplicateSheetName'\n                    });\n                    return;\n                }\n                this._workbook.renameSheet(sheet, e.name);\n                this.clipboardElement.focus();\n            },\n            sheet: function (sheet) {\n                this.navigator = sheet.navigator();\n                this.axisManager = sheet.axisManager();\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                this.clipboard = workbook.clipboard();\n                workbook.bind('commandRequest', this.onCommandRequest.bind(this));\n            },\n            refresh: function () {\n                var editor = this.editor;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                this._viewPortHeight = this.view.scroller.clientHeight;\n                this.navigator.height(this._viewPortHeight);\n                if (!editor.isActive() && !this.isEditorDisabled) {\n                    editor.enable(sheet.selection().enable() !== false);\n                    editor.value(workbook._inputForRef(sheet.activeCell()));\n                }\n                var ref = sheet.selection()._ref.simplify();\n                var def = this._workbook.nameForRef(ref, sheet.name());\n                this.view.nameEditor.value(def.name);\n            },\n            onScroll: function () {\n                this.view.render();\n            },\n            onWheel: function (event) {\n                var deltaX = event.originalEvent.deltaX;\n                var deltaY = event.originalEvent.deltaY;\n                if (event.originalEvent.deltaMode === 1) {\n                    deltaX *= 10;\n                    deltaY *= 10;\n                }\n                this.scrollWith(deltaX, deltaY);\n                event.preventDefault();\n            },\n            onAction: function (event, action) {\n                this.navigator.moveActiveCell(ACTIONS[action]);\n                event.preventDefault();\n            },\n            onPageUp: function () {\n                this.scrollDown(-this._viewPortHeight);\n            },\n            onPageDown: function () {\n                this.scrollDown(this._viewPortHeight);\n            },\n            onEntryAction: function (event, action) {\n                if (event.mod) {\n                    var shouldPrevent = true;\n                    var key = String.fromCharCode(event.keyCode);\n                    switch (key) {\n                    case 'A':\n                        this.navigator.selectAll();\n                        break;\n                    case 'Y':\n                        this._workbook.undoRedoStack.redo();\n                        break;\n                    case 'Z':\n                        this._workbook.undoRedoStack.undo();\n                        break;\n                    default:\n                        shouldPrevent = false;\n                        break;\n                    }\n                    if (shouldPrevent) {\n                        event.preventDefault();\n                    }\n                } else {\n                    var disabled = this._workbook.activeSheet().selection().enable() === false;\n                    if (action == 'delete' || action == 'backspace') {\n                        if (!disabled) {\n                            this._execute({ command: 'ClearContentCommand' });\n                        }\n                        event.preventDefault();\n                    } else if (alphaNumRegExp.test(action) || action === ':edit') {\n                        if (disabled) {\n                            event.preventDefault();\n                            return;\n                        }\n                        if (action !== ':edit') {\n                            this.editor.value('');\n                        }\n                        this.activateEditor();\n                    } else {\n                        this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                        event.preventDefault();\n                    }\n                }\n            },\n            onShiftAction: function (event, action) {\n                this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                event.preventDefault();\n            },\n            onMouseMove: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress() || sheet.selectionInProgress()) {\n                    return;\n                }\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.positionResizeHandle(object.ref);\n                } else {\n                    sheet.removeResizeHandle();\n                }\n            },\n            onMouseDown: function (event) {\n                var object = this.objectAt(event);\n                if (object.pane) {\n                    this.originFrame = object.pane;\n                }\n                if (object.type === 'editor') {\n                    this.onEditorEsc();\n                    this.openCustomEditor();\n                    event.preventDefault();\n                    return;\n                }\n                if (this.editor.canInsertRef(false) && object.ref) {\n                    this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n                    this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey);\n                    event.preventDefault();\n                    return;\n                } else {\n                    this._preventNavigation = false;\n                    this.editor.deactivate();\n                    if (this._preventNavigation) {\n                        return;\n                    }\n                }\n                var sheet = this._workbook.activeSheet();\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    sheet.startResizing({\n                        x: object.x,\n                        y: object.y\n                    });\n                    event.preventDefault();\n                    return;\n                }\n                if (object.type === 'filtericon') {\n                    this.openFilterMenu(event);\n                    event.preventDefault();\n                    return;\n                }\n                this._selectionMode = SELECTION_MODES[object.type];\n                this.appendSelection = event.mod;\n                this.navigator.startSelection(object.ref, this._selectionMode, this.appendSelection, event.shiftKey);\n            },\n            onContextMenu: function (event) {\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    return;\n                }\n                event.preventDefault();\n                this.cellContextMenu.close();\n                this.colHeaderContextMenu.close();\n                this.rowHeaderContextMenu.close();\n                var menu;\n                var object = this.objectAt(event);\n                if (object.type === 'columnresizehandle' || object.type === 'rowresizehandle') {\n                    return;\n                }\n                this.navigator.selectForContextMenu(object.ref, SELECTION_MODES[object.type]);\n                var isComposite = this.navigator._sheet.select() instanceof kendo.spreadsheet.UnionRef;\n                var showUnhide = false;\n                var showUnmerge = false;\n                if (object.type == 'columnheader') {\n                    menu = this.colHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenColumns();\n                } else if (object.type == 'rowheader') {\n                    menu = this.rowHeaderContextMenu;\n                    showUnhide = !isComposite && this.axisManager.selectionIncludesHiddenRows();\n                } else {\n                    menu = this.cellContextMenu;\n                    showUnmerge = this.navigator.selectionIncludesMergedCells();\n                }\n                menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n                setTimeout(function () {\n                    menu.open(event.pageX, event.pageY);\n                });\n            },\n            prevent: function (event) {\n                event.preventDefault();\n            },\n            constrainResize: function (type, ref) {\n                var sheet = this._workbook.activeSheet();\n                var resizeHandle = sheet.resizeHandlePosition();\n                return !resizeHandle || type === 'outside' || type === 'topcorner' || ref.col < resizeHandle.col || ref.row < resizeHandle.row;\n            },\n            onMouseDrag: function (event) {\n                if (this._selectionMode === 'sheet') {\n                    return;\n                }\n                var location = {\n                    clientX: event.clientX,\n                    clientY: event.clientY\n                };\n                var object = this.objectAt(location);\n                var sheet = this._workbook.activeSheet();\n                if (sheet.resizingInProgress()) {\n                    if (!this.constrainResize(object.type, object.ref)) {\n                        sheet.resizeHintPosition({\n                            x: object.x,\n                            y: object.y\n                        });\n                    }\n                    return;\n                }\n                if (object.type === 'outside') {\n                    this.startAutoScroll(object);\n                    return;\n                }\n                if (this.originFrame === object.pane) {\n                    this.selectToLocation(location);\n                } else {\n                    var frame = this.originFrame._grid;\n                    if (object.x > frame.right) {\n                        this.scrollLeft();\n                    }\n                    if (object.y > frame.bottom) {\n                        this.scrollTop();\n                    }\n                    if (object.y < frame.top || object.x < frame.left) {\n                        this.startAutoScroll(object, location);\n                    } else {\n                        this.selectToLocation(location);\n                    }\n                }\n                event.preventDefault();\n            },\n            onMouseUp: function (event) {\n                var sheet = this._workbook.activeSheet();\n                sheet.completeResizing();\n                this.navigator.completeSelection();\n                this.stopAutoScroll();\n                var editor = this.editor.activeEditor();\n                if (!editor) {\n                    return;\n                }\n                var el = event.target;\n                while (el) {\n                    if (el === editor.element[0]) {\n                        return;\n                    }\n                    el = el.parentNode;\n                }\n                var object = this.objectAt(event);\n                if (object && object.ref && editor.canInsertRef(false)) {\n                    editor.refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                }\n            },\n            onDblClick: function (event) {\n                var object = this.objectAt(event);\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (object.type !== 'cell' || disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet().selection(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n                this.onEditorUpdate();\n            },\n            onCut: function (e) {\n                if (e) {\n                    var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                    this.clipboardElement.append(table.clone(false));\n                    setTimeout(function () {\n                        this.clipboardElement.empty().append(table);\n                    }.bind(this));\n                }\n                this._execute({\n                    command: 'CutCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            clipBoardValue: function () {\n                return this.clipboardElement.html();\n            },\n            onPaste: function (e) {\n                var html = '';\n                var plain = '';\n                this.clipboard.menuInvoked = e === undefined;\n                if (e) {\n                    if (e.originalEvent.clipboardData && e.originalEvent.clipboardData.getData) {\n                        e.preventDefault();\n                        var hasHTML = false;\n                        var hasPlainText = false;\n                        if (window.DOMStringList && e.originalEvent.clipboardData.types instanceof window.DOMStringList) {\n                            hasHTML = e.originalEvent.clipboardData.types.contains('text/html');\n                            hasPlainText = e.originalEvent.clipboardData.types.contains('text/plain');\n                        } else {\n                            hasHTML = /text\\/html/.test(e.originalEvent.clipboardData.types);\n                            hasPlainText = /text\\/plain/.test(e.originalEvent.clipboardData.types);\n                        }\n                        if (hasHTML) {\n                            html = e.originalEvent.clipboardData.getData('text/html');\n                        }\n                        if (hasPlainText) {\n                            plain = e.originalEvent.clipboardData.getData('text/plain').trim();\n                        }\n                    } else {\n                        var table = this.clipboardElement.find('table.kendo-clipboard-' + this.clipboard._uid).detach();\n                        this.clipboardElement.empty();\n                        setTimeout(function () {\n                            var html = this.clipboardElement.html();\n                            var plain = window.clipboardData.getData('Text').trim();\n                            if (!html && !plain) {\n                                return;\n                            }\n                            this.clipboard.external({\n                                html: html,\n                                plain: plain\n                            });\n                            this.clipboardElement.empty().append(table);\n                            this._execute({\n                                command: 'PasteCommand',\n                                options: {\n                                    workbook: this.view._workbook,\n                                    event: e.originalEvent || e\n                                }\n                            });\n                            this.clipboard.menuInvoked = true;\n                        }.bind(this));\n                        return;\n                    }\n                } else {\n                    if (kendo.support.browser.msie) {\n                        this.clipboardElement.focus().select();\n                        document.execCommand('paste');\n                        return;\n                    } else {\n                        this.clipboard.menuInvoked = true;\n                    }\n                }\n                if (!html && !plain) {\n                    return;\n                }\n                this.clipboard.external({\n                    html: html,\n                    plain: plain\n                });\n                this._execute({\n                    command: 'PasteCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            onCopy: function (e) {\n                this.clipboard.menuInvoked = e === undefined;\n                this._execute({\n                    command: 'CopyCommand',\n                    options: {\n                        workbook: this.view._workbook,\n                        event: e.originalEvent || e\n                    }\n                });\n            },\n            scrollTop: function () {\n                this.scroller.scrollTop = 0;\n            },\n            scrollLeft: function () {\n                this.scroller.scrollLeft = 0;\n            },\n            scrollDown: function (value) {\n                this.scroller.scrollTop += value;\n            },\n            scrollRight: function (value) {\n                this.scroller.scrollLeft += value;\n            },\n            scrollWith: function (right, down) {\n                this.scroller.scrollTop += down;\n                this.scroller.scrollLeft += right;\n            },\n            objectAt: function (location) {\n                if (!location) {\n                    return;\n                }\n                var box = this.container[0].getBoundingClientRect();\n                return this.view.objectAt(location.clientX - box.left, location.clientY - box.top);\n            },\n            selectToLocation: function (cellLocation) {\n                var object = this.objectAt(cellLocation);\n                if (object.pane) {\n                    this.extendSelection(object);\n                    this.lastKnownCellLocation = cellLocation;\n                    this.originFrame = object.pane;\n                }\n                this.stopAutoScroll();\n            },\n            extendSelection: function (object) {\n                this.navigator.extendSelection(object.ref, this._selectionMode, this.appendSelection);\n            },\n            autoScroll: function () {\n                var x = this._autoScrollTarget.x;\n                var y = this._autoScrollTarget.y;\n                var boundaries = this.originFrame._grid;\n                var scroller = this.view.scroller;\n                var scrollStep = 8;\n                var scrollLeft = scroller.scrollLeft;\n                var scrollTop = scroller.scrollTop;\n                if (x < boundaries.left) {\n                    this.scrollRight(-scrollStep);\n                }\n                if (x > boundaries.right) {\n                    this.scrollRight(scrollStep);\n                }\n                if (y < boundaries.top) {\n                    this.scrollDown(-scrollStep);\n                }\n                if (y > boundaries.bottom) {\n                    this.scrollDown(scrollStep);\n                }\n                if (scrollTop === scroller.scrollTop && scrollLeft === scroller.scrollLeft) {\n                    this.selectToLocation(this.finalLocation);\n                } else {\n                    this.extendSelection(this.objectAt(this.lastKnownCellLocation));\n                }\n            },\n            startAutoScroll: function (viewObject, location) {\n                if (!this._scrollInterval) {\n                    this._scrollInterval = setInterval(this.autoScroll.bind(this), 50);\n                }\n                this.finalLocation = location || this.lastKnownCellLocation;\n                this._autoScrollTarget = viewObject;\n            },\n            stopAutoScroll: function () {\n                clearInterval(this._scrollInterval);\n                this._scrollInterval = null;\n            },\n            openCustomEditor: function () {\n                this.view.openCustomEditor();\n            },\n            openFilterMenu: function (event) {\n                var object = this.objectAt(event);\n                var sheet = this._workbook.activeSheet();\n                var column = sheet.filterColumn(object.ref);\n                var filterMenu = this.view.createFilterMenu(column);\n                filterMenu.bind('action', this.onCommandRequest.bind(this));\n                filterMenu.bind('action', filterMenu.close.bind(filterMenu));\n                filterMenu.openFor(event.target);\n            },\n            onEditorChange: function (e) {\n                var sheet = e.range._sheet;\n                if (this._workbook.activeSheet() !== sheet) {\n                    this._workbook.activeSheet()._setFormulaSelections();\n                    this._workbook.activeSheet(sheet);\n                }\n                sheet.isInEditMode(false);\n                this._lastEditorValue = e.value;\n                this._execute({\n                    command: 'EditCommand',\n                    options: {\n                        editActiveCell: true,\n                        value: e.value\n                    }\n                });\n            },\n            onEditorActivate: function () {\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                sheet._setFormulaSelections(this.editor.highlightedRefs());\n                sheet.isInEditMode(true);\n            },\n            onEditorDeactivate: function () {\n                var sheet = this._workbook.activeSheet();\n                sheet.isInEditMode(false);\n                sheet._setFormulaSelections([]);\n            },\n            onEditorUpdate: function () {\n                this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs());\n            },\n            onEditorBarFocus: function () {\n                var disabled = this._workbook.activeSheet().selection().enable() === false;\n                if (disabled) {\n                    return;\n                }\n                this.editor.activate({\n                    range: this._workbook.activeSheet().selection(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                });\n            },\n            onEditorCellFocus: function () {\n                this.editor.scale();\n            },\n            onEditorEsc: function () {\n                this.resetEditorValue();\n                this.editor.deactivate();\n                this.clipboardElement.focus();\n            },\n            insertNewline: function (e) {\n                e.preventDefault();\n                this.editor.insertNewline();\n            },\n            onEditorBlur: function (_, action) {\n                if (this.editor.isFiltered()) {\n                    return;\n                }\n                this._preventNavigation = false;\n                this.editor.deactivate();\n                if (!this._preventNavigation) {\n                    this.clipboardElement.focus();\n                    this.navigator.navigateInSelection(ENTRY_ACTIONS[action]);\n                }\n            },\n            onEditorAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.moveActiveCell(ACTIONS[action]);\n                    editor.activeEditor().refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            onEditorShiftAction: function (event, action) {\n                var editor = this.editor;\n                var sheet = this._workbook.activeSheet();\n                if (editor.canInsertRef(true)) {\n                    this.navigator.modifySelection(ACTIONS[action.replace('shift+', '')], this.appendSelection);\n                    editor.activeEditor().refAtPoint(sheet);\n                    sheet._setFormulaSelections(editor.highlightedRefs());\n                    event.preventDefault();\n                }\n            },\n            resetEditorValue: function () {\n                this.editor.value(this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell()));\n            },\n            activateEditor: function () {\n                this.editor.activate({\n                    range: this._workbook.activeSheet().selection(),\n                    rect: this.view.activeCellRectangle(),\n                    tooltip: this._activeTooltip()\n                }).focus();\n            },\n            deactivateEditor: function () {\n                this.view.editor.deactivate();\n            },\n            onCommandRequest: function (e) {\n                if (e.command) {\n                    this._execute(e);\n                } else {\n                    this._workbook.undoRedoStack[e.action]();\n                }\n            },\n            onDialogRequest: function (e) {\n                var additionalOptions = {\n                    pdfExport: this._workbook.options.pdf,\n                    excelExport: this._workbook.options.excel\n                };\n                if (e.options) {\n                    $.extend(true, e.options, additionalOptions);\n                } else {\n                    e.options = additionalOptions;\n                }\n                this.view.openDialog(e.name, e.options);\n            },\n            onNameEditorEnter: function () {\n                var ref;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var name = this.view.nameEditor.value();\n                ref = kendo.spreadsheet.calc.parseReference(name, true) || workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                ref = sheet.selection()._ref.clone().simplify().setSheet(sheet.name(), true);\n                this._execute({\n                    command: 'DefineNameCommand',\n                    options: {\n                        name: name,\n                        value: ref\n                    }\n                });\n                this.clipboardElement.focus();\n            },\n            onNameEditorCancel: function () {\n                this.clipboardElement.focus();\n            },\n            onNameEditorSelect: function (ev) {\n                var name = ev.name;\n                var workbook = this._workbook;\n                var sheet = workbook.activeSheet();\n                var ref = workbook.nameValue(name);\n                if (ref instanceof kendo.spreadsheet.Ref) {\n                    if (ref.sheet && ref.sheet.toLowerCase() != sheet.name().toLowerCase()) {\n                        var tmp = workbook.sheetByName(ref.sheet);\n                        if (tmp) {\n                            workbook.activeSheet(tmp);\n                            sheet = tmp;\n                        }\n                    }\n                    sheet.range(ref).select();\n                    return;\n                }\n                this.clipboardElement.focus();\n            },\n            onNameEditorDelete: function (ev) {\n                this._execute({\n                    command: 'DeleteNameCommand',\n                    options: { name: ev.name }\n                });\n                this.clipboardElement.focus();\n            }\n        });\n        kendo.spreadsheet.Controller = Controller;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/view', [\n        'kendo.core',\n        'kendo.menu',\n        'spreadsheet/sheetsbar'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CellRef = kendo.spreadsheet.CellRef;\n        var DOT = '.';\n        var RESIZE_HANDLE_WIDTH = 7;\n        var viewClassNames = {\n            view: 'k-spreadsheet-view',\n            fixedContainer: 'k-spreadsheet-fixed-container',\n            editContainer: 'k-spreadsheet-edit-container',\n            scroller: 'k-spreadsheet-scroller',\n            viewSize: 'k-spreadsheet-view-size',\n            clipboard: 'k-spreadsheet-clipboard',\n            cellEditor: 'k-spreadsheet-cell-editor',\n            barEditor: 'k-spreadsheet-editor',\n            topCorner: 'k-spreadsheet-top-corner',\n            filterHeadersWrapper: 'k-filter-wrapper',\n            filterRange: 'k-filter-range',\n            filterButton: 'k-spreadsheet-filter',\n            filterButtonActive: 'k-state-active',\n            horizontalResize: 'k-horizontal-resize',\n            verticalResize: 'k-vertical-resize',\n            icon: 'k-icon',\n            iconFilterDefault: 'k-i-arrow-60-down',\n            sheetsBar: 'k-spreadsheet-sheets-bar',\n            sheetsBarActive: 'k-spreadsheet-sheets-bar-active',\n            sheetsBarInactive: 'k-spreadsheet-sheets-bar-inactive',\n            cellContextMenu: 'k-spreadsheet-cell-context-menu',\n            rowHeaderContextMenu: 'k-spreadsheet-row-header-context-menu',\n            colHeaderContextMenu: 'k-spreadsheet-col-header-context-menu'\n        };\n        kendo.spreadsheet.messages.view = {\n            nameBox: 'Name Box',\n            errors: {\n                openUnsupported: 'Unsupported format. Please select an .xlsx file.',\n                shiftingNonblankCells: 'Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.',\n                insertColumnWhenRowIsSelected: 'Cannot insert column when all columns are selected.',\n                insertRowWhenColumnIsSelected: 'Cannot insert row when all rows are selected.',\n                filterRangeContainingMerges: 'Cannot create a filter within a range containing merges',\n                sortRangeContainingMerges: 'Cannot sort a range containing merges',\n                cantSortMultipleSelection: 'Cannot sort multiple selection',\n                cantSortNullRef: 'Cannot sort empty selection',\n                cantSortMixedCells: 'Cannot sort range containing cells of mixed shapes',\n                validationError: 'The value that you entered violates the validation rules set on the cell.',\n                cannotModifyDisabled: 'Cannot modify disabled cells.'\n            },\n            tabs: {\n                home: 'Home',\n                insert: 'Insert',\n                data: 'Data'\n            }\n        };\n        function selectElementContents(el) {\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            var range = document.createRange();\n            range.selectNodeContents(el);\n            sel.addRange(range);\n        }\n        function cellBefore(table, row) {\n            var cells = table.trs[row].children;\n            return cells[cells.length - 2];\n        }\n        function cellAbove(table, row) {\n            var prevRow = table.trs[row - 1];\n            var index = table.trs[row].children.length - 1;\n            if (prevRow && index >= 0) {\n                return prevRow.children[index];\n            }\n        }\n        function cellBorder(value) {\n            return (value.size || 1) + 'px solid ' + (value.color || '#000');\n        }\n        function asURL(link) {\n            if (!/:\\/\\//.test(link)) {\n                link = 'http://' + link;\n            }\n            return link;\n        }\n        function drawCell(collection, cell, cls, showGrid) {\n            function maybeLink(el) {\n                var link = cell.link;\n                if (!link) {\n                    if (typeof cell.value == 'object') {\n                        link = cell.value.link;\n                    }\n                }\n                if (link) {\n                    var style = { textDecoration: 'none' };\n                    if (cell.color) {\n                        style.color = cell.color;\n                    }\n                    if (cell.underline) {\n                        style.textDecoration = 'underline';\n                    }\n                    return kendo.dom.element('a', {\n                        href: asURL(link),\n                        style: style,\n                        target: '_blank'\n                    }, el ? [el] : []);\n                }\n                return el;\n            }\n            var shouldDraw = cell.value != null || cell.validation != null && !cell.validation.value || cell.background || cell.merged;\n            if (!cls && !shouldDraw) {\n                return;\n            }\n            var style = {};\n            var background = cell.background;\n            if (background) {\n                var defaultBorder = background;\n                if (showGrid) {\n                    defaultBorder = kendo.parseColor(defaultBorder).toHSV();\n                    defaultBorder.v *= 0.9;\n                    defaultBorder = defaultBorder.toCssRgba();\n                }\n                defaultBorder = cellBorder({ color: defaultBorder });\n                style.outline = defaultBorder;\n            }\n            if (background) {\n                style.backgroundColor = background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.overflowWrap = 'break-word';\n                style.wordWrap = 'break-word';\n            }\n            style.left = cell.left + 1 + 'px';\n            style.top = cell.top + 1 + 'px';\n            style.width = cell.width - 1 + 'px';\n            style.height = cell.height - 1 + 'px';\n            var data = cell.value, type = typeof data;\n            if (cell.format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            } else if (data !== null && data !== undefined) {\n                data = kendo.dom.text(data);\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                case 'currency':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var classNames = [paneClassNames.cell];\n            if (cls) {\n                classNames.push(cls);\n            }\n            if (cell.enable === false) {\n                classNames.push('k-state-disabled');\n            }\n            if (cell.merged) {\n                classNames.push('k-spreadsheet-merged-cell');\n            }\n            var verticalAlign = cell.verticalAlign || 'bottom';\n            if (verticalAlign && data) {\n                data = kendo.dom.element('div', { className: 'k-vertical-align-' + verticalAlign }, [maybeLink(data)]);\n            } else {\n                data = maybeLink(data);\n            }\n            var children = data ? [data] : [];\n            var properties = { style: style };\n            var validation = cell.validation;\n            if (validation && !validation.value) {\n                children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                classNames.push('k-dirty-cell');\n                properties.title = validation.message;\n            }\n            properties.className = classNames.join(' ');\n            var div = kendo.dom.element('div', properties, children);\n            collection.push(div);\n            return div;\n        }\n        function addCell(table, row, cell) {\n            var style = {};\n            if (cell.background) {\n                style.backgroundColor = cell.background;\n            }\n            if (cell.color) {\n                style.color = cell.color;\n            }\n            if (cell.fontFamily) {\n                style.fontFamily = cell.fontFamily;\n            }\n            if (cell.underline) {\n                style.textDecoration = 'underline';\n            }\n            if (cell.italic) {\n                style.fontStyle = 'italic';\n            }\n            if (cell.textAlign) {\n                style.textAlign = cell.textAlign;\n            }\n            if (cell.verticalAlign) {\n                style.verticalAlign = cell.verticalAlign === 'center' ? 'middle' : cell.verticalAlign;\n            }\n            if (cell.bold) {\n                style.fontWeight = 'bold';\n            }\n            if (cell.fontSize) {\n                style.fontSize = cell.fontSize + 'px';\n            }\n            if (cell.wrap === true) {\n                style.whiteSpace = 'pre-wrap';\n                style.wordBreak = 'break-all';\n            }\n            if (cell.borderRight) {\n                style.borderRight = cellBorder(cell.borderRight);\n            } else if (cell.background) {\n                style.borderRightColor = cell.background;\n            }\n            if (cell.borderBottom) {\n                style.borderBottom = cellBorder(cell.borderBottom);\n            } else if (cell.background) {\n                style.borderBottomColor = cell.background;\n            }\n            var data = cell.value, type = typeof data;\n            if (cell.format && data != null) {\n                data = kendo.spreadsheet.formatting.format(data, cell.format);\n                if (data.__dataType) {\n                    type = data.__dataType;\n                }\n            }\n            if (!style.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                case 'currency':\n                    style.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    style.textAlign = 'center';\n                    break;\n                }\n            }\n            var className = null;\n            if (cell.enable === false) {\n                className = 'k-state-disabled';\n            }\n            var td = table.addCell(row, data, style, className, cell.validation);\n            var border, sibling;\n            if (cell.borderLeft) {\n                sibling = cellBefore(table, row);\n                border = cellBorder(cell.borderLeft);\n                if (sibling && border) {\n                    sibling.attr.style.borderRight = border;\n                }\n            } else if (cell.background) {\n                style.borderLeftColor = cell.background;\n            }\n            if (cell.borderTop) {\n                sibling = cellAbove(table, row);\n                border = cellBorder(cell.borderTop);\n                if (sibling && border) {\n                    sibling.attr.style.borderBottom = border;\n                }\n            } else if (cell.background) {\n                style.borderTopColor = cell.background;\n            }\n            return td;\n        }\n        var HtmlTable = kendo.Class.extend({\n            init: function () {\n                this.cols = [];\n                this.trs = [];\n                this._height = 0;\n                this._width = 0;\n            },\n            addColumn: function (width) {\n                this._width += width;\n                var col = kendo.dom.element('col', { style: { width: width + 'px' } });\n                col.visible = width > 0;\n                this.cols.push(col);\n            },\n            addRow: function (height) {\n                var attr = null;\n                attr = { style: { height: height + 'px' } };\n                this._height += height;\n                var tr = kendo.dom.element('tr', attr);\n                tr.visible = height > 0;\n                this.trs.push(tr);\n            },\n            addCell: function (rowIndex, text, style, className, validation) {\n                if (text === null || text === undefined) {\n                    text = '';\n                }\n                if (!(text instanceof kendo.dom.Node)) {\n                    text = kendo.dom.text(text);\n                }\n                var children = [text];\n                var properties = { style: style };\n                if (validation && !validation.value) {\n                    children.push(kendo.dom.element('span', { className: 'k-dirty' }));\n                    className = (className || '') + (className ? ' ' : '') + 'k-dirty-cell';\n                    properties.title = validation.message;\n                }\n                if (className) {\n                    properties.className = className;\n                }\n                var td = kendo.dom.element('td', properties, children);\n                this.trs[rowIndex].children.push(td);\n                return td;\n            },\n            toDomTree: function (x, y, className) {\n                this.trs = this.trs.filter(function (tr) {\n                    return tr.visible;\n                });\n                var offset = 0;\n                this.cols = this.cols.filter(function (col, ci) {\n                    if (!col.visible) {\n                        this.trs.forEach(function (tr) {\n                            tr.children.splice(ci - offset, 1);\n                        });\n                        offset++;\n                    }\n                    return col.visible;\n                }, this);\n                return kendo.dom.element('table', {\n                    style: {\n                        left: x + 'px',\n                        top: y + 'px',\n                        height: this._height + 'px',\n                        width: this._width + 'px'\n                    },\n                    className: className\n                }, [\n                    kendo.dom.element('colgroup', null, this.cols),\n                    kendo.dom.element('tbody', null, this.trs)\n                ]);\n            }\n        });\n        var CELL_CONTEXT_MENU = '<ul class=\"#=classNames.cellContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=merge>Merge</li>' + '<li data-action=unmerge>Unmerge</li>' + '</ul>';\n        var ROW_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.rowHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-row\">Delete</li>' + '<li data-action=\"hide-row\">Hide</li>' + '<li data-action=\"unhide-row\">Unhide</li>' + '</ul>';\n        var COL_HEADER_CONTEXT_MENU = '<ul class=\"#=classNames.colHeaderContextMenu#\">' + '<li data-action=cut>Cut</li>' + '<li data-action=copy>Copy</li>' + '<li data-action=paste>Paste</li>' + '<li class=\"k-separator\"></li>' + '<li data-action=\"delete-column\">Delete</li>' + '<li data-action=\"hide-column\">Hide</li>' + '<li data-action=\"unhide-column\">Unhide</li>' + '</ul>';\n        kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n        var VIEW_CONTENTS = kendo.template('<div class=\"#=classNames.view#\"><div class=\"#=classNames.fixedContainer#\"></div><div class=\"#=classNames.scroller#\"><div class=\"#=classNames.viewSize#\"></div></div>' + '<div tabindex=\"0\" class=\"#=classNames.clipboard#\" contenteditable=true></div><div class=\"#=classNames.cellEditor#\"></div></div><div class=\"#=classNames.sheetsBar#\"></div>' + CELL_CONTEXT_MENU + ROW_HEADER_CONTEXT_MENU + COL_HEADER_CONTEXT_MENU);\n        function within(value, min, max) {\n            return value >= min && value <= max;\n        }\n        var View = kendo.Class.extend({\n            init: function (element, options) {\n                var classNames = View.classNames;\n                this.element = element;\n                this.options = $.extend(true, { messages: kendo.spreadsheet.messages.view }, this.options, options);\n                this._chrome();\n                this._dialogs = [];\n                element.append(VIEW_CONTENTS({ classNames: classNames }));\n                this._formulaInput();\n                this.wrapper = element.find(DOT + classNames.view);\n                this.container = element.find(DOT + classNames.fixedContainer)[0];\n                this.scroller = element.find(DOT + classNames.scroller)[0];\n                this.clipboard = element.find(DOT + classNames.clipboard);\n                this.viewSize = $(this.scroller.firstChild);\n                this.tree = new kendo.dom.Tree(this.container);\n                this.clipboardContents = new kendo.dom.Tree(this.clipboard[0]);\n                this.editor = new kendo.spreadsheet.SheetEditor(this);\n                this._sheetsbar();\n                var contextMenuConfig = {\n                    target: element,\n                    animation: false,\n                    showOn: 'never'\n                };\n                this.cellContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.cellContextMenu), contextMenuConfig);\n                this.colHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.colHeaderContextMenu), contextMenuConfig);\n                this.rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu(element.find(DOT + classNames.rowHeaderContextMenu), contextMenuConfig);\n                var scrollbar = kendo.support.scrollbar();\n                $(this.container).css({\n                    width: this.wrapper[0].clientWidth - scrollbar,\n                    height: this.wrapper[0].clientHeight - scrollbar\n                });\n            },\n            enableClipboard: function (enable) {\n                this.isClipboardDeactivated = !enable;\n                if (enable) {\n                    this.clipboard.attr('contenteditable', enable);\n                } else {\n                    this.clipboard.removeAttr('contenteditable');\n                }\n            },\n            _resize: function () {\n                var outerHeight = kendo._outerHeight;\n                var tabstripHeight = this.tabstrip ? outerHeight(this.tabstrip.element) : 0;\n                var formulaBarHeight = this.formulaBar ? outerHeight(this.formulaBar.element) : 0;\n                var sheetsBarHeight = this.sheetsbar ? outerHeight(this.sheetsbar.element) : 0;\n                this.wrapper.height(this.element.height() - (tabstripHeight + formulaBarHeight + sheetsBarHeight));\n                if (this.tabstrip) {\n                    this.tabstrip.quickAccessAdjust();\n                }\n            },\n            _chrome: function () {\n                var wrapper = $('<div class=\\'k-spreadsheet-action-bar\\' />').prependTo(this.element);\n                var nameEditor = $('<div class=\\'k-spreadsheet-name-editor\\' />').appendTo(wrapper);\n                this.nameEditor = new kendo.spreadsheet.NameEditor(nameEditor, this.options);\n                var formulaBar = $('<div />').appendTo(wrapper);\n                this.formulaBar = new kendo.spreadsheet.FormulaBar(formulaBar);\n                if (this.options.toolbar) {\n                    this._tabstrip();\n                }\n            },\n            _formulaInput: function () {\n                var editor = this.element.find(DOT + View.classNames.cellEditor);\n                this.formulaInput = new kendo.spreadsheet.FormulaInput(editor, { autoScale: true });\n            },\n            _sheetsbar: function () {\n                if (this.options.sheetsbar) {\n                    var options = $.extend(true, { openDialog: this.openDialog.bind(this) }, this.options.sheetsbar);\n                    this.sheetsbar = new kendo.spreadsheet.SheetsBar(this.element.find(DOT + View.classNames.sheetsBar), options);\n                }\n            },\n            _tabstrip: function () {\n                var messages = this.options.messages.tabs;\n                var options = $.extend(true, {\n                    home: true,\n                    insert: true,\n                    data: true\n                }, this.options.toolbar);\n                var tabs = [];\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                    this.element.children('.k-tabstrip').remove();\n                }\n                for (var name in options) {\n                    if (options[name] === true || options[name] instanceof Array) {\n                        tabs.push({\n                            id: name,\n                            text: messages[name],\n                            content: ''\n                        });\n                    }\n                }\n                this.tabstrip = new kendo.spreadsheet.TabStrip($('<div />').prependTo(this.element), {\n                    animation: false,\n                    dataTextField: 'text',\n                    dataContentField: 'content',\n                    dataSource: tabs,\n                    toolbarOptions: options,\n                    view: this\n                });\n                this.tabstrip.select(0);\n            },\n            _executeCommand: function (e) {\n                this._sheet.trigger('commandRequest', e);\n            },\n            workbook: function (workbook) {\n                this._workbook = workbook;\n                this.nameEditor._workbook = workbook;\n            },\n            sheet: function (sheet) {\n                this._sheet = sheet;\n            },\n            activeCellRectangle: function () {\n                return this.cellRectangle(this._sheet._viewActiveCell());\n            },\n            _rectangle: function (pane, ref) {\n                return pane._grid.boundingRectangle(ref.toRangeRef());\n            },\n            isColumnResizer: function (x, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                x -= this._sheet._grid._headerWidth;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var right = rectangle.right - this.scroller.scrollLeft;\n                return right - handleWidth <= x && x <= right + handleWidth;\n            },\n            isRowResizer: function (y, pane, ref) {\n                var rectangle = this._rectangle(pane, ref);\n                y -= this._sheet._grid._headerHeight;\n                var handleWidth = RESIZE_HANDLE_WIDTH / 2;\n                var bottom = rectangle.bottom - this.scroller.scrollTop;\n                return bottom - handleWidth <= y && y <= bottom + handleWidth;\n            },\n            isFilterIcon: function (x, y, pane, ref) {\n                var theGrid = pane._grid;\n                var scrollTop = theGrid.rows.frozen ? 0 : this.scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : this.scroller.scrollLeft;\n                x -= this._sheet._grid._headerWidth - scrollLeft;\n                y -= this._sheet._grid._headerHeight - scrollTop;\n                var result = false;\n                this._sheet.forEachFilterHeader(ref, function (ref) {\n                    if (!result) {\n                        var rect = this._rectangle(pane, ref);\n                        result = pane.filterIconRect(rect).intersects(x, y);\n                    }\n                }.bind(this));\n                return result;\n            },\n            isAutoFill: function (x, y, pane) {\n                var selection = this._sheet.select();\n                if (selection.size > 1) {\n                    return false;\n                }\n                x -= this._sheet._grid._headerWidth;\n                y -= this._sheet._grid._headerHeight;\n                if (!pane._grid.columns.frozen) {\n                    x += this.scroller.scrollLeft;\n                }\n                if (!pane._grid.rows.frozen) {\n                    y += this.scroller.scrollTop;\n                }\n                var rectangle = this._rectangle(pane, selection);\n                return Math.abs(rectangle.right - x) < 8 && Math.abs(rectangle.bottom - y) < 8;\n            },\n            isEditButton: function (x, y, column, columnCount) {\n                var ed = this._sheet.activeCellCustomEditor();\n                if (ed) {\n                    var editorOnLastColumn = column == columnCount - 2;\n                    var r = this.activeCellRectangle();\n                    if (y >= r.top && y <= r.bottom) {\n                        return editorOnLastColumn ? x < r.left && x >= r.left - 20 : x > r.right && x <= r.right + 20;\n                    }\n                }\n            },\n            objectAt: function (x, y) {\n                var grid = this._sheet._grid;\n                var object, pane;\n                if (x < 0 || y < 0 || x > this.scroller.clientWidth || y > this.scroller.clientHeight) {\n                    object = { type: 'outside' };\n                } else if (x < grid._headerWidth && y < grid._headerHeight) {\n                    object = { type: 'topcorner' };\n                } else {\n                    pane = this.paneAt(x, y);\n                    if (!pane) {\n                        object = { type: 'outside' };\n                    } else {\n                        var row = pane._grid.rows.indexVisible(y, this.scroller.scrollTop);\n                        var column = pane._grid.columns.indexVisible(x, this.scroller.scrollLeft);\n                        var type = 'cell';\n                        var ref = new CellRef(row, column);\n                        var selecting = this._sheet.selectionInProgress();\n                        if (this.isAutoFill(x, y, pane)) {\n                            type = 'autofill';\n                        } else if (this.isFilterIcon(x, y, pane, ref)) {\n                            type = 'filtericon';\n                        } else if (!selecting && x < grid._headerWidth) {\n                            ref = new CellRef(row, -Infinity);\n                            type = this.isRowResizer(y, pane, ref) ? 'rowresizehandle' : 'rowheader';\n                        } else if (!selecting && y < grid._headerHeight) {\n                            ref = new CellRef(-Infinity, column);\n                            type = this.isColumnResizer(x, pane, ref) ? 'columnresizehandle' : 'columnheader';\n                        } else if (this.isEditButton(x, y, column, grid.columnCount)) {\n                            type = 'editor';\n                        }\n                        object = {\n                            type: type,\n                            ref: ref\n                        };\n                    }\n                }\n                object.pane = pane;\n                object.x = x;\n                object.y = y;\n                return object;\n            },\n            paneAt: function (x, y) {\n                return this.panes.filter(function paneLocationWithin(pane) {\n                    var grid = pane._grid;\n                    return within(y, grid.top, grid.bottom) && within(x, grid.left, grid.right);\n                })[0];\n            },\n            containingPane: function (cell) {\n                return this.panes.filter(function (pane) {\n                    if (pane._grid.contains(cell)) {\n                        return true;\n                    }\n                    return false;\n                })[0];\n            },\n            cellRectangle: function (cell) {\n                var theGrid = this.containingPane(cell)._grid;\n                var rectangle = this._sheet._grid.rectangle(cell);\n                return rectangle.offset(theGrid.headerWidth - (theGrid.columns.frozen ? 0 : this.scroller.scrollLeft), theGrid.headerHeight - (theGrid.rows.frozen ? 0 : this.scroller.scrollTop));\n            },\n            refresh: function (reason) {\n                var sheet = this._sheet;\n                if (this.tabstrip) {\n                    this.tabstrip.refreshTools(sheet.range(sheet.activeCell()));\n                }\n                if (reason.sheetSelection && this.sheetsbar) {\n                    this.sheetsbar.renderSheets(this._workbook.sheets(), this._workbook.sheetIndex(this._sheet));\n                }\n                this._resize();\n                this.viewSize[0].style.height = sheet._grid.totalHeight() + 'px';\n                this.viewSize[0].style.width = sheet._grid.totalWidth() + 'px';\n                if (reason.layout) {\n                    var frozenColumns = sheet.frozenColumns();\n                    var frozenRows = sheet.frozenRows();\n                    this.panes = [this._pane(frozenRows, frozenColumns)];\n                    if (frozenColumns > 0) {\n                        this.panes.push(this._pane(frozenRows, 0, null, frozenColumns));\n                    }\n                    if (frozenRows > 0) {\n                        this.panes.push(this._pane(0, frozenColumns, frozenRows, null));\n                    }\n                    if (frozenRows > 0 && frozenColumns > 0) {\n                        this.panes.push(this._pane(0, 0, frozenRows, frozenColumns));\n                    }\n                }\n                if (reason.filter) {\n                    this._destroyFilterMenu();\n                }\n                if (reason.activeCell) {\n                    this._focus = sheet.activeCell().toRangeRef();\n                }\n            },\n            createFilterMenu: function (column) {\n                if (this._filterMenu && this._filterMenu.options.column == column) {\n                    return this._filterMenu;\n                }\n                this._destroyFilterMenu();\n                var sheet = this._sheet;\n                var ref = sheet.filter().ref;\n                var range = new kendo.spreadsheet.Range(ref, sheet);\n                var element = $('<div />').appendTo(this.element);\n                var options = {\n                    column: column,\n                    range: range\n                };\n                var filterMenu = new kendo.spreadsheet.FilterMenu(element, options);\n                this._filterMenu = filterMenu;\n                return filterMenu;\n            },\n            selectClipBoardContents: function () {\n                if (!this.isClipboardDeactivated) {\n                    this.clipboard.focus();\n                    selectElementContents(this.clipboard[0]);\n                }\n            },\n            scrollIntoView: function (cell) {\n                var willScroll = false;\n                var theGrid = this.containingPane(cell)._grid;\n                var boundaries = theGrid.scrollBoundaries(cell);\n                var scroller = this.scroller;\n                var scrollTop = theGrid.rows.frozen ? 0 : scroller.scrollTop;\n                var scrollLeft = theGrid.columns.frozen ? 0 : scroller.scrollLeft;\n                if (boundaries.top < scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollTop;\n                }\n                if (boundaries.bottom > scrollTop) {\n                    willScroll = true;\n                    scroller.scrollTop = boundaries.scrollBottom;\n                }\n                if (boundaries.left < scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollLeft;\n                }\n                if (boundaries.right > scrollLeft) {\n                    willScroll = true;\n                    scroller.scrollLeft = boundaries.scrollRight;\n                }\n                return willScroll;\n            },\n            _destroyDialog: function () {\n                this._dialogs.pop();\n            },\n            openCustomEditor: function () {\n                var self = this;\n                var cell = self._sheet.activeCell().first();\n                var editor = self._sheet.activeCellCustomEditor();\n                var range = self._sheet.range(cell);\n                editor.edit({\n                    range: range,\n                    rect: self.activeCellRectangle(),\n                    view: this,\n                    validation: this._sheet.validation(cell),\n                    callback: function (value, parse) {\n                        self._executeCommand({\n                            command: 'EditCommand',\n                            options: {\n                                operatingRange: range,\n                                property: parse ? 'input' : 'value',\n                                value: value\n                            }\n                        });\n                    }\n                });\n            },\n            openDialog: function (name, options) {\n                var dialog = kendo.spreadsheet.dialogs.create(name, options);\n                if (dialog) {\n                    dialog.bind('action', this._executeCommand.bind(this));\n                    dialog.bind('deactivate', this._destroyDialog.bind(this));\n                    this._dialogs.push(dialog);\n                    var sheet = this._sheet;\n                    var ref = sheet.activeCell();\n                    var range = new kendo.spreadsheet.Range(ref, sheet);\n                    dialog.open(range);\n                    return dialog;\n                }\n            },\n            showError: function (options, reopenEditor) {\n                var errorMessages = this.options.messages.errors;\n                var focusButton = function (e) {\n                    var cont = e.sender.dialog().element;\n                    cont.find('.k-button:first').focus();\n                    cont.find('.k-button, input').on('keydown', function (ev) {\n                        if (ev.keyCode == kendo.keys.ESC) {\n                            e.sender.close();\n                        }\n                    });\n                };\n                var onClose = function (e) {\n                    var dlg = e.sender;\n                    this.selectClipBoardContents();\n                    if (dlg._retry && reopenEditor) {\n                        reopenEditor();\n                    }\n                }.bind(this);\n                if (kendo.spreadsheet.dialogs.registered(options.type)) {\n                    var dialogOptions = { close: onClose };\n                    if (options.type === 'validationError') {\n                        dialogOptions = $.extend(dialogOptions, {\n                            title: options.title || 'Error',\n                            text: options.body ? options.body : errorMessages[options.type],\n                            activate: focusButton\n                        });\n                    }\n                    this.openDialog(options.type, dialogOptions);\n                } else {\n                    this.openDialog('message', {\n                        title: options.title || 'Error',\n                        text: options.body ? options.body : errorMessages[options.type],\n                        activate: focusButton,\n                        close: onClose\n                    });\n                }\n            },\n            destroy: function () {\n                this._dialogs.forEach(function (dialog) {\n                    dialog.destroy();\n                });\n                this.cellContextMenu.destroy();\n                this.rowHeaderContextMenu.destroy();\n                this.colHeaderContextMenu.destroy();\n                if (this.tabstrip) {\n                    this.tabstrip.destroy();\n                }\n                this._destroyFilterMenu();\n            },\n            _destroyFilterMenu: function () {\n                if (this._filterMenu) {\n                    this._filterMenu.destroy();\n                    this._filterMenu = undefined;\n                    this._filterMenuColumn = undefined;\n                }\n            },\n            render: function () {\n                if (!this.element.is(':visible')) {\n                    return;\n                }\n                var sheet = this._sheet;\n                var focus = sheet.focus();\n                if (focus && this.scrollIntoView(focus)) {\n                    return;\n                }\n                var resizeDirection = !sheet.resizingInProgress() ? 'none' : sheet.resizeHandlePosition().col === -Infinity ? 'column' : 'row';\n                this.wrapper.toggleClass(viewClassNames.editContainer, this.editor.isActive()).toggleClass(viewClassNames.horizontalResize, resizeDirection == 'row').toggleClass(viewClassNames.verticalResize, resizeDirection == 'column');\n                var grid = sheet._grid;\n                var scrollTop = this.scroller.scrollTop;\n                var scrollLeft = this.scroller.scrollLeft;\n                if (scrollTop < 0) {\n                    scrollTop = 0;\n                }\n                if (scrollLeft < 0) {\n                    scrollLeft = 0;\n                }\n                var result = this.panes.map(function (pane) {\n                    return pane.render(scrollLeft, scrollTop);\n                });\n                var topCorner = kendo.dom.element('div', {\n                    style: {\n                        width: grid._headerWidth + 'px',\n                        height: grid._headerHeight + 'px'\n                    },\n                    className: View.classNames.topCorner\n                });\n                result.push(topCorner);\n                if (sheet.resizeHandlePosition() && sheet.resizeHintPosition()) {\n                    result.push(this.renderResizeHint());\n                }\n                this.tree.render(result);\n                if (this.editor.isActive()) {\n                    this.editor.toggleTooltip(this.activeCellRectangle());\n                } else if (!sheet.selectionInProgress() && !sheet.resizingInProgress() && !sheet.isInEditMode()) {\n                    this.renderClipboardContents();\n                }\n            },\n            renderResizeHint: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var horizontal = ref.col !== -Infinity;\n                var style;\n                if (horizontal) {\n                    style = {\n                        height: this.scroller.clientHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: sheet.resizeHintPosition().x + 'px',\n                        top: '0px'\n                    };\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this.scroller.clientWidth + 'px',\n                        top: sheet.resizeHintPosition().y + 'px',\n                        left: '0px'\n                    };\n                }\n                var classNames = Pane.classNames;\n                return kendo.dom.element('div', {\n                    className: classNames.resizeHint + (!horizontal ? ' ' + classNames.resizeHintVertical : ''),\n                    style: style\n                }, [\n                    kendo.dom.element('div', { className: classNames.resizeHintHandle }),\n                    kendo.dom.element('div', { className: classNames.resizeHintMarker })\n                ]);\n            },\n            renderClipboardContents: function () {\n                var sheet = this._sheet;\n                var grid = sheet._grid;\n                var selection = sheet.select().toRangeRef();\n                var status = this._workbook.clipboard().canCopy();\n                if (status.canCopy === false && status.multiSelection) {\n                    this.clipboardContents.render([]);\n                    this.selectClipBoardContents();\n                    return;\n                }\n                selection = sheet.trim(selection);\n                var table = new HtmlTable();\n                var selectionView = grid.rangeDimensions(selection);\n                selectionView.rows.forEach(function (height) {\n                    table.addRow(height);\n                });\n                selectionView.columns.forEach(function (width) {\n                    table.addColumn(width);\n                });\n                var tmp = sheet._getMergedCells(selection);\n                var primaryMergedCells = tmp.primary;\n                var secondaryMergedCells = tmp.secondary;\n                sheet.forEach(selection, function (row, col, cell) {\n                    var location = new CellRef(row, col).print();\n                    if (!secondaryMergedCells[location]) {\n                        var td = addCell(table, row - selection.topLeft.row, cell);\n                        var mergedCell = primaryMergedCells[location];\n                        if (mergedCell) {\n                            td.attr.colspan = mergedCell.width();\n                            td.attr.rowspan = mergedCell.height();\n                        }\n                    }\n                });\n                this.clipboardContents.render([table.toDomTree(0, 0, 'kendo-clipboard-' + this._workbook.clipboard()._uid)]);\n                this.selectClipBoardContents();\n            },\n            _pane: function (row, column, rowCount, columnCount) {\n                var pane = new Pane(this._sheet, this._sheet._grid.pane({\n                    row: row,\n                    column: column,\n                    rowCount: rowCount,\n                    columnCount: columnCount\n                }));\n                pane.refresh(this.scroller.clientWidth, this.scroller.clientHeight);\n                return pane;\n            }\n        });\n        var paneClassNames = {\n            cell: 'k-spreadsheet-cell',\n            vaxis: 'k-spreadsheet-vaxis',\n            haxis: 'k-spreadsheet-haxis',\n            vborder: 'k-spreadsheet-vborder',\n            hborder: 'k-spreadsheet-hborder',\n            rowHeader: 'k-spreadsheet-row-header',\n            columnHeader: 'k-spreadsheet-column-header',\n            pane: 'k-spreadsheet-pane',\n            data: 'k-spreadsheet-data',\n            mergedCell: 'k-spreadsheet-merged-cell',\n            mergedCellsWrapper: 'k-merged-cells-wrapper',\n            activeCell: 'k-spreadsheet-active-cell',\n            selection: 'k-spreadsheet-selection',\n            selectionWrapper: 'k-selection-wrapper',\n            autoFillWrapper: 'k-auto-fill-wrapper',\n            single: 'k-single',\n            top: 'k-top',\n            right: 'k-right',\n            bottom: 'k-bottom',\n            left: 'k-left',\n            resizeHandle: 'k-resize-handle',\n            columnResizeHandle: 'k-column-resize-handle',\n            rowResizeHandle: 'k-row-resize-handle',\n            resizeHint: 'k-resize-hint',\n            resizeHintHandle: 'k-resize-hint-handle',\n            resizeHintMarker: 'k-resize-hint-marker',\n            resizeHintVertical: 'k-resize-hint-vertical',\n            selectionHighlight: 'k-spreadsheet-selection-highlight',\n            series: [\n                'k-series-a',\n                'k-series-b',\n                'k-series-c',\n                'k-series-d',\n                'k-series-e',\n                'k-series-f'\n            ]\n        };\n        var Pane = kendo.Class.extend({\n            init: function (sheet, grid) {\n                this._sheet = sheet;\n                this._grid = grid;\n            },\n            refresh: function (width, height) {\n                this._grid.refresh(width, height);\n            },\n            isVisible: function (scrollLeft, scrollTop, ref) {\n                return this._grid.view(scrollLeft, scrollTop).ref.intersects(ref);\n            },\n            render: function (scrollLeft, scrollTop) {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var grid = this._grid;\n                var view = grid.view(scrollLeft, scrollTop);\n                this._currentView = view;\n                this._currentRect = this._rectangle(view.ref);\n                this._selectedHeaders = sheet.selectedHeaders();\n                var children = [];\n                children.push(this.renderData());\n                children.push(this.renderSelection());\n                children.push(this.renderAutoFill());\n                children.push(this.renderEditorSelection());\n                children.push(this.renderFilterHeaders());\n                if (grid.hasRowHeader) {\n                    var rowHeader = kendo.dom.element('div', {\n                        className: classNames.rowHeader,\n                        style: {\n                            width: grid.headerWidth + 'px',\n                            top: view.rowOffset + 'px'\n                        }\n                    });\n                    children.push(rowHeader);\n                    sheet.forEach(view.ref.leftColumn(), function (row) {\n                        if (!sheet.isHiddenRow(row)) {\n                            var text = row + 1, height = sheet.rowHeight(row);\n                            rowHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(row, 'row'),\n                                style: {\n                                    width: grid.headerWidth + 'px',\n                                    height: height + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                        }\n                    }.bind(this));\n                }\n                if (grid.hasColumnHeader) {\n                    var columnHeader = kendo.dom.element('div', {\n                        className: classNames.columnHeader,\n                        style: {\n                            top: '0px',\n                            left: view.columnOffset + 'px',\n                            width: this._currentRect.width + 'px',\n                            height: grid.headerHeight + 'px'\n                        }\n                    });\n                    children.push(columnHeader);\n                    var left = 0;\n                    sheet.forEach(view.ref.topRow(), function (row, col) {\n                        if (!sheet.isHiddenColumn(col)) {\n                            var text = kendo.spreadsheet.Ref.display(null, Infinity, col), width = sheet.columnWidth(col);\n                            columnHeader.children.push(kendo.dom.element('div', {\n                                className: this.headerClassName(col, 'col'),\n                                style: {\n                                    position: 'absolute',\n                                    left: left + 'px',\n                                    width: width + 'px',\n                                    height: grid.headerHeight + 'px'\n                                }\n                            }, [kendo.dom.element('div', { className: 'k-vertical-align-center' }, [kendo.dom.text(text + '')])]));\n                            left += width;\n                        }\n                    }.bind(this));\n                }\n                if (sheet.resizeHandlePosition() && (grid.hasColumnHeader || grid.hasRowHeader)) {\n                    var ref = sheet._grid.normalize(sheet.resizeHandlePosition());\n                    if (view.ref.intersects(ref)) {\n                        if (!sheet.resizeHintPosition()) {\n                            children.push(this.renderResizeHandle());\n                        }\n                    }\n                }\n                var paneClasses = [classNames.pane];\n                if (grid.hasColumnHeader) {\n                    paneClasses.push(classNames.top);\n                }\n                if (grid.hasRowHeader) {\n                    paneClasses.push(classNames.left);\n                }\n                return kendo.dom.element('div', {\n                    style: grid.style,\n                    className: paneClasses.join(' ')\n                }, children);\n            },\n            headerClassName: function (index, type) {\n                var selectedHeaders = this._selectedHeaders;\n                var itemSelection;\n                var allHeaders;\n                if (type === 'row') {\n                    itemSelection = selectedHeaders.rows[index];\n                    allHeaders = selectedHeaders.allRows;\n                } else {\n                    itemSelection = selectedHeaders.cols[index];\n                    allHeaders = selectedHeaders.allCols;\n                }\n                var className = itemSelection || (selectedHeaders.all ? 'full' : allHeaders ? 'partial' : 'none');\n                if (className) {\n                    className = 'k-selection-' + className;\n                }\n                return className;\n            },\n            renderData: function () {\n                var sheet = this._sheet;\n                var view = this._currentView;\n                var cont = kendo.dom.element('div', {\n                    className: Pane.classNames.data,\n                    style: {\n                        position: 'relative',\n                        left: view.columnOffset + 'px',\n                        top: view.rowOffset + 'px'\n                    }\n                });\n                var rect = this._currentRect;\n                var layout = kendo.spreadsheet.draw.doLayout(sheet, view.ref, { forScreen: true }), prev;\n                var showGridLines = sheet._showGridLines;\n                if (showGridLines) {\n                    prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        if (x !== prev) {\n                            prev = x;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vaxis,\n                                style: {\n                                    left: x + 'px',\n                                    height: rect.height + 'px',\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                    prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        if (y !== prev) {\n                            prev = y;\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.haxis,\n                                style: {\n                                    top: y + 'px',\n                                    width: rect.width + 'px',\n                                    borderColor: sheet.gridLinesColor()\n                                }\n                            }));\n                        }\n                    });\n                }\n                var borders = kendo.spreadsheet.draw.Borders();\n                layout.cells.forEach(function (cell) {\n                    borders.add(cell);\n                    drawCell(cont.children, cell, null, showGridLines);\n                });\n                borders.vert.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            var style = {\n                                left: b.x + 'px',\n                                top: b.top + 'px',\n                                height: b.bottom - b.top + 1 + 'px',\n                                borderWidth: b.size + 'px',\n                                borderColor: b.color\n                            };\n                            if (b.size != 1) {\n                                style.transform = 'translateX(-' + (b.size - 1) / 2 + 'px)';\n                            }\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.vborder,\n                                style: style\n                            }));\n                        }\n                    });\n                });\n                borders.horiz.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            var style = {\n                                top: b.y + 'px',\n                                left: b.left + 'px',\n                                width: b.right - b.left + 'px',\n                                borderWidth: b.size + 'px',\n                                borderColor: b.color\n                            };\n                            if (b.size != 1) {\n                                style.transform = 'translateY(-' + (b.size - 1) / 2 + 'px)';\n                            }\n                            cont.children.push(kendo.dom.element('div', {\n                                className: paneClassNames.hborder,\n                                style: style\n                            }));\n                        }\n                    });\n                });\n                return cont;\n            },\n            renderResizeHandle: function () {\n                var sheet = this._sheet;\n                var ref = sheet.resizeHandlePosition();\n                var rectangle = this._rectangle(ref);\n                var classNames = [Pane.classNames.resizeHandle];\n                var style;\n                if (ref.col !== -Infinity) {\n                    style = {\n                        height: this._grid.headerHeight + 'px',\n                        width: RESIZE_HANDLE_WIDTH + 'px',\n                        left: rectangle.right - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        top: '0px'\n                    };\n                    classNames.push(viewClassNames.horizontalResize);\n                } else {\n                    style = {\n                        height: RESIZE_HANDLE_WIDTH + 'px',\n                        width: this._grid.headerWidth + 'px',\n                        top: rectangle.bottom - RESIZE_HANDLE_WIDTH / 2 + 'px',\n                        left: '0px'\n                    };\n                    classNames.push(viewClassNames.verticalResize);\n                }\n                return kendo.dom.element('div', {\n                    className: classNames.join(' '),\n                    style: style\n                });\n            },\n            filterIconRect: function (rect) {\n                var BUTTON_SIZE = 16;\n                var BUTTON_OFFSET = 3;\n                return new kendo.spreadsheet.Rectangle(rect.right - BUTTON_SIZE - BUTTON_OFFSET, rect.top + BUTTON_OFFSET, BUTTON_SIZE, BUTTON_SIZE);\n            },\n            renderFilterHeaders: function () {\n                var sheet = this._sheet;\n                var children = [];\n                var classNames = View.classNames;\n                var filter = sheet.filter();\n                function icon(className) {\n                    return kendo.dom.element('span', { className: classNames.icon + ' ' + className });\n                }\n                function filterButton(classNames, position, index) {\n                    var style = {\n                        left: position.left + 'px',\n                        top: position.top + 'px'\n                    };\n                    var filtered = filter && filter.columns.some(function (c) {\n                        return c.index === index;\n                    });\n                    var classes = classNames.filterButton;\n                    if (filtered) {\n                        classes += ' ' + classNames.filterButtonActive;\n                    }\n                    var button = kendo.dom.element('span', {\n                        className: classes,\n                        style: style\n                    }, [icon(classNames.iconFilterDefault)]);\n                    return button;\n                }\n                if (filter) {\n                    this._addDiv(children, filter.ref, classNames.filterRange);\n                }\n                sheet.forEachFilterHeader(this._currentView.ref, function (ref) {\n                    var rect = this._rectangle(ref);\n                    var position = this.filterIconRect(rect);\n                    var column = this._sheet.filterColumn(ref);\n                    var button = filterButton(classNames, position, column);\n                    children.push(button);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.filterHeadersWrapper }, children);\n            },\n            renderEditorSelection: function () {\n                var classNames = Pane.classNames;\n                var sheet = this._sheet;\n                var selections = [];\n                sheet._formulaSelections.forEach(function (range) {\n                    var ref = range.ref;\n                    if (ref === kendo.spreadsheet.NULLREF) {\n                        return;\n                    }\n                    this._addDiv(selections, ref, classNames.selectionHighlight + ' ' + range.colorClass);\n                }.bind(this));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderSelection: function () {\n                var classNames = Pane.classNames;\n                var selections = [];\n                var activeCellClasses = [classNames.activeCell];\n                var selectionClasses = [classNames.selection];\n                var sheet = this._sheet;\n                var activeCell = sheet.activeCell().toRangeRef();\n                var activeFormulaColor = this._activeFormulaColor();\n                var selection = sheet.select();\n                activeCellClasses = activeCellClasses.concat(activeFormulaColor, this._directionClasses(activeCell));\n                selectionClasses = selectionClasses.concat(activeFormulaColor);\n                if (sheet.singleCellSelection()) {\n                    activeCellClasses.push(classNames.single);\n                }\n                if (selection.size() === 1) {\n                    selectionClasses.push('k-single-selection');\n                }\n                if (this._sheet.autoFillPunch()) {\n                    selectionClasses.push('k-dim-auto-fill-handle');\n                }\n                selection.forEach(function (ref) {\n                    if (ref !== kendo.spreadsheet.NULLREF) {\n                        this._addDiv(selections, ref, selectionClasses.join(' '));\n                    }\n                }.bind(this));\n                this._addTable(selections, activeCell, activeCellClasses.join(' '));\n                return kendo.dom.element('div', { className: classNames.selectionWrapper }, selections);\n            },\n            renderAutoFill: function () {\n                var autoFillRectangle = [];\n                if (this._sheet.autoFillInProgress()) {\n                    var autoFillRef = this._sheet.autoFillRef();\n                    var punch = this._sheet.autoFillPunch();\n                    var direction = this._sheet._autoFillDirection;\n                    this._addDiv(autoFillRectangle, autoFillRef, 'k-auto-fill');\n                    if (punch) {\n                        this._addDiv(autoFillRectangle, punch, 'k-auto-fill-punch');\n                    } else if (direction !== undefined) {\n                        var ref, cssClass;\n                        switch (direction) {\n                        case 0:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 1:\n                            ref = autoFillRef.bottomRight;\n                            cssClass = 'k-auto-fill-br-hint';\n                            break;\n                        case 2:\n                            ref = new CellRef(autoFillRef.topLeft.row, autoFillRef.bottomRight.col);\n                            cssClass = 'k-auto-fill-tr-hint';\n                            break;\n                        case 3:\n                            ref = new CellRef(autoFillRef.bottomRight.row, autoFillRef.topLeft.col);\n                            cssClass = 'k-auto-fill-bl-hint';\n                            break;\n                        }\n                        var hint = kendo.dom.element('span', { className: 'k-tooltip' }, [kendo.dom.text(this._sheet._autoFillHint)]);\n                        var rectangle = this._addDiv(autoFillRectangle, ref, cssClass);\n                        if (rectangle) {\n                            rectangle.children.push(hint);\n                        }\n                    }\n                }\n                return kendo.dom.element('div', { className: Pane.classNames.autoFillWrapper }, autoFillRectangle);\n            },\n            _addDiv: function (collection, ref, className) {\n                var view = this._currentView, div;\n                if (view.ref.intersects(ref)) {\n                    div = this._rectangle(ref).resize(1, 1).toDiv(className);\n                    collection.push(div);\n                }\n                return div;\n            },\n            _addTable: function (collection, ref, className) {\n                var self = this;\n                var sheet = self._sheet;\n                var view = self._currentView;\n                var columnCount = self._grid.columns._axis._count;\n                if (view.ref.intersects(ref)) {\n                    var rectangle = self._rectangle(ref);\n                    var ed = self._sheet.activeCellCustomEditor();\n                    sheet.forEach(ref.collapse(), function (row, col, cell) {\n                        cell.left = rectangle.left;\n                        cell.top = rectangle.top;\n                        cell.width = rectangle.width;\n                        cell.height = rectangle.height;\n                        drawCell(collection, cell, className, true);\n                        if (ed) {\n                            var btnClass = 'k-button k-spreadsheet-editor-button';\n                            var isLastColumn = col == columnCount - 1;\n                            if (isLastColumn) {\n                                btnClass += ' k-spreadsheet-last-column';\n                            }\n                            var btn = kendo.dom.element('div', {\n                                className: btnClass,\n                                style: {\n                                    left: cell.left + (isLastColumn ? 0 : cell.width) + 'px',\n                                    top: cell.top + 'px',\n                                    height: cell.height + 'px'\n                                }\n                            });\n                            if (ed.icon) {\n                                btn.children.push(kendo.dom.element('span', { className: 'k-icon ' + ed.icon }));\n                            }\n                            collection.push(btn);\n                        }\n                    });\n                }\n            },\n            _activeFormulaColor: function () {\n                var activeFormulaSelection;\n                var colorClasses = [];\n                if (this._sheet.isInEditMode()) {\n                    activeFormulaSelection = this._sheet._formulaSelections.filter(function (sel) {\n                        return sel.active && sel.type == 'ref';\n                    })[0];\n                    if (activeFormulaSelection) {\n                        colorClasses.push(activeFormulaSelection.colorClass);\n                    }\n                }\n                return colorClasses;\n            },\n            _directionClasses: function (cell) {\n                var cellClasses = [];\n                var classNames = Pane.classNames;\n                var view = this._currentView.ref;\n                if (!cell.move(0, -1).intersects(view)) {\n                    cellClasses.push(classNames.left);\n                }\n                if (!cell.move(-1, 0).intersects(view)) {\n                    cellClasses.push(classNames.top);\n                }\n                if (!cell.move(0, 1).intersects(view)) {\n                    cellClasses.push(classNames.right);\n                }\n                if (!cell.move(1, 0).intersects(view)) {\n                    cellClasses.push(classNames.bottom);\n                }\n                return cellClasses;\n            },\n            _rectangle: function (ref) {\n                return this._grid.boundingRectangle(ref.toRangeRef()).offset(-this._currentView.mergedCellLeft, -this._currentView.mergedCellTop);\n            }\n        });\n        kendo.spreadsheet.View = View;\n        kendo.spreadsheet.Pane = Pane;\n        kendo.spreadsheet.drawCell = drawCell;\n        $.extend(true, View, { classNames: viewClassNames });\n        $.extend(true, Pane, { classNames: paneClassNames });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/customeditors', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.calendar',\n        'kendo.listview',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        'use strict';\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var EDITORS = {};\n        var registerEditor = kendo.spreadsheet.registerEditor = function (name, editor) {\n            EDITORS[name] = editor;\n        };\n        kendo.spreadsheet.Sheet.prototype.activeCellCustomEditor = function () {\n            var cell = this.activeCell().first();\n            if (this.range(cell).enable()) {\n                var val = this.validation(cell);\n                var key = this._properties.get('editor', this._grid.cellRefIndex(cell));\n                var editor;\n                if (key != null) {\n                    editor = EDITORS[key];\n                } else if (val && val.showButton) {\n                    key = '_validation_' + val.dataType;\n                    editor = EDITORS[key];\n                }\n                if (typeof editor == 'function') {\n                    editor = EDITORS[key] = editor();\n                }\n                return editor;\n            }\n        };\n        registerEditor('_validation_date', function () {\n            var context, calendar, popup;\n            function create() {\n                if (!calendar) {\n                    calendar = $('<div>').kendoCalendar();\n                    popup = $('<div>').kendoPopup();\n                    calendar.appendTo(popup);\n                    calendar = calendar.getKendoCalendar();\n                    popup = popup.getKendoPopup();\n                    calendar.bind('change', function () {\n                        popup.close();\n                        var date = calendar.value();\n                        if (!context.range.format()) {\n                            context.range.format('yyyy-mm-dd');\n                        }\n                        context.callback(kendo.spreadsheet.dateToNumber(date));\n                    });\n                }\n                popup.setOptions({ anchor: context.view.element.find('.k-spreadsheet-editor-button') });\n            }\n            function open() {\n                create();\n                var date = context.range.value();\n                if (date != null) {\n                    calendar.value(kendo.spreadsheet.numberToDate(date));\n                } else {\n                    calendar.value(null);\n                }\n                var val = context.validation;\n                if (val) {\n                    var min = kendo.ui.Calendar.fn.options.min;\n                    var max = kendo.ui.Calendar.fn.options.max;\n                    if (/^(?:greaterThan|between)/.test(val.comparerType)) {\n                        min = kendo.spreadsheet.numberToDate(val.from.value);\n                    }\n                    if (val.comparerType == 'between') {\n                        max = kendo.spreadsheet.numberToDate(val.to.value);\n                    }\n                    if (val.comparerType == 'lessThan') {\n                        max = kendo.spreadsheet.numberToDate(val.from.value);\n                    }\n                    calendar.setOptions({\n                        disableDates: function (date) {\n                            var from = val.from ? val.from.value | 0 : 0;\n                            var to = val.to ? val.to.value | 0 : 0;\n                            date = kendo.spreadsheet.dateToNumber(date) | 0;\n                            return !kendo.spreadsheet.validation.validationComparers[val.comparerType](date, from, to);\n                        },\n                        min: min,\n                        max: max\n                    });\n                } else {\n                    calendar.setOptions({\n                        disableDates: null,\n                        min: null,\n                        max: null\n                    });\n                }\n                popup.open();\n            }\n            return {\n                edit: function (options) {\n                    context = options;\n                    open();\n                },\n                icon: 'k-i-calendar'\n            };\n        });\n        registerEditor('_validation_list', function () {\n            var context, list, popup;\n            function create() {\n                if (!list) {\n                    list = $('<ul class=\\'k-list k-reset\\'/>').kendoStaticList({\n                        template: '#:value#',\n                        selectable: true,\n                        autoBind: false\n                    });\n                    popup = $('<div>').kendoPopup();\n                    list.appendTo(popup);\n                    popup = popup.getKendoPopup();\n                    list = list.getKendoStaticList();\n                    list.bind('change', function () {\n                        popup.close();\n                        var item = list.value()[0];\n                        if (item) {\n                            context.callback(item.value);\n                        }\n                    });\n                }\n                popup.setOptions({ anchor: context.view.element.find('.k-spreadsheet-editor-button') });\n            }\n            function open() {\n                create();\n                var matrix = context.validation.from.value;\n                var data = [];\n                if (matrix) {\n                    matrix.each(function (el) {\n                        data.push({ value: el });\n                    });\n                }\n                var dataSource = new kendo.data.DataSource({ data: data });\n                list.setDataSource(dataSource);\n                dataSource.read();\n                popup.open();\n            }\n            return {\n                edit: function (options) {\n                    context = options;\n                    open();\n                },\n                icon: 'k-i-arrow-60-down'\n            };\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/grid', [\n        'kendo.core',\n        'spreadsheet/references'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var CellRef = kendo.spreadsheet.CellRef;\n        var RangeRef = kendo.spreadsheet.RangeRef;\n        var UnionRef = kendo.spreadsheet.UnionRef;\n        var Rectangle = kendo.Class.extend({\n            init: function (left, top, width, height) {\n                this.left = left;\n                this.width = width;\n                this.right = left + width;\n                this.top = top;\n                this.height = height;\n                this.bottom = top + height;\n            },\n            offset: function (left, top) {\n                return new Rectangle(this.left + left, this.top + top, this.width, this.height);\n            },\n            resize: function (width, height) {\n                return new Rectangle(this.left, this.top, this.width + width, this.height + height);\n            },\n            intersects: function (x, y) {\n                return this.left < x && x < this.left + this.width && this.top < y && y < this.top + this.height;\n            },\n            toDiv: function (className) {\n                return kendo.dom.element('div', {\n                    className: className,\n                    style: {\n                        width: this.width + 'px',\n                        height: this.height + 'px',\n                        top: this.top + 'px',\n                        left: this.left + 'px'\n                    }\n                });\n            }\n        });\n        var Grid = kendo.Class.extend({\n            init: function (rows, columns, rowCount, columnCount, headerHeight, headerWidth) {\n                this.rowCount = rowCount;\n                this.columnCount = columnCount;\n                this._columns = columns;\n                this._rows = rows;\n                this._headerHeight = headerHeight;\n                this._headerWidth = headerWidth;\n            },\n            isAxis: function (ref) {\n                ref = ref.toRangeRef();\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                return topLeft.row === 0 && bottomRight.row === this.rowCount - 1 || topLeft.col === 0 && bottomRight.col === this.columnCount - 1;\n            },\n            width: function (start, end) {\n                return this._columns.sum(start, end);\n            },\n            height: function (start, end) {\n                return this._rows.sum(start, end);\n            },\n            totalHeight: function () {\n                return this._rows.total + this._headerHeight;\n            },\n            totalWidth: function () {\n                return this._columns.total + this._headerWidth;\n            },\n            index: function (row, column) {\n                return column * this.rowCount + row;\n            },\n            cellRef: function (index) {\n                return new CellRef(index % this.rowCount, index / this.rowCount >> 0);\n            },\n            rowRef: function (row) {\n                return new RangeRef(new CellRef(row, 0), new CellRef(row, this.columnCount - 1));\n            },\n            colRef: function (col) {\n                return new RangeRef(new CellRef(0, col), new CellRef(this.rowCount - 1, col));\n            },\n            cellRefIndex: function (ref) {\n                return this.index(ref.row, ref.col);\n            },\n            normalize: function (ref) {\n                if (ref instanceof RangeRef) {\n                    return new RangeRef(this.normalize(ref.topLeft), this.normalize(ref.bottomRight)).setSheet(ref.sheet, ref.hasSheet());\n                }\n                if (ref instanceof UnionRef) {\n                    return ref.map(function (ref) {\n                        return this.normalize(ref);\n                    }, this);\n                }\n                if (ref instanceof CellRef) {\n                    ref = ref.clone();\n                    ref.col = Math.max(0, Math.min(this.columnCount - 1, ref.col));\n                    ref.row = Math.max(0, Math.min(this.rowCount - 1, ref.row));\n                }\n                return ref;\n            },\n            rectangle: function (ref) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                return new Rectangle(this.width(0, topLeft.col - 1), this.height(0, topLeft.row - 1), this.width(topLeft.col, bottomRight.col), this.height(topLeft.row, bottomRight.row));\n            },\n            pane: function (options) {\n                return new PaneGrid(new kendo.spreadsheet.PaneAxis(this._rows, options.row, options.rowCount, this._headerHeight), new kendo.spreadsheet.PaneAxis(this._columns, options.column, options.columnCount, this._headerWidth), this);\n            },\n            rangeDimensions: function (rangeRef) {\n                return {\n                    rows: this._rows.values.iterator(rangeRef.topLeft.row, rangeRef.bottomRight.row),\n                    columns: this._columns.values.iterator(rangeRef.topLeft.col, rangeRef.bottomRight.col)\n                };\n            },\n            forEach: function (ref, callback) {\n                var topLeft = this.normalize(ref.topLeft);\n                var bottomRight = this.normalize(ref.bottomRight);\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    for (var ri = topLeft.row; ri <= bottomRight.row; ri++) {\n                        callback(new CellRef(ri, ci));\n                    }\n                }\n            },\n            trim: function (ref, property) {\n                var topLeft = ref.topLeft;\n                var bottomRight = ref.bottomRight;\n                var bottomRightRow = topLeft.row;\n                var bottomRightCol = topLeft.col;\n                for (var ci = topLeft.col; ci <= bottomRight.col; ci++) {\n                    var start = this.index(topLeft.row, ci);\n                    var end = this.index(bottomRight.row, ci);\n                    var values = property.tree.intersecting(start, end);\n                    if (values.length) {\n                        var cell = this.cellRef(values[values.length - 1].end);\n                        bottomRightRow = Math.max(bottomRightRow, cell.row);\n                        bottomRightCol = ci;\n                    }\n                }\n                return new RangeRef(ref.topLeft, new CellRef(Math.min(bottomRightRow, ref.bottomRight.row), bottomRightCol));\n            }\n        });\n        var PaneGrid = kendo.Class.extend({\n            init: function (rows, columns, grid) {\n                this.rows = rows;\n                this.columns = columns;\n                this._grid = grid;\n                this.headerHeight = rows.headerSize;\n                this.headerWidth = columns.headerSize;\n                this.hasRowHeader = columns.hasHeader;\n                this.hasColumnHeader = rows.hasHeader;\n            },\n            refresh: function (width, height) {\n                this.columns.viewSize(width);\n                this.rows.viewSize(height);\n                var x = this.columns.paneSegment();\n                var y = this.rows.paneSegment();\n                this.left = x.offset;\n                this.top = y.offset;\n                this.right = x.offset + x.length;\n                this.bottom = y.offset + y.length;\n                this.style = {\n                    top: y.offset + 'px',\n                    left: x.offset + 'px',\n                    height: y.length + 'px',\n                    width: x.length + 'px'\n                };\n            },\n            view: function (left, top) {\n                var rows = this.rows.visible(top);\n                var columns = this.columns.visible(left);\n                return {\n                    rows: rows,\n                    columns: columns,\n                    rowOffset: rows.offset,\n                    columnOffset: columns.offset,\n                    mergedCellLeft: columns.start,\n                    mergedCellTop: rows.start,\n                    ref: new RangeRef(new CellRef(rows.values.start, columns.values.start), new CellRef(rows.values.end, columns.values.end))\n                };\n            },\n            contains: function (ref) {\n                return this.rows.contains(ref.topLeft.row, ref.bottomRight.row) && this.columns.contains(ref.topLeft.col, ref.bottomRight.col);\n            },\n            index: function (row, column) {\n                return this._grid.index(row, column);\n            },\n            boundingRectangle: function (ref) {\n                return this._grid.rectangle(ref);\n            },\n            cellRefIndex: function (ref) {\n                return this._grid.cellRefIndex(ref);\n            },\n            scrollBoundaries: function (cell) {\n                var position = this.boundingRectangle(cell);\n                var boundaries = {\n                    top: Math.max(0, position.top - this.top + (this.hasColumnHeader ? 0 : this.headerHeight)),\n                    left: Math.max(0, position.left - this.left + (this.hasRowHeader ? 0 : this.headerWidth)),\n                    right: position.right - this.columns._viewSize + this.headerWidth,\n                    bottom: position.bottom - this.rows._viewSize + this.headerHeight\n                };\n                var widthCompensation = this.columns.defaultValue / 2;\n                var heightCompensation = this.rows.defaultValue / 2;\n                boundaries.scrollTop = boundaries.top - heightCompensation;\n                boundaries.scrollBottom = boundaries.bottom + heightCompensation;\n                boundaries.scrollLeft = boundaries.left - widthCompensation;\n                boundaries.scrollRight = boundaries.right + widthCompensation;\n                return boundaries;\n            }\n        });\n        kendo.spreadsheet.Grid = Grid;\n        kendo.spreadsheet.PaneGrid = PaneGrid;\n        kendo.spreadsheet.Rectangle = Rectangle;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/axis', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Axis = kendo.Class.extend({\n            init: function (count, value) {\n                this._value = value;\n                this._count = count;\n                this.values = new kendo.spreadsheet.RangeList(0, count - 1, value);\n                this._hidden = new kendo.spreadsheet.RangeList(0, count - 1, 0);\n                this.scrollBarSize = kendo.support.scrollbar();\n                this._refresh();\n            },\n            adjust: function (start, delta) {\n                if (delta < 0) {\n                    this.values.copy(start - delta, this._count - 1, start);\n                    this._hidden.copy(start - delta, this._count - 1, start);\n                } else {\n                    this.values.copy(start, this._count, start + delta);\n                    this._hidden.copy(start, this._count, start + delta);\n                    this.values.value(start, start + delta - 1, this._value);\n                    this._hidden.value(start, start + delta - 1, 0);\n                }\n                this._refresh();\n            },\n            toJSON: function (field, positions) {\n                var values = [];\n                var iterator = this.values.iterator(0, this._count - 1);\n                for (var idx = 0; idx < this._count; idx++) {\n                    var value = iterator.at(idx);\n                    var hidden = this._hidden.value(idx, idx);\n                    if (value === this._value && !hidden) {\n                        continue;\n                    }\n                    var position = positions[idx];\n                    if (position === undefined) {\n                        position = values.length;\n                        var item = { index: idx };\n                        item[field] = value;\n                        if (hidden) {\n                            item.hidden = hidden;\n                        }\n                        values.push(item);\n                        positions[idx] = position;\n                    }\n                }\n                return values;\n            },\n            fromJSON: function (field, values) {\n                for (var idx = 0; idx < values.length; idx++) {\n                    var el = values[idx];\n                    var value = el[field] || el.hidden;\n                    var index = el.index;\n                    if (index === undefined) {\n                        index = idx;\n                    }\n                    this.value(index, index, value);\n                    if (el.hidden) {\n                        this.hide(index);\n                    }\n                }\n            },\n            hide: function (index) {\n                if (!this.hidden(index)) {\n                    var value = this.value(index, index);\n                    this._hidden.value(index, index, value);\n                    this.value(index, index, 0);\n                }\n            },\n            hidden: function (index) {\n                return this._hidden.value(index, index) !== 0;\n            },\n            includesHidden: function (start, end) {\n                return this._hidden.intersecting(start, end).length > 1;\n            },\n            nextVisible: function (index, overflow) {\n                var end = this._count - 1;\n                if (index === end) {\n                    return overflow ? index + 1 : index;\n                }\n                for (var i = index + 1; i <= end; ++i) {\n                    if (!this.hidden(i)) {\n                        return i;\n                    }\n                }\n                return index;\n            },\n            nextPage: function (index, pageSize) {\n                return this.index(this.sum(0, index - 1) + pageSize);\n            },\n            prevPage: function (index, pageSize) {\n                return this.index(this.sum(0, index) - pageSize);\n            },\n            firstVisible: function () {\n                var firstHidden = this._hidden.first();\n                if (firstHidden.value === 0) {\n                    return 0;\n                } else {\n                    return firstHidden.end + 1;\n                }\n            },\n            lastVisible: function () {\n                var lastHidden = this._hidden.last();\n                if (lastHidden.value === 0) {\n                    return this._count - 1;\n                } else {\n                    return lastHidden.start - 1;\n                }\n            },\n            prevVisible: function (index, overflow) {\n                if (index === 0) {\n                    return overflow ? -1 : 0;\n                }\n                for (var i = index - 1; i >= 0; --i) {\n                    if (!this.hidden(i)) {\n                        return i;\n                    }\n                }\n                return index;\n            },\n            unhide: function (index) {\n                if (this.hidden(index)) {\n                    var value = this._hidden.value(index, index);\n                    this._hidden.value(index, index, 0);\n                    this.value(index, index, value);\n                }\n            },\n            value: function (start, end, value) {\n                if (value !== undefined) {\n                    this.values.value(start, end, value);\n                    this._refresh();\n                } else {\n                    return this.values.iterator(start, end).at(0);\n                }\n            },\n            sum: function (start, end) {\n                var values = this.values.iterator(start, end);\n                var sum = 0;\n                for (var idx = start; idx <= end; idx++) {\n                    sum += values.at(idx);\n                }\n                return sum;\n            },\n            visible: function (start, end) {\n                var startSegment = null;\n                var endSegment = null;\n                var lastPage = false;\n                if (end >= this.total + this.scrollBarSize) {\n                    lastPage = true;\n                }\n                var ranges = this._pixelValues.intersecting(start, end);\n                startSegment = ranges[0];\n                endSegment = ranges[ranges.length - 1];\n                if (!startSegment) {\n                    return {\n                        values: this.values.iterator(0, 0),\n                        offset: 0\n                    };\n                }\n                var startOffset = start - startSegment.start;\n                var startIndex = (startOffset / startSegment.value.value >> 0) + startSegment.value.start;\n                var offset = startOffset - (startIndex - startSegment.value.start) * startSegment.value.value;\n                var endOffset = end - endSegment.start;\n                var endIndex = (endOffset / endSegment.value.value >> 0) + endSegment.value.start;\n                if (endIndex > endSegment.value.end) {\n                    endIndex = endSegment.value.end;\n                }\n                if (lastPage) {\n                    offset += endSegment.value.value - (endOffset - (endIndex - endSegment.value.start) * endSegment.value.value);\n                }\n                offset = Math.min(-offset, 0);\n                return {\n                    values: this.values.iterator(startIndex, endIndex),\n                    offset: offset\n                };\n            },\n            index: function (value) {\n                var index = 0;\n                var iterator = this.values.iterator(0, this._count - 1);\n                var current = iterator.at(0);\n                while (current < value && index < this._count - 1) {\n                    current += iterator.at(++index);\n                }\n                return index;\n            },\n            indexVisible: function (value) {\n                var index = this.index(value);\n                if (this.hidden(index)) {\n                    index = this.prevVisible(index);\n                }\n                return index;\n            },\n            _refresh: function () {\n                var current = 0;\n                this._pixelValues = this.values.map(function (range) {\n                    var start = current;\n                    current += (range.end - range.start + 1) * range.value;\n                    var end = current - 1;\n                    return new kendo.spreadsheet.ValueRange(start, end, range);\n                });\n                this.total = current;\n            },\n            getState: function () {\n                return {\n                    values: this.values.getState(),\n                    hidden: this._hidden.getState()\n                };\n            },\n            setState: function (state) {\n                this.values.setState(state.values);\n                this._hidden.setState(state.hidden);\n                this._refresh();\n            }\n        });\n        var PaneAxis = kendo.Class.extend({\n            init: function (axis, start, count, headerSize) {\n                this._axis = axis;\n                this._start = start;\n                this._count = count;\n                this.hasHeader = start === 0;\n                this.headerSize = headerSize;\n                this.defaultValue = axis._value;\n                this.frozen = count > 0;\n            },\n            viewSize: function (viewSize) {\n                this._viewSize = viewSize;\n            },\n            sum: function (start, end) {\n                return this._axis.sum(start, end - 1);\n            },\n            start: function () {\n                return this.sum(0, this._start);\n            },\n            size: function () {\n                return this.sum(this._start, this._start + this._count);\n            },\n            index: function (value, offset) {\n                return this._axis.index(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            indexVisible: function (value, offset) {\n                return this._axis.indexVisible(value + (this.frozen ? 0 : offset) - this.headerSize);\n            },\n            paneSegment: function () {\n                var offset = this.start();\n                var length;\n                if (!this.hasHeader) {\n                    offset += this.headerSize;\n                }\n                if (this.frozen) {\n                    length = this.size();\n                    if (this.hasHeader) {\n                        length += this.headerSize;\n                    } else {\n                        length -= this.headerSize;\n                    }\n                } else {\n                    length = this._viewSize - offset;\n                }\n                return {\n                    offset: offset,\n                    length: length\n                };\n            },\n            visible: function (offset) {\n                var start = this.start();\n                var size;\n                if (this.frozen) {\n                    size = this.size();\n                    if (!this.hasHeader) {\n                        size -= this.headerSize;\n                    }\n                } else {\n                    size = this._viewSize - start - this.headerSize;\n                    start += offset;\n                }\n                var result = this._axis.visible(start, start + size - 1);\n                if (this.frozen) {\n                    result.offset = 0;\n                }\n                result.start = start;\n                if (this.hasHeader) {\n                    result.offset += this.headerSize;\n                    result.start -= this.headerSize;\n                }\n                return result;\n            },\n            contains: function (start, end) {\n                if (this.frozen) {\n                    if (start > this._start + this._count) {\n                        return false;\n                    }\n                    if (end < this._start) {\n                        return false;\n                    }\n                    return true;\n                } else {\n                    return end >= this._start;\n                }\n            }\n        });\n        kendo.spreadsheet.Axis = Axis;\n        kendo.spreadsheet.PaneAxis = PaneAxis;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filter', [\n        'kendo.core',\n        'kendo.data'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Filter = kendo.spreadsheet.Filter = kendo.Class.extend({\n            prepare: function () {\n            },\n            value: function (cell) {\n                return cell.value;\n            },\n            matches: function () {\n                throw new Error('The \\'matches\\' method is not implemented.');\n            },\n            toJSON: function () {\n                throw new Error('The \\'toJSON\\' method is not implemented.');\n            }\n        });\n        Filter.create = function (options) {\n            var filter = options.filter;\n            if (!filter) {\n                throw new Error('Filter type not specified.');\n            }\n            var constructor = kendo.spreadsheet[filter.charAt(0).toUpperCase() + filter.substring(1) + 'Filter'];\n            if (!constructor) {\n                throw new Error('Filter type not recognized.');\n            }\n            return new constructor(options);\n        };\n        kendo.spreadsheet.ValueFilter = Filter.extend({\n            _values: [],\n            _dates: [],\n            _blanks: false,\n            init: function ValueFilter(options) {\n                if (options.values !== undefined) {\n                    this._values = options.values;\n                }\n                if (options.blanks !== undefined) {\n                    this._blanks = options.blanks;\n                }\n                if (options.dates !== undefined) {\n                    this._dates = options.dates;\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (this._dates.length > 0 && cell.format && typeof value === 'number') {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            matches: function (value) {\n                if (value === null || value === undefined) {\n                    return this._blanks;\n                }\n                if (value instanceof Date) {\n                    return this._dates.some(function (date) {\n                        return date.year === value.getFullYear() && (date.month === undefined || date.month === value.getMonth()) && (date.day === undefined || date.day === value.getDate()) && (date.hours === undefined || date.hours === value.getHours()) && (date.minutes === undefined || date.minutes === value.getMinutes()) && (date.seconds === undefined || date.seconds === value.getSeconds());\n                    });\n                }\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'value',\n                    blanks: this._blanks,\n                    values: this._values.slice(0)\n                };\n            }\n        });\n        kendo.spreadsheet.CustomFilter = Filter.extend({\n            _logic: 'and',\n            init: function CustomFilter(options) {\n                if (options.logic !== undefined) {\n                    this._logic = options.logic;\n                }\n                if (options.criteria === undefined) {\n                    throw new Error('Must specify criteria.');\n                }\n                this._criteria = options.criteria;\n                var expression = kendo.data.Query.filterExpr({\n                    logic: this._logic,\n                    filters: this._criteria\n                }).expression;\n                this._matches = new Function('d', 'return ' + expression);\n            },\n            matches: function (value) {\n                if (value === null) {\n                    return false;\n                }\n                return this._matches(value);\n            },\n            value: function (cell) {\n                var value = cell.value;\n                var criterionValue = this._criteria[0].value;\n                var criterionType = criterionValue instanceof Date ? 'date' : typeof criterionValue;\n                var valueType = typeof value;\n                if (cell.format) {\n                    valueType = kendo.spreadsheet.formatting.type(value, cell.format);\n                }\n                if (valueType != criterionType) {\n                    if (criterionType == 'string') {\n                        if (cell.format) {\n                            value = kendo.spreadsheet.formatting.text(value, cell.format);\n                        }\n                        value = value + '';\n                    }\n                } else if (valueType == 'date') {\n                    value = kendo.spreadsheet.numberToDate(value);\n                }\n                return value;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'custom',\n                    logic: this._logic,\n                    criteria: this._criteria\n                };\n            }\n        });\n        kendo.spreadsheet.TopFilter = Filter.extend({\n            init: function TopFilter(options) {\n                this._type = options.type;\n                this._value = options.value;\n                this._values = [];\n            },\n            prepare: function (cells) {\n                var values = cells.map(this.value).sort().filter(function (value, index, array) {\n                    return index === 0 || value !== array[index - 1];\n                });\n                if (this._type === 'topNumber' || this._type == 'topPercent') {\n                    values.sort(function (x, y) {\n                        return y - x;\n                    });\n                } else {\n                    values.sort(function (x, y) {\n                        return x - y;\n                    });\n                }\n                var count = this._value;\n                if (this._type === 'topPercent' || this._type === 'bottomPercent') {\n                    count = values.length * count / 100 >> 0;\n                }\n                this._values = values.slice(0, count);\n            },\n            matches: function (value) {\n                return this._values.indexOf(value) >= 0;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'top',\n                    type: this._type,\n                    value: this._value\n                };\n            }\n        });\n        kendo.spreadsheet.DynamicFilter = Filter.extend({\n            init: function DynamicFilter(options) {\n                this._type = options.type;\n                this._predicate = this[options.type];\n                if (typeof this._predicate !== 'function') {\n                    throw new Error('DynamicFilter type \\'' + options.type + '\\' not recognized.');\n                }\n            },\n            value: function (cell) {\n                var value = cell.value;\n                if (cell.format) {\n                    var type = kendo.spreadsheet.formatting.type(value, cell.format);\n                    if (type === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                }\n                return value;\n            },\n            prepare: function (cells) {\n                var sum = 0;\n                var count = 0;\n                for (var ci = 0; ci < cells.length; ci++) {\n                    var value = this.value(cells[ci]);\n                    if (typeof value === 'number') {\n                        sum += value;\n                        count++;\n                    }\n                }\n                if (count > 0) {\n                    this._average = sum / count;\n                } else {\n                    this._average = 0;\n                }\n            },\n            matches: function (value) {\n                return this._predicate(value);\n            },\n            aboveAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value > this._average;\n            },\n            belowAverage: function (value) {\n                if (value instanceof Date) {\n                    value = kendo.spreadsheet.dateToNumber(value);\n                }\n                if (typeof value !== 'number') {\n                    return false;\n                }\n                return value < this._average;\n            },\n            tomorrow: function (value) {\n                if (value instanceof Date) {\n                    var tomorrow = kendo.date.addDays(kendo.date.today(), 1);\n                    return kendo.date.getDate(value).getTime() === tomorrow.getTime();\n                }\n                return false;\n            },\n            today: function (value) {\n                if (value instanceof Date) {\n                    return kendo.date.isToday(value);\n                }\n                return false;\n            },\n            yesterday: function (value) {\n                if (value instanceof Date) {\n                    var yesterday = kendo.date.addDays(kendo.date.today(), -1);\n                    return kendo.date.getDate(value).getTime() === yesterday.getTime();\n                }\n                return false;\n            },\n            nextWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), 7), value);\n            },\n            thisWeek: function (value) {\n                return sameWeek(kendo.date.today(), value);\n            },\n            lastWeek: function (value) {\n                return sameWeek(kendo.date.addDays(kendo.date.today(), -7), value);\n            },\n            nextMonth: function (value) {\n                return sameMonth(value, 1);\n            },\n            thisMonth: function (value) {\n                return sameMonth(value, 0);\n            },\n            lastMonth: function (value) {\n                return sameMonth(value, -1);\n            },\n            nextQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() + 1 === value.getFullYear();\n                }\n                return false;\n            },\n            thisQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(value) - quarter(today);\n                    return diff === 0 && today.getFullYear() === value.getFullYear();\n                }\n                return false;\n            },\n            lastQuarter: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    var diff = quarter(today) - quarter(value);\n                    return diff === 1 && today.getFullYear() === value.getFullYear() || diff == -3 && today.getFullYear() - 1 === value.getFullYear();\n                }\n                return false;\n            },\n            nextYear: function (value) {\n                return sameYear(value, 1);\n            },\n            thisYear: function (value) {\n                return sameYear(value, 0);\n            },\n            lastYear: function (value) {\n                return sameYear(value, -1);\n            },\n            yearToDate: function (value) {\n                if (value instanceof Date) {\n                    var today = kendo.date.today();\n                    return value.getFullYear() === today.getFullYear() && value <= today;\n                }\n                return false;\n            },\n            toJSON: function () {\n                return {\n                    filter: 'dynamic',\n                    type: this._type\n                };\n            }\n        });\n        [\n            1,\n            2,\n            3,\n            4\n        ].forEach(function (target) {\n            kendo.spreadsheet.DynamicFilter.prototype['quarter' + target] = function (value) {\n                if (value instanceof Date) {\n                    return quarter(value) === target;\n                }\n                return false;\n            };\n        });\n        kendo.cultures['en-US'].calendar.months.names.forEach(function (month, index) {\n            kendo.spreadsheet.DynamicFilter.prototype[month.toLowerCase()] = function (value) {\n                if (value instanceof Date) {\n                    return value.getMonth() === index;\n                }\n                return false;\n            };\n        });\n        function quarter(value) {\n            var month = value.getMonth() + 1;\n            if (month >= 1 && month <= 3) {\n                return 1;\n            } else if (month >= 4 && month <= 6) {\n                return 2;\n            } else if (month >= 7 && month <= 9) {\n                return 3;\n            } else {\n                return 4;\n            }\n        }\n        function sameYear(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.today();\n                today.setFullYear(today.getFullYear() + offset);\n                return today.getFullYear() === value.getFullYear();\n            }\n            return false;\n        }\n        function sameMonth(value, offset) {\n            if (value instanceof Date) {\n                var today = kendo.date.firstDayOfMonth(kendo.date.today());\n                today.setMonth(today.getMonth() + offset, 1);\n                return today.getTime() === kendo.date.firstDayOfMonth(value).getTime();\n            }\n            return false;\n        }\n        function sameWeek(a, b) {\n            if (b instanceof Date) {\n                var firstWeek = kendo.date.dayOfWeek(kendo.date.getDate(a), 1);\n                var secondWeek = kendo.date.dayOfWeek(kendo.date.getDate(b), 1);\n                return firstWeek.getTime() === secondWeek.getTime();\n            }\n            return false;\n        }\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sorter', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var Sorter = kendo.Class.extend({\n            init: function (grid, lists) {\n                this._grid = grid;\n                this._lists = lists;\n            },\n            indices: function (rangeRef, list, ascending, indices) {\n                var comparer = Sorter.ascendingComparer;\n                if (ascending === false) {\n                    comparer = Sorter.descendingComparer;\n                }\n                return list.sortedIndices(this._grid.cellRefIndex(rangeRef.topLeft), this._grid.cellRefIndex(rangeRef.bottomRight), comparer, indices);\n            },\n            sortBy: function (ref, column, list, ascending, indices) {\n                var sortedIndices = this.indices(ref.toColumn(column), list, ascending, indices);\n                for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col; ci++) {\n                    var start = this._grid.index(ref.topLeft.row, ci);\n                    var end = this._grid.index(ref.bottomRight.row, ci);\n                    for (var li = 0; li < this._lists.length; li++) {\n                        if (start < this._lists[li].lastRangeStart()) {\n                            this._lists[li].sort(start, end, sortedIndices);\n                        }\n                    }\n                }\n                return sortedIndices;\n            }\n        });\n        Sorter.ascendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            var typeA = typeof a;\n            var typeB = typeof b;\n            if (typeA === 'number') {\n                if (typeB === 'number') {\n                    return a - b;\n                } else {\n                    return -1;\n                }\n            }\n            if (typeA === 'string') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return a.localeCompare(b);\n                default:\n                    return -1;\n                }\n            }\n            if (typeA === 'boolean') {\n                switch (typeB) {\n                case 'number':\n                    return 1;\n                case 'string':\n                    return 1;\n                case 'boolean':\n                    return a - b;\n                default:\n                    return -1;\n                }\n            }\n            if (a instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                if (b instanceof kendo.spreadsheet.calc.runtime.CalcError) {\n                    return 0;\n                } else {\n                    return 1;\n                }\n            }\n            throw new Error('Cannot compare ' + a + ' and ' + b);\n        };\n        Sorter.descendingComparer = function (a, b) {\n            if (a === null && b === null) {\n                return 0;\n            }\n            if (a === null) {\n                return 1;\n            }\n            if (b === null) {\n                return -1;\n            }\n            return Sorter.ascendingComparer(b, a);\n        };\n        kendo.spreadsheet.Sorter = Sorter;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/numformat', [\n        'spreadsheet/calc',\n        'kendo.dom'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var calc = kendo.spreadsheet.calc;\n    var dom = kendo.dom;\n    var RX_COLORS = /^\\[(black|green|white|blue|magenta|yellow|cyan|red)\\]/i;\n    var RX_CONDITION = /^\\[(<=|>=|<>|<|>|=)(-?[0-9.]+)\\]/;\n    function parse(input) {\n        input = calc.InputStream(input);\n        var sections = [], haveConditional = false, decimalPart;\n        while (!input.eof()) {\n            var sec = readSection();\n            sections.push(sec);\n            if (sec.cond) {\n                haveConditional = true;\n            }\n        }\n        if (!haveConditional) {\n            if (sections.length == 1) {\n                sections[0].cond = 'num';\n            } else if (sections.length == 2) {\n                sections[0].cond = {\n                    op: '>=',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n            } else if (sections.length >= 3) {\n                sections[0].cond = {\n                    op: '>',\n                    value: 0\n                };\n                sections[1].cond = {\n                    op: '<',\n                    value: 0\n                };\n                sections[2].cond = {\n                    op: '=',\n                    value: 0\n                };\n                if (sections.length > 3) {\n                    sections[3].cond = 'text';\n                    sections = sections.slice(0, 4);\n                }\n            }\n        }\n        return sections;\n        function maybeColor() {\n            var m = input.skip(RX_COLORS);\n            if (m) {\n                return m[1].toLowerCase();\n            }\n        }\n        function maybeCondition() {\n            var m = input.skip(RX_CONDITION);\n            if (m) {\n                var val = parseFloat(m[2]);\n                if (!isNaN(val)) {\n                    return {\n                        op: m[1],\n                        value: val\n                    };\n                }\n            }\n        }\n        function readFormat() {\n            var format = [], tok, prev = null;\n            while (!input.eof() && (tok = readNext())) {\n                if (tok.type == 'date') {\n                    if (prev && /^(el)?time$/.test(prev.type) && prev.part == 'h' && tok.part == 'm' && tok.format < 3) {\n                        tok.type = 'time';\n                    }\n                } else if (/^(el)?time$/.test(tok.type) && tok.part == 's') {\n                    if (prev && prev.type == 'date' && prev.part == 'm' && prev.format < 3) {\n                        prev.type = 'time';\n                    }\n                }\n                if (!/^(?:str|space|fill)$/.test(tok.type)) {\n                    prev = tok;\n                }\n                format.push(tok);\n            }\n            return format;\n        }\n        function maybeFraction(tok) {\n            if (tok.type != 'date' || tok.part == 'm' && tok.format < 3) {\n                var m = input.skip(/^\\.(0+)/);\n                if (m) {\n                    tok.fraction = m[1].length;\n                    if (tok.type == 'date') {\n                        tok.type = 'time';\n                    }\n                }\n            }\n            return tok;\n        }\n        function readNext() {\n            var ch, m;\n            if (m = input.skip(/^([#0?]+)(?:,([#0?]+))+/)) {\n                return {\n                    type: 'digit',\n                    sep: true,\n                    format: m[1] + m[2],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^[#0?]+/)) {\n                return {\n                    type: 'digit',\n                    sep: false,\n                    format: m[0],\n                    decimal: decimalPart\n                };\n            }\n            if (m = input.skip(/^(e)([+-])/i)) {\n                return {\n                    type: 'exp',\n                    ch: m[1],\n                    sign: m[2]\n                };\n            }\n            if (m = input.skip(/^(d{1,4}|m{1,5}|yyyy|yy)/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'date',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(hh?|ss?)/i)) {\n                m = m[1];\n                return maybeFraction({\n                    type: 'time',\n                    part: m.toLowerCase().charAt(0),\n                    format: m.length,\n                    ampm: m == 'hh'\n                });\n            }\n            if (m = input.skip(/^\\[(hh?|mm?|ss?)\\]/i)) {\n                m = m[1].toLowerCase();\n                return maybeFraction({\n                    type: 'eltime',\n                    part: m.charAt(0),\n                    format: m.length\n                });\n            }\n            if (m = input.skip(/^(am\\/pm|a\\/p)/i)) {\n                m = m[1].split('/');\n                return {\n                    type: 'ampm',\n                    am: m[0],\n                    pm: m[1]\n                };\n            }\n            switch (ch = input.next()) {\n            case ';':\n                return null;\n            case '\\\\':\n                return {\n                    type: 'str',\n                    value: input.next()\n                };\n            case '\"':\n                return {\n                    type: 'str',\n                    value: input.readEscaped(ch)\n                };\n            case '@':\n                return { type: 'text' };\n            case '_':\n                return {\n                    type: 'space',\n                    value: input.next()\n                };\n            case '*':\n                return {\n                    type: 'fill',\n                    value: input.next()\n                };\n            case '.':\n                if (input.lookingAt(/^\\s*[#0?]/)) {\n                    decimalPart = true;\n                    return { type: 'dec' };\n                }\n                return {\n                    type: 'str',\n                    value: '.'\n                };\n            case '%':\n                return { type: 'percent' };\n            case ',':\n                return { type: 'comma' };\n            }\n            return {\n                type: 'str',\n                value: ch\n            };\n        }\n        function readSection() {\n            decimalPart = false;\n            var color = maybeColor(), cond = maybeCondition();\n            if (!color && cond) {\n                color = maybeColor();\n            }\n            return {\n                color: color,\n                cond: cond,\n                body: readFormat()\n            };\n        }\n    }\n    function print(sections) {\n        return sections.map(printSection).join(';');\n        function printSection(sec) {\n            var out = '';\n            if (sec.color) {\n                out += '[' + sec.color + ']';\n            }\n            if (sec.cond) {\n                if (!(sec.cond == 'text' || sec.cond == 'num')) {\n                    out += '[' + sec.cond.op + sec.cond.value + ']';\n                }\n            }\n            out += sec.body.map(printToken).join('');\n            return out;\n        }\n        function maybeFraction(fmt, tok) {\n            if (tok.fraction) {\n                fmt += '.' + padLeft('', tok.fraction, '0');\n            }\n            return fmt;\n        }\n        function printToken(tok) {\n            if (tok.type == 'digit') {\n                if (tok.sep) {\n                    return tok.format.charAt(0) + ',' + tok.format.substr(1);\n                } else {\n                    return tok.format;\n                }\n            } else if (tok.type == 'exp') {\n                return tok.ch + tok.sign;\n            } else if (tok.type == 'date' || tok.type == 'time') {\n                return maybeFraction(padLeft('', tok.format, tok.part), tok);\n            } else if (tok.type == 'eltime') {\n                return maybeFraction('[' + padLeft('', tok.format, tok.part) + ']', tok);\n            } else if (tok.type == 'ampm') {\n                return tok.am + '/' + tok.pm;\n            } else if (tok.type == 'str') {\n                return JSON.stringify(tok.value);\n            } else if (tok.type == 'text') {\n                return '@';\n            } else if (tok.type == 'space') {\n                return '_' + tok.value;\n            } else if (tok.type == 'fill') {\n                return '*' + tok.value;\n            } else if (tok.type == 'dec') {\n                return '.';\n            } else if (tok.type == 'percent') {\n                return '%';\n            } else if (tok.type == 'comma') {\n                return ',';\n            }\n        }\n    }\n    function adjustDecimals(sections, x) {\n        sections.forEach(function (sec) {\n            var diff = x;\n            if (sec.cond == 'text') {\n                return;\n            }\n            var body = sec.body, adjusted = false, i = body.length;\n            while (diff !== 0 && --i >= 0) {\n                var tok = body[i];\n                if (tok.type == 'digit') {\n                    if (tok.decimal) {\n                        adjusted = true;\n                        if (diff > 0) {\n                            tok.format += padLeft('', diff, '0');\n                        } else if (diff < 0) {\n                            var tmp = tok.format.length;\n                            tok.format = tok.format.substr(0, tmp + diff);\n                            diff += tmp - tok.format.length;\n                        }\n                        if (tok.format.length === 0) {\n                            body.splice(i, 1);\n                            while (--i >= 0) {\n                                tok = body[i];\n                                if (tok.type == 'digit' && tok.decimal) {\n                                    ++i;\n                                    break;\n                                }\n                                if (tok.type == 'dec') {\n                                    body.splice(i, 1);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                    if (diff > 0) {\n                        break;\n                    }\n                }\n            }\n            if (!adjusted && diff > 0) {\n                body.splice(i + 1, 0, { type: 'dec' }, {\n                    type: 'digit',\n                    sep: false,\n                    decimal: true,\n                    format: padLeft('', diff, '0')\n                });\n            }\n        });\n    }\n    function TokenStream(parts) {\n        var index = 0;\n        return {\n            next: function () {\n                return parts[index++];\n            },\n            eof: function () {\n                return index >= parts.length;\n            },\n            ahead: function (n, f) {\n                if (index + n <= parts.length) {\n                    var val = f.apply(null, parts.slice(index, index + n));\n                    if (val) {\n                        index += n;\n                    }\n                    return val;\n                }\n            },\n            restart: function () {\n                index = 0;\n            }\n        };\n    }\n    function compileFormatPart(format) {\n        var input = TokenStream(format.body);\n        var hasDate = false;\n        var hasTime = false;\n        var hasAmpm = false;\n        var percentCount = 0;\n        var currency = /[\\$\\xA2-\\xA5\\u058F\\u060B\\u09F2\\u09F3\\u09FB\\u0AF1\\u0BF9\\u0E3F\\u17DB\\u20A0-\\u20BD\\uA838\\uFDFC\\uFE69\\uFF04\\uFFE0\\uFFE1\\uFFE5\\uFFE6]/;\n        var scaleCount = 0;\n        var code = '';\n        var separeThousands = false;\n        var declen = 0;\n        var intFormat = [], decFormat = [];\n        var condition = format.cond;\n        var preamble = '';\n        if (condition == 'text') {\n            preamble = 'if (typeof value == \\'string\\' || value instanceof kendo.spreadsheet.CalcError) { ';\n        } else if (condition == 'num') {\n            preamble = 'if (typeof value == \\'number\\') { ';\n        } else if (condition) {\n            var op = condition.op == '=' ? '==' : condition.op;\n            preamble = 'if (typeof value == \\'number\\' && value ' + op + ' ' + condition.value + ') { ';\n            code += 'value = Math.abs(value); ';\n        }\n        if (format.color) {\n            code += 'result.color = ' + JSON.stringify(format.color) + '; ';\n        }\n        function checkComma(a, b) {\n            if (a.type == 'digit' && b.type == 'comma' || a.type == 'comma' && a.hidden && b.type == 'comma') {\n                b.hidden = true;\n                scaleCount++;\n            }\n        }\n        while (!input.eof()) {\n            input.ahead(2, checkComma);\n            var tok = input.next();\n            if (tok.type == 'percent') {\n                percentCount++;\n            } else if (tok.type == 'digit') {\n                if (tok.decimal) {\n                    declen += tok.format.length;\n                    decFormat.push(tok.format);\n                } else {\n                    intFormat.push(tok.format);\n                    if (tok.sep) {\n                        separeThousands = true;\n                    }\n                }\n            } else if (tok.type == 'time') {\n                hasAmpm = hasAmpm || !!tok.ampm;\n                hasTime = true;\n            } else if (tok.type == 'date') {\n                hasDate = true;\n            } else if (tok.type == 'ampm') {\n                hasAmpm = hasTime = true;\n            }\n        }\n        if (percentCount > 0) {\n            code += 'value *= ' + Math.pow(100, percentCount) + '; ';\n        }\n        if (scaleCount > 0) {\n            code += 'value /= ' + Math.pow(1000, scaleCount) + '; ';\n        }\n        if (intFormat.length) {\n            code += 'var intPart = runtime.formatInt(culture, value, ' + JSON.stringify(intFormat) + ', ' + declen + ', ' + separeThousands + '); ';\n            code += 'var isNegative = parseInt(intPart[0]) < 0;';\n        }\n        if (decFormat.length) {\n            code += 'var decPart = runtime.formatDec(value, ' + JSON.stringify(decFormat) + ', ' + declen + '); ';\n        }\n        if (intFormat.length || decFormat.length) {\n            code += 'type = \\'number\\'; ';\n        }\n        if (hasDate) {\n            code += 'var date = runtime.unpackDate(value); ';\n        }\n        if (hasTime) {\n            code += 'var time = runtime.unpackTime(value); ';\n        }\n        if (hasDate || hasTime) {\n            code += 'type = \\'date\\'; ';\n        }\n        if (percentCount > 0 || scaleCount > 0 || intFormat.length || decFormat.length || hasDate || hasTime) {\n            if (!preamble) {\n                preamble = 'if (typeof value == \\'number\\') { ';\n            }\n        }\n        input.restart();\n        code += 'var matchedCurrency = false;';\n        while (!input.eof()) {\n            var tok = input.next();\n            if (tok.type == 'dec') {\n                code += 'output += culture.numberFormat[\\'.\\']; ';\n            } else if (tok.type == 'comma' && !tok.hidden) {\n                code += 'output += \\',\\'; ';\n            } else if (tok.type == 'percent') {\n                code += 'type = \\'percent\\'; ';\n                code += 'output += culture.numberFormat.percent.symbol; ';\n            } else if (tok.type == 'str') {\n                if (currency.test(tok.value)) {\n                    code += 'type = \\'currency\\'; ';\n                    code += 'if (isNegative) { output += \\'-\\'; matchedCurrency = true; }';\n                }\n                code += 'output += ' + JSON.stringify(tok.value) + '; ';\n            } else if (tok.type == 'text') {\n                code += 'type = \\'text\\'; ';\n                code += 'output += value; ';\n            } else if (tok.type == 'space') {\n                code += 'if (output) result.body.push(output); ';\n                code += 'output = \\'\\'; ';\n                code += 'result.body.push({ type: \\'space\\', value: ' + JSON.stringify(tok.value) + ' }); ';\n            } else if (tok.type == 'fill') {\n                code += 'output += runtime.fill(' + JSON.stringify(tok.value) + '); ';\n            } else if (tok.type == 'digit') {\n                code += 'if (isNegative && intPart[0] && matchedCurrency) {intPart[0] = intPart[0].replace(\\'-\\', \\'\\');}';\n                code += 'output += ' + (tok.decimal ? 'decPart' : 'intPart') + '.shift(); ';\n            } else if (tok.type == 'date') {\n                code += 'output += runtime.date(culture, date, ' + JSON.stringify(tok.part) + ', ' + tok.format + '); ';\n            } else if (tok.type == 'time') {\n                code += 'output += runtime.time(time, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + hasAmpm + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'eltime') {\n                code += 'output += runtime.eltime(value, ' + JSON.stringify(tok.part) + ', ' + tok.format + ', ' + tok.fraction + '); ';\n            } else if (tok.type == 'ampm') {\n                code += 'output += time.hours < 12 ? ' + JSON.stringify(tok.am) + ' : ' + JSON.stringify(tok.pm) + '; ';\n            }\n        }\n        code += 'if (output) result.body.push(output); ';\n        code += 'result.type = type; ';\n        code += 'return result; ';\n        if (preamble) {\n            code = preamble + code + '}';\n        }\n        return code;\n    }\n    var CACHE = Object.create(null);\n    var TEXT = compileFormatPart({\n        cond: 'text',\n        body: [{ type: 'text' }]\n    });\n    function compile(format) {\n        var f = CACHE[format];\n        if (!f) {\n            var tree = parse(format);\n            var code = tree.map(compileFormatPart);\n            code.push(TEXT);\n            code = code.join('\\n');\n            code = '\\'use strict\\'; return function(value, culture){ ' + 'if (!culture) culture = kendo.culture(); ' + 'var output = \\'\\', type = null, result = { body: [] }; ' + code + '; return result; };';\n            f = CACHE[format] = new Function('runtime', code)(runtime);\n        }\n        return f;\n    }\n    var runtime = {\n        unpackDate: calc.runtime.unpackDate,\n        unpackTime: calc.runtime.unpackTime,\n        date: function (culture, d, part, length) {\n            switch (part) {\n            case 'd':\n                switch (length) {\n                case 1:\n                    return d.date;\n                case 2:\n                    return padLeft(d.date, 2, '0');\n                case 3:\n                    return culture.calendars.standard.days.namesAbbr[d.day];\n                case 4:\n                    return culture.calendars.standard.days.names[d.day];\n                }\n                break;\n            case 'm':\n                switch (length) {\n                case 1:\n                    return d.month + 1;\n                case 2:\n                    return padLeft(d.month + 1, 2, '0');\n                case 3:\n                    return culture.calendars.standard.months.namesAbbr[d.month];\n                case 4:\n                    return culture.calendars.standard.months.names[d.month];\n                case 5:\n                    return culture.calendars.standard.months.names[d.month].charAt(0);\n                }\n                break;\n            case 'y':\n                switch (length) {\n                case 2:\n                    return d.year % 100;\n                case 4:\n                    return d.year;\n                }\n                break;\n            }\n            return '##';\n        },\n        time: function (t, part, length, ampm, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = padLeft(ampm ? t.hours % 12 || 12 : t.hours, length, '0');\n                if (fraclen) {\n                    fraction = (t.minutes + (t.seconds + t.milliseconds / 1000) / 60) / 60;\n                }\n                break;\n            case 'm':\n                ret = padLeft(t.minutes, length, '0');\n                if (fraclen) {\n                    fraction = (t.seconds + t.milliseconds / 1000) / 60;\n                }\n                break;\n            case 's':\n                ret = padLeft(t.seconds, length, '0');\n                if (fraclen) {\n                    fraction = t.milliseconds / 1000;\n                }\n                break;\n            }\n            if (fraction) {\n                ret += runtime.toFixed(fraction, fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        eltime: function (value, part, length, fraclen) {\n            var ret, fraction;\n            switch (part) {\n            case 'h':\n                ret = value * 24;\n                break;\n            case 'm':\n                ret = value * 24 * 60;\n                break;\n            case 's':\n                ret = value * 24 * 60 * 60;\n                break;\n            }\n            if (fraclen) {\n                fraction = ret - (ret | 0);\n            }\n            ret = padLeft(ret | 0, length, '0');\n            if (fraction) {\n                ret += runtime.toFixed(fraction, fraclen).replace(/^0+/, '');\n            }\n            return ret;\n        },\n        fill: function (ch) {\n            return ch;\n        },\n        formatInt: function (culture, value, parts, declen, sep) {\n            value = runtime.toFixed(value, declen).replace(/\\..*$/, '');\n            if (declen > 0) {\n                if (value === '0') {\n                    value = '';\n                } else if (value === '-0') {\n                    value = '-';\n                }\n            }\n            var iv = value.length - 1;\n            var result = [];\n            var len = 0, str;\n            function add(ch) {\n                if (sep && len && len % 3 === 0 && /^[0-9]$/.test(ch)) {\n                    str = culture.numberFormat[','] + str;\n                }\n                str = ch + str;\n                len++;\n            }\n            for (var j = parts.length; --j >= 0;) {\n                var format = parts[j];\n                str = '';\n                for (var k = format.length; --k >= 0;) {\n                    var chf = format.charAt(k);\n                    if (iv < 0) {\n                        if (chf == '0') {\n                            add('0');\n                        } else if (chf == '?') {\n                            add(' ');\n                        }\n                    } else {\n                        if (value == '0' && chf == '?') {\n                            add(' ');\n                        } else {\n                            add(value.charAt(iv));\n                        }\n                        iv--;\n                    }\n                }\n                if (j === 0) {\n                    while (iv >= 0) {\n                        add(value.charAt(iv--));\n                    }\n                }\n                result.unshift(str);\n            }\n            return result;\n        },\n        formatDec: function (value, parts, declen) {\n            value = runtime.toFixed(value, declen);\n            var pos = value.indexOf('.');\n            if (pos >= 0) {\n                value = value.substr(pos + 1).replace(/0+$/, '');\n            } else {\n                value = '';\n            }\n            var iv = 0;\n            var result = [];\n            for (var j = 0; j < parts.length; ++j) {\n                var format = parts[j];\n                var str = '';\n                for (var k = 0; k < format.length; ++k) {\n                    var chf = format.charAt(k);\n                    if (iv < value.length) {\n                        str += value.charAt(iv++);\n                    } else if (chf == '0') {\n                        str += '0';\n                    } else if (chf == '?') {\n                        str += ' ';\n                    }\n                }\n                result.push(str);\n            }\n            return result;\n        },\n        toFixed: function toFixed(value, decimals) {\n            var str = String(value);\n            var pos = str.indexOf('.');\n            if (pos >= 0) {\n                var intpart = str.substr(0, pos) || 0;\n                var decpart = str.substr(pos + 1);\n                if (decpart.length > 14) {\n                    decpart = String(Math.round(decpart / Math.pow(10, decpart.length - 14)));\n                }\n                if (decpart.length < decimals) {\n                    while (decpart.length < decimals) {\n                        decpart += '0';\n                    }\n                    return intpart + '.' + decpart;\n                }\n                value = parseFloat(intpart + '.' + decpart);\n            }\n            return value.toFixed(decimals);\n        }\n    };\n    function padLeft(val, width, ch) {\n        val += '';\n        while (val.length < width) {\n            val = ch + val;\n        }\n        return val;\n    }\n    function text(f) {\n        var a = f.body;\n        var text = '';\n        for (var i = 0; i < a.length; ++i) {\n            var el = a[i];\n            if (typeof el == 'string') {\n                text += el;\n            } else if (el.type == 'space') {\n                text += ' ';\n            }\n        }\n        return text;\n    }\n    kendo.spreadsheet.formatting = {\n        compile: compile,\n        parse: parse,\n        format: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            var span = dom.element('span');\n            span.__dataType = f.type;\n            var a = f.body;\n            if (f.color) {\n                span.attr.style = { color: f.color };\n            }\n            for (var i = 0; i < a.length; ++i) {\n                var el = a[i];\n                if (typeof el == 'string') {\n                    span.children.push(dom.text(el));\n                } else if (el.type == 'space') {\n                    span.children.push(dom.element('span', { style: { visibility: 'hidden' } }, [dom.text(el.value)]));\n                }\n            }\n            return span;\n        },\n        text: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return text(f);\n        },\n        textAndColor: function (value, format, culture) {\n            var f = compile(format)(value, culture);\n            return {\n                text: text(f),\n                color: f.color,\n                type: f.type\n            };\n        },\n        type: function (value, format) {\n            return compile(format)(value).type;\n        },\n        adjustDecimals: function (format, diff) {\n            var ast = parse(format);\n            adjustDecimals(ast, diff);\n            return print(ast);\n        }\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions', [\n        'spreadsheet/runtime',\n        'util/main'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var util = kendo.util;\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var defineAlias = runtime.defineAlias;\n    var CalcError = runtime.CalcError;\n    var RangeRef = spreadsheet.RangeRef;\n    var CellRef = spreadsheet.CellRef;\n    var UnionRef = spreadsheet.UnionRef;\n    var Matrix = runtime.Matrix;\n    var Ref = spreadsheet.Ref;\n    var daysInMonth = runtime.daysInMonth;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var daysInYear = runtime.daysInYear;\n    [\n        'abs',\n        'cos',\n        'sin',\n        'acos',\n        'asin',\n        'tan',\n        'atan',\n        'exp',\n        'sqrt'\n    ].forEach(function (name) {\n        defineFunction(name, Math[name]).args([[\n                '*n',\n                'number'\n            ]]);\n    });\n    defineFunction('ln', Math.log).args([[\n            '*n',\n            'number'\n        ]]);\n    defineFunction('log', function (num, base) {\n        return Math.log(num) / Math.log(base);\n    }).args([\n        [\n            '*num',\n            'number++'\n        ],\n        [\n            '*base',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    10\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$base != 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('log10', function (num) {\n        return Math.log(num) / Math.log(10);\n    }).args([[\n            '*num',\n            'number++'\n        ]]);\n    defineFunction('pi', function () {\n        return Math.PI;\n    }).args([]);\n    defineFunction('sqrtpi', function (n) {\n        return Math.sqrt(n * Math.PI);\n    }).args([[\n            '*num',\n            'number+'\n        ]]);\n    defineFunction('degrees', function (rad) {\n        return 180 * rad / Math.PI % 360;\n    }).args([[\n            '*radians',\n            'number'\n        ]]);\n    defineFunction('radians', function (deg) {\n        return Math.PI * deg / 180;\n    }).args([[\n            '*degrees',\n            'number'\n        ]]);\n    function _cosh(n) {\n        return (Math.exp(n) + Math.exp(-n)) / 2;\n    }\n    defineFunction('cosh', _cosh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acosh', function (n) {\n        return Math.log(n + Math.sqrt(n - 1) * Math.sqrt(n + 1));\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$num >= 1'\n            ]\n        ]\n    ]);\n    function _sinh(n) {\n        return (Math.exp(n) - Math.exp(-n)) / 2;\n    }\n    defineFunction('sinh', _sinh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('asinh', function (n) {\n        return Math.log(n + Math.sqrt(n * n + 1));\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sec', function (n) {\n        return 1 / Math.cos(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('sech', function (n) {\n        return 1 / _cosh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csc', function (n) {\n        return 1 / Math.sin(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('csch', function (n) {\n        return 1 / _sinh(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atan2', function (x, y) {\n        return Math.atan(y / x);\n    }).args([\n        [\n            '*x',\n            'divisor'\n        ],\n        [\n            '*y',\n            'number'\n        ]\n    ]);\n    function _tanh(n) {\n        return _sinh(n) / _cosh(n);\n    }\n    defineFunction('tanh', _tanh).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('atanh', function (n) {\n        return Math.log(Math.sqrt(1 - n * n) / (1 - n));\n    }).args([[\n            '*num',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('cot', function (n) {\n        return 1 / Math.tan(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('coth', function (n) {\n        return 1 / _tanh(n);\n    }).args([[\n            '*num',\n            'divisor'\n        ]]);\n    defineFunction('acot', function (n) {\n        return Math.PI / 2 - Math.atan(n);\n    }).args([[\n            '*num',\n            'number'\n        ]]);\n    defineFunction('acoth', function (n) {\n        return Math.log((n + 1) / (n - 1)) / 2;\n    }).args([\n        [\n            '*num',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'or',\n                [\n                    'assert',\n                    '$num < -1'\n                ],\n                [\n                    'assert',\n                    '$num > 1'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('power', function (a, b) {\n        return Math.pow(a, b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'number'\n        ]\n    ]);\n    defineFunction('mod', function (a, b) {\n        return a % b;\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('quotient', function (a, b) {\n        return Math.floor(a / b);\n    }).args([\n        [\n            '*a',\n            'number'\n        ],\n        [\n            '*b',\n            'divisor'\n        ]\n    ]);\n    defineFunction('ceiling', function (num, s) {\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('ceiling.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('iso.ceiling', 'ceiling.precise');\n    defineFunction('ceiling.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.ceil(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor', function (num, s) {\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$significance >= 0 || $number < 0'\n            ]\n        ]\n    ]);\n    defineFunction('floor.precise', function (num, s) {\n        s = Math.abs(s);\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('floor.math', function (num, s, mode) {\n        if (!s || !num) {\n            return 0;\n        }\n        if (num < 0 && (!mode && s < 0 || mode && s > 0)) {\n            s = -s;\n        }\n        return s ? s * Math.floor(num / s) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*significance',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$number < 0 ? -1 : 1'\n                ]\n            ]\n        ],\n        [\n            '*mode',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('int', Math.floor).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('mround', function (num, mult) {\n        return mult ? mult * Math.round(num / mult) : 0;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*multiple',\n            'number'\n        ]\n    ]);\n    defineFunction('round', function (num, digits) {\n        var sign = num < 0 ? -1 : 1;\n        if (sign < 0) {\n            num = -num;\n        }\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = Math.round(num);\n        return sign * num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('roundup', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('rounddown', function (num, digits) {\n        digits = Math.pow(10, digits);\n        num *= digits;\n        num = num < 0 ? Math.ceil(num) : Math.floor(num);\n        return num / digits;\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*digits',\n            'number'\n        ]\n    ]);\n    defineFunction('even', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n + (n < 0 ? -1 : 1) : n;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('odd', function (num) {\n        var n = num < 0 ? Math.floor(num) : Math.ceil(num);\n        return n % 2 ? n : n + (n < 0 ? -1 : 1);\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('sign', function (num) {\n        return num < 0 ? -1 : num > 0 ? 1 : 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    function _gcd(a, b) {\n        while (b) {\n            var r = a % b;\n            a = b;\n            b = r;\n        }\n        return a;\n    }\n    function _lcm(a, b) {\n        return Math.abs(a * b) / _gcd(a, b);\n    }\n    defineFunction('gcd', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _gcd(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('lcm', function (args) {\n        var a = args[0];\n        for (var i = 1; i < args.length; ++i) {\n            a = _lcm(a, args[i]);\n        }\n        return a;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sum', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('product', function (numbers) {\n        return numbers.reduce(function (prod, num) {\n            return prod * num;\n        }, 1);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumproduct', function (first, rest) {\n        var sum = 0;\n        first.each(function (p, row, col) {\n            if (typeof p == 'number') {\n                for (var i = 0; i < rest.length; ++i) {\n                    var v = rest[i].get(row, col);\n                    if (typeof v != 'number') {\n                        return;\n                    }\n                    p *= v;\n                }\n                sum += p;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a1',\n            'matrix'\n        ],\n        [\n            '+',\n            [\n                'a2',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$a2.width == $a1.width'\n                    ],\n                    [\n                        'assert',\n                        '$a2.height == $a1.height'\n                    ]\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumsq', function (numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num * num;\n        }, 0);\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('sumx2my2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x - y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumx2py2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += x * x + y * y;\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('sumxmy2', function (a, b) {\n        var sum = 0;\n        a.each(function (x, row, col) {\n            var y = b.get(row, col);\n            if (typeof x == 'number' && typeof y == 'number') {\n                sum += (x - y) * (x - y);\n            }\n        });\n        return sum;\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.width == $a.width'\n                ],\n                [\n                    'assert',\n                    '$b.height == $a.height'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('seriessum', function (x, n, m, a) {\n        var sum = 0;\n        a.each(function (coef) {\n            if (typeof coef != 'number') {\n                throw new CalcError('VALUE');\n            }\n            sum += coef * Math.pow(x, n);\n            n += m;\n        });\n        return sum;\n    }).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'y',\n            'number'\n        ],\n        [\n            'm',\n            'number'\n        ],\n        [\n            'a',\n            'matrix'\n        ]\n    ]);\n    defineFunction('min', function (numbers) {\n        return numbers.length ? Math.min.apply(Math, numbers) : 0;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('max', function (numbers) {\n        return numbers.length ? Math.max.apply(Math, numbers) : 0;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('counta', function (values) {\n        return values.length;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('count', function (numbers) {\n        return numbers.length;\n    }).args([[\n            'numbers',\n            [\n                '#collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('countunique', function (values) {\n        var count = 0, seen = [];\n        values.forEach(function (val) {\n            if (seen.indexOf(val) < 0) {\n                count++;\n                seen.push(val);\n            }\n        });\n        return count;\n    }).args([[\n            'values',\n            [\n                '#collect',\n                'anyvalue'\n            ]\n        ]]);\n    defineFunction('countblank', function (a) {\n        var count = 0;\n        function add(val) {\n            if (val == null || val === '') {\n                count++;\n            }\n        }\n        function loop(args) {\n            for (var i = 0; i < args.length; ++i) {\n                var x = args[i];\n                if (x instanceof Matrix) {\n                    x.each(add, true);\n                } else {\n                    add(x);\n                }\n            }\n        }\n        loop(a);\n        return count;\n    }).args([[\n            '+',\n            [\n                'args',\n                [\n                    'or',\n                    'matrix',\n                    'anyvalue'\n                ]\n            ]\n        ]]);\n    defineFunction('iseven', function (num) {\n        return num % 2 === 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('isodd', function (num) {\n        return num % 2 !== 0;\n    }).args([[\n            '*number',\n            'number'\n        ]]);\n    defineFunction('n', function (val) {\n        if (typeof val == 'boolean') {\n            return val ? 1 : 0;\n        }\n        if (typeof val == 'number') {\n            return val;\n        }\n        return 0;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('na', function () {\n        return new CalcError('N/A');\n    }).args([]);\n    function forIFS(args, f) {\n        var chunks = [], i = 0, matrix = args[0];\n        while (i < args.length) {\n            chunks.push({\n                matrix: args[i++],\n                pred: parseCriteria(args[i++])\n            });\n        }\n        ROW:\n            for (var row = 0; row < matrix.height; ++row) {\n                COL:\n                    for (var col = 0; col < matrix.width; ++col) {\n                        for (i = 0; i < chunks.length; ++i) {\n                            var val = chunks[i].matrix.get(row, col);\n                            if (!chunks[i].pred(val == null || val === '' ? 0 : val)) {\n                                continue COL;\n                            }\n                        }\n                        f(row, col);\n                    }\n            }\n    }\n    var ARGS_COUNTIFS = [\n        [\n            'm1',\n            'matrix'\n        ],\n        [\n            'c1',\n            'anyvalue'\n        ],\n        [\n            [\n                'm2',\n                'matrix'\n            ],\n            [\n                'c2',\n                'anyvalue'\n            ]\n        ]\n    ];\n    defineFunction('countifs', function (m1, c1, rest) {\n        var count = 0;\n        rest.unshift(m1, c1);\n        forIFS(rest, function () {\n            count++;\n        });\n        return count;\n    }).args(ARGS_COUNTIFS);\n    var ARGS_SUMIFS = [[\n            'range',\n            'matrix'\n        ]].concat(ARGS_COUNTIFS);\n    defineFunction('sumifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val) {\n                sum += val;\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIFS);\n    defineFunction('averageifs', function (range, m1, c1, args) {\n        args.unshift(range, numericPredicate, m1, c1);\n        var sum = 0, count = 0;\n        forIFS(args, function (row, col) {\n            var val = range.get(row, col);\n            if (val == null || val === '') {\n                val = 0;\n            }\n            sum += val;\n            count++;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIFS);\n    defineFunction('countif', function (matrix, criteria) {\n        criteria = parseCriteria(criteria);\n        var count = 0;\n        matrix.each(function (val) {\n            if (criteria(val)) {\n                count++;\n            }\n        });\n        return count;\n    }).args([\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ]\n    ]);\n    var ARGS_SUMIF = [\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            '*criteria',\n            'anyvalue'\n        ],\n        [\n            'sumRange',\n            [\n                'or',\n                [\n                    'and',\n                    'matrix',\n                    [\n                        'assert',\n                        '$sumRange.width == $range.width'\n                    ],\n                    [\n                        'assert',\n                        '$sumRange.height == $range.height'\n                    ]\n                ],\n                [\n                    'null',\n                    '$range'\n                ]\n            ]\n        ]\n    ];\n    defineFunction('sumif', function (range, criteria, sumRange) {\n        var sum = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                }\n            }\n        });\n        return sum;\n    }).args(ARGS_SUMIF);\n    defineFunction('averageif', function (range, criteria, sumRange) {\n        var sum = 0, count = 0;\n        criteria = parseCriteria(criteria);\n        range.each(function (val, row, col) {\n            if (criteria(val)) {\n                var v = sumRange.get(row, col);\n                if (numericPredicate(v)) {\n                    sum += v || 0;\n                    count++;\n                }\n            }\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args(ARGS_SUMIF);\n    (function (def) {\n        def('large', function (numbers, nth) {\n            return numbers.sort(descending)[nth];\n        });\n        def('small', function (numbers, nth) {\n            return numbers.sort(ascending)[nth];\n        });\n    }(function (name, handler) {\n        defineFunction(name, function (matrix, nth) {\n            var numbers = [];\n            var error = matrix.each(function (val) {\n                if (val instanceof CalcError) {\n                    return val;\n                }\n                if (typeof val == 'number') {\n                    numbers.push(val);\n                }\n            });\n            if (error) {\n                return error;\n            }\n            if (nth > numbers.length) {\n                return new CalcError('NUM');\n            }\n            return handler(numbers, nth - 1);\n        }).args([\n            [\n                'array',\n                'matrix'\n            ],\n            [\n                '*nth',\n                'number++'\n            ]\n        ]);\n    }));\n    function _avg(numbers) {\n        return numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n    }\n    function _var_sp(numbers, divisor, avg) {\n        if (avg == null) {\n            avg = _avg(numbers);\n        }\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.pow(num - avg, 2);\n        }, 0) / divisor;\n    }\n    function _stdev_sp(numbers, divisor) {\n        return Math.sqrt(_var_sp(numbers, divisor));\n    }\n    defineFunction('stdev.s', function (numbers) {\n        return _stdev_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('stdev.p', function (numbers) {\n        return _stdev_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.s', function (numbers) {\n        return _var_sp(numbers, numbers.length - 1);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('var.p', function (numbers) {\n        return _var_sp(numbers, numbers.length);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('median', function (numbers) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        if (n % 2) {\n            return numbers[n >> 1];\n        }\n        return (numbers[n >> 1] + numbers[n >> 1 + 1]) / 2;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('mode.sngl', function (numbers) {\n        numbers.sort(ascending);\n        var prev = null, count = 0, max = 1, mode = null;\n        for (var i = 0; i < numbers.length; ++i) {\n            var n = numbers[i];\n            if (n != prev) {\n                count = 1;\n                prev = n;\n            } else {\n                count++;\n            }\n            if (count > max) {\n                max = count;\n                mode = n;\n            }\n        }\n        return mode == null ? new CalcError('N/A') : mode;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('mode.mult', function (numbers) {\n        var seen = Object.create(null), max = 2, res = [];\n        numbers.forEach(function (num) {\n            var s = seen[num] || 0;\n            seen[num] = ++s;\n            if (s == max) {\n                res.push(num);\n            } else if (s > max) {\n                max = s;\n                res = [num];\n            }\n        });\n        var m = new Matrix(this);\n        res.forEach(function (num, i) {\n            m.set(i, 0, num);\n        });\n        return m;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    defineFunction('geomean', function (numbers) {\n        var n = numbers.length;\n        var p = numbers.reduce(function (p, num) {\n            if (num < 0) {\n                throw new CalcError('NUM');\n            }\n            return p * num;\n        }, 1);\n        return Math.pow(p, 1 / n);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('harmean', function (numbers) {\n        var n = numbers.length;\n        var s = numbers.reduce(function (s, num) {\n            if (!num) {\n                throw new CalcError('DIV/0');\n            }\n            return s + 1 / num;\n        }, 0);\n        return n / s;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('trimmean', function (numbers, p) {\n        var n = numbers.length;\n        numbers.sort(ascending);\n        var discard = Math.floor(n * p);\n        if (discard % 2) {\n            --discard;\n        }\n        discard /= 2;\n        var sum = 0;\n        for (var i = discard; i < n - discard; ++i) {\n            sum += numbers[i];\n        }\n        return sum / (n - discard * 2);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'percent',\n            [\n                'and',\n                'number',\n                [\n                    '[between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('frequency', function (data, bins) {\n        data.sort(ascending);\n        bins.sort(ascending);\n        var prev = -Infinity;\n        var i = 0;\n        function count(max) {\n            var n = 0;\n            while (i < data.length && data[i] > prev && data[i] <= max) {\n                ++n;\n                ++i;\n            }\n            return n;\n        }\n        var m = new Matrix(this);\n        bins.forEach(function (val, i) {\n            var n = count(val);\n            prev = val;\n            m.set(i, 0, n);\n        });\n        m.set(m.height, 0, data.length - i);\n        return m;\n    }).args([\n        [\n            'data',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'bins',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ]\n    ]);\n    defineFunction('rank.eq', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        return pos < 0 ? new CalcError('N/A') : pos + 1;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('rank', 'rank.eq');\n    defineFunction('rank.avg', function (val, numbers, asc) {\n        numbers.sort(asc ? ascending : descending);\n        var pos = numbers.indexOf(val);\n        if (pos < 0) {\n            return new CalcError('N/A');\n        }\n        for (var i = pos; numbers[i] == val; ++i) {\n        }\n        return (pos + i + 1) / 2;\n    }).args([\n        [\n            'value',\n            'number'\n        ],\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            'order',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('kurt', function (numbers) {\n        var n = numbers.length;\n        var avg = _avg(numbers);\n        var variance = _var_sp(numbers, n - 1, avg);\n        var stddev = Math.sqrt(variance);\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + Math.pow((num - avg) / stddev, 4);\n        }, 0);\n        return n * (n + 1) / ((n - 1) * (n - 2) * (n - 3)) * sum - 3 * Math.pow(n - 1, 2) / ((n - 2) * (n - 3));\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 4',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _percentrank(numbers, x, exc) {\n        var nlt = 0, ngt = 0, left = null, right = null, found = false;\n        numbers.forEach(function (num) {\n            if (num < x) {\n                nlt++;\n                left = left == null ? num : Math.max(left, num);\n            } else if (num > x) {\n                ngt++;\n                right = right == null ? num : Math.min(right, num);\n            } else {\n                found = true;\n            }\n        });\n        if (!nlt && !ngt) {\n            return new CalcError('N/A');\n        }\n        if (found) {\n            if (exc) {\n                return (nlt + 1) / (numbers.length + 1);\n            }\n            return nlt / (nlt + ngt);\n        }\n        return ((right - x) * _percentrank(numbers, left, exc) + (x - left) * _percentrank(numbers, right, exc)) / (right - left);\n    }\n    var ARGS_PERCENTRANK = [\n        [\n            'array',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'x',\n            'number'\n        ],\n        [\n            'significance',\n            [\n                'or',\n                [\n                    'null',\n                    3\n                ],\n                'integer++'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array.length > 0',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('percentrank.inc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 0);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineFunction('percentrank.exc', function (numbers, x, significance) {\n        var p = _percentrank(numbers, x, 1);\n        p = p.toFixed(significance + 1);\n        return parseFloat(p.substr(0, p.length - 1));\n    }).args(ARGS_PERCENTRANK);\n    defineAlias('percentrank', 'percentrank.inc');\n    function _covariance(x, y, divisor) {\n        var sum = 0;\n        var ax = _avg(x);\n        var ay = _avg(y);\n        var n = x.length;\n        for (var i = 0; i < n; ++i) {\n            sum += (x[i] - ax) * (y[i] - ay);\n        }\n        return sum / divisor;\n    }\n    defineFunction('covariance.p', function (x, y) {\n        return _covariance(x, y, x.length);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('covariance.s', function (x, y) {\n        return _covariance(x, y, x.length - 1);\n    }).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length > 1',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineAlias('covar', 'covariance.p');\n    var _fact = util.memoize(function (n) {\n        for (var i = 2, fact = 1; i <= n; ++i) {\n            fact *= i;\n        }\n        return fact;\n    });\n    defineFunction('fact', _fact).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('factdouble', function (n) {\n        for (var i = 2 + (n & 1), fact = 1; i <= n; i += 2) {\n            fact *= i;\n        }\n        return fact;\n    }).args([[\n            '*n',\n            'integer+'\n        ]]);\n    defineFunction('multinomial', function (numbers) {\n        var div = 1, sum = 0;\n        numbers.forEach(function (n) {\n            if (n < 0) {\n                throw new CalcError('NUM');\n            }\n            sum += n;\n            div *= _fact(n);\n        });\n        return _fact(sum) / div;\n    }).args([[\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ]]);\n    var _combinations = util.memoize(function (n, k) {\n        for (var f1 = k + 1, f2 = 1, p1 = 1, p2 = 1; f2 <= n - k; ++f1, ++f2) {\n            p1 *= f1;\n            p2 *= f2;\n        }\n        return p1 / p2;\n    });\n    defineFunction('combin', _combinations).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('combina', function (n, k) {\n        return _combinations(n + k - 1, n - 1);\n    }).args([\n        [\n            '*n',\n            'integer++'\n        ],\n        [\n            '*k',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    1,\n                    '$n'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('average', function (numbers) {\n        var sum = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0);\n        return sum / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                [\n                    'and',\n                    'number',\n                    [\n                        'not',\n                        'boolean'\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length > 0',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('averagea', function (values) {\n        var sum = 0, count = 0;\n        values.forEach(function (num) {\n            if (typeof num != 'string') {\n                sum += num;\n            }\n            ++count;\n        });\n        return count ? sum / count : new CalcError('DIV/0');\n    }).args([[\n            'values',\n            [\n                'collect',\n                'anyvalue'\n            ]\n        ]]);\n    function _percentile(numbers, rank) {\n        numbers.sort(ascending);\n        var n = numbers.length;\n        var k = rank | 0, d = rank - k;\n        if (k === 0) {\n            return numbers[0];\n        }\n        if (k >= n) {\n            return numbers[n - 1];\n        }\n        --k;\n        return numbers[k] + d * (numbers[k + 1] - numbers[k]);\n    }\n    function _percentile_inc(numbers, p) {\n        var rank = p * (numbers.length - 1) + 1;\n        return _percentile(numbers, rank);\n    }\n    function _percentile_exc(numbers, p) {\n        var rank = p * (numbers.length + 1);\n        return _percentile(numbers, rank);\n    }\n    defineFunction('percentile.inc', _percentile_inc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('percentile.exc', _percentile_exc).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('quartile.inc', function (numbers, quarter) {\n        return _percentile_inc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineFunction('quartile.exc', function (numbers, quarter) {\n        return _percentile_exc(numbers, quarter / 4);\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'quarter',\n            [\n                'values',\n                0,\n                1,\n                2,\n                3,\n                4\n            ]\n        ]\n    ]);\n    defineAlias('quartile', 'quartile.inc');\n    defineAlias('percentile', 'percentile.inc');\n    var AGGREGATE_FUNCS = [\n        'AVERAGE',\n        'COUNT',\n        'COUNTA',\n        'MAX',\n        'MIN',\n        'PRODUCT',\n        'STDEV.S',\n        'STDEV.P',\n        'SUM',\n        'VAR.S',\n        'VAR.P',\n        'MEDIAN',\n        'MODE.SNGL',\n        'LARGE',\n        'SMALL',\n        'PERCENTILE.INC',\n        'QUARTILE.INC',\n        'PERCENTILE.EXC',\n        'QUARTILE.EXC'\n    ];\n    function fetchValuesForAggregate(self, args, options) {\n        var values = [];\n        var opt_ignore_hidden_rows = 1;\n        var opt_ignore_errors = 2;\n        var opt_use_aggregates = 4;\n        (function fetchValues(args) {\n            if (args instanceof Ref) {\n                self.getRefCells(args, true).forEach(function (cell) {\n                    var value = cell.value;\n                    if (options & opt_ignore_hidden_rows && cell.hidden) {\n                        return;\n                    }\n                    if (cell.formula) {\n                        var str = cell.formula.print(cell.row, cell.col);\n                        if (/^\\s*(?:aggregate|subtotal)\\s*\\(/i.test(str)) {\n                            if (!(options & opt_use_aggregates)) {\n                                return;\n                            }\n                        }\n                        if ('value' in cell.formula) {\n                            value = cell.formula.value;\n                        }\n                    }\n                    if (options & opt_ignore_errors && value instanceof CalcError) {\n                        return;\n                    }\n                    if (typeof value == 'number' || value instanceof CalcError) {\n                        values.push(value);\n                    }\n                });\n            } else if (Array.isArray(args)) {\n                for (var i = 0; i < args.length; ++i) {\n                    fetchValues(args[i]);\n                }\n            } else if (args instanceof Matrix) {\n                args.each(fetchValues);\n            } else if (typeof args == 'number') {\n                values.push(args);\n            } else if (args instanceof CalcError && !(options & opt_ignore_errors)) {\n                values.push(args);\n            }\n        }(args));\n        return values;\n    }\n    defineFunction('aggregate', function (callback, funcId, options, args) {\n        var self = this;\n        self.resolveCells(args, function () {\n            var values;\n            if (funcId > 12) {\n                values = fetchValuesForAggregate(self, args[0], options);\n                var k = args[1];\n                if (k instanceof CellRef) {\n                    k = self.getRefData(k);\n                }\n                if (typeof k != 'number') {\n                    return callback(new CalcError('VALUE'));\n                }\n            } else {\n                values = fetchValuesForAggregate(self, args, options);\n            }\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                12,\n                13,\n                14,\n                15,\n                16,\n                17,\n                18,\n                19\n            ]\n        ],\n        [\n            'options',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4,\n                    5,\n                    6,\n                    7\n                ]\n            ]\n        ],\n        [\n            'args',\n            'rest'\n        ]\n    ]);\n    defineFunction('subtotal', function (callback, funcId) {\n        var self = this;\n        var ignoreHidden = funcId > 100;\n        if (ignoreHidden) {\n            funcId -= 100;\n        }\n        var args = [];\n        for (var i = 2; i < arguments.length; ++i) {\n            args.push(arguments[i]);\n        }\n        self.resolveCells(args, function () {\n            var values = fetchValuesForAggregate(self, args, ignoreHidden ? 1 : 0);\n            self.func(AGGREGATE_FUNCS[funcId - 1], callback, values);\n        });\n    }).argsAsync([\n        [\n            'funcId',\n            [\n                'values',\n                1,\n                2,\n                3,\n                4,\n                5,\n                6,\n                7,\n                8,\n                9,\n                10,\n                11,\n                101,\n                102,\n                103,\n                104,\n                105,\n                106,\n                107,\n                108,\n                109,\n                110,\n                111\n            ]\n        ],\n        [\n            '+',\n            [\n                'ref',\n                [\n                    'or',\n                    'ref',\n                    '#matrix'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('avedev', function (numbers) {\n        var avg = numbers.reduce(function (sum, num) {\n            return sum + num;\n        }, 0) / numbers.length;\n        return numbers.reduce(function (sum, num) {\n            return sum + Math.abs(num - avg);\n        }, 0) / numbers.length;\n    }).args([\n        [\n            'numbers',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$numbers.length >= 2',\n                'NUM'\n            ]\n        ]\n    ]);\n    function _binom_dist(x, n, p, cumulative) {\n        if (!cumulative) {\n            return _combinations(n, x) * Math.pow(p, x) * Math.pow(1 - p, n - x);\n        } else {\n            var sum = 0;\n            for (var j = 0; j <= x; ++j) {\n                sum += _combinations(n, j) * Math.pow(p, j) * Math.pow(1 - p, n - j);\n            }\n            return sum;\n        }\n    }\n    defineFunction('binom.dist', _binom_dist).args([\n        [\n            'successes',\n            'integer+'\n        ],\n        [\n            'trials',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$trials >= $successes'\n                ]\n            ]\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('binomdist', 'binom.dist');\n    defineFunction('binom.inv', function (n, p, alpha) {\n        for (var x = 0; x <= n; ++x) {\n            if (_binom_dist(x, n, p, true) >= alpha) {\n                return x;\n            }\n        }\n        return new CalcError('N/A');\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineAlias('critbinom', 'binom.inv');\n    defineFunction('binom.dist.range', function (n, p, s, s2) {\n        var sum = 0;\n        for (var k = s; k <= s2; ++k) {\n            sum += _combinations(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);\n        }\n        return sum;\n    }).args([\n        [\n            'trials',\n            'integer+'\n        ],\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'successes_min',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    0,\n                    '$trials'\n                ]\n            ]\n        ],\n        [\n            'successes_max',\n            [\n                'or',\n                [\n                    'and',\n                    'integer',\n                    [\n                        '[between]',\n                        '$successes_min',\n                        '$trials'\n                    ]\n                ],\n                [\n                    'null',\n                    '$successes_min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('negbinom.dist', function (x, k, p, cumulative) {\n        if (cumulative) {\n            var sum = 0;\n            while (x >= 0) {\n                sum += _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n                x--;\n            }\n            return sum;\n        }\n        return _combinations(x + k - 1, x) * Math.pow(p, k) * Math.pow(1 - p, x);\n    }).args([\n        [\n            'number_f',\n            'integer+'\n        ],\n        [\n            'number_s',\n            'integer+'\n        ],\n        [\n            'probability_s',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineAlias('negbinomdist', 'negbinom.dist');\n    defineFunction('address', function (row, col, abs, a1, sheet) {\n        var cell = new CellRef(row - 1, col - 1, abs - 1);\n        if (sheet) {\n            cell.setSheet(sheet, true);\n        }\n        return a1 ? cell.print(0, 0) : cell.print();\n    }).args([\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'abs',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ],\n        [\n            'a1',\n            [\n                'or',\n                [\n                    'null',\n                    true\n                ],\n                'logical'\n            ]\n        ],\n        [\n            'sheet',\n            [\n                'or',\n                'null',\n                'string'\n            ]\n        ]\n    ]);\n    defineFunction('areas', function (ref) {\n        var count = 0;\n        (function loop(x) {\n            if (x instanceof CellRef || x instanceof RangeRef) {\n                count++;\n            } else if (x instanceof UnionRef) {\n                x.refs.forEach(loop);\n            }\n        }(ref));\n        return count;\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('choose', function (index, args) {\n        if (index > args.length) {\n            return new CalcError('N/A');\n        } else {\n            return args[index - 1];\n        }\n    }).args([\n        [\n            '*index',\n            'integer'\n        ],\n        [\n            '+',\n            [\n                'value',\n                'anything'\n            ]\n        ]\n    ]);\n    defineFunction('column', function (ref) {\n        if (!ref) {\n            return this.formula.col + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.col + 1;\n        }\n        return this.asMatrix(ref).mapCol(function (col) {\n            return col + ref.topLeft.col + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('columns', function (m) {\n        return m instanceof Ref ? m.width() : m.width;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('formulatext', function (ref) {\n        var cell = this.getRefCells(ref)[0];\n        if (!cell.formula) {\n            return new CalcError('N/A');\n        }\n        return cell.formula.print(cell.row, cell.col);\n    }).args([[\n            'ref',\n            'ref'\n        ]]);\n    defineFunction('hlookup', function (value, m, row, approx) {\n        var resultCol = null;\n        m.eachCol(function (col) {\n            var data = m.get(0, col);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultCol = col;\n            } else if (data === value) {\n                resultCol = col;\n                return true;\n            }\n        });\n        if (resultCol == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(row - 1, resultCol);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'row',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('index', function (callback, ref, row, col, areanum) {\n        var self = this;\n        if (ref instanceof UnionRef) {\n            ref = ref.refs[areanum - 1];\n        }\n        if (!row && !col || !ref) {\n            return callback(new CalcError('N/A'));\n        }\n        if (ref instanceof CellRef) {\n            ref = ref.toRangeRef();\n        }\n        if (ref instanceof RangeRef) {\n            if (row && col) {\n                if (col > ref.width() || row > ref.height()) {\n                    return callback(new CalcError('REF'));\n                }\n                var cell = ref.toCell(row - 1, col - 1);\n                self.resolveCells([cell], function () {\n                    callback(self.getRefData(cell));\n                });\n                return;\n            }\n            if (!row) {\n                var colRange = ref.toColumn(col - 1);\n                self.resolveCells([colRange], function () {\n                    callback(self.asMatrix(colRange));\n                });\n                return;\n            }\n            if (!col) {\n                var rowRange = ref.toRow(row - 1);\n                self.resolveCells([rowRange], function () {\n                    callback(self.asMatrix(rowRange));\n                });\n                return;\n            }\n        } else if (ref instanceof Matrix) {\n            if (ref.width > 1 && ref.height > 1) {\n                if (row && col) {\n                    return callback(ref.get(row - 1, col - 1));\n                }\n                if (!row) {\n                    return callback(ref.mapRow(function (row) {\n                        return ref.get(row, col - 1);\n                    }));\n                }\n                if (!col) {\n                    return callback(ref.mapCol(function (col) {\n                        return ref.get(row - 1, col);\n                    }));\n                }\n            }\n            if (ref.width == 1) {\n                return callback(ref.get(row - 1, 0));\n            }\n            if (ref.height == 1) {\n                return callback(ref.get(0, col - 1));\n            }\n        } else {\n            callback(new CalcError('REF'));\n        }\n    }).argsAsync([\n        [\n            'range',\n            [\n                'or',\n                'ref',\n                'matrix'\n            ]\n        ],\n        [\n            'row',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'col',\n            [\n                'or',\n                'integer+',\n                'null'\n            ]\n        ],\n        [\n            'areanum',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('indirect', function (thing) {\n        try {\n            var f = this.formula;\n            var exp = calc.parseFormula(f.sheet, f.row, f.col, thing);\n            if (!(exp.ast instanceof Ref)) {\n                throw 1;\n            }\n            return exp.ast.absolute(f.row, f.col);\n        } catch (ex) {\n            return new CalcError('REF');\n        }\n    }).args([[\n            'thing',\n            'string'\n        ]]);\n    defineFunction('match', function (val, m, type) {\n        var index = 1, cmp;\n        if (type === 0) {\n            cmp = parseCriteria(val);\n        } else if (type === -1) {\n            cmp = parseCriteria('<=' + val);\n        } else if (type === 1) {\n            cmp = parseCriteria('>=' + val);\n        }\n        if (m.each(function (el) {\n                if (el != null && cmp(el)) {\n                    if (type !== 0 && val != el) {\n                        --index;\n                    }\n                    return true;\n                }\n                index++;\n            }, true) && index > 0) {\n            return index;\n        } else {\n            return new CalcError('N/A');\n        }\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    -1,\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('offset', function (ref, rows, cols, height, width) {\n        var topLeft = (ref instanceof CellRef ? ref : ref.topLeft).clone();\n        topLeft.row += rows;\n        topLeft.col += cols;\n        if (topLeft.row < 0 || topLeft.col < 0) {\n            return new CalcError('VALUE');\n        }\n        if (height > 1 || width > 1) {\n            return new RangeRef(topLeft, new CellRef(topLeft.row + height - 1, topLeft.col + width - 1)).setSheet(ref.sheet, ref.hasSheet());\n        }\n        return topLeft;\n    }).args([\n        [\n            'ref',\n            'area'\n        ],\n        [\n            '*rows',\n            'integer'\n        ],\n        [\n            '*cols',\n            'integer'\n        ],\n        [\n            '*height',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.height()'\n                ]\n            ]\n        ],\n        [\n            '*width',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    '$ref.width()'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('row', function (ref) {\n        if (!ref) {\n            return this.formula.row + 1;\n        }\n        if (ref instanceof CellRef) {\n            return ref.row + 1;\n        }\n        return this.asMatrix(ref).mapRow(function (row) {\n            return row + ref.topLeft.row + 1;\n        });\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                'null'\n            ]\n        ]]);\n    defineFunction('rows', function (m) {\n        return m instanceof Ref ? m.height() : m.height;\n    }).args([[\n            'ref',\n            [\n                'or',\n                'area',\n                '#matrix'\n            ]\n        ]]);\n    defineFunction('vlookup', function (value, m, col, approx) {\n        var resultRow = null;\n        if (typeof value != 'number') {\n            approx = false;\n        }\n        if (typeof value == 'string') {\n            value = value.toLowerCase();\n        }\n        m.eachRow(function (row) {\n            var data = m.get(row, 0);\n            if (approx) {\n                if (data > value) {\n                    return true;\n                }\n                resultRow = row;\n            } else {\n                if (typeof data == 'string') {\n                    data = data.toLowerCase();\n                }\n                if (data === value) {\n                    resultRow = row;\n                    return true;\n                }\n            }\n        });\n        if (resultRow == null) {\n            return new CalcError('N/A');\n        }\n        return m.get(resultRow, col - 1);\n    }).args([\n        [\n            'value',\n            'anyvalue'\n        ],\n        [\n            'range',\n            'matrix'\n        ],\n        [\n            'col',\n            'integer++'\n        ],\n        [\n            'approx',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('date', function (year, month, date) {\n        return packDate(year, month - 1, date);\n    }).args([\n        [\n            '*year',\n            'integer'\n        ],\n        [\n            '*month',\n            'integer'\n        ],\n        [\n            '*date',\n            'integer'\n        ]\n    ]);\n    defineFunction('day', function (date) {\n        return unpackDate(date).date;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('month', function (date) {\n        return unpackDate(date).month + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('year', function (date) {\n        return unpackDate(date).year;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weekday', function (date) {\n        return unpackDate(date).day + 1;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('weeknum', function (date, type) {\n        var fw = packDate(unpackDate(date).year, 0, 1);\n        var sy = unpackDate(fw);\n        var diff;\n        if (type == 21) {\n            diff = 3 - (sy.day + 6) % 7;\n            if (diff < 0) {\n                diff += 7;\n            }\n            fw += diff;\n            sy.date += diff;\n            sy.day = 4;\n            type = 1;\n        } else {\n            if (type == 1) {\n                type = 0;\n            } else if (type == 2) {\n                type = 1;\n            } else {\n                type = (type - 10) % 7;\n            }\n        }\n        diff = sy.day - type;\n        if (diff < 0) {\n            diff += 7;\n        }\n        fw -= diff;\n        return Math.ceil((date + 1 - fw) / 7);\n    }).args([\n        [\n            '*date',\n            'date'\n        ],\n        [\n            '*type',\n            [\n                'or',\n                [\n                    'null',\n                    1\n                ],\n                [\n                    'values',\n                    1,\n                    2,\n                    11,\n                    12,\n                    13,\n                    14,\n                    15,\n                    16,\n                    17,\n                    21\n                ]\n            ]\n        ]\n    ]);\n    function weeksInYear(year) {\n        var d = unpackDate(packDate(year, 0, 1));\n        if (d.day == 4 || d.day == 3 && runtime.isLeapYear(year)) {\n            return 53;\n        }\n        return 52;\n    }\n    defineFunction('isoweeknum', function isoweeknum(date) {\n        var d = unpackDate(date);\n        var dow = d.day || 7;\n        var wk = Math.floor((d.ord - dow + 10) / 7);\n        if (wk < 1) {\n            return weeksInYear(d.year - 1);\n        } else if (wk == 53 && wk > weeksInYear(d.year)) {\n            return 1;\n        }\n        return wk;\n    }).args([[\n            '*date',\n            'date'\n        ]]);\n    defineFunction('now', function () {\n        return runtime.dateToSerial(new Date());\n    }).args([]);\n    defineFunction('today', function () {\n        return runtime.dateToSerial(new Date()) | 0;\n    }).args([]);\n    defineFunction('time', function (hh, mm, ss) {\n        return runtime.packTime(hh, mm, ss, 0);\n    }).args([\n        [\n            '*hours',\n            'integer'\n        ],\n        [\n            '*minutes',\n            'integer'\n        ],\n        [\n            '*seconds',\n            'integer'\n        ]\n    ]);\n    defineFunction('hour', function (time) {\n        return runtime.unpackTime(time).hours;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('minute', function (time) {\n        return runtime.unpackTime(time).minutes;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('second', function (time) {\n        return runtime.unpackTime(time).seconds;\n    }).args([[\n            '*time',\n            'datetime'\n        ]]);\n    defineFunction('edate', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('eomonth', function (base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = daysInMonth(y, m);\n        return packDate(y, m, d);\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*months',\n            'integer'\n        ]\n    ]);\n    defineFunction('workday', function (date, n, holidays) {\n        var inc = n > 0 ? 1 : -1;\n        n = Math.abs(n);\n        var dow = unpackDate(date).day;\n        while (n > 0) {\n            date += inc;\n            dow = (dow + inc) % 7;\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                --n;\n            }\n        }\n        return date;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'days',\n            'integer'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('networkdays', function (date, end, holidays) {\n        if (date > end) {\n            var tmp = date;\n            date = end;\n            end = tmp;\n        }\n        var count = 0;\n        var dow = unpackDate(date).day;\n        while (date <= end) {\n            if (dow > 0 && dow < 6 && holidays.indexOf(date) < 0) {\n                count++;\n            }\n            date++;\n            dow = (dow + 1) % 7;\n        }\n        return count;\n    }).args([\n        [\n            'start_date',\n            'date'\n        ],\n        [\n            'end_date',\n            'date'\n        ],\n        [\n            'holidays',\n            [\n                'collect',\n                'date'\n            ]\n        ]\n    ]);\n    defineFunction('days', function (start, end) {\n        return end - start;\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ]\n    ]);\n    function _days_360(start, end, method) {\n        var d1 = unpackDate(start);\n        var d2 = unpackDate(end);\n        if (method) {\n            if (d1.date == 31) {\n                d1.date = 30;\n            }\n            if (d2.date == 31) {\n                d2.date = 30;\n            }\n        } else {\n            if (d1.month == 1 && d2.month == 1 && d1.date == daysInMonth(d1.year, 1) && d2.date == daysInMonth(d2.year, 1)) {\n                d2.date = 30;\n            }\n            if (d1.date == daysInMonth(d1.year, d1.month)) {\n                d1.date = 30;\n                if (d2.date == 31) {\n                    d2.date = 30;\n                }\n            } else {\n                if (d1.date == 30 && d2.date == 31) {\n                    d2.date = 30;\n                }\n            }\n        }\n        return 360 * (d2.year - d1.year) + 30 * (d2.month - d1.month) + (d2.date - d1.date);\n    }\n    runtime._days_360 = _days_360;\n    defineFunction('days360', _days_360).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('yearfrac', function (start, end, method) {\n        switch (method) {\n        case 0:\n            return _days_360(start, end, false) / 360;\n        case 1:\n            return (end - start) / daysInYear(unpackDate(start).year);\n        case 2:\n            return (end - start) / 360;\n        case 3:\n            return (end - start) / 365;\n        case 4:\n            return _days_360(start, end, true) / 360;\n        }\n    }).args([\n        [\n            '*start_date',\n            'date'\n        ],\n        [\n            '*end_date',\n            'date'\n        ],\n        [\n            '*method',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'values',\n                    0,\n                    1,\n                    2,\n                    3,\n                    4\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('datevalue', function (text) {\n        var date = runtime.parseDate(text);\n        if (date) {\n            return runtime.dateToSerial(date);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('timevalue', function (text) {\n        var m = text.toLowerCase().match(/(\\d+):(\\d+)(:(\\d+)(\\.(\\d+))?)?\\s*(am?|pm?)?/);\n        if (m) {\n            var hh = parseFloat(m[1]);\n            var mm = parseFloat(m[2]);\n            var ss = m[3] ? parseFloat(m[4]) : 0;\n            var ampm = m[7];\n            if (ampm && (hh > 12 || hh < 1)) {\n                return new CalcError('VALUE');\n            }\n            if (/^p/.test(ampm)) {\n                hh += 12;\n            }\n            return runtime.packTime(hh, mm, ss, 0);\n        }\n        return new CalcError('VALUE');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mdeterm', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.determinant();\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('transpose', function (m) {\n        return m.transpose();\n    }).args([[\n            'range',\n            'matrix'\n        ]]);\n    defineFunction('mmult', function (a, b) {\n        return a.multiply(b);\n    }).args([\n        [\n            'a',\n            'matrix'\n        ],\n        [\n            'b',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$b.height == $a.width'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('munit', function (n) {\n        return new Matrix(this).unit(n);\n    }).args([[\n            'n',\n            'integer+'\n        ]]);\n    defineFunction('minverse', function (m) {\n        var error = m.each(function (val) {\n            if (typeof val != 'number') {\n                return new CalcError('VALUE');\n            }\n        }, true);\n        return error || m.inverse() || new CalcError('VALUE');\n    }).args([[\n            'm',\n            [\n                'and',\n                'matrix',\n                [\n                    'assert',\n                    '$m.width == $m.height'\n                ]\n            ]\n        ]]);\n    defineFunction('rand', function () {\n        return Math.random();\n    }).args([]);\n    defineFunction('randbetween', function (min, max) {\n        return min + Math.floor((max - min + 1) * Math.random());\n    }).args([\n        [\n            'min',\n            'integer'\n        ],\n        [\n            'max',\n            [\n                'and',\n                'integer',\n                [\n                    'assert',\n                    '$max >= $min'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('true', function () {\n        return true;\n    }).args([]);\n    defineFunction('false', function () {\n        return true;\n    }).args([]);\n    defineFunction('roman', function (num) {\n        return util.arabicToRoman(num).toUpperCase();\n    }).args([[\n            '*number',\n            'integer'\n        ]]);\n    defineFunction('arabic', function (rom) {\n        var num = util.romanToArabic(rom);\n        return num == null ? new CalcError('VALUE') : num;\n    }).args([[\n            '*roman',\n            'string'\n        ]]);\n    defineFunction('base', function (number, radix, minLen) {\n        var str = number.toString(radix).toUpperCase();\n        while (str.length < minLen) {\n            str = '0' + str;\n        }\n        return str;\n    }).args([\n        [\n            '*number',\n            'integer'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ],\n        [\n            '*minLen',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('decimal', function (text, radix) {\n        text = text.toUpperCase();\n        var val = 0;\n        for (var i = 0; i < text.length; ++i) {\n            var d = text.charCodeAt(i);\n            if (d >= 48 && d <= 57) {\n                d -= 48;\n            } else if (d >= 65 && d < 55 + radix) {\n                d -= 55;\n            } else {\n                return new CalcError('VALUE');\n            }\n            val = val * radix + d;\n        }\n        return val;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*radix',\n            [\n                'and',\n                'integer',\n                [\n                    '[between]',\n                    2,\n                    36\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('char', function (code) {\n        return String.fromCharCode(code);\n    }).args([[\n            '*code',\n            'integer+'\n        ]]);\n    var RX_NON_PRINTABLE = /[\\0-\\x1F\\x7F-\\x9F\\xAD\\u0378\\u0379\\u037F-\\u0383\\u038B\\u038D\\u03A2\\u0528-\\u0530\\u0557\\u0558\\u0560\\u0588\\u058B-\\u058E\\u0590\\u05C8-\\u05CF\\u05EB-\\u05EF\\u05F5-\\u0605\\u061C\\u061D\\u06DD\\u070E\\u070F\\u074B\\u074C\\u07B2-\\u07BF\\u07FB-\\u07FF\\u082E\\u082F\\u083F\\u085C\\u085D\\u085F-\\u089F\\u08A1\\u08AD-\\u08E3\\u08FF\\u0978\\u0980\\u0984\\u098D\\u098E\\u0991\\u0992\\u09A9\\u09B1\\u09B3-\\u09B5\\u09BA\\u09BB\\u09C5\\u09C6\\u09C9\\u09CA\\u09CF-\\u09D6\\u09D8-\\u09DB\\u09DE\\u09E4\\u09E5\\u09FC-\\u0A00\\u0A04\\u0A0B-\\u0A0E\\u0A11\\u0A12\\u0A29\\u0A31\\u0A34\\u0A37\\u0A3A\\u0A3B\\u0A3D\\u0A43-\\u0A46\\u0A49\\u0A4A\\u0A4E-\\u0A50\\u0A52-\\u0A58\\u0A5D\\u0A5F-\\u0A65\\u0A76-\\u0A80\\u0A84\\u0A8E\\u0A92\\u0AA9\\u0AB1\\u0AB4\\u0ABA\\u0ABB\\u0AC6\\u0ACA\\u0ACE\\u0ACF\\u0AD1-\\u0ADF\\u0AE4\\u0AE5\\u0AF2-\\u0B00\\u0B04\\u0B0D\\u0B0E\\u0B11\\u0B12\\u0B29\\u0B31\\u0B34\\u0B3A\\u0B3B\\u0B45\\u0B46\\u0B49\\u0B4A\\u0B4E-\\u0B55\\u0B58-\\u0B5B\\u0B5E\\u0B64\\u0B65\\u0B78-\\u0B81\\u0B84\\u0B8B-\\u0B8D\\u0B91\\u0B96-\\u0B98\\u0B9B\\u0B9D\\u0BA0-\\u0BA2\\u0BA5-\\u0BA7\\u0BAB-\\u0BAD\\u0BBA-\\u0BBD\\u0BC3-\\u0BC5\\u0BC9\\u0BCE\\u0BCF\\u0BD1-\\u0BD6\\u0BD8-\\u0BE5\\u0BFB-\\u0C00\\u0C04\\u0C0D\\u0C11\\u0C29\\u0C34\\u0C3A-\\u0C3C\\u0C45\\u0C49\\u0C4E-\\u0C54\\u0C57\\u0C5A-\\u0C5F\\u0C64\\u0C65\\u0C70-\\u0C77\\u0C80\\u0C81\\u0C84\\u0C8D\\u0C91\\u0CA9\\u0CB4\\u0CBA\\u0CBB\\u0CC5\\u0CC9\\u0CCE-\\u0CD4\\u0CD7-\\u0CDD\\u0CDF\\u0CE4\\u0CE5\\u0CF0\\u0CF3-\\u0D01\\u0D04\\u0D0D\\u0D11\\u0D3B\\u0D3C\\u0D45\\u0D49\\u0D4F-\\u0D56\\u0D58-\\u0D5F\\u0D64\\u0D65\\u0D76-\\u0D78\\u0D80\\u0D81\\u0D84\\u0D97-\\u0D99\\u0DB2\\u0DBC\\u0DBE\\u0DBF\\u0DC7-\\u0DC9\\u0DCB-\\u0DCE\\u0DD5\\u0DD7\\u0DE0-\\u0DF1\\u0DF5-\\u0E00\\u0E3B-\\u0E3E\\u0E5C-\\u0E80\\u0E83\\u0E85\\u0E86\\u0E89\\u0E8B\\u0E8C\\u0E8E-\\u0E93\\u0E98\\u0EA0\\u0EA4\\u0EA6\\u0EA8\\u0EA9\\u0EAC\\u0EBA\\u0EBE\\u0EBF\\u0EC5\\u0EC7\\u0ECE\\u0ECF\\u0EDA\\u0EDB\\u0EE0-\\u0EFF\\u0F48\\u0F6D-\\u0F70\\u0F98\\u0FBD\\u0FCD\\u0FDB-\\u0FFF\\u10C6\\u10C8-\\u10CC\\u10CE\\u10CF\\u1249\\u124E\\u124F\\u1257\\u1259\\u125E\\u125F\\u1289\\u128E\\u128F\\u12B1\\u12B6\\u12B7\\u12BF\\u12C1\\u12C6\\u12C7\\u12D7\\u1311\\u1316\\u1317\\u135B\\u135C\\u137D-\\u137F\\u139A-\\u139F\\u13F5-\\u13FF\\u169D-\\u169F\\u16F1-\\u16FF\\u170D\\u1715-\\u171F\\u1737-\\u173F\\u1754-\\u175F\\u176D\\u1771\\u1774-\\u177F\\u17DE\\u17DF\\u17EA-\\u17EF\\u17FA-\\u17FF\\u180F\\u181A-\\u181F\\u1878-\\u187F\\u18AB-\\u18AF\\u18F6-\\u18FF\\u191D-\\u191F\\u192C-\\u192F\\u193C-\\u193F\\u1941-\\u1943\\u196E\\u196F\\u1975-\\u197F\\u19AC-\\u19AF\\u19CA-\\u19CF\\u19DB-\\u19DD\\u1A1C\\u1A1D\\u1A5F\\u1A7D\\u1A7E\\u1A8A-\\u1A8F\\u1A9A-\\u1A9F\\u1AAE-\\u1AFF\\u1B4C-\\u1B4F\\u1B7D-\\u1B7F\\u1BF4-\\u1BFB\\u1C38-\\u1C3A\\u1C4A-\\u1C4C\\u1C80-\\u1CBF\\u1CC8-\\u1CCF\\u1CF7-\\u1CFF\\u1DE7-\\u1DFB\\u1F16\\u1F17\\u1F1E\\u1F1F\\u1F46\\u1F47\\u1F4E\\u1F4F\\u1F58\\u1F5A\\u1F5C\\u1F5E\\u1F7E\\u1F7F\\u1FB5\\u1FC5\\u1FD4\\u1FD5\\u1FDC\\u1FF0\\u1FF1\\u1FF5\\u1FFF\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u206F\\u2072\\u2073\\u208F\\u209D-\\u209F\\u20BB-\\u20CF\\u20F1-\\u20FF\\u218A-\\u218F\\u23F4-\\u23FF\\u2427-\\u243F\\u244B-\\u245F\\u2700\\u2B4D-\\u2B4F\\u2B5A-\\u2BFF\\u2C2F\\u2C5F\\u2CF4-\\u2CF8\\u2D26\\u2D28-\\u2D2C\\u2D2E\\u2D2F\\u2D68-\\u2D6E\\u2D71-\\u2D7E\\u2D97-\\u2D9F\\u2DA7\\u2DAF\\u2DB7\\u2DBF\\u2DC7\\u2DCF\\u2DD7\\u2DDF\\u2E3C-\\u2E7F\\u2E9A\\u2EF4-\\u2EFF\\u2FD6-\\u2FEF\\u2FFC-\\u2FFF\\u3040\\u3097\\u3098\\u3100-\\u3104\\u312E-\\u3130\\u318F\\u31BB-\\u31BF\\u31E4-\\u31EF\\u321F\\u32FF\\u4DB6-\\u4DBF\\u9FCD-\\u9FFF\\uA48D-\\uA48F\\uA4C7-\\uA4CF\\uA62C-\\uA63F\\uA698-\\uA69E\\uA6F8-\\uA6FF\\uA78F\\uA794-\\uA79F\\uA7AB-\\uA7F7\\uA82C-\\uA82F\\uA83A-\\uA83F\\uA878-\\uA87F\\uA8C5-\\uA8CD\\uA8DA-\\uA8DF\\uA8FC-\\uA8FF\\uA954-\\uA95E\\uA97D-\\uA97F\\uA9CE\\uA9DA-\\uA9DD\\uA9E0-\\uA9FF\\uAA37-\\uAA3F\\uAA4E\\uAA4F\\uAA5A\\uAA5B\\uAA7C-\\uAA7F\\uAAC3-\\uAADA\\uAAF7-\\uAB00\\uAB07\\uAB08\\uAB0F\\uAB10\\uAB17-\\uAB1F\\uAB27\\uAB2F-\\uABBF\\uABEE\\uABEF\\uABFA-\\uABFF\\uD7A4-\\uD7AF\\uD7C7-\\uD7CA\\uD7FC-\\uF8FF\\uFA6E\\uFA6F\\uFADA-\\uFAFF\\uFB07-\\uFB12\\uFB18-\\uFB1C\\uFB37\\uFB3D\\uFB3F\\uFB42\\uFB45\\uFBC2-\\uFBD2\\uFD40-\\uFD4F\\uFD90\\uFD91\\uFDC8-\\uFDEF\\uFDFE\\uFDFF\\uFE1A-\\uFE1F\\uFE27-\\uFE2F\\uFE53\\uFE67\\uFE6C-\\uFE6F\\uFE75\\uFEFD-\\uFF00\\uFFBF-\\uFFC1\\uFFC8\\uFFC9\\uFFD0\\uFFD1\\uFFD8\\uFFD9\\uFFDD-\\uFFDF\\uFFE7\\uFFEF-\\uFFFB\\uFFFE\\uFFFF]/g;\n    defineFunction('clean', function (text) {\n        return text.replace(RX_NON_PRINTABLE, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('code', function (text) {\n        return text.charAt(0);\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineAlias('unichar', 'char');\n    defineAlias('unicode', 'code');\n    defineFunction('concatenate', function (args) {\n        var out = '';\n        for (var i = 0; i < args.length; ++i) {\n            out += args[i];\n        }\n        return out;\n    }).args([[\n            '+',\n            [\n                '*text',\n                'string'\n            ]\n        ]]);\n    defineFunction('dollar', function (number, decimals) {\n        var format = '$#,##0.DECIMALS;($#,##0.DECIMALS)';\n        var dec = '';\n        while (decimals-- > 0) {\n            dec += '0';\n        }\n        format = format.replace(/DECIMALS/g, dec);\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('exact', function (a, b) {\n        return a === b;\n    }).args([\n        [\n            '*text1',\n            'string'\n        ],\n        [\n            '*text2',\n            'string'\n        ]\n    ]);\n    defineFunction('find', function (substring, string, start) {\n        var pos = string.indexOf(substring, start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('fixed', function (number, decimals, noCommas) {\n        var scale = Math.pow(10, decimals);\n        number = Math.round(number * scale) / scale;\n        var format = noCommas ? '0' : '#,##0';\n        if (decimals > 0) {\n            format += '.';\n            while (decimals-- > 0) {\n                format += '0';\n            }\n        }\n        return spreadsheet.formatting.text(number, format);\n    }).args([\n        [\n            '*number',\n            'number'\n        ],\n        [\n            '*decimals',\n            [\n                'or',\n                'integer',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            '*noCommas',\n            [\n                'or',\n                'boolean',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('left', function (text, length) {\n        return text.substr(0, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('right', function (text, length) {\n        return text.substr(-length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*length',\n            [\n                'or',\n                'integer+',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('len', function (text) {\n        return text.length;\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('lower', function (text) {\n        return text.toLowerCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('upper', function (text) {\n        return text.toUpperCase();\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('ltrim', function (text) {\n        return text.replace(/^\\s+/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('rtrim', function (text) {\n        return text.replace(/\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('trim', function (text) {\n        return text.replace(/^\\s+|\\s+$/, '');\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('mid', function (text, start, length) {\n        return text.substr(start - 1, length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ]\n    ]);\n    defineFunction('proper', function (text) {\n        return text.toLowerCase().replace(/\\b./g, function (s) {\n            return s.toUpperCase();\n        });\n    }).args([[\n            '*text',\n            'string'\n        ]]);\n    defineFunction('replace', function (text, start, length, newText) {\n        return text.substr(0, --start) + newText + text.substr(start + length);\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*start',\n            'integer++'\n        ],\n        [\n            '*length',\n            'integer+'\n        ],\n        [\n            '*newText',\n            'string'\n        ]\n    ]);\n    defineFunction('rept', function (text, number) {\n        var out = '';\n        while (number-- > 0) {\n            out += text;\n        }\n        return out;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*number',\n            'integer+'\n        ]\n    ]);\n    defineFunction('search', function (substring, string, start) {\n        var pos = string.toLowerCase().indexOf(substring.toLowerCase(), start - 1);\n        return pos < 0 ? new CalcError('VALUE') : pos + 1;\n    }).args([\n        [\n            '*substring',\n            'string'\n        ],\n        [\n            '*string',\n            'string'\n        ],\n        [\n            '*start',\n            [\n                'or',\n                'integer++',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('substitute', function (text, oldText, newText, nth) {\n        if (oldText === newText) {\n            return text;\n        }\n        var pos = -1;\n        function replace() {\n            text = text.substring(0, pos) + newText + text.substring(pos + oldText.length);\n        }\n        while ((pos = text.indexOf(oldText, pos + 1)) >= 0) {\n            if (nth == null) {\n                replace();\n            } else if (--nth === 0) {\n                replace();\n                break;\n            }\n        }\n        return text;\n    }).args([\n        [\n            '*text',\n            'string'\n        ],\n        [\n            '*oldText',\n            'string'\n        ],\n        [\n            '*newText',\n            'string'\n        ],\n        [\n            '*nth',\n            [\n                'or',\n                'integer++',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('t', function (value) {\n        return typeof value == 'string' ? value : '';\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    defineFunction('text', function (value, format) {\n        return spreadsheet.formatting.text(value, format);\n    }).args([\n        [\n            '*value',\n            'anyvalue'\n        ],\n        [\n            '*format',\n            'string'\n        ]\n    ]);\n    defineFunction('value', function (value) {\n        if (typeof value == 'number') {\n            return value;\n        }\n        if (typeof value == 'boolean') {\n            return +value;\n        }\n        value = (value + '').replace(/[$,]/g, '');\n        value = parseFloat(value);\n        return isNaN(value) ? new CalcError('VALUE') : value;\n    }).args([[\n            '*value',\n            'anyvalue'\n        ]]);\n    function Hyperlink(link, text) {\n        this.link = link;\n        this.text = text;\n    }\n    Hyperlink.prototype.toString = function () {\n        return this.text;\n    };\n    defineFunction('hyperlink', function (link, text) {\n        return new Hyperlink(link, text);\n    }).args([\n        [\n            '*link',\n            'string'\n        ],\n        [\n            '*text',\n            [\n                'or',\n                'string',\n                [\n                    'null',\n                    '$link'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('iferror', function (value, valueIfError) {\n        return value instanceof CalcError ? valueIfError : value;\n    }).args([\n        [\n            '*value',\n            'forced!'\n        ],\n        [\n            '*value_if_error',\n            'anyvalue!'\n        ]\n    ]);\n    var parseCriteria = function () {\n        var RXCACHE = Object.create(null);\n        function makeComparator(cmp, x) {\n            if (typeof x == 'string') {\n                var num = parseFloat(x);\n                if (!isNaN(num) && num == x) {\n                    x = num;\n                }\n            }\n            return function (a) {\n                var b = x;\n                if (typeof a == 'string' && typeof b == 'string') {\n                    a = a.toLowerCase();\n                    b = b.toLowerCase();\n                }\n                return cmp(a, b);\n            };\n        }\n        function lc(a) {\n            var num, str;\n            if (typeof a == 'string') {\n                a = a.toLowerCase();\n            }\n            if (/^[0-9.]+%$/.test(a)) {\n                str = a.substr(0, a.length - 1);\n                num = parseFloat(str);\n                if (!isNaN(num) && num == str) {\n                    a = num / 100;\n                }\n            } else if (/^[0-9.]+$/.test(a)) {\n                num = parseFloat(a);\n                if (!isNaN(num) && num == a) {\n                    a = num;\n                }\n            }\n            return a;\n        }\n        function compLT(a, b) {\n            return lc(a) < lc(b);\n        }\n        function compLTE(a, b) {\n            return lc(a) <= lc(b);\n        }\n        function compGT(a, b) {\n            return lc(a) > lc(b);\n        }\n        function compGTE(a, b) {\n            return lc(a) >= lc(b);\n        }\n        function compNE(a, b) {\n            return !compEQ(a, b);\n        }\n        function compEQ(a, b) {\n            if (b instanceof RegExp) {\n                return b.test(a);\n            }\n            if (typeof a == 'string' || typeof b == 'string') {\n                a = String(a);\n                b = String(b);\n            }\n            return lc(a) == lc(b);\n        }\n        return function (cmp) {\n            if (typeof cmp == 'function') {\n                return cmp;\n            }\n            var m;\n            if (m = /^=(.*)$/.exec(cmp)) {\n                return makeComparator(compEQ, m[1]);\n            }\n            if (m = /^<>(.*)$/.exec(cmp)) {\n                return makeComparator(compNE, m[1]);\n            }\n            if (m = /^<=(.*)$/.exec(cmp)) {\n                return makeComparator(compLTE, m[1]);\n            }\n            if (m = /^<(.*)$/.exec(cmp)) {\n                return makeComparator(compLT, m[1]);\n            }\n            if (m = /^>=(.*)$/.exec(cmp)) {\n                return makeComparator(compGTE, m[1]);\n            }\n            if (m = /^>(.*)$/.exec(cmp)) {\n                return makeComparator(compGT, m[1]);\n            }\n            if (/[?*]/.exec(cmp)) {\n                var rx = RXCACHE[cmp];\n                if (!rx) {\n                    rx = cmp.replace(/(~\\?|~\\*|[\\]({\\+\\.\\|\\^\\$\\\\})\\[]|[?*])/g, function (s) {\n                        switch (s) {\n                        case '~?':\n                            return '\\\\?';\n                        case '~*':\n                            return '\\\\*';\n                        case '?':\n                            return '.';\n                        case '*':\n                            return '.*';\n                        default:\n                            return '\\\\' + s;\n                        }\n                    });\n                    rx = RXCACHE[cmp] = new RegExp('^' + rx + '$', 'i');\n                }\n                return makeComparator(compEQ, rx);\n            }\n            return makeComparator(compEQ, cmp);\n        };\n    }();\n    function numericPredicate(val) {\n        return typeof val == 'number' || typeof val == 'boolean' || val == null || val === '';\n    }\n    function ascending(a, b) {\n        return a === b ? 0 : a < b ? -1 : 1;\n    }\n    function descending(a, b) {\n        return a === b ? 0 : a < b ? 1 : -1;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/runtime.functions.2', ['spreadsheet/runtime'], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var calc = spreadsheet.calc;\n    var runtime = calc.runtime;\n    var defineFunction = runtime.defineFunction;\n    var CalcError = runtime.CalcError;\n    var packDate = runtime.packDate;\n    var unpackDate = runtime.unpackDate;\n    var isLeapYear = runtime.isLeapYear;\n    var daysInMonth = runtime.daysInMonth;\n    var _days_360 = runtime._days_360;\n    defineFunction('ERF', function (ll, ul) {\n        if (ul == null) {\n            return ERF(ll);\n        }\n        return ERF(ul) - ERF(ll);\n    }).args([\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                'null'\n            ]\n        ]\n    ]);\n    defineFunction('ERFC', ERFC).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMALN', GAMMALN).args([[\n            'x',\n            'number++'\n        ]]);\n    defineFunction('GAMMA', GAMMA).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('GAMMA.DIST', GAMMA_DIST).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('GAMMA.INV', GAMMA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ]\n    ]);\n    defineFunction('NORM.S.DIST', NORM_S_DIST).args([\n        [\n            'z',\n            'number'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.S.INV', NORM_S_INV).args([[\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('NORM.DIST', NORM_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('NORM.INV', NORM_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'stddev',\n            'number++'\n        ]\n    ]);\n    defineFunction('BETADIST', BETADIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.DIST', BETA_DIST).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x >= $A',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$x <= $B',\n                'NUM'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$A < $B',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('BETA.INV', BETA_INV).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'alpha',\n            'number++'\n        ],\n        [\n            'beta',\n            'number++'\n        ],\n        [\n            'A',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'B',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CHISQ.DIST', chisq_left).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('CHISQ.DIST.RT', chisq_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV', chisq_left_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.INV.RT', chisq_right_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('CHISQ.TEST', function (ac, ex) {\n        return chisq_test(ac.data, ex.data);\n    }).args([\n        [\n            'actual_range',\n            'matrix'\n        ],\n        [\n            'expected_range',\n            'matrix'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.width == $expected_range.width'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$actual_range.height == $expected_range.height'\n            ]\n        ]\n    ]);\n    defineFunction('EXPON.DIST', expon).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'lambda',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('POISSON.DIST', poisson).args([\n        [\n            'x',\n            'integer+'\n        ],\n        [\n            'mean',\n            'number+'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST', Fdist).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('F.DIST.RT', Fdist_right).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV', Finv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.INV.RT', Finv_right).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '[between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom1',\n            'integer++'\n        ],\n        [\n            'deg_freedom2',\n            'integer++'\n        ]\n    ]);\n    defineFunction('F.TEST', Ftest).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FISHER', fisher).args([[\n            'x',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    -1,\n                    1\n                ]\n            ]\n        ]]);\n    defineFunction('FISHERINV', fisherinv).args([[\n            'y',\n            'number'\n        ]]);\n    defineFunction('T.DIST', Tdist).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('T.DIST.RT', Tdist_right).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.DIST.2T', Tdist_2tail).args([\n        [\n            'x',\n            'number+'\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV', Tdist_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.INV.2T', Tdist_2tail_inv).args([\n        [\n            'p',\n            [\n                'and',\n                'number',\n                [\n                    '(between]',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'deg_freedom',\n            'integer++'\n        ]\n    ]);\n    defineFunction('T.TEST', Tdist_test).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'tails',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    3\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$type != 1 || $array1.length == $array2.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array1.length >= 2',\n                'DIV/0'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length >= 2',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.T', confidence_t).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++',\n                [\n                    'assert',\n                    '$size != 1',\n                    'DIV/0'\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('CONFIDENCE.NORM', confidence_norm).args([\n        [\n            'alpha',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'size',\n            [\n                'and',\n                'integer++'\n            ]\n        ]\n    ]);\n    defineFunction('GAUSS', gauss).args([[\n            'z',\n            'number'\n        ]]);\n    defineFunction('PHI', phi).args([[\n            'x',\n            'number'\n        ]]);\n    defineFunction('LOGNORM.DIST', lognorm_dist).args([\n        [\n            'x',\n            'number++'\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ],\n        [\n            'cumulative',\n            'logical'\n        ]\n    ]);\n    defineFunction('LOGNORM.INV', lognorm_inv).args([\n        [\n            'probability',\n            [\n                'and',\n                'number',\n                [\n                    '(between)',\n                    0,\n                    1\n                ]\n            ]\n        ],\n        [\n            'mean',\n            'number'\n        ],\n        [\n            'standard_dev',\n            'number++'\n        ]\n    ]);\n    defineFunction('PROB', prob).args([\n        [\n            'x_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'prob_range',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'lower_limit',\n            'number'\n        ],\n        [\n            'upper_limit',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    '$lower_limit'\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$prob_range.length == $x_range.length',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('SLOPE', slope).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('INTERCEPT', intercept).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('PEARSON', pearson).args([\n        [\n            'array1',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'array2',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length == $array1.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$array2.length > 0 && $array1.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('RSQ', rsq).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length != 1 && $known_y.length != 1',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('STEYX', steyx).args([\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length >= 3 && $known_y.length >= 3',\n                'DIV/0'\n            ]\n        ]\n    ]);\n    defineFunction('FORECAST', forecast).args([\n        [\n            'x',\n            'number'\n        ],\n        [\n            'known_y',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'known_x',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length == $known_y.length',\n                'N/A'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$known_x.length > 0 && $known_y.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('LINEST', linest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('LOGEST', logest).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            'stats',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('TREND', trend).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('GROWTH', growth).args([\n        [\n            'known_y',\n            'matrix'\n        ],\n        [\n            'known_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'new_x',\n            [\n                'or',\n                'matrix',\n                'null'\n            ]\n        ],\n        [\n            'const',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('FV', FV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $pv'\n            ]\n        ]\n    ]);\n    defineFunction('PV', PV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('PMT', PMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('NPER', NPER).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'pmt',\n            'number'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('RATE', RATE).args([\n        [\n            'nper',\n            'number'\n        ],\n        [\n            'pmt',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number++',\n                [\n                    'null',\n                    0.01\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$pmt || $fv'\n            ]\n        ]\n    ]);\n    defineFunction('IPMT', IPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('PPMT', PPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            'fv',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('CUMPRINC', CUMPRINC).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('CUMIPMT', CUMIPMT).args([\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number++'\n        ],\n        [\n            'end_period',\n            'number++'\n        ],\n        [\n            'type',\n            [\n                'or',\n                [\n                    'values',\n                    0,\n                    1\n                ],\n                [\n                    'null',\n                    0\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('NPV', NPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number'\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length > 0',\n                'N/A'\n            ]\n        ]\n    ]);\n    defineFunction('IRR', IRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('EFFECT', EFFECT).args([\n        [\n            'nominal_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('NOMINAL', NOMINAL).args([\n        [\n            'effect_rate',\n            'number++'\n        ],\n        [\n            'npery',\n            'integer++'\n        ]\n    ]);\n    defineFunction('XNPV', XNPV).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('XIRR', XIRR).args([\n        [\n            'values',\n            [\n                'collect',\n                'number',\n                1\n            ]\n        ],\n        [\n            'dates',\n            [\n                'collect',\n                'date',\n                1\n            ]\n        ],\n        [\n            'guess',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    0.1\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$values.length == $dates.length',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ISPMT', ISPMT).args([\n        [\n            'rate',\n            'number'\n        ],\n        [\n            'per',\n            'number++'\n        ],\n        [\n            'nper',\n            'number++'\n        ],\n        [\n            'pv',\n            'number'\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$per >= 1 && $per <= $nper'\n            ]\n        ]\n    ]);\n    defineFunction('DB', DB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'month',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    12\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('DDB', DDB).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'period',\n            'number++'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ]\n    ]);\n    defineFunction('SLN', SLN).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ]\n    ]);\n    defineFunction('SYD', SYD).args([\n        [\n            'cost',\n            'number'\n        ],\n        [\n            'salvage',\n            'number'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'per',\n            'number++'\n        ]\n    ]);\n    defineFunction('VDB', VDB).args([\n        [\n            'cost',\n            'number+'\n        ],\n        [\n            'salvage',\n            'number+'\n        ],\n        [\n            'life',\n            'number++'\n        ],\n        [\n            'start_period',\n            'number+'\n        ],\n        [\n            'end_period',\n            'number+'\n        ],\n        [\n            'factor',\n            [\n                'or',\n                'number+',\n                [\n                    'null',\n                    2\n                ]\n            ]\n        ],\n        [\n            'no_switch',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    false\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$end_period >= $start_period',\n                'NUM'\n            ]\n        ]\n    ]);\n    var COUPS_ARGS = [\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ];\n    defineFunction('COUPDAYBS', COUPDAYBS).args(COUPS_ARGS);\n    defineFunction('COUPDAYS', COUPDAYS).args(COUPS_ARGS);\n    defineFunction('COUPDAYSNC', COUPDAYSNC).args(COUPS_ARGS);\n    defineFunction('COUPPCD', COUPPCD).args(COUPS_ARGS);\n    defineFunction('COUPNCD', COUPNCD).args(COUPS_ARGS);\n    defineFunction('COUPNUM', COUPNUM).args(COUPS_ARGS);\n    defineFunction('ACCRINTM', ACCRINTM).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('ACCRINT', ACCRINT).args([\n        [\n            'issue',\n            'date'\n        ],\n        [\n            'first_interest',\n            'date'\n        ],\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'par',\n            [\n                'or',\n                [\n                    'null',\n                    1000\n                ],\n                'number++'\n            ]\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            'calc_method',\n            [\n                'or',\n                'logical',\n                [\n                    'null',\n                    true\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$issue < $settlement',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('DISC', DISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'pr',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('INTRATE', INTRATE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('RECEIVED', RECEIVED).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'investment',\n            'number++'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICE', PRICE).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'rate',\n            'number++'\n        ],\n        [\n            'yld',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'frequency',\n            [\n                'and',\n                'integer',\n                [\n                    'values',\n                    1,\n                    2,\n                    4\n                ]\n            ]\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    defineFunction('PRICEDISC', PRICEDISC).args([\n        [\n            'settlement',\n            'date'\n        ],\n        [\n            'maturity',\n            'date'\n        ],\n        [\n            'discount',\n            'number++'\n        ],\n        [\n            'redemption',\n            'number++'\n        ],\n        [\n            'basis',\n            [\n                'or',\n                [\n                    'null',\n                    0\n                ],\n                [\n                    'and',\n                    'integer',\n                    [\n                        'values',\n                        0,\n                        1,\n                        2,\n                        3,\n                        4\n                    ]\n                ]\n            ]\n        ],\n        [\n            '?',\n            [\n                'assert',\n                '$settlement < $maturity',\n                'NUM'\n            ]\n        ]\n    ]);\n    var MAX_IT = 300, EPS = 2.2204e-16, FP_MIN = 1e-30, f_abs = Math.abs;\n    function ERF(x) {\n        if (f_abs(x) >= 3.3) {\n            return 1 - ERFC(x);\n        }\n        var S = x > 0 ? 1 : -1;\n        if (S == -1) {\n            x = -x;\n        }\n        var m = 0, an = 1;\n        for (var n = 1; n < 100; n++) {\n            m += an;\n            an *= 2 * x * x / (2 * n + 1);\n        }\n        return S * 2 / Math.sqrt(Math.PI) * x * Math.exp(-x * x) * m;\n    }\n    function ERFC(x) {\n        if (f_abs(x) < 3.3) {\n            return 1 - ERF(x);\n        }\n        var s = 1;\n        if (x < 0) {\n            s = -1;\n            x = -x;\n        }\n        var frac = x;\n        for (var n = 8; n >= 1; n -= 0.5) {\n            frac = x + n / frac;\n        }\n        frac = 1 / (x + frac);\n        return s == 1 ? Math.exp(-x * x) / Math.sqrt(Math.PI) * frac : 2 - Math.exp(-x * x) / Math.sqrt(Math.PI) * frac;\n    }\n    function GAMMALN(x) {\n        var cof = [\n            1.000000000190015,\n            76.18009172947146,\n            -86.50532032941678,\n            24.01409824083091,\n            -1.231739572450155,\n            0.001208650973866179,\n            -0.000005395239384953\n        ];\n        var y = x, tmp = x + 5.5, ser = cof[0];\n        tmp -= (x + 0.5) * Math.log(tmp);\n        for (var j = 1; j <= 6; j++) {\n            y += 1;\n            ser += cof[j] / y;\n        }\n        return -tmp + Math.log(Math.sqrt(2 * Math.PI) * ser / x);\n    }\n    function GAMMA(x) {\n        if (x > 0) {\n            return Math.exp(GAMMALN(x));\n        }\n        var pi = Math.PI, y = -x;\n        return -pi / (y * GAMMA(y) * Math.sin(pi * y));\n    }\n    function BETALN(a, b) {\n        return GAMMALN(a) + GAMMALN(b) - GAMMALN(a + b);\n    }\n    function BETA(a, b) {\n        return Math.exp(BETALN(a, b));\n    }\n    function gamma_inc(a, x) {\n        return x < a + 1 ? g_series(a, x) : 1 - g_contfrac(a, x);\n    }\n    function g_series(a, x) {\n        var sum = 1 / a, frac = sum, ap = a;\n        var gln = GAMMALN(a), n;\n        for (n = 1; n <= MAX_IT; n++) {\n            ap++;\n            frac *= x / ap;\n            sum += frac;\n            if (f_abs(frac) < f_abs(sum) * EPS) {\n                break;\n            }\n        }\n        return sum * Math.exp(-x + a * Math.log(x) - gln);\n    }\n    function g_contfrac(a, x) {\n        var f = FP_MIN, c = f, d = 0, aj = 1, bj = x + 1 - a;\n        var gln = GAMMALN(a);\n        for (var i = 1; i <= MAX_IT; i++) {\n            d = bj + aj * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = bj + aj / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            var delta = c * d;\n            f *= delta;\n            if (f_abs(delta - 1) < EPS) {\n                break;\n            }\n            bj += 2;\n            aj = -i * (i - a);\n        }\n        return f * Math.exp(-x - gln + a * Math.log(x));\n    }\n    function GAMMA_DIST(x, a, b, cumulative) {\n        if (!cumulative) {\n            return Math.pow(x / b, a - 1) * Math.exp(-x / b) / (b * GAMMA(a));\n        }\n        return gamma_inc(a, x / b);\n    }\n    function GAMMA_INV(p, a, b) {\n        if (p === 0) {\n            return 0;\n        }\n        if (p == 1) {\n            return Infinity;\n        }\n        var m = 0, M = 10, x = 0, ab = a * b;\n        if (ab > 1) {\n            M *= ab;\n        }\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = GAMMA_DIST(x, a, b, true);\n            if (f_abs(p - q) < 1e-16) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function NORM_S_DIST(x, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-x * x / 2) / Math.sqrt(2 * Math.PI);\n        }\n        return 0.5 + 0.5 * ERF(x / Math.sqrt(2));\n    }\n    function NORM_S_INV(p) {\n        var a = [\n                -39.69683028665376,\n                220.9460984245205,\n                -275.9285104469687,\n                138.357751867269,\n                -30.66479806614716,\n                2.506628277459239\n            ], b = [\n                -54.47609879822406,\n                161.5858368580409,\n                -155.6989798598866,\n                66.80131188771972,\n                -13.28068155288572\n            ], c = [\n                -0.007784894002430293,\n                -0.3223964580411365,\n                -2.400758277161838,\n                -2.549732539343734,\n                4.374664141464968,\n                2.938163982698783\n            ], d = [\n                0.007784695709041462,\n                0.3224671290700398,\n                2.445134137142996,\n                3.754408661907416\n            ];\n        var plow = 0.02425, phigh = 1 - plow;\n        var q, r;\n        if (p < plow) {\n            q = Math.sqrt(-2 * Math.log(p));\n            return (((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        if (phigh < p) {\n            q = Math.sqrt(-2 * Math.log(1 - p));\n            return -(((((c[0] * q + c[1]) * q + c[2]) * q + c[3]) * q + c[4]) * q + c[5]) / ((((d[0] * q + d[1]) * q + d[2]) * q + d[3]) * q + 1);\n        }\n        q = p - 0.5;\n        r = q * q;\n        return (((((a[0] * r + a[1]) * r + a[2]) * r + a[3]) * r + a[4]) * r + a[5]) * q / (((((b[0] * r + b[1]) * r + b[2]) * r + b[3]) * r + b[4]) * r + 1);\n    }\n    function NORM_DIST(x, m, s, cumulative) {\n        if (!cumulative) {\n            return Math.exp(-(x - m) * (x - m) / (2 * s * s)) / (s * Math.sqrt(2 * Math.PI));\n        }\n        return NORM_S_DIST((x - m) / s, true);\n    }\n    function NORM_INV(p, m, s) {\n        return m + s * NORM_S_INV(p);\n    }\n    function betastd_pdf(x, a, b) {\n        return Math.exp((a - 1) * Math.log(x) + (b - 1) * Math.log(1 - x) - BETALN(a, b));\n    }\n    function betastd_cdf(x, a, b) {\n        var k = Math.exp(a * Math.log(x) + b * Math.log(1 - x) - BETALN(a, b));\n        return x < (a + 1) / (a + b + 2) ? k * beta_lentz(a, b, x) / a : 1 - k * beta_lentz(b, a, 1 - x) / b;\n    }\n    function beta_lentz(a, b, x) {\n        var m, m2;\n        var aa, c, d, del, h, qab, qam, qap;\n        qab = a + b;\n        qap = a + 1;\n        qam = a - 1;\n        c = 1;\n        d = 1 - qab * x / qap;\n        if (f_abs(d) < FP_MIN) {\n            d = FP_MIN;\n        }\n        d = 1 / d;\n        h = d;\n        for (m = 1; m <= MAX_IT; m++) {\n            m2 = 2 * m;\n            aa = m * (b - m) * x / ((qam + m2) * (a + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            h *= d * c;\n            aa = -(a + m) * (qab + m) * x / ((a + m2) * (qap + m2));\n            d = 1 + aa * d;\n            if (f_abs(d) < FP_MIN) {\n                d = FP_MIN;\n            }\n            c = 1 + aa / c;\n            if (f_abs(c) < FP_MIN) {\n                c = FP_MIN;\n            }\n            d = 1 / d;\n            del = d * c;\n            h *= del;\n            if (f_abs(del - 1) < EPS) {\n                break;\n            }\n        }\n        return h;\n    }\n    function betastd_inv(p, a, b) {\n        var m = 0, M = 1, x = 0;\n        for (var i = 0; i < MAX_IT; i++) {\n            x = 0.5 * (m + M);\n            var q = betastd_cdf(x, a, b);\n            if (f_abs(p - q) < EPS) {\n                break;\n            }\n            if (q > p) {\n                M = x;\n            } else {\n                m = x;\n            }\n        }\n        return x;\n    }\n    function BETADIST(x, a, b, m, M) {\n        return betastd_cdf((x - m) / (M - m), a, b);\n    }\n    function BETA_DIST(x, a, b, cdf, m, M) {\n        if (cdf) {\n            return betastd_cdf((x - m) / (M - m), a, b);\n        }\n        return betastd_pdf((x - m) / (M - m), a, b) / (M - m);\n    }\n    function BETA_INV(p, a, b, m, M) {\n        return m + (M - m) * betastd_inv(p, a, b);\n    }\n    function chisq_left(x, n, cds) {\n        return GAMMA_DIST(x, n / 2, 2, cds);\n    }\n    function chisq_right(x, n) {\n        return 1 - chisq_left(x, n, true);\n    }\n    function chisq_left_inv(p, n) {\n        return GAMMA_INV(p, n / 2, 2);\n    }\n    function chisq_right_inv(p, n) {\n        return chisq_left_inv(1 - p, n);\n    }\n    function chisq_test(obsv, expect) {\n        var rows = obsv.length, cols = obsv[0].length;\n        var x = 0, i, j;\n        for (i = 0; i < rows; i++) {\n            for (j = 0; j < cols; j++) {\n                var eij = expect[i][j];\n                var delta = obsv[i][j] - eij;\n                delta *= delta;\n                x += delta / eij;\n            }\n        }\n        var n = (rows - 1) * (cols - 1);\n        return chisq_right(x, n);\n    }\n    function expon(x, r, cdf) {\n        if (cdf) {\n            return 1 - Math.exp(-r * x);\n        }\n        return r * Math.exp(-r * x);\n    }\n    function poisson(k, m, cdf) {\n        if (cdf) {\n            return 1 - chisq_left(2 * m, 2 * (k + 1), true);\n        }\n        var lnf = 0;\n        for (var i = 2; i <= k; i++) {\n            lnf += Math.log(i);\n        }\n        return Math.exp(k * Math.log(m) - m - lnf);\n    }\n    function Fdist(x, n, d, cdf) {\n        if (cdf) {\n            return betastd_cdf(n * x / (d + n * x), n / 2, d / 2);\n        }\n        var u = n / d;\n        n /= 2;\n        d /= 2;\n        return u / BETA(n, d) * Math.pow(u * x, n - 1) / Math.pow(1 + u * x, n + d);\n    }\n    function Fdist_right(x, n, d) {\n        return 1 - Fdist(x, n, d, true);\n    }\n    function Finv_right(p, n, d) {\n        return d / n * (1 / BETA_INV(p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function Finv(p, n, d) {\n        return d / n * (1 / BETA_INV(1 - p, d / 2, n / 2, 0, 1) - 1);\n    }\n    function _mean(arr) {\n        var me = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            me += arr[i];\n        }\n        return me / n;\n    }\n    function _var_sq(arr, m) {\n        var v = 0, n = arr.length;\n        for (var i = 0; i < n; i++) {\n            var delta = arr[i] - m;\n            v += delta * delta;\n        }\n        return v / (n - 1);\n    }\n    function Ftest(arr1, arr2) {\n        var n1 = arr1.length - 1, n2 = arr2.length - 1;\n        var va1 = _var_sq(arr1, _mean(arr1)), va2 = _var_sq(arr2, _mean(arr2));\n        if (!va1 || !va2) {\n            throw new CalcError('DIV/0');\n        }\n        return 2 * Fdist(va1 / va2, n1, n2, true);\n    }\n    function fisher(x) {\n        return 0.5 * Math.log((1 + x) / (1 - x));\n    }\n    function fisherinv(x) {\n        var e2 = Math.exp(2 * x);\n        return (e2 - 1) / (e2 + 1);\n    }\n    function Tdist(x, n, cdf) {\n        if (cdf) {\n            return 1 - 0.5 * betastd_cdf(n / (x * x + n), n / 2, 0.5);\n        }\n        return 1 / (Math.sqrt(n) * BETA(0.5, n / 2)) * Math.pow(1 + x * x / n, -(n + 1) / 2);\n    }\n    function Tdist_right(x, n) {\n        return 1 - Tdist(x, n, true);\n    }\n    function Tdist_2tail(x, n) {\n        if (x < 0) {\n            x = -x;\n        }\n        return 2 * Tdist_right(x, n);\n    }\n    function Tdist_inv(p, n) {\n        var x = betastd_inv(2 * Math.min(p, 1 - p), n / 2, 0.5);\n        x = Math.sqrt(n * (1 - x) / x);\n        return p > 0.5 ? x : -x;\n    }\n    function Tdist_2tail_inv(p, n) {\n        return Tdist_inv(1 - p / 2, n);\n    }\n    function Tdist_test(gr1, gr2, tail, type) {\n        var n1 = gr1.length, n2 = gr2.length;\n        var t_st, df;\n        if (type == 1) {\n            var d = 0, d2 = 0;\n            for (var i = 0; i < n1; i++) {\n                var delta = gr1[i] - gr2[i];\n                d += delta;\n                d2 += delta * delta;\n            }\n            var md = d / n1;\n            t_st = md / Math.sqrt((d2 - d * md) / (n1 * (n1 - 1)));\n            return tail == 1 ? Tdist_right(t_st, n1 - 1) : Tdist_2tail(t_st, n1 - 1);\n        }\n        var m1 = _mean(gr1), m2 = _mean(gr2), v1 = _var_sq(gr1, m1), v2 = _var_sq(gr2, m2);\n        if (type == 3) {\n            var u1 = v1 / n1, u2 = v2 / n2, u = u1 + u2;\n            var q1 = u1 / u, q2 = u2 / u;\n            df = 1 / (q1 * q1 / (n1 - 1) + q2 * q2 / (n2 - 1));\n            t_st = f_abs(m1 - m2) / Math.sqrt(u);\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        } else {\n            df = n1 + n2 - 2;\n            t_st = f_abs(m1 - m2) * Math.sqrt(df * n1 * n2 / ((n1 + n2) * ((n1 - 1) * v1 + (n2 - 1) * v2)));\n            return tail == 1 ? Tdist_right(t_st, df) : Tdist_2tail(t_st, df);\n        }\n    }\n    function confidence_t(alpha, stddev, size) {\n        return -Tdist_inv(alpha / 2, size - 1) * stddev / Math.sqrt(size);\n    }\n    function confidence_norm(alpha, stddev, size) {\n        return -NORM_S_INV(alpha / 2) * stddev / Math.sqrt(size);\n    }\n    function gauss(z) {\n        return NORM_S_DIST(z, true) - 0.5;\n    }\n    function phi(x) {\n        return NORM_S_DIST(x);\n    }\n    function lognorm_dist(x, m, s, cumulative) {\n        if (cumulative) {\n            return 0.5 + 0.5 * ERF((Math.log(x) - m) / (s * Math.sqrt(2)));\n        }\n        var t = Math.log(x) - m;\n        return Math.exp(-t * t / (2 * s * s)) / (x * s * Math.sqrt(2 * Math.PI));\n    }\n    function lognorm_inv(p, m, s) {\n        return Math.exp(NORM_INV(p, m, s));\n    }\n    function prob(x_, p_, lw, up) {\n        var n = x_.length;\n        var s = 0, i;\n        for (i = 0; i < n; i++) {\n            if (p_[i] <= 0 || p_[i] > 1) {\n                throw new CalcError('NUM');\n            }\n            s += p_[i];\n        }\n        if (s != 1) {\n            throw new CalcError('NUM');\n        }\n        var res = 0;\n        for (i = 0; i < n; i++) {\n            var x = x_[i];\n            if (x >= lw && x <= up) {\n                res += p_[i];\n            }\n        }\n        return res;\n    }\n    function slope(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_), b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return b1 / b2;\n    }\n    function intercept(y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var b1 = 0, b2 = 0;\n        for (var i = 0, n = y_.length; i < n; i++) {\n            var t = x_[i] - mx;\n            b1 += t * (y_[i] - my);\n            b2 += t * t;\n        }\n        return my - b1 * mx / b2;\n    }\n    function pearson(x_, y_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n            s3 += t2 * t2;\n        }\n        return s1 / Math.sqrt(s2 * s3);\n    }\n    function rsq(x_, y_) {\n        var r = pearson(x_, y_);\n        return r * r;\n    }\n    function steyx(y_, x_) {\n        var n = x_.length;\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0, s3 = 0;\n        for (var i = 0; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t2 * t2;\n            s2 += t1 * t2;\n            s3 += t1 * t1;\n        }\n        return Math.sqrt((s1 - s2 * s2 / s3) / (n - 2));\n    }\n    function forecast(x, y_, x_) {\n        var mx = _mean(x_), my = _mean(y_);\n        var s1 = 0, s2 = 0;\n        for (var i = 0, n = x_.length; i < n; i++) {\n            var t1 = x_[i] - mx, t2 = y_[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (s2 === 0) {\n            throw new CalcError('N/A');\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return a + b * x;\n    }\n    function _mat_mean(Mat) {\n        var n = Mat.height, sum = 0;\n        for (var i = 0; i < n; i++) {\n            sum += Mat.data[i][0];\n        }\n        return sum / n;\n    }\n    function _mat_devsq(Mat, mean) {\n        var n = Mat.height, sq = 0;\n        for (var i = 0; i < n; i++) {\n            var x = Mat.data[i][0] - mean;\n            sq += x * x;\n        }\n        return sq;\n    }\n    function linest(Y, X, konst, stats) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        var line_1 = [];\n        for (i = B.height - 1; i >= 0; i--) {\n            line_1.push(B.data[i][0]);\n        }\n        if (!konst) {\n            line_1.push(0);\n        }\n        if (!stats) {\n            return this.asMatrix([line_1]);\n        }\n        var Y1 = X.multiply(B);\n        var y_y1 = Y.adds(Y1, true);\n        var mp = !konst ? 0 : _mat_mean(Y1);\n        var SSreg = _mat_devsq(Y1, mp);\n        var me = !konst ? 0 : _mat_mean(y_y1);\n        var SSresid = _mat_devsq(y_y1, me);\n        var line_5 = [];\n        line_5.push(SSreg, SSresid);\n        var R2 = SSreg / (SSreg + SSresid);\n        var degfre = Y.height - X.width;\n        var err_est = Math.sqrt(SSresid / degfre);\n        var line_3 = [];\n        line_3.push(R2, err_est);\n        var F_sta = !konst ? R2 / X.width / ((1 - R2) / degfre) : SSreg / (X.width - 1) / (SSresid / degfre);\n        var line_4 = [];\n        line_4.push(F_sta, degfre);\n        var SCP = Xt.multiply(X).inverse();\n        var line_2 = [];\n        for (i = SCP.height - 1; i >= 0; i--) {\n            line_2.push(Math.sqrt(SCP.data[i][i] * SSresid / degfre));\n        }\n        return this.asMatrix([\n            line_1,\n            line_2,\n            line_3,\n            line_4,\n            line_5\n        ]);\n    }\n    function logest(Y, X, konst, stats) {\n        return linest.call(this, Y.map(Math.log), X, konst, stats).map(Math.exp);\n    }\n    function trend(Y, X, W, konst) {\n        var i = 0;\n        if (!X) {\n            X = Y.map(function () {\n                return ++i;\n            });\n        }\n        if (konst) {\n            X = X.clone();\n            X.eachRow(function (row) {\n                X.data[row].unshift(1);\n            });\n            ++X.width;\n        }\n        var Xt = X.transpose();\n        var B = Xt.multiply(X).inverse().multiply(Xt).multiply(Y);\n        if (!W) {\n            W = X;\n        } else {\n            if (konst) {\n                W = W.clone();\n                W.eachRow(function (row) {\n                    W.data[row].unshift(1);\n                });\n                ++W.width;\n            }\n        }\n        return W.multiply(B);\n    }\n    function growth(Y, X, new_X, konst) {\n        return trend.call(this, Y.map(Math.log), X, new_X, konst).map(Math.exp);\n    }\n    function root_newton(func, guess, max_it, eps) {\n        var MAX_IT = max_it || 20, EPS = eps || 1e-7;\n        var root = guess;\n        for (var j = 1; j <= MAX_IT; j++) {\n            var f_d = func(root), f = f_d[0], df = f_d[1];\n            var dx = f / df;\n            root -= dx;\n            if (Math.abs(dx) < EPS) {\n                return root;\n            }\n        }\n        return new CalcError('NUM');\n    }\n    function FV(rate, nper, pmt, pv, type) {\n        var h1 = Math.pow(1 + rate, nper);\n        var h2 = rate ? (h1 - 1) / rate : nper;\n        return -(pv * h1 + pmt * h2 * (1 + rate * type));\n    }\n    function PV(rate, nper, pmt, fv, type) {\n        if (!rate) {\n            return -fv - pmt * nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -(fv + pmt * (h1 - 1) / rate * (1 + rate * type)) / h1;\n    }\n    function PMT(rate, nper, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / nper;\n        }\n        var h1 = Math.pow(1 + rate, nper);\n        return -rate * (fv + pv * h1) / ((1 + rate * type) * (h1 - 1));\n    }\n    function NPER(rate, pmt, pv, fv, type) {\n        if (!rate) {\n            return -(fv + pv) / pmt;\n        }\n        var h1 = pmt * (1 + rate * type);\n        return Math.log((h1 - fv * rate) / (h1 + pv * rate)) / Math.log(1 + rate);\n    }\n    function RATE(nper, pmt, pv, fv, type, guess) {\n        function xfd(x) {\n            var h2 = Math.pow(1 + x, nper - 1), h1 = h2 * (1 + x);\n            return [\n                pv * h1 + pmt * (1 / x + type) * (h1 - 1) + fv,\n                nper * pv * h2 + pmt * (-(h1 - 1) / (x * x) + (1 / x + type) * nper * h2)\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function IPMT(rate, per, nper, pv, fv, type) {\n        if (type == 1 && per == 1) {\n            return 0;\n        }\n        var pmt = PMT(rate, nper, pv, fv, type);\n        var ipmt = FV(rate, per - 1, pmt, pv, type) * rate;\n        return type ? ipmt / (1 + rate) : ipmt;\n    }\n    function PPMT(rate, per, nper, pv, fv, type) {\n        var pmt = PMT(rate, nper, pv, fv, type);\n        return pmt - IPMT(rate, per, nper, pv, fv, type);\n    }\n    function CUMPRINC(rate, nper, pv, start, end, type) {\n        if (type == 1) {\n            start--;\n            end--;\n        }\n        var tn = Math.pow(1 + rate, nper), ts = Math.pow(1 + rate, start - 1), te = Math.pow(1 + rate, end);\n        var monthlyPayment = rate * pv * tn / (tn - 1);\n        var remainingBalanceAtStart = ts * pv - (ts - 1) / rate * monthlyPayment;\n        var remainingBalanceAtEnd = te * pv - (te - 1) / rate * monthlyPayment;\n        return remainingBalanceAtEnd - remainingBalanceAtStart;\n    }\n    function CUMIPMT(rate, nper, pv, start, end, type) {\n        var cip = 0;\n        for (var i = start; i <= end; i++) {\n            cip += IPMT(rate, i, nper, pv, 0, type);\n        }\n        return cip;\n    }\n    function NPV(rate, flows) {\n        var npv = 0;\n        for (var i = 0, n = flows.length; i < n; i++) {\n            npv += flows[i] * Math.pow(1 + rate, -i - 1);\n        }\n        return npv;\n    }\n    function IRR(flows, guess) {\n        function xfd(x) {\n            var npv = 0, npv1 = 0;\n            for (var j = 0, n = flows.length; j < n; j++) {\n                npv += flows[j] * Math.pow(1 + x, -j - 1);\n                npv1 += -j * flows[j] * Math.pow(1 + x, -j - 2);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function EFFECT(nominal_rate, npery) {\n        return Math.pow(1 + nominal_rate / npery, npery) - 1;\n    }\n    function NOMINAL(effect_rate, npery) {\n        return npery * (Math.pow(effect_rate + 1, 1 / npery) - 1);\n    }\n    function XNPV(rate, values, dates) {\n        var npv = 0;\n        for (var i = 0, n = values.length; i < n; i++) {\n            npv += values[i] * Math.pow(1 + rate, (dates[0] - dates[i]) / 365);\n        }\n        return npv;\n    }\n    function XIRR(values, dates, guess) {\n        function xfd(x) {\n            var npv = values[0], npv1 = 0;\n            for (var j = 1, n = values.length; j < n; j++) {\n                var delta = (dates[0] - dates[j]) / 365;\n                npv += values[j] * Math.pow(1 + x, delta);\n                npv1 += delta * values[j] * Math.pow(1 + x, delta - 1);\n            }\n            return [\n                npv,\n                npv1\n            ];\n        }\n        return root_newton(xfd, guess);\n    }\n    function ISPMT(rate, per, nper, pv) {\n        var tmp = -pv * rate;\n        return tmp * (1 - per / nper);\n    }\n    function DB(cost, salvage, life, period, month) {\n        var rate = 1 - Math.pow(salvage / cost, 1 / life);\n        rate = Math.floor(rate * 1000 + 0.5) / 1000;\n        var db = cost * rate * month / 12;\n        if (period == 1) {\n            return db;\n        }\n        for (var i = 1; i < life; i++) {\n            if (i == period - 1) {\n                return (cost - db) * rate;\n            }\n            db += (cost - db) * rate;\n        }\n        return (cost - db) * rate * (12 - month) / 12;\n    }\n    function DDB(cost, salvage, life, period, factor) {\n        var f = factor / life;\n        var prior = -cost * (Math.pow(1 - f, period - 1) - 1);\n        var dep = (cost - prior) * f;\n        dep = Math.min(dep, Math.max(0, cost - prior - salvage));\n        return dep;\n    }\n    function SLN(cost, salvage, life) {\n        return (cost - salvage) / life;\n    }\n    function SYD(cost, salvage, life, per) {\n        return (cost - salvage) * (life - per + 1) * 2 / (life * (life + 1));\n    }\n    function VDB(cost, salvage, life, start, end, factor, no_switch) {\n        var interest = factor >= life ? 1 : factor / life;\n        function _getGDA(value, period) {\n            var gda, oldValue, newValue;\n            if (interest == 1) {\n                oldValue = period == 1 ? value : 0;\n            } else {\n                oldValue = value * Math.pow(1 - interest, period - 1);\n            }\n            newValue = value * Math.pow(1 - interest, period);\n            gda = newValue < salvage ? oldValue - salvage : oldValue - newValue;\n            return gda < 0 ? 0 : gda;\n        }\n        function _interVDB(cost, life1, period) {\n            var remValue = cost - salvage;\n            var intEnd = Math.ceil(period);\n            var term, lia = 0, vdb = 0, nowLia = false;\n            for (var i = 1; i <= intEnd; i++) {\n                if (!nowLia) {\n                    var gda = _getGDA(cost, i);\n                    lia = remValue / (life1 - i + 1);\n                    if (lia > gda) {\n                        term = lia;\n                        nowLia = true;\n                    } else {\n                        term = gda;\n                        remValue -= gda;\n                    }\n                } else {\n                    term = lia;\n                }\n                if (i == intEnd) {\n                    term *= period + 1 - intEnd;\n                }\n                vdb += term;\n            }\n            return vdb;\n        }\n        var intStart = Math.floor(start), intEnd = Math.ceil(end);\n        var vdb = 0;\n        if (no_switch) {\n            for (var i = intStart + 1; i <= intEnd; i++) {\n                var term = _getGDA(cost, i);\n                if (i == intStart + 1) {\n                    term *= Math.min(end, intStart + 1) - start;\n                } else {\n                    if (i == intEnd) {\n                        term *= end + 1 - intEnd;\n                    }\n                }\n                vdb += term;\n            }\n        } else {\n            var life1 = life;\n            if (start != Math.floor(start)) {\n                if (factor > 1) {\n                    if (start >= life / 2) {\n                        var part = start - life / 2;\n                        start = life / 2;\n                        end -= part;\n                        life1 += 1;\n                    }\n                }\n            }\n            cost -= _interVDB(cost, life1, start);\n            vdb = _interVDB(cost, life - start, end - start);\n        }\n        return vdb;\n    }\n    function _edate(base, months) {\n        var d = unpackDate(base);\n        var m = d.month + months;\n        var y = d.year + Math.floor(m / 12);\n        m %= 12;\n        if (m < 0) {\n            m += 12;\n        }\n        d = Math.min(d.date, daysInMonth(y, m));\n        return packDate(y, m, d);\n    }\n    function _daysBetween(from, to, basis) {\n        if (basis == 1 || basis == 2 || basis == 3) {\n            return to - from;\n        }\n        return _days_360(from, to, basis);\n    }\n    function _borderCoupons(settlement, maturity, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(maturity);\n        var periods = base.year - sett.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev, next, months = 12 / freq;\n        do {\n            periods++;\n            prev = _edate(maturity, -periods * months);\n        } while (settlement < prev);\n        periods--;\n        next = _edate(maturity, -periods * months);\n        return [\n            prev,\n            next\n        ];\n    }\n    function _borderCoupons_fw(first, settlement, freq) {\n        var sett = unpackDate(settlement), base = unpackDate(first);\n        var periods = sett.year - base.year;\n        if (periods > 0) {\n            periods = (periods - 1) * freq;\n        }\n        var prev = first, next, months = 12 / freq;\n        while (settlement > prev) {\n            next = prev;\n            periods++;\n            prev = _edate(first, periods * months);\n        }\n        return [\n            next,\n            prev\n        ];\n    }\n    function COUPDAYBS(settlement, maturity, frequency, basis) {\n        var prev = _borderCoupons(settlement, maturity, frequency)[0];\n        return _daysBetween(prev, settlement, basis);\n    }\n    function COUPDAYS(settl, matur, freq, basis) {\n        if (basis == 1) {\n            var borders = _borderCoupons(settl, matur, freq);\n            return _daysBetween(borders[0], borders[1], 1);\n        }\n        if (basis == 3) {\n            return 365 / freq;\n        }\n        return 360 / freq;\n    }\n    function COUPDAYSNC(settl, matur, freq, basis) {\n        var next = _borderCoupons(settl, matur, freq)[1];\n        return _daysBetween(settl, next, basis);\n    }\n    function COUPPCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[0];\n    }\n    function COUPNCD(settl, matur, freq) {\n        return _borderCoupons(settl, matur, freq)[1];\n    }\n    function COUPNUM(settl, matur, freq) {\n        var sett = unpackDate(settl), mat = unpackDate(matur);\n        var months = 12 * (mat.year - sett.year) + mat.month - sett.month;\n        return 1 + (months * freq / 12 | 0);\n    }\n    function daysInYear(yr, basis) {\n        if (basis == 3) {\n            return 365;\n        }\n        if (basis == 1) {\n            return isLeapYear(yr) ? 366 : 365;\n        }\n        return 360;\n    }\n    function ACCRINTM(issue, maturity, rate, par, basis) {\n        var year_days = daysInYear(unpackDate(maturity).year, basis);\n        return rate * par * _daysBetween(issue, maturity, basis) / year_days;\n    }\n    function ACCRINT(issue, first, settl, rate, par, freq, basis, calc) {\n        var accr = 0, cost = par * rate / freq;\n        var brace, prev, next, prev1, next1, nrc;\n        var annual = basis % 2 === 0 ? 360 : 365;\n        function _numCoupons(from, to) {\n            return (to - from) * freq / annual | 0;\n        }\n        if (settl <= first) {\n            brace = _borderCoupons(settl, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            if (prev <= issue) {\n                return cost * _daysBetween(issue, settl, basis) / _daysBetween(prev, next, basis);\n            }\n            brace = _borderCoupons(issue, prev, freq);\n            prev1 = brace[0];\n            next1 = brace[1];\n            nrc = _numCoupons(next1, settl);\n            return cost * (nrc + _daysBetween(issue, next1, basis) / _daysBetween(prev1, next1, basis) + (settl < next ? _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis) : 0));\n        } else {\n            brace = _borderCoupons_fw(first, settl, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(first, settl);\n            if (next == settl) {\n                accr = cost * nrc;\n            } else {\n                accr = cost * (nrc + _daysBetween(prev, settl, basis) / _daysBetween(prev, next, basis));\n            }\n            if (!calc) {\n                return accr;\n            }\n            brace = _borderCoupons(issue, first, freq);\n            prev = brace[0];\n            next = brace[1];\n            nrc = _numCoupons(issue, first);\n            accr += cost * (nrc + _daysBetween(issue, next, basis) / _daysBetween(prev, next, basis));\n            return accr;\n        }\n    }\n    function DISC(settl, matur, pr, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - pr) / redemption * annual / _daysBetween(settl, matur, basis);\n    }\n    function INTRATE(settl, matur, investment, redemption, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return (redemption - investment) / investment * annual / _daysBetween(settl, matur, basis);\n    }\n    function RECEIVED(settl, matur, investment, discount, basis) {\n        var annual = basis % 2 === 0 ? 360 : isLeapYear(unpackDate(settl).year) ? 366 : 365;\n        return investment / (1 - discount * _daysBetween(settl, matur, basis) / annual);\n    }\n    function PRICE(settl, matur, rate, yld, redemption, freq, basis) {\n        var N = 1 + ((matur - settl) * freq / (basis % 2 === 0 ? 360 : 365) | 0);\n        var brace = _borderCoupons(settl, matur, freq), prev = brace[0], next = brace[1];\n        var beg_settl = _daysBetween(prev, settl, basis), settl_end = _daysBetween(settl, next, basis), beg_end = _daysBetween(prev, next, basis);\n        var den = 100 * rate / freq, yf = yld / freq, frac = settl_end / beg_end;\n        if (N == 1) {\n            return (redemption + den) / (1 + frac * yf) - beg_settl / beg_end * den;\n        }\n        return redemption / Math.pow(1 + yf, N - 1 + frac) + den * Math.pow(1 + yf, 1 - N - frac) * (Math.pow(1 + yf, N) - 1) / yf - beg_settl / beg_end * den;\n    }\n    function PRICEDISC(settl, matur, discount, redemption, basis) {\n        var dsm = _daysBetween(settl, matur, basis), dy = daysInYear(unpackDate(matur).year, basis);\n        return redemption - discount * redemption * dsm / dy;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/borderpalette', [\n        'kendo.core',\n        'kendo.colorpicker',\n        'kendo.popup'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var BORDER_TYPES = [\n            'allBorders',\n            'insideBorders',\n            'insideHorizontalBorders',\n            'insideVerticalBorders',\n            'outsideBorders',\n            'leftBorder',\n            'topBorder',\n            'rightBorder',\n            'bottomBorder',\n            'noBorders'\n        ];\n        var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n            allBorders: 'All borders',\n            insideBorders: 'Inside borders',\n            insideHorizontalBorders: 'Inside horizontal borders',\n            insideVerticalBorders: 'Inside vertical borders',\n            outsideBorders: 'Outside borders',\n            leftBorder: 'Left border',\n            topBorder: 'Top border',\n            rightBorder: 'Right border',\n            bottomBorder: 'Bottom border',\n            noBorders: 'No border'\n        };\n        var COLOR_PICKER_MESSAGES = kendo.spreadsheet.messages.colorPicker = {\n            reset: 'Reset color',\n            customColor: 'Custom color...',\n            apply: 'Apply',\n            cancel: 'Cancel'\n        };\n        function withPreventDefault(f) {\n            return function (e) {\n                e.preventDefault();\n                return f.apply(this, arguments);\n            };\n        }\n        var ColorChooser = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = options.color;\n                this._resetButton();\n                this._colorPalette();\n                this._customColorPalette();\n                this._customColorButton();\n                this.resetButton.on('click', withPreventDefault(this.resetColor.bind(this)));\n                this.customColorButton.on('click', withPreventDefault(this.customColor.bind(this)));\n            },\n            options: { name: 'ColorChooser' },\n            events: ['change'],\n            destroy: function () {\n                kendo.unbind(this.dialog.element.find('.k-action-buttons'));\n                this.dialog.destroy();\n                this.colorPalette.destroy();\n                this.resetButton.off('click');\n                this.customColorButton.off('click');\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.color = value;\n                    this.customColorButton.find('.k-icon').css('background-color', this.color);\n                    this.colorPalette.value(null);\n                    this.flatColorPicker.value(this.color);\n                } else {\n                    return this.color;\n                }\n            },\n            _change: function (value) {\n                this.color = value;\n                this.trigger('change', { value: value });\n            },\n            _colorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-color-palette' });\n                var colorPalette = this.colorPalette = $('<div />').kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    value: this.color,\n                    change: function (e) {\n                        this.customColorButton.find('.k-icon').css('background-color', 'transparent');\n                        this.flatColorPicker.value(null);\n                        this._change(e.value);\n                    }.bind(this)\n                }).data('kendoColorPalette');\n                element.append(colorPalette.wrapper).appendTo(this.element);\n            },\n            _customColorPalette: function () {\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-window',\n                    'html': '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>' + COLOR_PICKER_MESSAGES.apply + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>' + COLOR_PICKER_MESSAGES.cancel + '</button>' + '</div>'\n                });\n                var dialog = this.dialog = element.appendTo(document.body).kendoWindow({\n                    animation: false,\n                    scrollable: false,\n                    resizable: false,\n                    maximizable: false,\n                    modal: true,\n                    visible: false,\n                    width: 268,\n                    open: function () {\n                        this.center();\n                    }\n                }).data('kendoWindow');\n                dialog.one('activate', function () {\n                    this.element.find('[data-role=flatcolorpicker]').data('kendoFlatColorPicker')._hueSlider.resize();\n                });\n                var flatColorPicker = this.flatColorPicker = dialog.element.children().first().kendoFlatColorPicker().data('kendoFlatColorPicker');\n                var viewModel = kendo.observable({\n                    apply: function () {\n                        this.customColorButton.find('.k-icon').css('background-color', flatColorPicker.value());\n                        this.colorPalette.value(null);\n                        this._change(flatColorPicker.value());\n                        dialog.close();\n                    }.bind(this),\n                    close: function () {\n                        flatColorPicker.value(null);\n                        dialog.close();\n                    }\n                });\n                kendo.bind(dialog.element.find('.k-action-buttons'), viewModel);\n            },\n            _resetButton: function () {\n                this.resetButton = $('<a class=\\'k-button k-reset-color\\' href=\\'#\\'>' + '<span class=\\'k-icon k-i-reset-color\\'></span>' + COLOR_PICKER_MESSAGES.reset + '</a>').appendTo(this.element);\n            },\n            _customColorButton: function () {\n                this.customColorButton = $('<a class=\\'k-button k-custom-color\\' href=\\'#\\'>' + '<span class=\\'k-icon\\'></span>' + COLOR_PICKER_MESSAGES.customColor + '</a>').appendTo(this.element);\n            },\n            resetColor: function () {\n                this.colorPalette.value(null);\n                this.flatColorPicker.value(null);\n                this._change(null);\n            },\n            customColor: function () {\n                this.dialog.open();\n            }\n        });\n        var BorderPalette = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                this.element = element;\n                this.color = '#000';\n                this.element.addClass('k-spreadsheet-border-palette');\n                this._borderTypePalette();\n                this._borderColorPalette();\n                this.element.on('click', '.k-spreadsheet-border-type-palette .k-button', withPreventDefault(this._click.bind(this)));\n            },\n            options: { name: 'BorderPalette' },\n            events: ['change'],\n            destroy: function () {\n                this.colorChooser.destroy();\n                this.element.off('click');\n            },\n            _borderTypePalette: function () {\n                var messages = BORDER_PALETTE_MESSAGES;\n                var buttons = BORDER_TYPES.map(function (type) {\n                    return '<a title=\"' + messages[type] + '\" aria-label=\"' + messages[type] + '\" href=\"#\" data-border-type=\"' + type + '\" class=\"k-button k-button-icon\">' + '<span class=\"k-icon k-i-' + kendo.toHyphens(type) + '\"></span>' + '</a>';\n                }).join('');\n                var element = $('<div />', {\n                    'class': 'k-spreadsheet-border-type-palette',\n                    'html': buttons\n                });\n                element.appendTo(this.element);\n            },\n            _borderColorPalette: function () {\n                var element = $('<div />', { 'class': 'k-spreadsheet-border-color-palette' });\n                element.appendTo(this.element);\n                this.colorChooser = new ColorChooser(element, {\n                    color: this.color,\n                    change: this._colorChange.bind(this)\n                });\n            },\n            _click: function (e) {\n                this.type = $(e.currentTarget).data('borderType');\n                this.trigger('change', {\n                    type: this.type,\n                    color: this.color\n                });\n            },\n            _colorChange: function (e) {\n                this.color = e.value;\n                if (this.type) {\n                    this.trigger('change', {\n                        type: this.type,\n                        color: this.color\n                    });\n                }\n            }\n        });\n        kendo.spreadsheet.ColorChooser = ColorChooser;\n        kendo.spreadsheet.BorderPalette = BorderPalette;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/toolbar', [\n        'kendo.toolbar',\n        'kendo.colorpicker',\n        'kendo.combobox',\n        'kendo.dropdownlist',\n        'kendo.popup',\n        'spreadsheet/borderpalette'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ToolBar = kendo.ui.ToolBar;\n        var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n            addColumnLeft: 'Add column left',\n            addColumnRight: 'Add column right',\n            addRowAbove: 'Add row above',\n            addRowBelow: 'Add row below',\n            alignment: 'Alignment',\n            alignmentButtons: {\n                justtifyLeft: 'Align left',\n                justifyCenter: 'Center',\n                justifyRight: 'Align right',\n                justifyFull: 'Justify',\n                alignTop: 'Align top',\n                alignMiddle: 'Align middle',\n                alignBottom: 'Align bottom'\n            },\n            backgroundColor: 'Background',\n            bold: 'Bold',\n            borders: 'Borders',\n            copy: 'Copy',\n            cut: 'Cut',\n            deleteColumn: 'Delete column',\n            deleteRow: 'Delete row',\n            filter: 'Filter',\n            fontFamily: 'Font',\n            fontSize: 'Font size',\n            format: 'Custom format...',\n            formatTypes: {\n                automatic: 'Automatic',\n                text: 'Text',\n                number: 'Number',\n                percent: 'Percent',\n                financial: 'Financial',\n                currency: 'Currency',\n                date: 'Date',\n                time: 'Time',\n                dateTime: 'Date time',\n                duration: 'Duration',\n                moreFormats: 'More formats...'\n            },\n            formatDecreaseDecimal: 'Decrease decimal',\n            formatIncreaseDecimal: 'Increase decimal',\n            freeze: 'Freeze panes',\n            freezeButtons: {\n                freezePanes: 'Freeze panes',\n                freezeRows: 'Freeze rows',\n                freezeColumns: 'Freeze columns',\n                unfreeze: 'Unfreeze panes'\n            },\n            italic: 'Italic',\n            merge: 'Merge cells',\n            mergeButtons: {\n                mergeCells: 'Merge all',\n                mergeHorizontally: 'Merge horizontally',\n                mergeVertically: 'Merge vertically',\n                unmerge: 'Unmerge'\n            },\n            open: 'Open...',\n            paste: 'Paste',\n            quickAccess: {\n                redo: 'Redo',\n                undo: 'Undo'\n            },\n            exportAs: 'Export...',\n            toggleGridlines: 'Toggle gridlines',\n            sort: 'Sort',\n            sortButtons: {\n                sortRangeAsc: 'Sort range A to Z',\n                sortRangeDesc: 'Sort range Z to A'\n            },\n            textColor: 'Text Color',\n            textWrap: 'Wrap text',\n            underline: 'Underline',\n            validation: 'Data validation...',\n            hyperlink: 'Link'\n        };\n        var defaultTools = {\n            home: [\n                'open',\n                'exportAs',\n                [\n                    'cut',\n                    'copy',\n                    'paste'\n                ],\n                [\n                    'bold',\n                    'italic',\n                    'underline'\n                ],\n                'hyperlink',\n                'backgroundColor',\n                'textColor',\n                'borders',\n                'fontSize',\n                'fontFamily',\n                'alignment',\n                'textWrap',\n                [\n                    'formatDecreaseDecimal',\n                    'formatIncreaseDecimal'\n                ],\n                'format',\n                'merge',\n                'freeze',\n                'filter',\n                'toggleGridlines'\n            ],\n            insert: [\n                [\n                    'addColumnLeft',\n                    'addColumnRight',\n                    'addRowBelow',\n                    'addRowAbove'\n                ],\n                [\n                    'deleteColumn',\n                    'deleteRow'\n                ]\n            ],\n            data: [\n                'sort',\n                'filter',\n                'validation'\n            ]\n        };\n        var toolDefaults = {\n            open: {\n                type: 'open',\n                overflow: 'never',\n                iconClass: 'file-excel'\n            },\n            exportAs: {\n                type: 'exportAsDialog',\n                dialogName: 'exportAs',\n                overflow: 'never',\n                text: '',\n                iconClass: 'file-excel'\n            },\n            bold: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'bold',\n                value: true,\n                iconClass: 'bold',\n                togglable: true\n            },\n            italic: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'italic',\n                value: true,\n                iconClass: 'italic',\n                togglable: true\n            },\n            underline: {\n                type: 'button',\n                command: 'PropertyChangeCommand',\n                property: 'underline',\n                value: true,\n                iconClass: 'underline',\n                togglable: true\n            },\n            formatDecreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: -1,\n                iconClass: 'decimal-decrease'\n            },\n            formatIncreaseDecimal: {\n                type: 'button',\n                command: 'AdjustDecimalsCommand',\n                value: +1,\n                iconClass: 'decimal-increase'\n            },\n            textWrap: {\n                type: 'button',\n                command: 'TextWrapCommand',\n                property: 'wrap',\n                value: true,\n                iconClass: 'text-wrap',\n                togglable: true\n            },\n            cut: {\n                type: 'button',\n                command: 'ToolbarCutCommand',\n                iconClass: 'cut'\n            },\n            copy: {\n                type: 'button',\n                command: 'ToolbarCopyCommand',\n                iconClass: 'copy'\n            },\n            paste: {\n                type: 'button',\n                command: 'ToolbarPasteCommand',\n                iconClass: 'paste'\n            },\n            separator: { type: 'separator' },\n            alignment: {\n                type: 'alignment',\n                iconClass: 'align-left'\n            },\n            backgroundColor: {\n                type: 'colorPicker',\n                property: 'background',\n                iconClass: 'paint'\n            },\n            textColor: {\n                type: 'colorPicker',\n                property: 'color',\n                iconClass: 'foreground-color'\n            },\n            fontFamily: {\n                type: 'fontFamily',\n                property: 'fontFamily',\n                iconClass: 'font-family'\n            },\n            fontSize: {\n                type: 'fontSize',\n                property: 'fontSize',\n                iconClass: 'font-size'\n            },\n            format: {\n                type: 'format',\n                property: 'format',\n                iconClass: 'custom-format'\n            },\n            filter: {\n                type: 'filter',\n                property: 'hasFilter',\n                iconClass: 'filter'\n            },\n            merge: {\n                type: 'merge',\n                iconClass: 'cells-merge'\n            },\n            freeze: {\n                type: 'freeze',\n                iconClass: 'pane-freeze'\n            },\n            borders: {\n                type: 'borders',\n                iconClass: 'borders-all'\n            },\n            formatCells: {\n                type: 'dialog',\n                dialogName: 'formatCells',\n                overflow: 'never'\n            },\n            hyperlink: {\n                type: 'dialog',\n                dialogName: 'hyperlink',\n                iconClass: 'link-horizontal',\n                overflow: 'never',\n                text: ''\n            },\n            toggleGridlines: {\n                type: 'button',\n                command: 'GridLinesChangeCommand',\n                property: 'gridLines',\n                value: true,\n                iconClass: 'border-no',\n                togglable: true\n            },\n            addColumnLeft: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'left',\n                iconClass: 'table-column-insert-left'\n            },\n            addColumnRight: {\n                type: 'button',\n                command: 'AddColumnCommand',\n                value: 'right',\n                iconClass: 'table-column-insert-right'\n            },\n            addRowBelow: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'below',\n                iconClass: 'table-row-insert-below'\n            },\n            addRowAbove: {\n                type: 'button',\n                command: 'AddRowCommand',\n                value: 'above',\n                iconClass: 'table-row-insert-above'\n            },\n            deleteColumn: {\n                type: 'button',\n                command: 'DeleteColumnCommand',\n                iconClass: 'table-column-delete'\n            },\n            deleteRow: {\n                type: 'button',\n                command: 'DeleteRowCommand',\n                iconClass: 'table-row-delete'\n            },\n            sort: {\n                type: 'sort',\n                iconClass: 'sort-desc'\n            },\n            validation: {\n                type: 'dialog',\n                dialogName: 'validation',\n                iconClass: 'exception',\n                overflow: 'never'\n            }\n        };\n        var SpreadsheetToolBar = ToolBar.extend({\n            init: function (element, options) {\n                options.items = this._expandTools(options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName]);\n                ToolBar.fn.init.call(this, element, options);\n                var handleClick = this._click.bind(this);\n                this.element.addClass('k-spreadsheet-toolbar');\n                this._addSeparators(this.element);\n                var that = this;\n                this.element.on('keydown', function (e) {\n                    var tool;\n                    if (e.keyCode === 9) {\n                        tool = that._nextTool(e.shiftKey ? -1 : 1);\n                        if (tool) {\n                            document.activeElement.blur();\n                            if ($(tool).is('.k-upload-button')) {\n                                $(tool).addClass('k-state-focused');\n                            }\n                            if ($(tool).find('input').length) {\n                                $(tool).find('input').focus();\n                            } else {\n                                tool.focus();\n                            }\n                            e.preventDefault();\n                        }\n                    }\n                });\n                this.element.on('focusout', function () {\n                    $(this).find('.k-toolbar-first-visible').removeClass('k-state-focused');\n                });\n                this.bind({\n                    click: handleClick,\n                    toggle: handleClick\n                });\n            },\n            _nextTool: function (direction) {\n                var that = this;\n                var tools = that.element.find('.k-widget, .k-button, .k-button-group > a');\n                var activeIndex = tools.index(document.activeElement.closest('.k-widget, .k-button, .k-button-group > a'));\n                if (activeIndex > 0) {\n                    return tools[activeIndex + direction];\n                }\n            },\n            _addSeparators: function (element) {\n                var groups = element.children('.k-widget, a.k-button, .k-button-group');\n                groups.before('<span class=\\'k-separator\\' />');\n            },\n            _expandTools: function (tools) {\n                function expandTool(toolName) {\n                    var options = $.isPlainObject(toolName) ? toolName : toolDefaults[toolName] || {};\n                    var spriteCssClass = 'k-icon k-i-' + options.iconClass;\n                    var type = options.type;\n                    var typeDefaults = {\n                        button: { showText: 'overflow' },\n                        colorPicker: {\n                            toolIcon: spriteCssClass,\n                            spriteCssClass: spriteCssClass\n                        },\n                        borders: { spriteCssClass: spriteCssClass },\n                        alignment: { spriteCssClass: spriteCssClass },\n                        merge: { spriteCssClass: spriteCssClass },\n                        freeze: { spriteCssClass: spriteCssClass }\n                    };\n                    var tool = $.extend({\n                        name: options.name || toolName,\n                        text: MESSAGES[options.name || toolName],\n                        icon: options.iconClass,\n                        attributes: {\n                            title: MESSAGES[options.name || toolName],\n                            'aria-label': MESSAGES[options.name || toolName]\n                        }\n                    }, typeDefaults[type], options);\n                    if (type == 'splitButton') {\n                        tool.menuButtons = tool.menuButtons.map(expandTool);\n                    }\n                    tool.attributes['data-tool'] = toolName;\n                    if (options.property) {\n                        tool.attributes['data-property'] = options.property;\n                    }\n                    return tool;\n                }\n                return tools.reduce(function (tools, tool) {\n                    if ($.isArray(tool)) {\n                        tools.push({\n                            type: 'buttonGroup',\n                            buttons: tool.map(expandTool)\n                        });\n                    } else {\n                        tools.push(expandTool.call(this, tool));\n                    }\n                    return tools;\n                }, []);\n            },\n            _click: function (e) {\n                var toolName = e.target.attr('data-tool');\n                var tool = toolDefaults[toolName] || {};\n                var commandType = tool.command;\n                if (!commandType) {\n                    return;\n                }\n                var args = {\n                    command: commandType,\n                    options: {\n                        property: tool.property || null,\n                        value: tool.value || null\n                    }\n                };\n                if (typeof args.options.value === 'boolean') {\n                    args.options.value = e.checked ? true : null;\n                }\n                this.action(args);\n            },\n            events: [\n                'click',\n                'toggle',\n                'open',\n                'close',\n                'overflowOpen',\n                'overflowClose',\n                'action',\n                'dialog'\n            ],\n            options: {\n                name: 'SpreadsheetToolBar',\n                resizable: true,\n                tools: defaultTools\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refresh: function (activeCell) {\n                var range = activeCell;\n                var tools = this._tools();\n                function setToggle(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    var togglable = toolbar && toolbar.options.togglable || overflow && overflow.options.togglable;\n                    if (!togglable) {\n                        return;\n                    }\n                    var toggle = false;\n                    if (typeof value === 'boolean') {\n                        toggle = value;\n                    } else if (typeof value === 'string') {\n                        toggle = toolbar.options.value === value;\n                    }\n                    toolbar.toggle(toggle);\n                    if (overflow) {\n                        overflow.toggle(toggle);\n                    }\n                }\n                function update(tool, value) {\n                    var toolbar = tool.toolbar;\n                    var overflow = tool.overflow;\n                    if (toolbar && toolbar.update) {\n                        toolbar.update(value);\n                    }\n                    if (overflow && overflow.update) {\n                        overflow.update(value);\n                    }\n                }\n                for (var i = 0; i < tools.length; i++) {\n                    var property = tools[i].property;\n                    var tool = tools[i].tool;\n                    var value = kendo.isFunction(range[property]) ? range[property]() : range;\n                    if (property == 'gridLines') {\n                        value = range.sheet().showGridLines();\n                    }\n                    if (tool.type === 'button') {\n                        setToggle(tool, value);\n                    } else {\n                        update(tool, value);\n                    }\n                }\n                this.resize();\n            },\n            _tools: function () {\n                return this.element.find('[data-property]').toArray().map(function (element) {\n                    element = $(element);\n                    return {\n                        property: element.attr('data-property'),\n                        tool: this._getItem(element)\n                    };\n                }.bind(this));\n            },\n            destroy: function () {\n                this.element.find('[data-command],.k-button').each(function () {\n                    var element = $(this);\n                    var instance = element.data('instance');\n                    if (instance && instance.destroy) {\n                        instance.destroy();\n                    }\n                });\n                ToolBar.fn.destroy.call(this);\n            }\n        });\n        kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n        var DropDownTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var dropDownList = $('<select />').attr('title', options.attributes.title).attr('aria-label', options.attributes.title).kendoDropDownList({ height: 'auto' }).data('kendoDropDownList');\n                this.dropDownList = dropDownList;\n                this.element = dropDownList.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                dropDownList.bind('open', this._open.bind(this));\n                dropDownList.bind('change', this._change.bind(this));\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n            },\n            _open: function () {\n                var ddl = this.dropDownList;\n                var list = ddl.list;\n                var listWidth;\n                list.css({\n                    whiteSpace: 'nowrap',\n                    width: 'auto'\n                });\n                listWidth = list.width();\n                if (listWidth) {\n                    listWidth += 20;\n                } else {\n                    listWidth = ddl._listWidth;\n                }\n                list.css('width', listWidth + kendo.support.scrollbar());\n                ddl._listWidth = listWidth;\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var value = instance.value();\n                var dataItem = instance.dataItem();\n                var popupName = dataItem ? dataItem.popup : undefined;\n                if (popupName) {\n                    this.toolbar.dialog({ name: popupName });\n                } else {\n                    this.toolbar.action({\n                        command: 'PropertyChangeCommand',\n                        options: {\n                            property: this.options.property,\n                            value: value == 'null' ? null : value\n                        }\n                    });\n                }\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.dropDownList.value(value);\n                } else {\n                    return this.dropDownList.value();\n                }\n            }\n        });\n        var PopupTool = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.element = $('<a href=\\'#\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'' + options.spriteCssClass + '\\'>' + '</span><span class=\\'k-icon k-i-arrow-60-down\\'></span>' + '</a>');\n                this.element.on('click touchend', this.open.bind(this)).attr('data-command', options.command);\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this._popup();\n            },\n            destroy: function () {\n                this.popup.destroy();\n            },\n            open: function (ev) {\n                ev.preventDefault();\n                this.popup.toggle();\n            },\n            _popup: function () {\n                var element = this.element;\n                this.popup = $('<div class=\\'k-spreadsheet-popup\\' />').appendTo(element).kendoPopup({ anchor: element }).data('kendoPopup');\n            }\n        });\n        kendo.toolbar.registerComponent('dialog', kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this._dialogName = options.dialogName;\n                this.element.bind('click touchend', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        kendo.toolbar.registerComponent('exportAsDialog', kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this._dialogName = options.dialogName;\n                this.toolbar = toolbar;\n                this._title = options.attributes.title;\n                this.element = $('<button class=\\'k-button k-button-icon\\'>' + '<span class=\\'k-icon k-i-download\\' />' + '</button>').attr('title', this._title).attr('aria-label', this._title).data('instance', this);\n                this.element.bind('click', this.open.bind(this)).data('instance', this);\n            },\n            open: function () {\n                this.toolbar.dialog({ name: this._dialogName });\n            }\n        }));\n        var OverflowDialogButton = kendo.toolbar.OverflowButton.extend({\n            init: function (options, toolbar) {\n                kendo.toolbar.OverflowButton.fn.init.call(this, options, toolbar);\n                this.element.on('click touchend', this._click.bind(this));\n                this.message = this.options.text;\n                var instance = this.element.data('button');\n                this.element.data(this.options.type, instance);\n            },\n            _click: $.noop\n        });\n        var ColorPicker = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.popup.element.addClass('k-spreadsheet-colorpicker');\n                this.colorChooser = new kendo.spreadsheet.ColorChooser(this.popup.element, { change: this._colorChange.bind(this) });\n                this.element.attr({ 'data-property': options.property });\n                this.element.data({\n                    type: 'colorPicker',\n                    colorPicker: this,\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.colorChooser.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (value) {\n                this.value(value);\n            },\n            value: function (value) {\n                this.colorChooser.value(value);\n            },\n            _colorChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: e.sender.value()\n                    }\n                });\n                this.popup.close();\n            }\n        });\n        var ColorPickerButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                options.iconName = 'text';\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n            },\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'colorPicker',\n                    options: {\n                        title: this.options.property,\n                        property: this.options.property\n                    }\n                });\n            }\n        });\n        kendo.toolbar.registerComponent('colorPicker', ColorPicker, ColorPickerButton);\n        var FONT_SIZES = [\n            8,\n            9,\n            10,\n            11,\n            12,\n            13,\n            14,\n            16,\n            18,\n            20,\n            22,\n            24,\n            26,\n            28,\n            36,\n            48,\n            72\n        ];\n        var DEFAULT_FONT_SIZE = 12;\n        var FontSize = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                var comboBox = $('<input />').attr('aria-label', options.attributes.title).kendoComboBox({\n                    change: this._valueChange.bind(this),\n                    clearButton: false,\n                    dataSource: options.fontSizes || FONT_SIZES,\n                    value: DEFAULT_FONT_SIZE\n                }).data('kendoComboBox');\n                this.comboBox = comboBox;\n                this.element = comboBox.wrapper;\n                this.options = options;\n                this.toolbar = toolbar;\n                this.attributes();\n                this.addUidAttr();\n                this.addOverflowAttr();\n                this.element.width(options.width).attr({\n                    'data-command': 'PropertyChangeCommand',\n                    'data-property': options.property\n                });\n                this.element.data({\n                    type: 'fontSize',\n                    fontSize: this\n                });\n            },\n            _valueChange: function (e) {\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.options.property,\n                        value: kendo.parseInt(e.sender.value())\n                    }\n                });\n            },\n            update: function (value) {\n                this.value(kendo.parseInt(value) || DEFAULT_FONT_SIZE);\n            },\n            value: function (value) {\n                if (value !== undefined) {\n                    this.comboBox.value(value);\n                } else {\n                    return this.comboBox.value();\n                }\n            }\n        });\n        var FontSizeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontSize',\n                    options: {\n                        sizes: FONT_SIZES,\n                        defaultSize: DEFAULT_FONT_SIZE\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_SIZE;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontSize', FontSize, FontSizeButton);\n        var FONT_FAMILIES = [\n            'Arial',\n            'Courier New',\n            'Georgia',\n            'Times New Roman',\n            'Trebuchet MS',\n            'Verdana'\n        ];\n        var DEFAULT_FONT_FAMILY = 'Arial';\n        var FontFamily = DropDownTool.extend({\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.setDataSource(options.fontFamilies || FONT_FAMILIES);\n                ddl.value(DEFAULT_FONT_FAMILY);\n                this.element.data({\n                    type: 'fontFamily',\n                    fontFamily: this\n                });\n            },\n            update: function (value) {\n                this.value(value || DEFAULT_FONT_FAMILY);\n            }\n        });\n        var FontFamilyButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({\n                    name: 'fontFamily',\n                    options: {\n                        fonts: FONT_FAMILIES,\n                        defaultFont: DEFAULT_FONT_FAMILY\n                    }\n                });\n            },\n            update: function (value) {\n                this._value = value || DEFAULT_FONT_FAMILY;\n                this.element.find('.k-text').text(this.message + ' (' + this._value + ') ...');\n            }\n        });\n        kendo.toolbar.registerComponent('fontFamily', FontFamily, FontFamilyButton);\n        var defaultFormats = kendo.spreadsheet.formats = {\n            automatic: null,\n            text: '@',\n            number: '#,0.00',\n            percent: '0.00%',\n            financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n            currency: '$#,##0.00;[Red]$#,##0.00',\n            date: 'm/d/yyyy',\n            time: 'h:mm:ss AM/PM',\n            dateTime: 'm/d/yyyy h:mm',\n            duration: '[h]:mm:ss'\n        };\n        var Format = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                var icon = '<span class=\\'k-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>';\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    dataValueField: 'format',\n                    dataTextField: 'name',\n                    dataValuePrimitive: true,\n                    valueTemplate: icon,\n                    template: '# if (data.sample) { #' + '<span class=\\'k-spreadsheet-sample\\'>#: data.sample #</span>' + '# } #' + '#: data.name #'\n                });\n                ddl.text(icon);\n                ddl.setDataSource([\n                    {\n                        format: defaultFormats.automatic,\n                        name: MESSAGES.formatTypes.automatic\n                    },\n                    {\n                        format: defaultFormats.text,\n                        name: MESSAGES.formatTypes.text\n                    },\n                    {\n                        format: defaultFormats.number,\n                        name: MESSAGES.formatTypes.number,\n                        sample: '1,499.99'\n                    },\n                    {\n                        format: defaultFormats.percent,\n                        name: MESSAGES.formatTypes.percent,\n                        sample: '14.50%'\n                    },\n                    {\n                        format: defaultFormats.financial,\n                        name: MESSAGES.formatTypes.financial,\n                        sample: '(1,000.12)'\n                    },\n                    {\n                        format: defaultFormats.currency,\n                        name: MESSAGES.formatTypes.currency,\n                        sample: '$1,499.99'\n                    },\n                    {\n                        format: defaultFormats.date,\n                        name: MESSAGES.formatTypes.date,\n                        sample: '4/21/2012'\n                    },\n                    {\n                        format: defaultFormats.time,\n                        name: MESSAGES.formatTypes.time,\n                        sample: '5:49:00 PM'\n                    },\n                    {\n                        format: defaultFormats.dateTime,\n                        name: MESSAGES.formatTypes.dateTime,\n                        sample: '4/21/2012 5:49:00'\n                    },\n                    {\n                        format: defaultFormats.duration,\n                        name: MESSAGES.formatTypes.duration,\n                        sample: '168:05:00'\n                    },\n                    {\n                        popup: 'formatCells',\n                        name: MESSAGES.formatTypes.moreFormats\n                    }\n                ]);\n                this.element.data({\n                    type: 'format',\n                    format: this\n                });\n            }\n        });\n        var FormatButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'formatCells' });\n            }\n        });\n        kendo.toolbar.registerComponent('format', Format, FormatButton);\n        var BorderChangeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._borderPalette();\n                this.element.data({\n                    type: 'borders',\n                    instance: this\n                });\n            },\n            destroy: function () {\n                this.borderPalette.destroy();\n                PopupTool.fn.destroy.call(this);\n            },\n            _borderPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this._action.bind(this) });\n            },\n            _action: function (e) {\n                this.toolbar.action({\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: e.type,\n                        style: {\n                            size: 1,\n                            color: e.color\n                        }\n                    }\n                });\n            }\n        });\n        var BorderChangeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'borders' });\n            }\n        });\n        kendo.toolbar.registerComponent('borders', BorderChangeTool, BorderChangeButton);\n        var AlignmentTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this.element.attr({ 'data-property': 'alignment' });\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'alignment',\n                    alignment: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function () {\n                this.buttons = [\n                    {\n                        property: 'textAlign',\n                        value: 'left',\n                        iconClass: 'align-left',\n                        text: MESSAGES.alignmentButtons.justtifyLeft\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'center',\n                        iconClass: 'align-center',\n                        text: MESSAGES.alignmentButtons.justifyCenter\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'right',\n                        iconClass: 'align-right',\n                        text: MESSAGES.alignmentButtons.justifyRight\n                    },\n                    {\n                        property: 'textAlign',\n                        value: 'justify',\n                        iconClass: 'align-justify',\n                        text: MESSAGES.alignmentButtons.justifyFull\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'top',\n                        iconClass: 'align-top',\n                        text: MESSAGES.alignmentButtons.alignTop\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'center',\n                        iconClass: 'align-middle',\n                        text: MESSAGES.alignmentButtons.alignMiddle\n                    },\n                    {\n                        property: 'verticalAlign',\n                        value: 'bottom',\n                        iconClass: 'align-bottom',\n                        text: MESSAGES.alignmentButtons.alignBottom\n                    }\n                ];\n            },\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            update: function (range) {\n                var textAlign = range.textAlign();\n                var verticalAlign = range.verticalAlign();\n                var element = this.popup.element;\n                element.find('.k-button').removeClass('k-state-active');\n                if (textAlign) {\n                    element.find('[data-property=textAlign][data-value=' + textAlign + ']').addClass('k-state-active');\n                }\n                if (verticalAlign) {\n                    element.find('[data-property=verticalAlign][data-value=' + verticalAlign + ']').addClass('k-state-active');\n                }\n            },\n            _commandPalette: function () {\n                var buttons = this.buttons;\n                var element = $('<div />').appendTo(this.popup.element);\n                buttons.forEach(function (options, index) {\n                    var button = '<a title=\\'' + options.text + '\\' data-property=\\'' + options.property + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icon\\'>' + '<span class=\\'k-icon k-i-' + options.iconClass + '\\'></span>' + '</a>';\n                    if (index !== 0 && buttons[index - 1].property !== options.property) {\n                        element.append($('<span class=\\'k-separator\\' />'));\n                    }\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var property = button.attr('data-property');\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: property,\n                        value: value\n                    }\n                });\n            }\n        });\n        var AlignmentButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'alignment' });\n            }\n        });\n        kendo.toolbar.registerComponent('alignment', AlignmentTool, AlignmentButton);\n        var MergeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'merge',\n                    merge: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function () {\n                this.buttons = [\n                    {\n                        value: 'cells',\n                        iconClass: 'cells-merge',\n                        text: MESSAGES.mergeButtons.mergeCells\n                    },\n                    {\n                        value: 'horizontally',\n                        iconClass: 'cells-merge-horizontally',\n                        text: MESSAGES.mergeButtons.mergeHorizontally\n                    },\n                    {\n                        value: 'vertically',\n                        iconClass: 'cells-merge-vertically',\n                        text: MESSAGES.mergeButtons.mergeVertically\n                    },\n                    {\n                        value: 'unmerge',\n                        iconClass: 'table-unmerge',\n                        text: MESSAGES.mergeButtons.unmerge\n                    }\n                ];\n            },\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'MergeCellCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var MergeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'merge' });\n            }\n        });\n        kendo.toolbar.registerComponent('merge', MergeTool, MergeButton);\n        var FreezeTool = PopupTool.extend({\n            init: function (options, toolbar) {\n                PopupTool.fn.init.call(this, options, toolbar);\n                this._defineButtons();\n                this._commandPalette();\n                this.popup.element.on('click', '.k-button', function (e) {\n                    this._action($(e.currentTarget));\n                }.bind(this));\n                this.element.data({\n                    type: 'freeze',\n                    freeze: this,\n                    instance: this\n                });\n            },\n            _defineButtons: function () {\n                this.buttons = [\n                    {\n                        value: 'panes',\n                        iconClass: 'pane-freeze',\n                        text: MESSAGES.freezeButtons.freezePanes\n                    },\n                    {\n                        value: 'rows',\n                        iconClass: 'row-freeze',\n                        text: MESSAGES.freezeButtons.freezeRows\n                    },\n                    {\n                        value: 'columns',\n                        iconClass: 'column-freeze',\n                        text: MESSAGES.freezeButtons.freezeColumns\n                    },\n                    {\n                        value: 'unfreeze',\n                        iconClass: 'table-unmerge',\n                        text: MESSAGES.freezeButtons.unfreeze\n                    }\n                ];\n            },\n            destroy: function () {\n                this.popup.element.off();\n                PopupTool.fn.destroy.call(this);\n            },\n            _commandPalette: function () {\n                var element = $('<div />').appendTo(this.popup.element);\n                this.buttons.forEach(function (options) {\n                    var button = '<a title=\\'' + options.text + '\\' data-value=\\'' + options.value + '\\' class=\\'k-button k-button-icontext\\'>' + '<span class=\\'k-icon k-i-' + options.iconClass + '\\'></span>' + options.text + '</a>';\n                    element.append(button);\n                });\n            },\n            _action: function (button) {\n                var value = button.attr('data-value');\n                this.toolbar.action({\n                    command: 'FreezePanesCommand',\n                    options: { value: value }\n                });\n            }\n        });\n        var FreezeButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'freeze' });\n            }\n        });\n        kendo.toolbar.registerComponent('freeze', FreezeTool, FreezeButton);\n        var Sort = DropDownTool.extend({\n            _revertTitle: function (e) {\n                e.sender.value('');\n                e.sender.wrapper.width('auto');\n            },\n            init: function (options, toolbar) {\n                DropDownTool.fn.init.call(this, options, toolbar);\n                var ddl = this.dropDownList;\n                ddl.bind('change', this._revertTitle.bind(this));\n                ddl.bind('dataBound', this._revertTitle.bind(this));\n                ddl.setOptions({\n                    valueTemplate: '<span class=\\'k-icon k-i-' + options.iconClass + '\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>',\n                    template: '<span class=\\'k-icon k-i-#= iconClass #\\' style=\\'line-height: 1em; width: 1.35em;\\'></span>#=text#',\n                    dataTextField: 'text',\n                    dataValueField: 'value'\n                });\n                ddl.setDataSource([\n                    {\n                        value: 'asc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeAsc,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        value: 'desc',\n                        sheet: false,\n                        text: MESSAGES.sortButtons.sortRangeDesc,\n                        iconClass: 'sort-desc'\n                    }\n                ]);\n                ddl.select(0);\n                this.element.data({\n                    type: 'sort',\n                    sort: this\n                });\n            },\n            _change: function (e) {\n                var instance = e.sender;\n                var dataItem = instance.dataItem();\n                if (dataItem) {\n                    this.toolbar.action({\n                        command: 'SortCommand',\n                        options: {\n                            value: dataItem.value,\n                            sheet: dataItem.sheet\n                        }\n                    });\n                }\n            },\n            value: $.noop\n        });\n        var SortButton = OverflowDialogButton.extend({\n            _click: function () {\n                this.toolbar.dialog({ name: 'sort' });\n            }\n        });\n        kendo.toolbar.registerComponent('sort', Sort, SortButton);\n        var Filter = kendo.toolbar.ToolBarButton.extend({\n            init: function (options, toolbar) {\n                options.showText = 'overflow';\n                kendo.toolbar.ToolBarButton.fn.init.call(this, options, toolbar);\n                this.element.on('click', this._click.bind(this));\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        var FilterButton = OverflowDialogButton.extend({\n            init: function (options, toolbar) {\n                OverflowDialogButton.fn.init.call(this, options, toolbar);\n                this.element.data({\n                    type: 'filter',\n                    filter: this\n                });\n            },\n            _click: function () {\n                this.toolbar.action({ command: 'FilterCommand' });\n            },\n            update: function (value) {\n                this.toggle(value);\n            }\n        });\n        kendo.toolbar.registerComponent('filter', Filter, FilterButton);\n        var Open = kendo.toolbar.Item.extend({\n            init: function (options, toolbar) {\n                this.toolbar = toolbar;\n                this.element = $('<div class=\\'k-button k-upload-button k-button-icon\\'>' + '<span class=\\'k-icon k-i-folder-open\\' />' + '</div>').data('instance', this);\n                this._title = options.attributes.title;\n                this._reset();\n            },\n            _reset: function () {\n                this.element.remove('input');\n                $('<input type=\\'file\\' autocomplete=\\'off\\' accept=\\'.xlsx\\'/>').attr('title', this._title).attr('aria-label', this._title).one('change', this._change.bind(this)).appendTo(this.element);\n            },\n            _change: function (e) {\n                this.toolbar.action({\n                    command: 'OpenCommand',\n                    options: { file: e.target.files[0] }\n                });\n                this._reset();\n            }\n        });\n        kendo.toolbar.registerComponent('open', Open);\n        kendo.spreadsheet.TabStrip = kendo.ui.TabStrip.extend({\n            init: function (element, options) {\n                kendo.ui.TabStrip.fn.init.call(this, element, options);\n                element.addClass('k-spreadsheet-tabstrip');\n                this._quickAccessButtons();\n                this.toolbars = {};\n                var tabs = options.dataSource;\n                this.contentElements.each(function (idx, element) {\n                    this._toolbar($(element), tabs[idx].id, options.toolbarOptions[tabs[idx].id]);\n                }.bind(this));\n                this.one('activate', function () {\n                    this.toolbars[this.options.dataSource[0].id].resize();\n                });\n            },\n            events: kendo.ui.TabStrip.fn.events.concat([\n                'action',\n                'dialog'\n            ]),\n            destroy: function () {\n                this.quickAccessToolBar.off('click');\n                kendo.ui.TabStrip.fn.destroy.call(this);\n                for (var name in this.toolbars) {\n                    this.toolbars[name].destroy();\n                }\n            },\n            action: function (args) {\n                this.trigger('action', args);\n            },\n            dialog: function (args) {\n                this.trigger('dialog', args);\n            },\n            refreshTools: function (range) {\n                var toolbars = this.toolbars;\n                for (var name in toolbars) {\n                    if (toolbars.hasOwnProperty(name)) {\n                        toolbars[name].refresh(range);\n                    }\n                }\n            },\n            _quickAccessButtons: function () {\n                var buttons = [\n                    {\n                        title: MESSAGES.quickAccess.undo,\n                        iconClass: 'undo',\n                        action: 'undo'\n                    },\n                    {\n                        title: MESSAGES.quickAccess.redo,\n                        iconClass: 'redo',\n                        action: 'redo'\n                    }\n                ];\n                var buttonTemplate = kendo.template('<a href=\\'\\\\#\\' title=\\'#= title #\\' data-action=\\'#= action #\\' class=\\'k-button k-button-icon\\' aria-label=\\'#= title #\\'><span class=\\'k-icon k-i-#=iconClass#\\'></span></a>');\n                this.quickAccessToolBar = $('<div />', {\n                    'class': 'k-spreadsheet-quick-access-toolbar',\n                    'html': kendo.render(buttonTemplate, buttons)\n                }).insertBefore(this.wrapper);\n                this.quickAccessToolBar.on('click', '.k-button', function (e) {\n                    e.preventDefault();\n                    var action = $(e.currentTarget).attr('data-action');\n                    this.action({ action: action });\n                }.bind(this));\n                this.quickAccessAdjust();\n            },\n            quickAccessAdjust: function () {\n                this.tabGroup.css('padding-left', kendo._outerWidth(this.quickAccessToolBar));\n            },\n            _toolbar: function (container, name, tools) {\n                var element;\n                var options;\n                if (this.toolbars[name]) {\n                    this.toolbars[name].destroy();\n                    container.children('.k-toolbar').remove();\n                }\n                if (tools) {\n                    element = container.html('<div />').children('div');\n                    options = {\n                        tools: typeof tools === 'boolean' ? undefined : tools,\n                        toolbarName: name,\n                        action: this.action.bind(this),\n                        dialog: this.dialog.bind(this)\n                    };\n                    this.toolbars[name] = new kendo.spreadsheet.ToolBar(element, options);\n                }\n            }\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/dialogs', [\n        'kendo.core',\n        'kendo.binder',\n        'kendo.validator'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var ObservableObject = kendo.data.ObservableObject;\n        var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n            apply: 'Apply',\n            save: 'Save',\n            cancel: 'Cancel',\n            remove: 'Remove',\n            retry: 'Retry',\n            revert: 'Revert',\n            okText: 'OK',\n            formatCellsDialog: {\n                title: 'Format',\n                categories: {\n                    number: 'Number',\n                    currency: 'Currency',\n                    date: 'Date'\n                }\n            },\n            fontFamilyDialog: { title: 'Font' },\n            fontSizeDialog: { title: 'Font size' },\n            bordersDialog: { title: 'Borders' },\n            alignmentDialog: {\n                title: 'Alignment',\n                buttons: {\n                    justtifyLeft: 'Align left',\n                    justifyCenter: 'Center',\n                    justifyRight: 'Align right',\n                    justifyFull: 'Justify',\n                    alignTop: 'Align top',\n                    alignMiddle: 'Align middle',\n                    alignBottom: 'Align bottom'\n                }\n            },\n            mergeDialog: {\n                title: 'Merge cells',\n                buttons: {\n                    mergeCells: 'Merge all',\n                    mergeHorizontally: 'Merge horizontally',\n                    mergeVertically: 'Merge vertically',\n                    unmerge: 'Unmerge'\n                }\n            },\n            freezeDialog: {\n                title: 'Freeze panes',\n                buttons: {\n                    freezePanes: 'Freeze panes',\n                    freezeRows: 'Freeze rows',\n                    freezeColumns: 'Freeze columns',\n                    unfreeze: 'Unfreeze panes'\n                }\n            },\n            confirmationDialog: {\n                text: 'Are you sure you want to remove this sheet?',\n                title: 'Sheet remove'\n            },\n            validationDialog: {\n                title: 'Data Validation',\n                hintMessage: 'Please enter a valid {0} value {1}.',\n                hintTitle: 'Validation {0}',\n                criteria: {\n                    any: 'Any value',\n                    number: 'Number',\n                    text: 'Text',\n                    date: 'Date',\n                    custom: 'Custom Formula',\n                    list: 'List'\n                },\n                comparers: {\n                    greaterThan: 'greater than',\n                    lessThan: 'less than',\n                    between: 'between',\n                    notBetween: 'not between',\n                    equalTo: 'equal to',\n                    notEqualTo: 'not equal to',\n                    greaterThanOrEqualTo: 'greater than or equal to',\n                    lessThanOrEqualTo: 'less than or equal to'\n                },\n                comparerMessages: {\n                    greaterThan: 'greater than {0}',\n                    lessThan: 'less than {0}',\n                    between: 'between {0} and {1}',\n                    notBetween: 'not between {0} and {1}',\n                    equalTo: 'equal to {0}',\n                    notEqualTo: 'not equal to {0}',\n                    greaterThanOrEqualTo: 'greater than or equal to {0}',\n                    lessThanOrEqualTo: 'less than or equal to {0}',\n                    custom: 'that satisfies the formula: {0}'\n                },\n                labels: {\n                    criteria: 'Criteria',\n                    comparer: 'Comparer',\n                    min: 'Min',\n                    max: 'Max',\n                    value: 'Value',\n                    start: 'Start',\n                    end: 'End',\n                    onInvalidData: 'On invalid data',\n                    rejectInput: 'Reject input',\n                    showWarning: 'Show warning',\n                    showHint: 'Show hint',\n                    hintTitle: 'Hint title',\n                    hintMessage: 'Hint message',\n                    ignoreBlank: 'Ignore blank',\n                    showListButton: 'Display button to show list',\n                    showCalendarButton: 'Display button to show calendar'\n                },\n                placeholders: {\n                    typeTitle: 'Type title',\n                    typeMessage: 'Type message'\n                }\n            },\n            exportAsDialog: {\n                title: 'Export...',\n                labels: {\n                    scale: 'Scale',\n                    fit: 'Fit to page',\n                    fileName: 'File name',\n                    saveAsType: 'Save as type',\n                    exportArea: 'Export',\n                    paperSize: 'Paper size',\n                    margins: 'Margins',\n                    orientation: 'Orientation',\n                    print: 'Print',\n                    guidelines: 'Guidelines',\n                    center: 'Center',\n                    horizontally: 'Horizontally',\n                    vertically: 'Vertically'\n                }\n            },\n            modifyMergedDialog: { errorMessage: 'Cannot change part of a merged cell.' },\n            rangeDisabledDialog: { errorMessage: 'Destination range contains disabled cells.' },\n            incompatibleRangesDialog: { errorMessage: 'Incompatible ranges' },\n            noFillDirectionDialog: { errorMessage: 'Cannot determine fill direction' },\n            duplicateSheetNameDialog: { errorMessage: 'Duplicate sheet name' },\n            overflowDialog: { errorMessage: 'Cannot paste, because the copy area and the paste area are not the same size and shape.' },\n            useKeyboardDialog: {\n                title: 'Copying and pasting',\n                errorMessage: 'These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:',\n                labels: {\n                    forCopy: 'for copy',\n                    forCut: 'for cut',\n                    forPaste: 'for paste'\n                }\n            },\n            unsupportedSelectionDialog: { errorMessage: 'That action cannot be performed on multiple selection.' },\n            linkDialog: {\n                title: 'Hyperlink',\n                labels: {\n                    text: 'Text',\n                    url: 'Address',\n                    removeLink: 'Remove link'\n                }\n            }\n        };\n        var registry = {};\n        kendo.spreadsheet.dialogs = {\n            register: function (name, dialogClass) {\n                registry[name] = dialogClass;\n            },\n            registered: function (name) {\n                return !!registry[name];\n            },\n            create: function (name, options) {\n                var dialogClass = registry[name];\n                if (dialogClass) {\n                    return new dialogClass(options);\n                }\n            }\n        };\n        var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n            init: function (options) {\n                kendo.Observable.fn.init.call(this, options);\n                this.options = $.extend(true, {}, this.options, options);\n                this.bind(this.events, options);\n            },\n            events: [\n                'close',\n                'activate'\n            ],\n            options: { autoFocus: true },\n            dialog: function () {\n                if (!this._dialog) {\n                    this._dialog = $('<div class=\\'k-spreadsheet-window k-action-window k-popup-edit-form\\' />').addClass(this.options.className || '').append(kendo.template(this.options.template)({\n                        messages: kendo.spreadsheet.messages.dialogs || MESSAGES,\n                        errors: this.options.errors\n                    })).appendTo(document.body).kendoWindow({\n                        autoFocus: false,\n                        scrollable: false,\n                        resizable: false,\n                        modal: true,\n                        visible: false,\n                        width: this.options.width || 320,\n                        title: this.options.title,\n                        open: function () {\n                            this.center();\n                        },\n                        close: this._onDialogClose.bind(this),\n                        activate: this._onDialogActivate.bind(this),\n                        deactivate: this._onDialogDeactivate.bind(this)\n                    }).data('kendoWindow');\n                }\n                return this._dialog;\n            },\n            _onDialogClose: function () {\n                this.trigger('close', { action: this._action });\n            },\n            _onDialogActivate: function () {\n                this.trigger('activate');\n            },\n            _onDialogDeactivate: function () {\n                this.trigger('deactivate');\n                this.destroy();\n            },\n            destroy: function () {\n                if (this._dialog) {\n                    this._dialog.destroy();\n                    this._dialog = null;\n                }\n            },\n            open: function () {\n                this.dialog().open();\n                this.dialog().element.find('.k-primary').focus();\n            },\n            apply: function () {\n                this.close();\n            },\n            close: function () {\n                this._action = 'close';\n                this.dialog().close();\n            }\n        });\n        function formattedValue(value, format) {\n            return kendo.spreadsheet.formatting.text(value, format);\n        }\n        var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.useCategory(this.category);\n            },\n            useCategory: function (category) {\n                var type = category && category.type || 'number';\n                var formatCurrency = type == 'currency';\n                this.category = category;\n                this.set('showCurrencyFilter', formatCurrency && this.currencies.length > 1);\n                if (!formatCurrency) {\n                    this.set('formats', this.allFormats[type + 'Formats']);\n                } else {\n                    this.currency(this.currencies[0]);\n                }\n                this.useFirstFormat();\n            },\n            useFirstFormat: function () {\n                if (this.formats.length) {\n                    this.set('format', this.formats[0].value);\n                }\n            },\n            currency: function (currency) {\n                if (currency !== undefined) {\n                    this._currency = currency;\n                    var info = currency.value;\n                    var formats = [\n                        {\n                            currency: info,\n                            decimals: true\n                        },\n                        {\n                            currency: info,\n                            decimals: true,\n                            iso: true\n                        },\n                        {\n                            currency: info,\n                            decimals: false\n                        }\n                    ];\n                    formats = formats.map(function (format) {\n                        format = FormatCellsViewModel.convert.currency(format);\n                        return {\n                            value: format,\n                            name: formattedValue(1000, format)\n                        };\n                    });\n                    this.set('formats', formats);\n                    this.useFirstFormat();\n                }\n                return this._currency || this.currencies[0];\n            },\n            categoryFilter: function (category) {\n                if (category !== undefined) {\n                    this.useCategory(category);\n                }\n                return this.category;\n            },\n            preview: function () {\n                var format = this.get('format');\n                var value = this.value || 0;\n                if (format && format.length) {\n                    return formattedValue(value, format);\n                } else {\n                    return value;\n                }\n            }\n        });\n        FormatCellsViewModel.convert = {\n            currency: function (options) {\n                function repeat(token, n) {\n                    return new Array(n + 1).join(token);\n                }\n                var info = options.currency;\n                var format = info.pattern[1];\n                if (options.decimals) {\n                    format = format.replace(/n/g, 'n' + info['.'] + repeat('0', info.decimals));\n                }\n                if (options.iso) {\n                    format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, '');\n                } else {\n                    format = format.replace(/\\$/g, info.symbol);\n                }\n                format = format.replace(/n/g, '?');\n                return format;\n            },\n            date: function (format) {\n                if (/T|Z/.test(format)) {\n                    return '';\n                }\n                return format.toLowerCase().replace(/tt/g, 'AM/PM').replace(/'/g, '\"');\n            }\n        };\n        function uniqueBy(field, array) {\n            var result = [];\n            var values = [];\n            for (var i = 0; i < array.length; i++) {\n                if ($.inArray(array[i][field], values) == -1) {\n                    result.push(array[i]);\n                    values.push(array[i][field]);\n                }\n            }\n            return result;\n        }\n        var FormatCellsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    categories: [\n                        {\n                            type: 'number',\n                            name: messages.categories.number\n                        },\n                        {\n                            type: 'currency',\n                            name: messages.categories.currency\n                        },\n                        {\n                            type: 'date',\n                            name: messages.categories.date\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._generateFormats();\n            },\n            options: {\n                className: 'k-spreadsheet-format-cells',\n                template: '<div class=\\'k-edit-form-container\\'>' + '<div class=\\'k-root-tabs\\' data-role=\\'tabstrip\\' ' + 'data-text-field=\\'name\\' ' + 'data-bind=\\'source: categories, value: categoryFilter\\' ' + 'data-animation=\\'false\\' />' + '<div class=\\'k-spreadsheet-preview\\' data-bind=\\'text: preview\\' />' + '<script type=\\'text/x-kendo-template\\' id=\\'format-item-template\\'>' + '\\\\#: data.name \\\\#' + '</script>' + '<select data-role=\\'dropdownlist\\' class=\\'k-format-filter\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'value.name\\' ' + 'data-bind=\\'visible: showCurrencyFilter, value: currency, source: currencies\\' />' + '<ul data-role=\\'staticlist\\' tabindex=\\'0\\' ' + 'class=\\'k-list k-reset\\' ' + 'data-template=\\'format-item-template\\' ' + 'data-value-primitive=\\'true\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'source: formats, value: format\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>' + '</div>'\n            },\n            _generateFormats: function () {\n                var options = this.options;\n                if (!options.currencies) {\n                    options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n                }\n                if (!options.numberFormats) {\n                    options.numberFormats = [\n                        {\n                            value: '#.00%',\n                            name: '100.00%'\n                        },\n                        {\n                            value: '#%',\n                            name: '100%'\n                        },\n                        {\n                            value: '#.00',\n                            name: '1024.00'\n                        },\n                        {\n                            value: '#,###.00',\n                            name: '1,024.00'\n                        }\n                    ];\n                }\n                if (!options.dateFormats) {\n                    var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n                    options.dateFormats = uniqueBy('value', $.map(calendarPatterns, function (format) {\n                        format = FormatCellsViewModel.convert.date(format);\n                        if (!format) {\n                            return;\n                        }\n                        return {\n                            value: format,\n                            name: formattedValue(34567.7678, format)\n                        };\n                    }));\n                }\n            },\n            open: function (range) {\n                var options = this.options;\n                var value = range.value();\n                var categories = options.categories.slice(0);\n                var element;\n                this.viewModel = new FormatCellsViewModel({\n                    currencies: options.currencies.slice(0),\n                    allFormats: {\n                        numberFormats: options.numberFormats.slice(0),\n                        dateFormats: options.dateFormats.slice(0)\n                    },\n                    categories: categories,\n                    format: range.format(),\n                    category: value instanceof Date ? categories[2] : categories[0],\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    value: value\n                });\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                kendo.bind(element, this.viewModel);\n                var currencyFilter = element.find('select.k-format-filter').data('kendoDropDownList');\n                if (options.currencies.length > 10) {\n                    currencyFilter.setOptions({ filter: 'contains' });\n                }\n                element.find(kendo.roleSelector('staticlist')).parent().addClass('k-list-wrapper');\n            },\n            apply: function () {\n                var format = this.viewModel.format;\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'format',\n                        value: format\n                    }\n                });\n            }\n        });\n        FormatCellsDialog.currenciesFrom = function (cultures) {\n            return uniqueBy('description', $.map(cultures, function (culture, name) {\n                if (!/-/.test(name)) {\n                    return;\n                }\n                var currency = culture.numberFormat.currency;\n                var description = kendo.format('{0} ({1}, {2})', currency.name, currency.abbr, currency.symbol);\n                return {\n                    description: description,\n                    value: currency\n                };\n            }));\n        };\n        kendo.spreadsheet.dialogs.register('formatCells', FormatCellsDialog);\n        kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n        var MessageDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    close: this.close.bind(this)\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('message', MessageDialog);\n        var ConfirmationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.confirmationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    text: messages.text\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                className: 'k-spreadsheet-message',\n                messageId: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: confirm\\'>' + '#= messages.okText #' + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>' + '#= messages.cancel #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    confirm: this.confirm.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            isConfirmed: function () {\n                return this._confirmed;\n            },\n            confirm: function () {\n                this._confirmed = true;\n                this.close();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('confirmation', ConfirmationDialog);\n        var ValidationErrorDialog = SpreadsheetDialog.extend({\n            options: {\n                className: 'k-spreadsheet-message',\n                title: '',\n                messageId: '',\n                text: '',\n                template: '<div class=\\'k-spreadsheet-message-content\\' data-bind=\\'text: text\\' />' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: retry\\'>' + '#= messages.retry #' + '</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>' + '#= messages.cancel #' + '</button>' + '</div>'\n            },\n            open: function () {\n                SpreadsheetDialog.fn.open.call(this);\n                var options = this.options;\n                var text = options.text;\n                if (options.messageId) {\n                    text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n                }\n                kendo.bind(this.dialog().element, {\n                    text: text,\n                    retry: this.retry.bind(this),\n                    cancel: this.close.bind(this)\n                });\n            },\n            retry: function () {\n                this._retry = true;\n                this.close();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validationError', ValidationErrorDialog);\n        var FontFamilyDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var fonts = this.options.fonts;\n                var defaultFont = this.options.defaultFont;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: fonts }),\n                    template: '#: data #',\n                    value: defaultFont,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontFamily',\n                        value: e.sender.value()[0]\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontFamily', FontFamilyDialog);\n        var FontSizeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                var sizes = this.options.sizes;\n                var defaultSize = this.options.defaultSize;\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: sizes }),\n                    template: '#: data #',\n                    value: defaultSize,\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: 'fontSize',\n                        value: kendo.parseInt(e.sender.value()[0])\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('fontSize', FontSizeDialog);\n        var BordersDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.element = this.dialog().element;\n                this._borderPalette();\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: {\n                width: 177,\n                template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                var state = this.value();\n                this.trigger('action', {\n                    command: 'BorderChangeCommand',\n                    options: {\n                        border: state.type,\n                        style: {\n                            size: 1,\n                            color: state.color\n                        }\n                    }\n                });\n            },\n            _borderPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.borderPalette = new kendo.spreadsheet.BorderPalette(element, { change: this.value.bind(this) });\n            },\n            value: function (state) {\n                if (state === undefined) {\n                    return this._state;\n                } else {\n                    this._state = state;\n                }\n            }\n        });\n        kendo.spreadsheet.dialogs.register('borders', BordersDialog);\n        var ColorChooser = SpreadsheetDialog.extend({\n            init: function (options) {\n                SpreadsheetDialog.fn.init.call(this, options);\n                this.element = this.dialog().element;\n                this.property = options.property;\n                this.options.title = options.title;\n                this.viewModel = kendo.observable({\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                kendo.bind(this.element.find('.k-action-buttons'), this.viewModel);\n            },\n            options: { template: '<div></div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.apply #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>' },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: this.property,\n                        value: this.value()\n                    }\n                });\n            },\n            value: function (e) {\n                if (e === undefined) {\n                    return this._value;\n                } else {\n                    this._value = e.value;\n                }\n            }\n        });\n        var ColorPickerDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 177;\n                ColorChooser.fn.init.call(this, options);\n                this._colorPalette();\n            },\n            _colorPalette: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPalette = element.kendoColorPalette({\n                    palette: [\n                        '#ffffff',\n                        '#000000',\n                        '#d6ecff',\n                        '#4e5b6f',\n                        '#7fd13b',\n                        '#ea157a',\n                        '#feb80a',\n                        '#00addc',\n                        '#738ac8',\n                        '#1ab39f',\n                        '#f2f2f2',\n                        '#7f7f7f',\n                        '#a7d6ff',\n                        '#d9dde4',\n                        '#e5f5d7',\n                        '#fad0e4',\n                        '#fef0cd',\n                        '#c5f2ff',\n                        '#e2e7f4',\n                        '#c9f7f1',\n                        '#d8d8d8',\n                        '#595959',\n                        '#60b5ff',\n                        '#b3bcca',\n                        '#cbecb0',\n                        '#f6a1c9',\n                        '#fee29c',\n                        '#8be6ff',\n                        '#c7d0e9',\n                        '#94efe3',\n                        '#bfbfbf',\n                        '#3f3f3f',\n                        '#007dea',\n                        '#8d9baf',\n                        '#b2e389',\n                        '#f272af',\n                        '#fed46b',\n                        '#51d9ff',\n                        '#aab8de',\n                        '#5fe7d5',\n                        '#a5a5a5',\n                        '#262626',\n                        '#003e75',\n                        '#3a4453',\n                        '#5ea226',\n                        '#af0f5b',\n                        '#c58c00',\n                        '#0081a5',\n                        '#425ea9',\n                        '#138677',\n                        '#7f7f7f',\n                        '#0c0c0c',\n                        '#00192e',\n                        '#272d37',\n                        '#3f6c19',\n                        '#750a3d',\n                        '#835d00',\n                        '#00566e',\n                        '#2c3f71',\n                        '#0c594f'\n                    ],\n                    change: this.value.bind(this)\n                }).data('kendoColorPalette');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('colorPicker', ColorPickerDialog);\n        var CustomColorDialog = ColorChooser.extend({\n            init: function (options) {\n                options.width = 268;\n                ColorChooser.fn.init.call(this, options);\n                this.dialog().setOptions({ animation: false });\n                this.dialog().one('activate', this._colorPicker.bind(this));\n            },\n            _colorPicker: function () {\n                var element = this.dialog().element.find('div:first');\n                this.colorPicker = element.kendoFlatColorPicker({ change: this.value.bind(this) }).data('kendoFlatColorPicker');\n            }\n        });\n        kendo.spreadsheet.dialogs.register('customColor', CustomColorDialog);\n        var AlignmentDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            property: 'textAlign',\n                            value: 'left',\n                            iconClass: 'align-left',\n                            text: messages.buttons.justtifyLeft\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'center',\n                            iconClass: 'align-center',\n                            text: messages.buttons.justifyCenter\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'right',\n                            iconClass: 'align-right',\n                            text: messages.buttons.justifyRight\n                        },\n                        {\n                            property: 'textAlign',\n                            value: 'justify',\n                            iconClass: 'align-justify',\n                            text: messages.buttons.justifyFull\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'top',\n                            iconClass: 'align-top',\n                            text: messages.buttons.alignTop\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'center',\n                            iconClass: 'align-middle',\n                            text: messages.buttons.alignMiddle\n                        },\n                        {\n                            property: 'verticalAlign',\n                            value: 'bottom',\n                            iconClass: 'align-bottom',\n                            text: messages.buttons.alignBottom\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-property=\\'#=property#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-i-#=iconClass#\\'></span>' + '#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'PropertyChangeCommand',\n                    options: {\n                        property: dataItem.property,\n                        value: dataItem.value\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('alignment', AlignmentDialog);\n        var MergeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'cells',\n                            iconClass: 'cells-merge',\n                            text: messages.buttons.mergeCells\n                        },\n                        {\n                            value: 'horizontally',\n                            iconClass: 'cells-merge-horizontally',\n                            text: messages.buttons.mergeHorizontally\n                        },\n                        {\n                            value: 'vertically',\n                            iconClass: 'cells-merge-vertically',\n                            text: messages.buttons.mergeVertically\n                        },\n                        {\n                            value: 'unmerge',\n                            iconClass: 'table-unmerge',\n                            text: messages.buttons.unmerge\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'MergeCellCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('merge', MergeDialog);\n        var FreezeDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    buttons: [\n                        {\n                            value: 'panes',\n                            iconClass: 'pane-freeze',\n                            text: messages.buttons.freezePanes\n                        },\n                        {\n                            value: 'rows',\n                            iconClass: 'row-freeze',\n                            text: messages.buttons.freezeRows\n                        },\n                        {\n                            value: 'columns',\n                            iconClass: 'column-freeze',\n                            text: messages.buttons.freezeColumns\n                        },\n                        {\n                            value: 'unfreeze',\n                            iconClass: 'table-unmerge',\n                            text: messages.buttons.unfreeze\n                        }\n                    ]\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n                this._list();\n            },\n            options: { template: '<ul class=\\'k-list k-reset\\'></ul>' },\n            _list: function () {\n                var ul = this.dialog().element.find('ul');\n                this.list = new kendo.ui.StaticList(ul, {\n                    dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                    template: '<a title=\\'#=text#\\' data-value=\\'#=value#\\'>' + '<span class=\\'k-icon k-icon k-i-#=iconClass#\\'></span>#=text#' + '</a>',\n                    change: this.apply.bind(this)\n                });\n                this.list.dataSource.fetch();\n            },\n            apply: function (e) {\n                var dataItem = e.sender.value()[0];\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'FreezePanesCommand',\n                    options: { value: dataItem.value }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('freeze', FreezeDialog);\n        var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n            init: function (options) {\n                ObservableObject.fn.init.call(this, options);\n                this.bind('change', function (e) {\n                    if (e.field === 'criterion') {\n                        this.reset();\n                        if (this.criterion === 'custom' || this.criterion === 'list') {\n                            this.setHintMessageTemplate();\n                        }\n                    }\n                    if (e.field === 'comparer') {\n                        this.setHintMessageTemplate();\n                    }\n                    if ((e.field == 'hintMessage' || e.field == 'hintTitle') && !this._mute) {\n                        this.shouldBuild = false;\n                    }\n                    if ((e.field == 'from' || e.field == 'to' || e.field == 'hintMessageTemplate' || e.field == 'type') && this.shouldBuild) {\n                        this.buildMessages();\n                    }\n                }.bind(this));\n                this.reset();\n            },\n            buildMessages: function () {\n                this._mute = true;\n                this.set('hintTitle', this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : '');\n                this.set('hintMessage', this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : '');\n                this._mute = false;\n            },\n            reset: function () {\n                this.setComparers();\n                this.set('comparer', this.comparers[0].type);\n                this.set('from', null);\n                this.set('to', null);\n                this.set('useCustomMessages', false);\n                this.shouldBuild = true;\n                this.hintTitleTemplate = this.defaultHintTitle;\n                this.buildMessages();\n            },\n            setComparers: function () {\n                var all = this.defaultComparers;\n                var comparers = [];\n                if (this.criterion === 'text') {\n                    var text_comparers = [\n                        'equalTo',\n                        'notEqualTo'\n                    ];\n                    for (var idx = 0; idx < all.length; idx++) {\n                        if (text_comparers[0] == all[idx].type) {\n                            comparers.push(all[idx]);\n                            text_comparers.shift();\n                        }\n                    }\n                } else {\n                    comparers = all.slice();\n                }\n                this.set('comparers', comparers);\n            },\n            setHintMessageTemplate: function () {\n                if (this.criterion !== 'custom' && this.criterion !== 'list') {\n                    this.set('hintMessageTemplate', kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n                } else {\n                    this.set('hintMessageTemplate', '');\n                    this.set('hintMessage', '');\n                }\n            },\n            isAny: function () {\n                return this.get('criterion') === 'any';\n            },\n            isNumber: function () {\n                return this.get('criterion') === 'number';\n            },\n            showToForNumber: function () {\n                return this.showTo() && this.isNumber();\n            },\n            showToForDate: function () {\n                return this.showTo() && this.isDate();\n            },\n            isText: function () {\n                return this.get('criterion') === 'text';\n            },\n            isDate: function () {\n                return this.get('criterion') === 'date';\n            },\n            isList: function () {\n                return this.get('criterion') === 'list';\n            },\n            isCustom: function () {\n                return this.get('criterion') === 'custom';\n            },\n            showRemove: function () {\n                return this.get('hasValidation');\n            },\n            showTo: function () {\n                return this.get('comparer') == 'between' || this.get('comparer') == 'notBetween';\n            },\n            update: function (validation) {\n                this.set('hasValidation', !!validation);\n                if (validation) {\n                    this.fromValidationObject(validation);\n                }\n            },\n            fromValidationObject: function (validation) {\n                this.set('criterion', validation.dataType);\n                this.set('comparer', validation.comparerType);\n                this.set('from', validation.from);\n                this.set('to', validation.to);\n                this.set('type', validation.type);\n                this.set('ignoreBlank', validation.allowNulls);\n                this.set('showButton', validation.showButton);\n                if (validation.messageTemplate || validation.titleTemplate) {\n                    this.hintMessageTemplate = validation.messageTemplate;\n                    this.hintMessage = validation.messageTemplate;\n                    this.hintTitleTemplate = validation.titleTemplate;\n                    this.hintTitle = validation.titleTemplate;\n                    this.useCustomMessages = true;\n                    this.buildMessages();\n                } else {\n                    this.useCustomMessages = false;\n                }\n            },\n            toValidationObject: function () {\n                if (this.criterion === 'any') {\n                    return null;\n                }\n                var options = {\n                    type: this.type,\n                    dataType: this.criterion,\n                    comparerType: this.comparer,\n                    from: this.from,\n                    to: this.to,\n                    allowNulls: this.ignoreBlank,\n                    showButton: this.showButton\n                };\n                if (this.useCustomMessages) {\n                    options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                    options.titleTemplate = this.hintTitle;\n                }\n                return options;\n            }\n        });\n        var ValidationDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n                var defaultOptions = {\n                    title: messages.title,\n                    hintMessage: messages.hintMessage,\n                    hintTitle: messages.hintTitle,\n                    criteria: [\n                        {\n                            type: 'any',\n                            name: messages.criteria.any\n                        },\n                        {\n                            type: 'number',\n                            name: messages.criteria.number\n                        },\n                        {\n                            type: 'text',\n                            name: messages.criteria.text\n                        },\n                        {\n                            type: 'date',\n                            name: messages.criteria.date\n                        },\n                        {\n                            type: 'custom',\n                            name: messages.criteria.custom\n                        },\n                        {\n                            type: 'list',\n                            name: messages.criteria.list\n                        }\n                    ],\n                    comparers: [\n                        {\n                            type: 'greaterThan',\n                            name: messages.comparers.greaterThan\n                        },\n                        {\n                            type: 'lessThan',\n                            name: messages.comparers.lessThan\n                        },\n                        {\n                            type: 'between',\n                            name: messages.comparers.between\n                        },\n                        {\n                            type: 'notBetween',\n                            name: messages.comparers.notBetween\n                        },\n                        {\n                            type: 'equalTo',\n                            name: messages.comparers.equalTo\n                        },\n                        {\n                            type: 'notEqualTo',\n                            name: messages.comparers.notEqualTo\n                        },\n                        {\n                            type: 'greaterThanOrEqualTo',\n                            name: messages.comparers.greaterThanOrEqualTo\n                        },\n                        {\n                            type: 'lessThanOrEqualTo',\n                            name: messages.comparers.lessThanOrEqualTo\n                        }\n                    ],\n                    comparerMessages: messages.comparerMessages\n                };\n                SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n            },\n            options: {\n                width: 450,\n                criterion: 'any',\n                type: 'reject',\n                ignoreBlank: true,\n                showButton: true,\n                useCustomMessages: false,\n                errorTemplate: '<div class=\"k-widget k-tooltip k-tooltip-validation\" style=\"margin:0.5em\"><span class=\"k-icon k-i-warning\"> </span>' + '#= message #<div class=\"k-callout k-callout-n\"></div></div>',\n                template: '<div class=\"k-edit-form-container\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.criteria #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.criteria #\"' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: criterion, source: criteria\" />' + '</div>' + '<div data-bind=\"visible: isNumber\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.comparer #\"' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.min #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.min #\" title=\"#: messages.validationDialog.labels.min #\" placeholder=\"e.g. 10\" class=\"k-textbox\" data-bind=\"value: from, enabled: isNumber\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.max #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.max #\" title=\"#: messages.validationDialog.labels.max #\" placeholder=\"e.g. 100\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForNumber\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isText\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.comparer #\"' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isText\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.comparer #:</label></div>' + '<div class=\"k-edit-field\">' + '<select data-role=\"dropdownlist\" ' + 'title=\"#: messages.validationDialog.labels.comparer #\"' + 'data-text-field=\"name\" ' + 'data-value-field=\"type\" ' + 'data-bind=\"value: comparer, source: comparers\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.start #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.start #\" title=\"#: messages.validationDialog.labels.start #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isDate\" required=\"required\" />' + '</div>' + '<div data-bind=\"visible: showTo\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.end #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.end #\" title=\"#: messages.validationDialog.labels.end #\" class=\"k-textbox\" data-bind=\"value: to, enabled: showToForDate\" required=\"required\" />' + '</div>' + '</div>' + '</div>' + '<div data-bind=\"visible: isCustom\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isCustom\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.value #:</label></div>' + '<div class=\"k-edit-field\">' + '<input name=\"#: messages.validationDialog.labels.value #\" title=\"#: messages.validationDialog.labels.value #\" class=\"k-textbox\" data-bind=\"value: from, enabled: isList\" required=\"required\" />' + '</div>' + '</div>' + '<div data-bind=\"visible: isList\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"showButton\" id=\"listShowButton\" class=\"k-checkbox\" data-bind=\"checked: showButton\"/>' + '<label for=\"listShowButton\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.showListButton #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"visible: isDate\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" name=\"showButton\" id=\"dateShowButton\" class=\"k-checkbox\" data-bind=\"checked: showButton\"/>' + '<label for=\"dateShowButton\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.showCalendarButton #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.ignoreBlank #\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox\" data-bind=\"checked: ignoreBlank\"/>' + '<label for=\"ignoreBlank\" class=\"k-checkbox-label\">' + ' #: messages.validationDialog.labels.ignoreBlank #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\">' + '<div class=\"k-hr\"></div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.onInvalidData #:</label></div>' + '<div class=\"k-edit-field\">' + '<input type=\"radio\" title=\"#: messages.validationDialog.labels.rejectInput #\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeReject\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.rejectInput #' + '</label> ' + '<input type=\"radio\" title=\"#: messages.validationDialog.labels.showWarning #\" id=\"validationTypeWarning\"  name=\"validationType\" value=\"warning\" data-bind=\"checked: type\" class=\"k-radio\" />' + '<label for=\"validationTypeWarning\" class=\"k-radio-label\">' + '#: messages.validationDialog.labels.showWarning #' + '</label>' + '</div>' + '</div>' + '<div data-bind=\"invisible: isAny\" class=\"hint-wrapper\">' + '<div class=\"k-edit-field\">' + '<input type=\"checkbox\" title=\"#: messages.validationDialog.labels.showHint #\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox\" data-bind=\"checked: useCustomMessages\" />' + '<label class=\"k-checkbox-label\" for=\"useCustomMessages\">' + ' #: messages.validationDialog.labels.showHint #' + '</label>' + '</div>' + '<div data-bind=\"visible: useCustomMessages\">' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintTitle #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" title=\"#: messages.validationDialog.labels.hintTitle #\" placeholder=\"#: messages.validationDialog.placeholders.typeTitle #\" data-bind=\"value: hintTitle\" />' + '</div>' + '<div class=\"k-edit-label\"><label>#: messages.validationDialog.labels.hintMessage #:</label></div>' + '<div class=\"k-edit-field\">' + '<input class=\"k-textbox\" title=\"#: messages.validationDialog.labels.hintMessage #\" placeholder=\"#: messages.validationDialog.placeholders.typeMessage #\" data-bind=\"value: hintMessage\" />' + '</div>' + '</div>' + '</div>' + '<div class=\"k-action-buttons\">' + '<button class=\"k-button\" data-bind=\"visible: showRemove, click: remove\">#: messages.remove #</button>' + '<button class=\"k-button k-primary\" data-bind=\"click: apply\">#: messages.apply #</button>' + '<button class=\"k-button\" data-bind=\"click: close\">#: messages.cancel #</button>' + '</div>' + '</div>'\n            },\n            open: function (range) {\n                var options = this.options;\n                var element;\n                this.viewModel = new ValidationViewModel({\n                    type: options.type,\n                    defaultHintMessage: options.hintMessage,\n                    defaultHintTitle: options.hintTitle,\n                    defaultComparers: options.comparers.slice(0),\n                    comparerMessages: options.comparerMessages,\n                    criteria: options.criteria.slice(0),\n                    criterion: options.criterion,\n                    ignoreBlank: options.ignoreBlank,\n                    showButton: options.showButton,\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this),\n                    remove: this.remove.bind(this)\n                });\n                this.viewModel.update(range.validation());\n                SpreadsheetDialog.fn.open.call(this);\n                element = this.dialog().element;\n                if (this.validatable) {\n                    this.validatable.destroy();\n                }\n                kendo.bind(element, this.viewModel);\n                this.validatable = new kendo.ui.Validator(element.find('.k-edit-form-container'), {\n                    validateOnBlur: false,\n                    errorTemplate: this.options.errorTemplate || undefined\n                });\n            },\n            apply: function () {\n                if (this.validatable.validate()) {\n                    SpreadsheetDialog.fn.apply.call(this);\n                    this.trigger('action', {\n                        command: 'EditValidationCommand',\n                        options: { value: this.viewModel.toValidationObject() }\n                    });\n                }\n            },\n            remove: function () {\n                this.viewModel.set('criterion', 'any');\n                this.apply();\n            }\n        });\n        kendo.spreadsheet.dialogs.register('validation', ValidationDialog);\n        kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n        var ExportAsDialog = SpreadsheetDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.exportAsDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n                this.viewModel = kendo.observable({\n                    title: this.options.title,\n                    name: this.options.name,\n                    extension: this.options.extension,\n                    fileFormats: this.options.fileFormats,\n                    excel: options.excelExport,\n                    pdf: {\n                        proxyURL: options.pdfExport.proxyURL,\n                        forceProxy: options.pdfExport.forceProxy,\n                        title: options.pdfExport.title,\n                        author: options.pdfExport.author,\n                        subject: options.pdfExport.subject,\n                        keywords: options.pdfExport.keywords,\n                        creator: options.pdfExport.creator,\n                        date: options.pdfExport.date,\n                        fitWidth: this.options.pdf.fitWidth,\n                        area: this.options.pdf.area,\n                        areas: this.options.pdf.areas,\n                        paperSize: this.options.pdf.paperSize,\n                        paperSizes: this.options.pdf.paperSizes,\n                        margin: this.options.pdf.margin,\n                        margins: this.options.pdf.margins,\n                        landscape: this.options.pdf.landscape,\n                        guidelines: this.options.pdf.guidelines,\n                        hCenter: this.options.pdf.hCenter,\n                        vCenter: this.options.pdf.vCenter\n                    },\n                    apply: this.apply.bind(this),\n                    close: this.close.bind(this)\n                });\n                var dialog = this.dialog();\n                this.viewModel.bind('change', function (e) {\n                    if (e.field === 'extension') {\n                        this.set('showPdfOptions', this.extension === '.pdf' ? true : false);\n                        dialog.center();\n                    }\n                });\n                kendo.bind(dialog.element, this.viewModel);\n            },\n            options: {\n                name: 'Workbook',\n                extension: '.xlsx',\n                fileFormats: [\n                    {\n                        description: 'Excel Workbook (.xlsx)',\n                        extension: '.xlsx'\n                    },\n                    {\n                        description: 'Portable Document Format(.pdf)',\n                        extension: '.pdf'\n                    }\n                ],\n                pdf: {\n                    fitWidth: true,\n                    area: 'workbook',\n                    areas: [\n                        {\n                            area: 'workbook',\n                            text: 'Entire Workbook'\n                        },\n                        {\n                            area: 'sheet',\n                            text: 'Active Sheet'\n                        },\n                        {\n                            area: 'selection',\n                            text: 'Selection'\n                        }\n                    ],\n                    paperSize: 'a4',\n                    paperSizes: [\n                        {\n                            value: 'a2',\n                            text: 'A2 (420 mm \\xD7 594 mm)     '\n                        },\n                        {\n                            value: 'a3',\n                            text: 'A3 (297 mm x 420 mm)     '\n                        },\n                        {\n                            value: 'a4',\n                            text: 'A4 (210 mm x 297 mm)     '\n                        },\n                        {\n                            value: 'a5',\n                            text: 'A5 (148 mm x 210 mm)     '\n                        },\n                        {\n                            value: 'b3',\n                            text: 'B3 (353 mm \\xD7 500 mm)     '\n                        },\n                        {\n                            value: 'b4',\n                            text: 'B4 (250 mm x 353 mm)     '\n                        },\n                        {\n                            value: 'b5',\n                            text: 'B5 (176 mm x 250 mm)     '\n                        },\n                        {\n                            value: 'folio',\n                            text: 'Folio (8.5\" x 13\")       '\n                        },\n                        {\n                            value: 'legal',\n                            text: 'Legal (8.5\" x 14\")       '\n                        },\n                        {\n                            value: 'letter',\n                            text: 'Letter (8.5\" x 11\")      '\n                        },\n                        {\n                            value: 'tabloid',\n                            text: 'Tabloid (11\" x 17\")      '\n                        },\n                        {\n                            value: 'executive',\n                            text: 'Executive (7.25\" x 10.5\")'\n                        }\n                    ],\n                    margin: {\n                        bottom: '0.75in',\n                        left: '0.7in',\n                        right: '0.7in',\n                        top: '0.75in'\n                    },\n                    margins: [\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.7in',\n                                right: '0.7in',\n                                top: '0.75in'\n                            },\n                            text: 'Normal'\n                        },\n                        {\n                            value: {\n                                bottom: '0.75in',\n                                left: '0.25in',\n                                right: '0.25in',\n                                top: '0.75in'\n                            },\n                            text: 'Narrow'\n                        },\n                        {\n                            value: {\n                                bottom: '1in',\n                                left: '1in',\n                                right: '1in',\n                                top: '1in'\n                            },\n                            text: 'Wide'\n                        }\n                    ],\n                    landscape: true,\n                    guidelines: true,\n                    hCenter: true,\n                    vCenter: true\n                },\n                width: 520,\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.fileName #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-textbox\\' data-bind=\\'value: name\\' />' + '</div>' + '<div >' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.saveAsType #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'description\\' ' + 'data-value-field=\\'extension\\' ' + 'data-bind=\\'value: extension, source: fileFormats\\' />' + '</div>' + '</div>' + '<div class=\\'k-export-config\\' data-bind=\\'visible: showPdfOptions\\'>' + '<hr class=\\'k-hr\\' />' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.exportArea #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'area\\' ' + 'data-bind=\\'value: pdf.area, source: pdf.areas\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.paperSize#:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.paperSize, source: pdf.paperSizes\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.margins #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<select data-role=\\'dropdownlist\\' class=\\'k-file-format\\' ' + 'data-value-primitive=\\'true\\'' + 'data-text-field=\\'text\\' ' + 'data-value-field=\\'value\\' ' + 'data-bind=\\'value: pdf.margin, source: pdf.margins\\' />' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.orientation #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<div class=\\'k-button-group\\'>' + '<input type=\\'radio\\' id=\\'k-orientation-portrait\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'false\\' />' + '<label class=\\'k-button k-button-icon k-group-start k-orientation-button\\' for=\\'k-orientation-portrait\\'><span class=\\'k-icon k-i-page-portrait\\'></span></label>' + '<input type=\\'radio\\' id=\\'k-orientation-landscape\\' name=\\'orientation\\' data-type=\\'boolean\\' data-bind=\\'checked: pdf.landscape\\' value=\\'true\\' />' + '<label class=\\'k-button k-button-icon k-group-end k-orientation-button\\' for=\\'k-orientation-landscape\\'><span class=\\'k-icon k-i-page-landscape\\'></span></label>' + '</div>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.print #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'guidelines\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.guidelines\\'/><label class=\\'k-checkbox-label\\' for=\\'guidelines\\'>#: messages.exportAsDialog.labels.guidelines#</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.scale #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'fitWidth\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.fitWidth\\'/><label class=\\'k-checkbox-label\\' for=\\'fitWidth\\'>#: messages.exportAsDialog.labels.fit #</label>' + '</div>' + '<div class=\\'k-edit-label\\'><label>#: messages.exportAsDialog.labels.center #:</label></div>' + '<div class=\\'k-edit-field\\'>' + '<input class=\\'k-checkbox\\' id=\\'hCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.hCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'hCenter\\'>#: messages.exportAsDialog.labels.horizontally #</label>' + '<input class=\\'k-checkbox\\' id=\\'vCenter\\' type=\\'checkbox\\' data-bind=\\'checked: pdf.vCenter\\'/><label class=\\'k-checkbox-label\\' for=\\'vCenter\\'>#: messages.exportAsDialog.labels.vertically #</label>' + '</div>' + '<div class=\\'k-page-orientation\\'>' + '<span class=\\'k-icon k-i-page-portrait\\' data-bind=\\'invisible: pdf.landscape\\'></span>' + '<span class=\\'k-icon k-i-page-landscape\\' data-bind=\\'visible: pdf.landscape\\'></span>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#: messages.save #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: close\\'>#: messages.cancel #</button>' + '</div>'\n            },\n            apply: function () {\n                SpreadsheetDialog.fn.apply.call(this);\n                this.trigger('action', {\n                    command: 'SaveAsCommand',\n                    options: this.viewModel\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('exportAs', ExportAsDialog);\n        function basicErrorDialog(id, msg) {\n            kendo.spreadsheet.dialogs.register(id, MessageDialog.extend({ options: { messageId: msg } }));\n        }\n        basicErrorDialog('modifyMerged', 'modifyMergedDialog.errorMessage');\n        basicErrorDialog('rangeDisabled', 'rangeDisabledDialog.errorMessage');\n        basicErrorDialog('overflow', 'overflowDialog.errorMessage');\n        basicErrorDialog('unsupportedSelection', 'unsupportedSelectionDialog.errorMessage');\n        basicErrorDialog('incompatibleRanges', 'incompatibleRangesDialog.errorMessage');\n        basicErrorDialog('noFillDirection', 'noFillDirectionDialog.errorMessage');\n        basicErrorDialog('duplicateSheetName', 'duplicateSheetNameDialog.errorMessage');\n        var ImportErrorDialog = MessageDialog.extend({\n            options: {\n                width: 640,\n                title: 'Errors in import',\n                template: '<div class=\\'k-spreadsheet-message-content k-spreadsheet-import-errors\\'>' + '<div class=\\'k--header-message\\'>We encountered #= errors.length # errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div>' + '<div class=\\'k--errors\\'>' + '<table>' + '<thead>' + '<tr><th>Context</th><th>Error message</th></tr>' + '</thead>' + '# for (var i = 0; i < errors.length; ++i) { #' + '# var err = errors[i]; #' + '<tr><td>#: err.context #</td><td>#: err.error #</td></tr>' + '# } #' + '</table>' + '</div>' + '</div>' + '<div class=\\'k-action-buttons\\'>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#: messages.okText #' + '</button>' + '</div>'\n            }\n        });\n        kendo.spreadsheet.dialogs.register('importError', ImportErrorDialog);\n        var UseKeyboardDialog = MessageDialog.extend({\n            init: function (options) {\n                var messages = kendo.spreadsheet.messages.dialogs.useKeyboardDialog || MESSAGES;\n                SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n            },\n            options: { template: '#: messages.useKeyboardDialog.errorMessage #' + '<div>Ctrl+C #: messages.useKeyboardDialog.labels.forCopy #</div>' + '<div>Ctrl+X #: messages.useKeyboardDialog.labels.forCut #</div>' + '<div>Ctrl+V #: messages.useKeyboardDialog.labels.forPaste #</div>' + '<div class=\"k-action-buttons\">' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: close\\'>' + '#= messages.okText #' + '</button>' + '</div>' }\n        });\n        kendo.spreadsheet.dialogs.register('useKeyboard', UseKeyboardDialog);\n        var HyperlinkDialog = SpreadsheetDialog.extend({\n            options: {\n                template: '<div class=\\'k-edit-label\\'><label>#: messages.linkDialog.labels.url #:</label></div>' + '<div class=\\'k-edit-field\\'><input class=\\'k-textbox\\' data-bind=\\'value: url\\' title=\\'#: messages.linkDialog.labels.url #\\' /></div>' + '<div class=\\'k-action-buttons\\'>' + ('<button class=\\'k-button k-left\\' data-bind=\\'click: remove\\'>#= messages.linkDialog.labels.removeLink #</button>' + '<button class=\\'k-button k-primary\\' data-bind=\\'click: apply\\'>#= messages.okText #</button>' + '<button class=\\'k-button\\' data-bind=\\'click: cancel\\'>#= messages.cancel #</button>') + '</div>',\n                title: MESSAGES.linkDialog.title,\n                autoFocus: false\n            },\n            open: function (range) {\n                var self = this;\n                SpreadsheetDialog.fn.open.apply(self, arguments);\n                var element = self.dialog().element;\n                var model = kendo.observable({\n                    url: range.link(),\n                    apply: function () {\n                        if (!/\\S/.test(model.url)) {\n                            model.url = null;\n                        }\n                        self.trigger('action', {\n                            command: 'HyperlinkCommand',\n                            options: { link: model.url }\n                        });\n                        self.close();\n                    },\n                    remove: function () {\n                        model.url = null;\n                        model.apply();\n                    },\n                    cancel: self.close.bind(self)\n                });\n                kendo.bind(element, model);\n                element.find('input').focus().on('keydown', function (ev) {\n                    if (ev.keyCode == 13) {\n                        model.url = $(this).val();\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.apply();\n                    } else if (ev.keyCode == 27) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.cancel();\n                    }\n                });\n            }\n        });\n        kendo.spreadsheet.dialogs.register('hyperlink', HyperlinkDialog);\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/sheetbinder', [\n        'kendo.core',\n        'kendo.data',\n        'spreadsheet/sheet'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var identity = function (o) {\n            return o;\n        };\n        var SheetDataSourceBinder = kendo.Class.extend({\n            init: function (options) {\n                this.options = $.extend({}, this.options, options);\n                this.columns = this._normalizeColumns(this.options.columns);\n                this._sheet();\n                this._dataSource();\n                this._header();\n                this._boundRowsCount = 0;\n                this.dataSource.fetch();\n            },\n            _sheet: function () {\n                this.sheet = this.options.sheet;\n                this._sheetChangeHandler = this._sheetChange.bind(this);\n                this._sheetDeleteRowHandler = this._sheetDeleteRow.bind(this);\n                this._sheetInsertRowHandler = this._sheetInsertRow.bind(this);\n                this.sheet.bind('change', this._sheetChangeHandler).bind('afterDeleteRow', this._sheetDeleteRowHandler).bind('afterInsertRow', this._sheetInsertRowHandler);\n            },\n            _sheetInsertRow: function (e) {\n                if (e.index !== undefined) {\n                    this.dataSource.insert(Math.max(e.index - 1, 0), {});\n                }\n            },\n            _sheetDeleteRow: function (e) {\n                if (e.index !== undefined) {\n                    var dataSource = this.dataSource;\n                    var model = dataSource.view()[e.index - 1];\n                    if (model) {\n                        dataSource.remove(model);\n                    }\n                }\n            },\n            _header: function () {\n                this.sheet.batch(function () {\n                    this.columns.forEach(function (column, index) {\n                        this.sheet.range(0, index).value(column.title);\n                    }.bind(this));\n                }.bind(this));\n            },\n            _sheetChange: function (e) {\n                if (e.insertRow || e.deleteRow) {\n                    return;\n                }\n                if (e.recalc && e.ref) {\n                    var dataSource = this.dataSource;\n                    var data = dataSource.view();\n                    var columns = this.columns;\n                    var fields;\n                    if (dataSource.reader.model) {\n                        fields = dataSource.reader.model.fields;\n                    }\n                    if (!columns.length && data.length) {\n                        columns = Object.keys(data[0].toJSON());\n                    }\n                    var getters = columns.map(function (column) {\n                        var field = column.field;\n                        if (field && fields && fields[field] && fields[field].type == 'date') {\n                            return kendo.spreadsheet.numberToDate;\n                        }\n                        return identity;\n                    });\n                    this._skipRebind = true;\n                    var normalizedRef = this.sheet._grid.normalize(e.ref);\n                    var values = this.sheet.range(normalizedRef).values();\n                    normalizedRef.forEach(function (ref) {\n                        ref = ref.toRangeRef();\n                        var record;\n                        var valueIndex = 0;\n                        for (var ri = ref.topLeft.row; ri <= ref.bottomRight.row; ri++) {\n                            record = data[ri - 1];\n                            if (!record) {\n                                record = dataSource.insert(ri - 1, {});\n                                data = dataSource.view();\n                            }\n                            var colValueIndex = 0;\n                            for (var ci = ref.topLeft.col; ci <= ref.bottomRight.col && ci < columns.length; ci++) {\n                                record.set(columns[ci].field, getters[ci](values[valueIndex][colValueIndex++]));\n                            }\n                            valueIndex++;\n                        }\n                    });\n                    this._boundRowsCount = dataSource.view().length;\n                    this._skipRebind = false;\n                }\n            },\n            _normalizeColumns: function (columns) {\n                return columns.map(function (column) {\n                    var field = column.field || column;\n                    return {\n                        field: field,\n                        title: column.title || field\n                    };\n                });\n            },\n            _dataSource: function () {\n                var options = this.options;\n                var dataSource = options.dataSource;\n                dataSource = Array.isArray(dataSource) ? { data: dataSource } : dataSource;\n                if (this.dataSource && this._changeHandler) {\n                    this.dataSource.unbind('change', this._changeHandler);\n                } else {\n                    this._changeHandler = this._change.bind(this);\n                }\n                this.dataSource = kendo.data.DataSource.create(dataSource).bind('change', this._changeHandler);\n            },\n            _change: function () {\n                if (this._skipRebind) {\n                    return;\n                }\n                var data = this.dataSource.view();\n                var columns = this.columns;\n                if (!columns.length && data.length) {\n                    this.columns = columns = this._normalizeColumns(Object.keys(data[0].toJSON()));\n                    this._header();\n                }\n                var getters = columns.map(function (column) {\n                    return kendo.getter(column.field);\n                });\n                this.sheet.batch(function () {\n                    var length = Math.max(data.length, this._boundRowsCount);\n                    for (var idx = 0; idx < length; idx++) {\n                        for (var getterIdx = 0; getterIdx < getters.length; getterIdx++) {\n                            var value = data[idx] ? getters[getterIdx](data[idx]) : null;\n                            this.sheet.range(idx + 1, getterIdx).value(value);\n                        }\n                    }\n                }.bind(this));\n                this._boundRowsCount = data.length;\n            },\n            destroy: function () {\n                this.dataSource.unbind('change', this._changeHandler);\n                this.sheet.unbind('change', this._sheetChangeHandler).unbind('deleteRow', this._sheetDeleteRowHandler).unbind('insertRow', this._sheetInsertRowHandler);\n            },\n            options: { columns: [] }\n        });\n        kendo.spreadsheet.SheetDataSourceBinder = SheetDataSourceBinder;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/filtermenu', [\n        'kendo.core',\n        'kendo.popup',\n        'kendo.treeview',\n        'kendo.numerictextbox',\n        'kendo.datepicker',\n        'kendo.datetimepicker'\n    ], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var classNames = {\n            details: 'k-details',\n            button: 'k-button',\n            detailsSummary: 'k-details-summary',\n            detailsContent: 'k-details-content',\n            icon: 'k-icon',\n            iconCollapse: 'k-i-arrow-45-down-right',\n            iconExpand: 'k-i-arrow-60-right',\n            iconSearch: 'k-i-zoom',\n            textbox: 'k-textbox',\n            wrapper: 'k-spreadsheet-filter-menu',\n            filterByCondition: 'k-spreadsheet-condition-filter',\n            filterByValue: 'k-spreadsheet-value-filter',\n            valuesTreeViewWrapper: 'k-spreadsheet-value-treeview-wrapper',\n            actionButtons: 'k-action-buttons'\n        };\n        var Details = Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.details);\n                this._summary = this.element.find('.' + FilterMenu.classNames.detailsSummary).on('click', this._toggle.bind(this));\n                var iconClass = options.expanded ? FilterMenu.classNames.iconCollapse : FilterMenu.classNames.iconExpand;\n                this._icon = $('<span />', { 'class': FilterMenu.classNames.icon + ' ' + iconClass }).prependTo(this._summary);\n                this._container = kendo.wrap(this._summary.next(), true);\n                if (!options.expanded) {\n                    this._container.hide();\n                }\n            },\n            options: { name: 'Details' },\n            events: ['toggle'],\n            visible: function () {\n                return this.options.expanded;\n            },\n            toggle: function (show) {\n                var animation = kendo.fx(this._container).expand('vertical');\n                animation.stop()[show ? 'reverse' : 'play']();\n                this._icon.toggleClass(FilterMenu.classNames.iconExpand, show).toggleClass(FilterMenu.classNames.iconCollapse, !show);\n                this.options.expanded = !show;\n            },\n            _toggle: function () {\n                var show = this.visible();\n                this.toggle(show);\n                this.trigger('toggle', { show: show });\n            }\n        });\n        var FILTERMENU_MESSAGES = kendo.spreadsheet.messages.filterMenu = {\n            sortAscending: 'Sort range A to Z',\n            sortDescending: 'Sort range Z to A',\n            filterByValue: 'Filter by value',\n            filterByCondition: 'Filter by condition',\n            apply: 'Apply',\n            search: 'Search',\n            addToCurrent: 'Add to current selection',\n            clear: 'Clear',\n            blanks: '(Blanks)',\n            operatorNone: 'None',\n            and: 'AND',\n            or: 'OR',\n            operators: {\n                string: {\n                    contains: 'Text contains',\n                    doesnotcontain: 'Text does not contain',\n                    startswith: 'Text starts with',\n                    endswith: 'Text ends with',\n                    matches: 'Text matches',\n                    doesnotmatch: 'Text does not match'\n                },\n                date: {\n                    eq: 'Date is',\n                    neq: 'Date is not',\n                    lt: 'Date is before',\n                    gt: 'Date is after'\n                },\n                number: {\n                    eq: 'Is equal to',\n                    neq: 'Is not equal to',\n                    gte: 'Is greater than or equal to',\n                    gt: 'Is greater than',\n                    lte: 'Is less than or equal to',\n                    lt: 'Is less than'\n                }\n            }\n        };\n        kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (element, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, element, bindings, options);\n                this._change = $.proxy(this.change, this);\n                $(this.element).on('change', this._change);\n            },\n            refresh: function () {\n                var that = this, value = that.bindings.spreadsheetFilterValue.get();\n                $(that.element).val(value instanceof Date ? '' : value);\n            },\n            change: function () {\n                var value = this.element.value;\n                this.bindings.spreadsheetFilterValue.set(value);\n            }\n        });\n        kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function (widget, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n                this.widget = widget;\n                this._change = $.proxy(this.change, this);\n                this.widget.first('change', this._change);\n            },\n            refresh: function () {\n                var binding = this.bindings.spreadsheetFilterValue, value = binding.get(), type = $(this.widget.element).data('filterType');\n                if (type === 'date' && value instanceof Date || type === 'number' && !isNaN(value)) {\n                    this.widget.value(value);\n                } else {\n                    this.widget.value(null);\n                }\n            },\n            change: function () {\n                var value = this.widget.value(), binding = this.bindings.spreadsheetFilterValue;\n                binding.set(value);\n            }\n        });\n        var templates = {\n            filterByValue: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByValue #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div class=\\'k-textbox k-space-right\\'>' + '<input placeholder=\\'#= messages.search #\\' data-#=ns#bind=\\'events: { input: filterValues }\\' />' + '<span class=\\'k-icon k-i-zoom\\' />' + '</div>' + '<div data-#=ns#bind=\\'visible: hasActiveSearch\\'><input class=\\'k-checkbox\\' type=\\'checkbox\\' data-#=ns#bind=\\'checked: appendToSearch\\' id=\\'_#=guid#\\' /><label class=\\'k-checkbox-label\\' for=\\'_#=guid#\\'>#= messages.addToCurrent #</label></div>' + '<div class=\\'' + classNames.valuesTreeViewWrapper + '\\'>' + '<div data-#=ns#role=\\'treeview\\' ' + 'data-#=ns#checkboxes=\\'{ checkChildren: true }\\' ' + 'data-#=ns#bind=\\'source: valuesDataSource, events: { check: valuesChange, select: valueSelect }\\' ' + '/>' + '</div>' + '</div>',\n            filterByCondition: '<div class=\\'' + classNames.detailsSummary + '\\'>#= messages.filterByCondition #</div>' + '<div class=\\'' + classNames.detailsContent + '\\'>' + '<div>' + '<select ' + 'data-#=ns#role=\"dropdownlist\"' + 'data-#=ns#bind=\"value: operator, source: operators, events: { change: operatorChange } \"' + 'data-value-primitive=\"false\"' + 'data-option-label=\"#=messages.operatorNone#\"' + 'data-height=\"auto\"' + 'data-text-field=\"text\"' + 'data-value-field=\"unique\">' + '</select>' + '</div>' + '<div data-#=ns#bind=\"visible: isString\">' + '<input data-filter-type=\"string\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isNumber\">' + '<input data-filter-type=\"number\" data-#=ns#role=\"numerictextbox\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '<div data-#=ns#bind=\"visible: isDate\">' + '<input data-filter-type=\"date\" data-#=ns#role=\"datepicker\" data-#=ns#bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />' + '</div>' + '</div>',\n            menuItem: '<li data-command=\\'#=command#\\' data-dir=\\'#=dir#\\'>' + '<span class=\\'k-icon k-i-#=iconClass#\\'></span>#=text#' + '</li>',\n            actionButtons: '<button data-#=ns#bind=\\'click: apply\\' class=\\'k-button k-primary\\'>#=messages.apply#</button>' + '<button data-#=ns#bind=\\'click: clear\\' class=\\'k-button\\'>#=messages.clear#</button>'\n        };\n        function distinctValues(values) {\n            var hash = {};\n            var result = [];\n            for (var i = 0; i < values.length; i++) {\n                if (!hash[values[i].value]) {\n                    hash[values[i].value] = values[i];\n                    result.push(values[i]);\n                } else if (!hash[values[i].value].checked && values[i].checked) {\n                    hash[values[i].value].checked = true;\n                }\n            }\n            return result;\n        }\n        function filter(dataSource, query) {\n            var hasVisibleChildren = false;\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            var valuesFilter = this;\n            var values = this.values;\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                var text = item.text.toString().toLowerCase();\n                var itemVisible = query === true || query === '' || text.indexOf(query) >= 0;\n                var filterSpread = filter.bind(valuesFilter);\n                var anyVisibleChildren = filterSpread(item.children, query);\n                hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                item.hidden = !itemVisible && !anyVisibleChildren;\n                if (query.length || values && !values.length) {\n                    item.checked = !item.hidden;\n                } else if (values && values.indexOf(item.text) != -1) {\n                    item.checked = true;\n                }\n            }\n            if (data) {\n                dataSource.filter({\n                    field: 'hidden',\n                    operator: 'neq',\n                    value: true\n                });\n            }\n            return hasVisibleChildren;\n        }\n        function uncheckAll(dataSource) {\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                item.checked = false;\n                if (item.hasChildren) {\n                    uncheckAll(item.children);\n                }\n            }\n        }\n        var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n            valuesChange: function (e) {\n                var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                var checked = function (item) {\n                    return item.checked;\n                };\n                var value = function (item) {\n                    return item.dataType === 'date' ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                };\n                var unique = function (value, index, array) {\n                    return array.lastIndexOf(value) === index;\n                };\n                var data = dataSource.data();\n                var values = data[0].children.data().toJSON();\n                var blanks = values.filter(function (item) {\n                    return item.dataType === 'blank';\n                });\n                blanks = blanks.length ? blanks[0].checked : false;\n                values = values.filter(checked).map(value);\n                if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                    values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                }\n                this.set('valueFilter', {\n                    values: values,\n                    blanks: blanks\n                });\n            },\n            valueSelect: function (e) {\n                e.preventDefault();\n                var node = e.sender.dataItem(e.node);\n                node.set('checked', !node.checked);\n            },\n            hasActiveSearch: false,\n            appendToSearch: false,\n            filterValues: function (e) {\n                var query = typeof e == 'string' ? e : $(e.target).val().toLowerCase();\n                var dataSource = this.valuesDataSource;\n                this.set('hasActiveSearch', !!query);\n                var filterSpread = filter.bind(this.valueFilter);\n                uncheckAll(dataSource);\n                filterSpread(dataSource, query);\n            },\n            reset: function () {\n                this.set('customFilter', {\n                    logic: 'and',\n                    criteria: [{\n                            operator: null,\n                            value: null\n                        }]\n                });\n                this.set('valueFilter', { values: [] });\n            },\n            operatorChange: function (e) {\n                var dataItem = e.sender.dataItem();\n                this.set('operatorType', dataItem.type);\n                if (!this.get('customFilter')) {\n                    this.reset();\n                }\n                this.set('customFilter.criteria[0].operator', dataItem.value);\n            },\n            isNone: function () {\n                return this.get('operatorType') === undefined;\n            },\n            isString: function () {\n                return this.get('operatorType') === 'string';\n            },\n            isNumber: function () {\n                return this.get('operatorType') === 'number';\n            },\n            isDate: function () {\n                return this.get('operatorType') === 'date';\n            }\n        });\n        function flattenOperators(operators) {\n            var messages = FILTERMENU_MESSAGES.operators;\n            var result = [];\n            for (var type in operators) {\n                if (!operators.hasOwnProperty(type)) {\n                    continue;\n                }\n                for (var operator in operators[type]) {\n                    if (!operators[type].hasOwnProperty(operator)) {\n                        continue;\n                    }\n                    result.push({\n                        text: messages[type][operator],\n                        value: operator,\n                        unique: type + '_' + operator,\n                        type: type\n                    });\n                }\n            }\n            return result;\n        }\n        var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n            valuesTree: function (range, column) {\n                return [{\n                        text: 'All',\n                        expanded: true,\n                        checked: false,\n                        items: this.values(range.resize({ top: 1 }), column)\n                    }];\n            },\n            values: function (range, column) {\n                var values = [];\n                var messages = FILTERMENU_MESSAGES;\n                var columnRange = range.column(column);\n                var sheet = range.sheet();\n                columnRange.forEachCell(function (row, col, cell) {\n                    var checked = true;\n                    if (sheet.isHiddenRow(row)) {\n                        checked = false;\n                    }\n                    var value = cell.value;\n                    var dataType = cell.dataType;\n                    var text = cell.text;\n                    if (value === undefined) {\n                        dataType = 'blank';\n                    } else if (cell.format) {\n                        dataType = kendo.spreadsheet.formatting.type(value, cell.format);\n                    } else {\n                        dataType = typeof value;\n                    }\n                    if (value !== null && cell.format) {\n                        text = kendo.spreadsheet.formatting.text(value, cell.format);\n                    } else {\n                        text = dataType == 'blank' ? messages.blanks : value;\n                    }\n                    if (dataType === 'percent' || dataType === 'currency') {\n                        dataType = 'number';\n                    }\n                    if (dataType === 'date') {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n                    values.push({\n                        dataType: dataType,\n                        value: value,\n                        text: text,\n                        checked: checked\n                    });\n                });\n                values = distinctValues(values);\n                values.sort(function (a, b) {\n                    if (a.dataType === b.dataType) {\n                        return 0;\n                    }\n                    if (a.dataType === 'blank' || b.dataType === 'blank') {\n                        return a.dataType === 'blank' ? -1 : 1;\n                    }\n                    if (a.dataType === 'number' || b.dataType === 'number') {\n                        return a.dataType === 'number' ? -1 : 1;\n                    }\n                    if (a.dataType === 'date' || b.dataType === 'date') {\n                        return a.dataType === 'date' ? -1 : 1;\n                    }\n                    return 0;\n                });\n                return values;\n            },\n            filterType: function (range, column) {\n                var sheet = range.sheet();\n                var filter = this.filterForColumn(column, sheet);\n                var type;\n                filter = filter && filter.filter.toJSON();\n                if (filter && filter.filter == 'custom') {\n                    var value = filter.criteria[0].value;\n                    if (value instanceof Date) {\n                        type = 'date';\n                    } else if (typeof value == 'string') {\n                        type = 'string';\n                    } else if (typeof value == 'number') {\n                        type = 'number';\n                    }\n                }\n                if (!type) {\n                    var topValue = this.values(range.row(1), column)[0];\n                    type = topValue && topValue.dataType;\n                    if (type == 'blank') {\n                        type = null;\n                    }\n                }\n                return type;\n            },\n            filterForColumn: function (column, sheet) {\n                var allFilters = sheet.filter();\n                var filters;\n                if (allFilters) {\n                    filters = allFilters.columns.filter(function (item) {\n                        return item.index === column;\n                    })[0];\n                }\n                return filters;\n            },\n            filter: function (column, sheet) {\n                var columnFilters = this.filterForColumn(column, sheet);\n                if (!columnFilters) {\n                    return;\n                }\n                var options = columnFilters.filter.toJSON();\n                var type = options.filter;\n                delete options.filter;\n                var result = {\n                    type: type,\n                    options: options\n                };\n                var criteria = options.criteria;\n                if (criteria && criteria.length) {\n                    result.operator = criteria[0].operator;\n                }\n                return result;\n            }\n        };\n        var FilterMenu = Widget.extend({\n            init: function (element, options) {\n                Widget.call(this, element, options);\n                this.element.addClass(FilterMenu.classNames.wrapper);\n                this.viewModel = new FilterMenuViewModel({\n                    active: 'value',\n                    operator: null,\n                    operators: flattenOperators(this.options.operators),\n                    clear: this.clear.bind(this),\n                    apply: this.apply.bind(this)\n                });\n                this._filterInit();\n                this._popup();\n                this._sort();\n                this._filterByCondition();\n                this._filterByValue();\n                this._actionButtons();\n            },\n            options: {\n                name: 'FilterMenu',\n                column: 0,\n                range: null,\n                operators: {\n                    string: {\n                        contains: 'Text contains',\n                        doesnotcontain: 'Text does not contain',\n                        startswith: 'Text starts with',\n                        endswith: 'Text ends with',\n                        matches: 'Text matches',\n                        doesnotmatch: 'Text does not match'\n                    },\n                    date: {\n                        eq: 'Date is',\n                        neq: 'Date is not',\n                        lt: 'Date is before',\n                        gt: 'Date is after'\n                    },\n                    number: {\n                        eq: 'Is equal to',\n                        neq: 'Is not equal to',\n                        gte: 'Is greater than or equal to',\n                        gt: 'Is greater than',\n                        lte: 'Is less than or equal to',\n                        lt: 'Is less than'\n                    }\n                }\n            },\n            events: ['action'],\n            destroy: function () {\n                Widget.fn.destroy.call(this);\n                this.menu.destroy();\n                this.valuesTreeView.destroy();\n                this.popup.destroy();\n            },\n            openFor: function (anchor) {\n                this.popup.setOptions({ anchor: anchor });\n                this.popup.open();\n            },\n            close: function () {\n                this.popup.close();\n            },\n            clear: function () {\n                this.action({\n                    command: 'ClearFilterCommand',\n                    options: { column: this.options.column }\n                });\n                this.viewModel.reset();\n                this.close();\n            },\n            apply: function () {\n                this._active();\n                var options = {\n                    operatingRange: this.options.range,\n                    column: this.options.column\n                };\n                var valueFilter;\n                var customFilter;\n                if (this.viewModel.active === 'value') {\n                    this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                    valueFilter = this.viewModel.valueFilter.toJSON();\n                    if (valueFilter.blanks || valueFilter.values && valueFilter.values.length) {\n                        options.valueFilter = valueFilter;\n                    }\n                } else if (this.viewModel.active === 'custom') {\n                    customFilter = this.viewModel.customFilter.toJSON();\n                    if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                        options.customFilter = customFilter;\n                    }\n                }\n                if (options.valueFilter || options.customFilter) {\n                    this.action({\n                        command: 'ApplyFilterCommand',\n                        options: options\n                    });\n                }\n            },\n            action: function (options) {\n                this.trigger('action', $.extend({}, options));\n            },\n            _filterInit: function () {\n                var column = this.options.column;\n                var range = this.options.range;\n                var sheet = range.sheet();\n                var activeFilter = FilterMenuController.filter(column, sheet);\n                if (activeFilter) {\n                    var filterType = FilterMenuController.filterType(range, column);\n                    this.viewModel.set('active', activeFilter.type);\n                    this.viewModel.set(activeFilter.type + 'Filter', activeFilter.options);\n                    if (activeFilter.type == 'custom') {\n                        this.viewModel.set('operator', filterType + '_' + activeFilter.operator);\n                        this.viewModel.set('operatorType', filterType);\n                    }\n                } else {\n                    this.viewModel.reset();\n                }\n            },\n            _popup: function () {\n                this.popup = this.element.kendoPopup({ copyAnchorStyles: false }).data('kendoPopup');\n            },\n            _sort: function () {\n                var template = kendo.template(FilterMenu.templates.menuItem);\n                var messages = FILTERMENU_MESSAGES;\n                var items = [\n                    {\n                        command: 'sort',\n                        dir: 'asc',\n                        text: messages.sortAscending,\n                        iconClass: 'sort-asc'\n                    },\n                    {\n                        command: 'sort',\n                        dir: 'desc',\n                        text: messages.sortDescending,\n                        iconClass: 'sort-desc'\n                    }\n                ];\n                var ul = $('<ul />', { 'html': kendo.render(template, items) }).appendTo(this.element);\n                this.menu = ul.kendoMenu({\n                    orientation: 'vertical',\n                    select: function (e) {\n                        var dir = $(e.item).data('dir');\n                        var range = this.options.range.resize({ top: 1 });\n                        var options = {\n                            value: dir,\n                            sheet: false,\n                            operatingRange: range,\n                            column: this.options.column\n                        };\n                        if (range.isSortable()) {\n                            this.action({\n                                command: 'SortCommand',\n                                options: options\n                            });\n                        } else {\n                            this.close();\n                        }\n                    }.bind(this)\n                }).data('kendoMenu');\n            },\n            _appendTemplate: function (template, className, details, expanded) {\n                var compiledTemplate = kendo.template(template);\n                var wrapper = $('<div class=\\'' + className + '\\'/>').html(compiledTemplate({\n                    messages: FILTERMENU_MESSAGES,\n                    guid: kendo.guid(),\n                    ns: kendo.ns\n                }));\n                this.element.append(wrapper);\n                if (details) {\n                    details = new Details(wrapper, {\n                        expanded: expanded,\n                        toggle: this._detailToggle.bind(this)\n                    });\n                }\n                kendo.bind(wrapper, this.viewModel);\n                return wrapper;\n            },\n            _detailToggle: function (e) {\n                this.element.find('[data-role=details]').not(e.sender.element).data('kendoDetails').toggle(!e.show);\n            },\n            _filterByCondition: function () {\n                var isExpanded = this.viewModel.active === 'custom';\n                this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n            },\n            _filterByValue: function () {\n                var isExpanded = this.viewModel.active === 'value';\n                var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n                this.valuesTreeView = wrapper.find('[data-role=treeview]').data('kendoTreeView');\n                var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n                this.viewModel.set('valuesDataSource', new kendo.data.HierarchicalDataSource({ data: values }));\n            },\n            _actionButtons: function () {\n                this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n            },\n            _active: function () {\n                var activeContainer = this.element.find('[data-role=details]').filter(function (index, element) {\n                    return $(element).data('kendoDetails').visible();\n                });\n                if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                    this.viewModel.set('active', 'value');\n                } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                    this.viewModel.set('active', 'custom');\n                }\n            }\n        });\n        kendo.spreadsheet.FilterMenu = FilterMenu;\n        $.extend(true, FilterMenu, {\n            classNames: classNames,\n            templates: templates\n        });\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/editor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var SheetEditor = kendo.Observable.extend({\n            init: function (view) {\n                kendo.Observable.fn.init.call(this);\n                this.view = view;\n                this.formulaBar = view.formulaBar;\n                this._active = false;\n                this.barInput = view.formulaBar.formulaInput;\n                this.cellInput = view.formulaInput;\n                this.barInput.syncWith(this.cellInput);\n                this.cellInput.syncWith(this.barInput);\n                this.barInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.cellInput.bind('keyup', this._triggerUpdate.bind(this));\n                this.barInput.bind('blur', this._blur.bind(this));\n                this.cellInput.bind('blur', this._blur.bind(this));\n            },\n            events: [\n                'activate',\n                'deactivate',\n                'change',\n                'update'\n            ],\n            _blur: function () {\n                this.deactivate();\n            },\n            _triggerUpdate: function () {\n                this.trigger('update', { value: this.value() });\n            },\n            activeEditor: function () {\n                var editor = null;\n                var activeElement = kendo._activeElement();\n                if (this.barElement()[0] === activeElement) {\n                    editor = this.barInput;\n                } else if (this.cellElement()[0] === activeElement) {\n                    editor = this.cellInput;\n                }\n                return editor;\n            },\n            activate: function (options) {\n                this._active = true;\n                this._rect = options.rect;\n                this._range = options.range;\n                this.cellInput.position(options.rect);\n                this.cellInput.resize(options.rect);\n                this.cellInput.tooltip(options.tooltip);\n                this.cellInput.activeCell = this.barInput.activeCell = this._range.topLeft();\n                this.cellInput.activeSheet = this.barInput.activeSheet = this._range._sheet;\n                this.trigger('activate');\n                return this;\n            },\n            deactivate: function () {\n                var cellInput = this.cellInput;\n                if (!this._active) {\n                    return;\n                }\n                if (cellInput.value() != this._value) {\n                    this.trigger('change', {\n                        value: cellInput.value(),\n                        range: this._range\n                    });\n                }\n                this._active = false;\n                this._rect = null;\n                cellInput.hide();\n                this.trigger('deactivate');\n            },\n            enable: function (enable) {\n                this.barInput.enable(enable);\n                this.cellInput.enable(enable);\n            },\n            barElement: function () {\n                return this.barInput.element;\n            },\n            cellElement: function () {\n                return this.cellInput.element;\n            },\n            focus: function (inputType) {\n                inputType = inputType || 'cell';\n                if (inputType === 'cell') {\n                    this.cellInput.element.focus();\n                    this.cellInput.end();\n                } else {\n                    this.barInput.element.focus();\n                }\n            },\n            isActive: function () {\n                return this._active;\n            },\n            isFiltered: function () {\n                return this.barInput.popup.visible() || this.cellInput.popup.visible();\n            },\n            canInsertRef: function (isKeyboardAction) {\n                var editor = this.activeEditor();\n                return editor && editor.canInsertRef(isKeyboardAction);\n            },\n            highlightedRefs: function () {\n                var editor = this.activeEditor();\n                var refs = [];\n                if (editor) {\n                    refs = editor.highlightedRefs();\n                }\n                return refs;\n            },\n            scale: function () {\n                this.cellInput.scale();\n            },\n            toggleTooltip: function (rect) {\n                this.cellInput.toggleTooltip(notEqual(this._rect, rect));\n            },\n            value: function (value) {\n                if (value === undefined) {\n                    return this.barInput.value();\n                }\n                if (value === null) {\n                    value = '';\n                }\n                this._value = value;\n                this.barInput.value(value);\n                this.cellInput.value(value);\n            },\n            insertNewline: function () {\n                this.activeEditor().insertNewline();\n                this.scale();\n            },\n            select: function () {\n                this.activeEditor().select();\n            }\n        });\n        function notEqual(oldRect, newRect) {\n            return oldRect && (oldRect.top !== newRect.top || oldRect.left !== newRect.left);\n        }\n        kendo.spreadsheet.SheetEditor = SheetEditor;\n    }(kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/autofill', [\n        'spreadsheet/runtime',\n        'spreadsheet/range'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var Range = spreadsheet.Range;\n    var runtime = spreadsheet.calc.runtime;\n    var Formula = runtime.Formula;\n    var ERR_INCOMPATIBLE = 'incompatibleRanges';\n    var ERR_NO_DIRECTION = 'noFillDirection';\n    var FillError = Range.FillError = function (msg) {\n        this.code = msg;\n    };\n    Range.prototype._previewFillFrom = function (srcRange, direction) {\n        var destRange = this, sheet = destRange._sheet;\n        if (typeof srcRange == 'string') {\n            srcRange = sheet.range(srcRange);\n        }\n        var src = srcRange._ref.toRangeRef();\n        var dest = destRange._ref.toRangeRef();\n        if (src.intersects(dest)) {\n            if (src.eq(dest)) {\n                return null;\n            }\n            dest = dest.clone();\n            if (src.topLeft.eq(dest.topLeft)) {\n                if (src.width() == dest.width()) {\n                    dest.topLeft.row += src.height();\n                    direction = 0;\n                } else if (src.height() == dest.height()) {\n                    dest.topLeft.col += src.width();\n                    direction = 1;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else if (src.bottomRight.eq(dest.bottomRight)) {\n                if (src.width() == dest.width()) {\n                    dest.bottomRight.row -= src.height();\n                    direction = 2;\n                } else if (src.height() == dest.height()) {\n                    dest.bottomRight.col -= src.width();\n                    direction = 3;\n                } else {\n                    throw new FillError(ERR_INCOMPATIBLE);\n                }\n            } else {\n                throw new FillError(ERR_INCOMPATIBLE);\n            }\n            return sheet.range(dest)._previewFillFrom(srcRange, direction);\n        }\n        if (direction == null) {\n            if (src.topLeft.col == dest.topLeft.col) {\n                direction = src.topLeft.row < dest.topLeft.row ? 0 : 2;\n            } else if (src.topLeft.row == dest.topLeft.row) {\n                direction = src.topLeft.col < dest.topLeft.col ? 1 : 3;\n            } else {\n                throw new FillError(ERR_NO_DIRECTION);\n            }\n        }\n        var horizontal = direction & 1;\n        var descending = direction & 2;\n        if (horizontal && src.height() != dest.height() || !horizontal && src.width() != dest.width()) {\n            throw new FillError(ERR_INCOMPATIBLE);\n        }\n        var data = srcRange._properties(), n;\n        if (!horizontal) {\n            data = transpose(data);\n            n = dest.height();\n        } else {\n            n = dest.width();\n        }\n        var fill = new Array(data.length);\n        for (var i = 0; i < data.length; ++i) {\n            var s = data[i];\n            var f = findSeries(s);\n            var a = fill[i] = new Array(n);\n            for (var j = 0; j < n; ++j) {\n                var idx = descending ? -j - 1 : s.length + j;\n                var srcIdx = descending ? s.length - j % s.length - 1 : j % s.length;\n                a[descending ? n - j - 1 : j] = f(idx, srcIdx);\n            }\n        }\n        if (!horizontal) {\n            fill = transpose(fill);\n        }\n        return {\n            props: fill,\n            direction: direction,\n            dest: destRange\n        };\n    };\n    Range.prototype.fillFrom = function (srcRange, direction) {\n        var x = this._previewFillFrom(srcRange, direction);\n        x.dest._properties(x.props);\n        return x.dest;\n    };\n    function linearRegression(data) {\n        var N = data.length;\n        var mx = (N + 1) / 2, my = data.reduce(function (a, b) {\n                return a + b;\n            }, 0) / N;\n        var s1 = 0, s2 = 0;\n        for (var i = 0; i < N; i++) {\n            var t1 = i + 1 - mx, t2 = data[i] - my;\n            s1 += t1 * t2;\n            s2 += t1 * t1;\n        }\n        if (!s2) {\n            return function (N) {\n                return data[N % data.length];\n            };\n        }\n        var b = s1 / s2, a = my - b * mx;\n        return function (N) {\n            return a + b * (N + 1);\n        };\n    }\n    function findSeries(properties) {\n        function findStep(a) {\n            var diff = a[1] - a[0];\n            for (var i = 2; i < a.length; ++i) {\n                if (a[i] - a[i - 1] != diff) {\n                    return null;\n                }\n            }\n            return diff;\n        }\n        function getData(a) {\n            return a.map(function (v) {\n                return v.number;\n            });\n        }\n        var series = [];\n        var data = properties.map(function (x) {\n            return x.formula || x.value;\n        });\n        forEachSeries(data, function (begin, end, type, a) {\n            var f, values;\n            if (type == 'number') {\n                values = getData(a);\n                f = linearRegression(values);\n            } else if (type == 'string' || type == 'formula' || type == 'boolean') {\n                f = function (N, i) {\n                    return data[i];\n                };\n            } else if (Array.isArray(type)) {\n                if (a.length == 1) {\n                    f = function (N) {\n                        return type[(a[0].number + N) % type.length];\n                    };\n                } else {\n                    var diff = findStep(getData(a));\n                    if (diff == null) {\n                        f = function (N) {\n                            return a[N % a.length].value;\n                        };\n                    } else {\n                        f = function (N) {\n                            var idx = a[0].number + diff * N;\n                            return type[idx % type.length];\n                        };\n                    }\n                }\n            } else if (type != 'null') {\n                values = getData(a);\n                if (values.length == 1) {\n                    values.push(values[0] + 1);\n                }\n                values = linearRegression(values);\n                f = function (N, i) {\n                    return data[i].replace(/^(.*\\D)\\d+/, '$1' + values(N, i));\n                };\n            } else {\n                f = function () {\n                    return null;\n                };\n            }\n            var s = {\n                f: f,\n                begin: begin,\n                end: end,\n                len: end - begin\n            };\n            for (var i = begin; i < end; ++i) {\n                series[i] = s;\n            }\n        });\n        return function (N, i) {\n            var s = series[i];\n            var q = N / data.length | 0;\n            var r = N % data.length;\n            var n = q * s.len + r - s.begin;\n            var value = s.f(n, i);\n            var props = clone(properties[i]);\n            delete props.enable;\n            if (value instanceof Formula) {\n                props.formula = value;\n            } else {\n                props.value = value;\n            }\n            return props;\n        };\n    }\n    function clone(obj) {\n        var copy = {};\n        Object.keys(obj || {}).forEach(function (key) {\n            copy[key] = obj[key];\n        });\n        return copy;\n    }\n    function forEachSeries(data, f) {\n        var prev = null, start = 0, a = [], type;\n        for (var i = 0; i < data.length; ++i) {\n            type = getType(data[i]);\n            a.push(type);\n            if (prev != null && type.type !== prev.type) {\n                f(start, i, prev.type, a.slice(start, i));\n                start = i;\n            }\n            prev = type;\n        }\n        f(start, i, prev.type, a.slice(start, i));\n    }\n    function getType(el) {\n        if (typeof el == 'number') {\n            return {\n                type: 'number',\n                number: el\n            };\n        }\n        if (typeof el == 'string') {\n            var lst = findStringList(el);\n            if (lst) {\n                return lst;\n            }\n            var m = /^(.*\\D)(\\d+)/.exec(el);\n            if (m) {\n                el = el.replace(/^(.*\\D)\\d+/, '$1-######');\n                return {\n                    type: el,\n                    match: m,\n                    number: parseFloat(m[2])\n                };\n            }\n            return { type: 'string' };\n        }\n        if (typeof el == 'boolean') {\n            return { type: 'boolean' };\n        }\n        if (el == null) {\n            return { type: 'null' };\n        }\n        if (el instanceof Formula) {\n            return { type: 'formula' };\n        }\n        window.console.error(el);\n        throw new Error('Cannot fill data');\n    }\n    function stringLists() {\n        var culture = kendo.culture();\n        return [\n            culture.calendars.standard.days.namesAbbr,\n            culture.calendars.standard.days.names,\n            culture.calendars.standard.months.namesAbbr,\n            culture.calendars.standard.months.names\n        ];\n    }\n    function findStringList(str) {\n        var strl = str.toLowerCase();\n        var lists = stringLists();\n        for (var i = 0; i < lists.length; ++i) {\n            var a = lists[i];\n            for (var j = a.length; --j >= 0;) {\n                var el = a[j].toLowerCase();\n                if (el == strl) {\n                    return {\n                        type: a,\n                        number: j,\n                        value: str\n                    };\n                }\n            }\n        }\n    }\n    function transpose(a) {\n        var height = a.length, width = a[0].length;\n        var t = [];\n        for (var i = 0; i < width; ++i) {\n            t[i] = [];\n            for (var j = 0; j < height; ++j) {\n                t[i][j] = a[j][i];\n            }\n        }\n        return t;\n    }\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/nameeditor', ['kendo.core'], f);\n}(function () {\n    (function (kendo) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var CLASS_NAMES = {\n            input: 'k-spreadsheet-name-editor',\n            list: 'k-spreadsheet-name-list'\n        };\n        var NameEditor = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                kendo.ui.Widget.call(this, element, options);\n                element.addClass(CLASS_NAMES.input);\n                var comboBoxTitle = options.messages.nameBox || 'Name Box';\n                var dataSource = new kendo.data.DataSource({\n                    transport: {\n                        read: function (options) {\n                            var data = [];\n                            this._workbook.forEachName(function (def) {\n                                if (!def.hidden && def.value instanceof kendo.spreadsheet.Ref) {\n                                    data.push({ name: def.name });\n                                }\n                            });\n                            options.success(data);\n                        }.bind(this),\n                        cache: false\n                    }\n                });\n                var comboElement = $('<input />').attr('title', comboBoxTitle).attr('aria-label', comboBoxTitle);\n                this.combo = comboElement.appendTo(element).kendoComboBox({\n                    clearButton: false,\n                    dataTextField: 'name',\n                    dataValueField: 'name',\n                    template: '#:data.name#<a class=\\'k-button-delete\\' href=\\'\\\\#\\'><span class=\\'k-icon k-i-close\\'></span></a>',\n                    dataSource: dataSource,\n                    autoBind: false,\n                    ignoreCase: true,\n                    change: this._on_listChange.bind(this),\n                    noDataTemplate: '<div></div>',\n                    open: function () {\n                        dataSource.read();\n                    }\n                }).getKendoComboBox();\n                this.combo.input.on('keydown', this._on_keyDown.bind(this)).on('focus', this._on_focus.bind(this));\n                this.combo.popup.element.addClass('k-spreadsheet-names-popup').on('mousemove', function (ev) {\n                    ev.stopPropagation();\n                }).on('click', '.k-button-delete', function (ev) {\n                    ev.preventDefault();\n                    ev.stopPropagation();\n                    var item = $(ev.target).closest('.k-item');\n                    item = this.combo.dataItem(item);\n                    this._deleteItem(item.name);\n                }.bind(this));\n            },\n            value: function (val) {\n                if (val === undefined) {\n                    return this.combo.value();\n                } else {\n                    this.combo.value(val);\n                }\n            },\n            _deleteItem: function (name) {\n                this.trigger('delete', { name: name });\n            },\n            _on_keyDown: function (ev) {\n                switch (ev.keyCode) {\n                case 27:\n                    this.combo.value(this._prevValue);\n                    this.trigger('cancel');\n                    break;\n                case 13:\n                    this.trigger('enter');\n                    break;\n                }\n            },\n            _on_focus: function () {\n                this._prevValue = this.combo.value();\n            },\n            _on_listChange: function () {\n                var name = this.combo.value();\n                if (name) {\n                    this.trigger('select', { name: name });\n                }\n            }\n        });\n        kendo.spreadsheet.NameEditor = NameEditor;\n    }(window.kendo));\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('spreadsheet/print', [\n        'kendo.pdf',\n        'spreadsheet/sheet',\n        'spreadsheet/range',\n        'spreadsheet/references',\n        'spreadsheet/numformat',\n        'util/text-metrics'\n    ], f);\n}(function () {\n    'use strict';\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n    var spreadsheet = kendo.spreadsheet;\n    var CellRef = spreadsheet.CellRef;\n    var drawing = kendo.drawing;\n    var formatting = spreadsheet.formatting;\n    var geo = kendo.geometry;\n    var GUIDELINE_WIDTH = 0.8;\n    function distributeCoords(heights, pageHeight) {\n        var curr = 0;\n        var out = [];\n        var threshold = 0.2 * pageHeight;\n        var bottom = pageHeight;\n        heights.forEach(function (h) {\n            if (pageHeight && curr + h > bottom) {\n                if (bottom - curr < threshold) {\n                    curr = pageHeight * Math.ceil(curr / pageHeight);\n                }\n                bottom += pageHeight * Math.ceil(h / pageHeight);\n            }\n            out.push(curr);\n            curr += h;\n        });\n        out.push(curr);\n        return out;\n    }\n    function doLayout(sheet, range, options) {\n        var grid = sheet._grid;\n        range = grid.normalize(range);\n        var cells = [];\n        var rowHeights = [];\n        var colWidths = [];\n        var mergedCells = sheet._getMergedCells(range);\n        var maxRow = -1, maxCol = -1;\n        sheet.forEach(range, function (row, col, cell) {\n            var relrow = row - range.topLeft.row;\n            var relcol = col - range.topLeft.col;\n            var rh = sheet.rowHeight(row);\n            var cw = sheet.columnWidth(col);\n            if (!relcol) {\n                rowHeights.push(rh);\n            }\n            if (!relrow) {\n                colWidths.push(cw);\n            }\n            if (sheet.isHiddenColumn(col) || sheet.isHiddenRow(row) || !rh || !cw) {\n                return;\n            }\n            var nonEmpty = options.forScreen || shouldDrawCell(cell);\n            if (!(options.emptyCells || nonEmpty)) {\n                return;\n            }\n            var id = new CellRef(row, col).print();\n            if (mergedCells.secondary[id]) {\n                return;\n            }\n            if (nonEmpty) {\n                maxRow = Math.max(maxRow, relrow);\n                maxCol = Math.max(maxCol, relcol);\n            } else {\n                cell.empty = true;\n            }\n            cell.row = relrow;\n            cell.col = relcol;\n            var m = mergedCells.primary[id];\n            if (m) {\n                delete mergedCells.primary[id];\n                cell.merged = true;\n                cell.rowspan = m.height();\n                cell.colspan = m.width();\n                if (options.forScreen) {\n                    cell.width = sheet._columns.sum(m.topLeft.col, m.bottomRight.col);\n                    cell.height = sheet._rows.sum(m.topLeft.row, m.bottomRight.row);\n                }\n            } else {\n                cell.rowspan = 1;\n                cell.colspan = 1;\n            }\n            cells.push(cell);\n        });\n        rowHeights = rowHeights.slice(0, maxRow + 1);\n        colWidths = colWidths.slice(0, maxCol + 1);\n        var pageWidth = Math.floor(options.pageWidth);\n        var pageHeight = Math.floor(options.pageHeight);\n        var scaleFactor = 1;\n        if (options.fitWidth) {\n            var width = colWidths.reduce(sum, 0);\n            if (width > pageWidth) {\n                scaleFactor = pageWidth / width;\n                pageWidth /= scaleFactor;\n                pageHeight /= scaleFactor;\n            }\n        }\n        var yCoords = distributeCoords(rowHeights, pageHeight || 0);\n        var xCoords = distributeCoords(colWidths, pageWidth || 0);\n        var boxWidth = 0;\n        var boxHeight = 0;\n        cells = cells.filter(function (cell) {\n            if (cell.empty && (cell.row > maxRow || cell.col > maxCol)) {\n                return false;\n            }\n            cell.left = xCoords[cell.col];\n            cell.top = yCoords[cell.row];\n            if (cell.merged) {\n                if (!options.forScreen) {\n                    cell.right = orlast(xCoords, cell.col + cell.colspan);\n                    cell.bottom = orlast(yCoords, cell.row + cell.rowspan);\n                    cell.width = cell.right - cell.left;\n                    cell.height = cell.bottom - cell.top;\n                } else {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                }\n            } else {\n                cell.width = colWidths[cell.col];\n                cell.height = rowHeights[cell.row];\n                cell.bottom = cell.top + cell.height;\n                cell.right = cell.left + cell.width;\n            }\n            boxWidth = Math.max(boxWidth, cell.right);\n            boxHeight = Math.max(boxHeight, cell.bottom);\n            return true;\n        });\n        Object.keys(mergedCells.primary).forEach(function (id) {\n            var ref = mergedCells.primary[id];\n            sheet.forEach(ref.topLeft.toRangeRef(), function (row, col, cell) {\n                var relrow = row - range.topLeft.row;\n                var relcol = col - range.topLeft.col;\n                cell.merged = true;\n                cell.colspan = ref.width();\n                cell.rowspan = ref.height();\n                if (relrow < 0) {\n                    cell.top = -sheet._rows.sum(row, row - relrow - 1);\n                } else {\n                    cell.top = yCoords[relrow];\n                }\n                if (relcol < 0) {\n                    cell.left = -sheet._columns.sum(col, col - relcol - 1);\n                } else {\n                    cell.left = xCoords[relcol];\n                }\n                cell.height = sheet._rows.sum(ref.topLeft.row, ref.bottomRight.row);\n                cell.width = sheet._columns.sum(ref.topLeft.col, ref.bottomRight.col);\n                if (cell.height > 0 && cell.width > 0) {\n                    cell.right = cell.left + cell.width;\n                    cell.bottom = cell.top + cell.height;\n                    cell.row = relrow;\n                    cell.col = relcol;\n                    cells.push(cell);\n                }\n            });\n        });\n        return {\n            width: boxWidth,\n            height: boxHeight,\n            cells: cells.sort(normalOrder),\n            scale: scaleFactor,\n            xCoords: xCoords,\n            yCoords: yCoords\n        };\n    }\n    function sameBorder(a, b) {\n        return a.size === b.size && a.color === b.color;\n    }\n    function sum(a, b) {\n        return a + b;\n    }\n    function orlast(a, i) {\n        return i < a.length ? a[i] : a[a.length - 1];\n    }\n    function shouldDrawCell(cell) {\n        return cell.value != null || cell.merged || cell.background != null || cell.borderRight != null || cell.borderBottom != null || cell.validation != null && !cell.validation.value;\n    }\n    function normalOrder(a, b) {\n        if (a.top < b.top) {\n            return -1;\n        } else if (a.top == b.top) {\n            if (a.left < b.left) {\n                return -1;\n            } else if (a.left == b.left) {\n                return 0;\n            } else {\n                return 1;\n            }\n        } else {\n            return 1;\n        }\n    }\n    function drawLayout(sheet, layout, group, options) {\n        var ncols = Math.ceil(layout.width / options.pageWidth);\n        var nrows = Math.ceil(layout.height / options.pageHeight);\n        var pageWidth = options.pageWidth / layout.scale;\n        var pageHeight = options.pageHeight / layout.scale;\n        for (var i = 0; i < ncols; ++i) {\n            for (var j = 0; j < nrows; ++j) {\n                addPage(j, i);\n            }\n        }\n        function addPage(row, col) {\n            var left = col * pageWidth;\n            var right = left + pageWidth;\n            var top = row * pageHeight;\n            var bottom = top + pageHeight;\n            var endbottom = 0, endright = 0;\n            var cells = layout.cells.filter(function (cell) {\n                if (cell.right <= left || cell.left >= right || cell.bottom <= top || cell.top >= bottom) {\n                    return false;\n                }\n                endbottom = Math.max(cell.bottom, endbottom);\n                endright = Math.max(cell.right, endright);\n                return true;\n            });\n            endbottom = Math.min(endbottom, bottom);\n            endright = Math.min(endright, right);\n            if (cells.length > 0) {\n                var page = new drawing.Group();\n                group.append(page);\n                page.clip(drawing.Path.fromRect(new geo.Rect([\n                    0,\n                    0\n                ], [\n                    options.pageWidth,\n                    options.pageHeight\n                ])));\n                var content = new drawing.Group();\n                page.append(content);\n                content.clip(drawing.Path.fromRect(new geo.Rect([\n                    left,\n                    top\n                ], [\n                    endright,\n                    endbottom\n                ])));\n                var matrix = geo.Matrix.scale(layout.scale, layout.scale).multiplyCopy(geo.Matrix.translate(-left, -top));\n                if (options.hCenter || options.vCenter) {\n                    matrix = matrix.multiplyCopy(geo.Matrix.translate(options.hCenter ? (right - endright) / 2 : 0, options.vCenter ? (bottom - endbottom) / 2 : 0));\n                }\n                content.transform(matrix);\n                if (options.guidelines) {\n                    var prev = null;\n                    layout.xCoords.forEach(function (x) {\n                        x = Math.min(x, endright);\n                        if (x !== prev && x >= left && x <= right) {\n                            prev = x;\n                            content.append(new drawing.Path().moveTo(x, top).lineTo(x, endbottom).close().stroke('#aaa', GUIDELINE_WIDTH));\n                        }\n                    });\n                    var prev = null;\n                    layout.yCoords.forEach(function (y) {\n                        y = Math.min(y, endbottom);\n                        if (y !== prev && y >= top && y <= bottom) {\n                            prev = y;\n                            content.append(new drawing.Path().moveTo(left, y).lineTo(endright, y).close().stroke('#aaa', GUIDELINE_WIDTH));\n                        }\n                    });\n                }\n                var borders = Borders();\n                cells.forEach(function (cell) {\n                    drawCell(cell, content, options);\n                    borders.add(cell, sheet);\n                });\n                var bordersGroup = new drawing.Group();\n                borders.vert.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            bordersGroup.append(new drawing.Path().moveTo(b.x, b.top).lineTo(b.x, b.bottom).close().stroke(b.color, b.size));\n                        }\n                    });\n                });\n                borders.horiz.forEach(function (a) {\n                    a.forEach(function (b) {\n                        if (!b.rendered) {\n                            b.rendered = true;\n                            bordersGroup.append(new drawing.Path().moveTo(b.left, b.y).lineTo(b.right, b.y).close().stroke(b.color, b.size));\n                        }\n                    });\n                });\n                content.append(bordersGroup);\n            }\n        }\n    }\n    function drawCell(cell, content, options) {\n        var g = new drawing.Group();\n        content.append(g);\n        var rect = new geo.Rect([\n            cell.left,\n            cell.top\n        ], [\n            cell.width,\n            cell.height\n        ]);\n        if (cell.background || cell.merged) {\n            var r2d2 = rect;\n            if (options.guidelines) {\n                r2d2 = rect.clone();\n                r2d2.origin.x += GUIDELINE_WIDTH / 2;\n                r2d2.origin.y += GUIDELINE_WIDTH / 2;\n                r2d2.size.width -= GUIDELINE_WIDTH;\n                r2d2.size.height -= GUIDELINE_WIDTH;\n            }\n            g.append(new drawing.Rect(r2d2).fill(cell.background || '#fff').stroke(null));\n        }\n        var val = cell.value;\n        if (val != null) {\n            var type = typeof val == 'number' ? 'number' : null;\n            var clip = new drawing.Group();\n            clip.clip(drawing.Path.fromRect(rect));\n            g.append(clip);\n            var f;\n            if (cell.format) {\n                f = formatting.textAndColor(val, cell.format);\n                val = f.text;\n                if (f.type) {\n                    type = f.type;\n                }\n            } else {\n                val += '';\n            }\n            if (!cell.textAlign) {\n                switch (type) {\n                case 'number':\n                case 'date':\n                case 'percent':\n                case 'currency':\n                    cell.textAlign = 'right';\n                    break;\n                case 'boolean':\n                    cell.textAlign = 'center';\n                    break;\n                }\n            }\n            drawText(val, f && f.color || cell.color || '#000', cell, clip);\n        }\n    }\n    var CONT;\n    function drawText(text, color, cell, group) {\n        if (!CONT) {\n            CONT = document.createElement('div');\n            CONT.style.position = 'fixed';\n            CONT.style.left = '-10000px';\n            CONT.style.top = '-10000px';\n            CONT.style.overflow = 'hidden';\n            CONT.style.boxSizing = 'border-box';\n            CONT.style.padding = '2px 4px';\n            CONT.style.lineHeight = 'normal';\n            document.body.appendChild(CONT);\n        }\n        CONT.style.color = color;\n        CONT.style.font = makeFontDef(cell);\n        CONT.style.width = cell.width + 'px';\n        CONT.style.textAlign = cell.textAlign || 'left';\n        CONT.style.textDecoration = cell.underline ? 'underline' : 'none';\n        if (cell.wrap) {\n            CONT.style.whiteSpace = 'pre-wrap';\n            CONT.style.overflowWrap = CONT.style.wordWrap = 'break-word';\n        } else {\n            CONT.style.whiteSpace = 'pre';\n            CONT.style.overflowWrap = CONT.style.wordWrap = 'normal';\n        }\n        if (CONT.firstChild) {\n            CONT.removeChild(CONT.firstChild);\n        }\n        CONT.appendChild(document.createTextNode(text));\n        var vtrans = 0;\n        switch (cell.verticalAlign) {\n        case 'center':\n            vtrans = cell.height - CONT.offsetHeight >> 1;\n            break;\n        case undefined:\n        case null:\n        case 'bottom':\n            vtrans = cell.height - CONT.offsetHeight;\n            break;\n        }\n        if (vtrans < 0) {\n            vtrans = 0;\n        }\n        var text_group = kendo.drawing.drawDOM.drawText(CONT);\n        text_group.transform(geo.Matrix.translate(10000 + cell.left, 10000 + cell.top + vtrans));\n        group.append(text_group);\n    }\n    function makeFontDef(cell) {\n        var font = [];\n        if (cell.italic) {\n            font.push('italic');\n        }\n        if (cell.bold) {\n            font.push('bold');\n        }\n        font.push((cell.fontSize || 12) + 'px');\n        font.push(cell.fontFamily || 'Arial');\n        return font.join(' ');\n    }\n    function draw(sheet, range, options, callback) {\n        if (options == null && callback == null) {\n            callback = range;\n            options = {};\n            range = spreadsheet.SHEETREF;\n        }\n        if (callback == null) {\n            callback = options;\n            if (range instanceof spreadsheet.Range || range instanceof spreadsheet.Ref || typeof range == 'string') {\n                options = {};\n            } else {\n                options = range;\n                range = spreadsheet.SHEETREF;\n            }\n        }\n        options = kendo.jQuery.extend({\n            paperSize: 'A4',\n            landscape: true,\n            margin: '1cm',\n            guidelines: true,\n            emptyCells: true,\n            fitWidth: false,\n            center: false\n        }, options);\n        var group = new drawing.Group();\n        var paper = kendo.pdf.getPaperOptions(options);\n        group.options.set('pdf', {\n            author: options.author,\n            creator: options.creator,\n            date: options.date,\n            keywords: options.keywords,\n            margin: paper.margin,\n            multiPage: true,\n            paperSize: paper.paperSize,\n            subject: options.subject,\n            title: options.title\n        });\n        var pageWidth = paper.paperSize[0];\n        var pageHeight = paper.paperSize[1];\n        if (paper.margin) {\n            pageWidth -= paper.margin.left + paper.margin.right + 1;\n            pageHeight -= paper.margin.top + paper.margin.bottom + 1;\n        }\n        options.pageWidth = pageWidth;\n        options.pageHeight = pageHeight;\n        var layout = doLayout(sheet, sheet._ref(range), options);\n        drawLayout(sheet, layout, group, options);\n        callback(group);\n    }\n    spreadsheet.Sheet.prototype.draw = function (range, options, callback) {\n        var sheet = this;\n        if (sheet._workbook) {\n            sheet.recalc(sheet._workbook._context, function () {\n                draw(sheet, range, options, callback);\n            });\n        } else {\n            draw(sheet, range, options, callback);\n        }\n    };\n    function Container() {\n    }\n    Container.prototype = {\n        forEach: function (f) {\n            Object.keys(this).forEach(function (key) {\n                f(this[key], key, this);\n            }, this);\n        }\n    };\n    function Borders() {\n        var horiz = new Container();\n        var vert = new Container();\n        function add(cell, sheet) {\n            if (sheet) {\n                var pb = sheet._properties;\n                var grid = sheet._grid;\n                cell.borderLeft = pb.get('vBorders', grid.index(cell.row, cell.col));\n                cell.borderRight = pb.get('vBorders', grid.index(cell.row, cell.col + cell.colspan));\n                cell.borderTop = pb.get('hBorders', grid.index(cell.row, cell.col));\n                cell.borderBottom = pb.get('hBorders', grid.index(cell.row + cell.rowspan, cell.col));\n            }\n            if (cell.borderLeft) {\n                addVert(cell.row, cell.col, cell.borderLeft, cell.left, cell.top, cell.bottom);\n            }\n            if (cell.borderRight) {\n                addVert(cell.row, cell.col + cell.colspan, cell.borderRight, cell.right, cell.top, cell.bottom);\n            }\n            if (cell.borderTop) {\n                addHoriz(cell.row, cell.col, cell.borderTop, cell.top, cell.left, cell.right);\n            }\n            if (cell.borderBottom) {\n                addHoriz(cell.row + cell.rowspan, cell.col, cell.borderBottom, cell.bottom, cell.left, cell.right);\n            }\n        }\n        function addVert(row, col, border, x, top, bottom) {\n            var a = vert[col] || (vert[col] = new Container());\n            var prev = row > 0 && a[row - 1];\n            if (prev && sameBorder(prev, border)) {\n                a[row] = prev;\n                prev.bottom = bottom;\n            } else {\n                a[row] = {\n                    size: border.size,\n                    color: border.color,\n                    x: x,\n                    top: top,\n                    bottom: bottom\n                };\n            }\n        }\n        function addHoriz(row, col, border, y, left, right) {\n            var a = horiz[row] || (horiz[row] = new Container());\n            var prev = col > 0 && a[col - 1];\n            if (prev && sameBorder(prev, border)) {\n                a[col] = prev;\n                prev.right = right;\n            } else {\n                a[col] = {\n                    size: border.size,\n                    color: border.color,\n                    y: y,\n                    left: left,\n                    right: right\n                };\n            }\n        }\n        return {\n            add: add,\n            horiz: horiz,\n            vert: vert\n        };\n    }\n    spreadsheet.draw = {\n        Borders: Borders,\n        doLayout: doLayout\n    };\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));\n(function (f, define) {\n    define('kendo.spreadsheet', [\n        'util/undoredostack',\n        'util/text-metrics',\n        'util/parse-xml',\n        'kendo.excel',\n        'kendo.progressbar',\n        'kendo.pdf',\n        'spreadsheet/commands',\n        'spreadsheet/formulabar',\n        'spreadsheet/formulainput',\n        'spreadsheet/eventlistener',\n        'spreadsheet/rangelist',\n        'spreadsheet/propertybag',\n        'spreadsheet/references',\n        'spreadsheet/navigator',\n        'spreadsheet/axismanager',\n        'spreadsheet/clipboard',\n        'spreadsheet/range',\n        'spreadsheet/sheet',\n        'spreadsheet/sheetsbar',\n        'spreadsheet/excel-reader',\n        'spreadsheet/workbook',\n        'spreadsheet/formulacontext',\n        'spreadsheet/controller',\n        'spreadsheet/view',\n        'spreadsheet/customeditors',\n        'spreadsheet/grid',\n        'spreadsheet/axis',\n        'spreadsheet/filter',\n        'spreadsheet/sorter',\n        'spreadsheet/runtime',\n        'spreadsheet/calc',\n        'spreadsheet/numformat',\n        'spreadsheet/runtime.functions',\n        'spreadsheet/runtime.functions.2',\n        'spreadsheet/toolbar',\n        'spreadsheet/dialogs',\n        'spreadsheet/sheetbinder',\n        'spreadsheet/filtermenu',\n        'spreadsheet/editor',\n        'spreadsheet/autofill',\n        'spreadsheet/nameeditor',\n        'spreadsheet/print'\n    ], f);\n}(function () {\n    var __meta__ = {\n        id: 'spreadsheet',\n        name: 'Spreadsheet',\n        category: 'web',\n        description: 'Spreadsheet component',\n        depends: [\n            'core',\n            'binder',\n            'colorpicker',\n            'combobox',\n            'data',\n            'dom',\n            'dropdownlist',\n            'menu',\n            'ooxml',\n            'popup',\n            'sortable',\n            'tabstrip',\n            'toolbar',\n            'treeview',\n            'window',\n            'validator',\n            'excel',\n            'pdf',\n            'drawing'\n        ]\n    };\n    (function (kendo, undefined) {\n        if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n            return;\n        }\n        var $ = kendo.jQuery;\n        var keys = $.extend({\n            F10: 121,\n            F11: 122,\n            B: 66,\n            I: 73,\n            U: 85,\n            N: 78,\n            H: 72,\n            A: 65,\n            PAGEDOWN: 34,\n            PAGEUP: 33,\n            DELETE: 46,\n            R: 82\n        }, kendo.keys);\n        var Widget = kendo.ui.Widget;\n        var Workbook = kendo.spreadsheet.Workbook;\n        var Controller = kendo.spreadsheet.Controller;\n        var View = kendo.spreadsheet.View;\n        var NS = '.kendoSpreadsheet';\n        var ALL_REASONS = {\n            recalc: true,\n            selection: true,\n            activeCell: true,\n            layout: true,\n            sheetSelection: true,\n            resize: true,\n            editorChange: false,\n            editorClose: false\n        };\n        var classNames = { wrapper: 'k-widget k-spreadsheet' };\n        var Spreadsheet = kendo.ui.Widget.extend({\n            init: function (element, options) {\n                Widget.fn.init.call(this, element, options);\n                this.element.addClass(Spreadsheet.classNames.wrapper);\n                this._view = new View(this.element, {\n                    messages: this.options.messages.view,\n                    toolbar: this.options.toolbar,\n                    sheetsbar: this.options.sheetsbar\n                });\n                this._workbook = new Workbook(this.options, this._view);\n                this._controller = new Controller(this._view, this._workbook);\n                this._autoRefresh = true;\n                this._bindWorkbookEvents();\n                this._view.workbook(this._workbook);\n                this._view.enableClipboard(false);\n                this.refresh();\n                this._view.enableClipboard(true);\n                this._resizeHandler = function () {\n                    this.resize();\n                }.bind(this);\n                $(window).on('resize' + NS, this._resizeHandler);\n                this.element.on('keydown' + NS, this._keyDown.bind(this));\n            },\n            _keyDown: function (e) {\n                var key = e.keyCode;\n                if (key === keys.F11 && e.shiftKey) {\n                    this._view.sheetsbar._onAddSelect();\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.PAGEDOWN) {\n                    this._view.sheetsbar.trigger('select', {\n                        name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex + 1].name(),\n                        isAddButton: false\n                    });\n                } else if (e.altKey && key === keys.PAGEUP) {\n                    this._view.sheetsbar.trigger('select', {\n                        name: this._view.sheetsbar._sheets[this._view.sheetsbar._selectedIndex - 1].name(),\n                        isAddButton: false\n                    });\n                } else if (e.altKey && key === keys.DELETE) {\n                    var closeCallback = function (e) {\n                        var dlg = e.sender;\n                        if (dlg.isConfirmed()) {\n                            this._view.sheetsbar.trigger('remove', {\n                                name: this.activeSheet()._name(),\n                                confirmation: true\n                            });\n                        }\n                    }.bind(this);\n                    this._view.sheetsbar._openDialog('confirmation', { close: closeCallback });\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.R) {\n                    this._view.sheetsbar._createEditor();\n                    e.preventDefault();\n                    return;\n                } else if (key === keys.F10 && this._view.tabstrip) {\n                    this._view.tabstrip.toolbars[this._view.tabstrip.element.find('li.k-state-active').text().toLowerCase()].element.find(':not(.k-overflow-anchor):kendoFocusable:first').focus();\n                    this._view.tabstrip.toolbars[this._view.tabstrip.element.find('li.k-state-active').text().toLowerCase()].element.find('.k-toolbar-first-visible').addClass('k-state-focused');\n                    e.preventDefault();\n                    return;\n                } else if (e.ctrlKey && key === keys.B) {\n                    $('[data-tool=bold]')[0].click();\n                } else if (e.ctrlKey && key === keys.I) {\n                    $('[data-tool=italic]')[0].click();\n                } else if (e.ctrlKey && key === keys.U) {\n                    $('[data-tool=underline]')[0].click();\n                } else if (e.altKey && key === keys.H) {\n                    this._view.tabstrip.select(0);\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.N) {\n                    this._view.tabstrip.select(1);\n                    e.preventDefault();\n                    return;\n                } else if (e.altKey && key === keys.A) {\n                    this._view.tabstrip.select(2);\n                    e.preventDefault();\n                    return;\n                }\n            },\n            _resize: function () {\n                this.refresh({ layout: true });\n            },\n            _workbookChange: function (e) {\n                if (this._autoRefresh) {\n                    this.refresh(e);\n                }\n                if (e.recalc && e.ref) {\n                    var range = e.range || new kendo.spreadsheet.Range(e.ref, this.activeSheet());\n                    this.trigger('change', { range: range });\n                }\n            },\n            _workbookCut: function (e) {\n                this.trigger('cut', e);\n            },\n            _workbookCopy: function (e) {\n                this.trigger('copy', e);\n            },\n            _workbookPaste: function (e) {\n                this.trigger('paste', e);\n            },\n            activeSheet: function (sheet) {\n                return this._workbook.activeSheet(sheet);\n            },\n            moveSheetToIndex: function (sheet, index) {\n                return this._workbook.moveSheetToIndex(sheet, index);\n            },\n            insertSheet: function (options) {\n                return this._workbook.insertSheet(options);\n            },\n            sheets: function () {\n                return this._workbook.sheets();\n            },\n            removeSheet: function (sheet) {\n                return this._workbook.removeSheet(sheet);\n            },\n            sheetByName: function (sheetName) {\n                return this._workbook.sheetByName(sheetName);\n            },\n            sheetIndex: function (sheet) {\n                return this._workbook.sheetIndex(sheet);\n            },\n            sheetByIndex: function (index) {\n                return this._workbook.sheetByIndex(index);\n            },\n            renameSheet: function (sheet, newSheetName) {\n                return this._workbook.renameSheet(sheet, newSheetName);\n            },\n            refresh: function (reason) {\n                if (!reason) {\n                    reason = ALL_REASONS;\n                }\n                if (!reason.editorClose) {\n                    this._view.sheet(this._workbook.activeSheet());\n                    this._controller.sheet(this._workbook.activeSheet());\n                    this._workbook.refresh(reason);\n                }\n                if (!reason.editorChange) {\n                    this._view.refresh(reason);\n                    this._controller.refresh();\n                    this._view.render();\n                    this.trigger('render');\n                }\n                return this;\n            },\n            openDialog: function (name, options) {\n                return this._view.openDialog(name, options);\n            },\n            autoRefresh: function (value) {\n                if (value !== undefined) {\n                    this._autoRefresh = value;\n                    if (value === true) {\n                        this.refresh();\n                    }\n                    return this;\n                }\n                return this._autoRefresh;\n            },\n            toJSON: function () {\n                return this._workbook.toJSON();\n            },\n            fromJSON: function (json) {\n                if (json.sheets) {\n                    this._workbook.destroy();\n                    this._workbook = new Workbook($.extend({}, this.options, json));\n                    this._bindWorkbookEvents();\n                    this._view.workbook(this._workbook);\n                    this._controller.workbook(this._workbook);\n                    this.activeSheet(this.activeSheet());\n                } else {\n                    this.refresh();\n                }\n            },\n            fromFile: function (blob, name) {\n                return this._workbook.fromFile(blob, name);\n            },\n            saveAsPDF: function (options) {\n                this._workbook.saveAsPDF($.extend({}, this.options.pdf, options, { workbook: this._workbook }));\n            },\n            saveAsExcel: function (options) {\n                this._workbook.saveAsExcel(options);\n            },\n            draw: function (options, callback) {\n                this._workbook.draw(options, callback);\n            },\n            _workbookExcelExport: function (e) {\n                if (this.trigger('excelExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookExcelImport: function (e) {\n                if (this.trigger('excelImport', e)) {\n                    e.preventDefault();\n                } else {\n                    this._initProgress(e.promise);\n                }\n            },\n            _initProgress: function (deferred) {\n                var loading = $('<div class=\\'k-loading-mask\\' ' + 'style=\\'width: 100%; height: 100%; top: 0;\\'>' + '<div class=\\'k-loading-color\\'/>' + '</div>').appendTo(this.element);\n                var pb = $('<div class=\\'k-loading-progress\\'>').appendTo(loading).kendoProgressBar({\n                    type: 'chunk',\n                    chunkCount: 10,\n                    min: 0,\n                    max: 1,\n                    value: 0\n                }).data('kendoProgressBar');\n                deferred.progress(function (e) {\n                    pb.value(e.progress);\n                }).always(function () {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n            },\n            _workbookPdfExport: function (e) {\n                if (this.trigger('pdfExport', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertSheet: function (e) {\n                if (this.trigger('insertSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookRemoveSheet: function (e) {\n                if (this.trigger('removeSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookSelectSheet: function (e) {\n                if (this.trigger('selectSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookRenameSheet: function (e) {\n                if (this.trigger('renameSheet', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertRow: function (e) {\n                if (this.trigger('insertRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookInsertColumn: function (e) {\n                if (this.trigger('insertColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookDeleteRow: function (e) {\n                if (this.trigger('deleteRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookDeleteColumn: function (e) {\n                if (this.trigger('deleteColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookHideRow: function (e) {\n                if (this.trigger('hideRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookHideColumn: function (e) {\n                if (this.trigger('hideColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookUnhideRow: function (e) {\n                if (this.trigger('unhideRow', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookUnhideColumn: function (e) {\n                if (this.trigger('unhideColumn', e)) {\n                    e.preventDefault();\n                }\n            },\n            _workbookSelect: function (e) {\n                this.trigger('select', e);\n            },\n            _workbookChangeFormat: function (e) {\n                this.trigger('changeFormat', e);\n            },\n            _bindWorkbookEvents: function () {\n                this._workbook.bind('cut', this._workbookCut.bind(this));\n                this._workbook.bind('copy', this._workbookCopy.bind(this));\n                this._workbook.bind('paste', this._workbookPaste.bind(this));\n                this._workbook.bind('change', this._workbookChange.bind(this));\n                this._workbook.bind('excelExport', this._workbookExcelExport.bind(this));\n                this._workbook.bind('excelImport', this._workbookExcelImport.bind(this));\n                this._workbook.bind('pdfExport', this._workbookPdfExport.bind(this));\n                this._workbook.bind('insertSheet', this._workbookInsertSheet.bind(this));\n                this._workbook.bind('removeSheet', this._workbookRemoveSheet.bind(this));\n                this._workbook.bind('selectSheet', this._workbookSelectSheet.bind(this));\n                this._workbook.bind('renameSheet', this._workbookRenameSheet.bind(this));\n                this._workbook.bind('insertRow', this._workbookInsertRow.bind(this));\n                this._workbook.bind('insertColumn', this._workbookInsertColumn.bind(this));\n                this._workbook.bind('deleteRow', this._workbookDeleteRow.bind(this));\n                this._workbook.bind('deleteColumn', this._workbookDeleteColumn.bind(this));\n                this._workbook.bind('hideRow', this._workbookHideRow.bind(this));\n                this._workbook.bind('hideColumn', this._workbookHideColumn.bind(this));\n                this._workbook.bind('unhideRow', this._workbookUnhideRow.bind(this));\n                this._workbook.bind('unhideColumn', this._workbookUnhideColumn.bind(this));\n                this._workbook.bind('select', this._workbookSelect.bind(this));\n                this._workbook.bind('changeFormat', this._workbookChangeFormat.bind(this));\n            },\n            destroy: function () {\n                kendo.ui.Widget.fn.destroy.call(this);\n                this._workbook.destroy();\n                this._controller.destroy();\n                this._view.destroy();\n                if (this._resizeHandler) {\n                    $(window).off('resize' + NS, this._resizeHandler);\n                }\n            },\n            options: {\n                name: 'Spreadsheet',\n                toolbar: true,\n                sheetsbar: true,\n                rows: 200,\n                columns: 50,\n                rowHeight: 20,\n                columnWidth: 64,\n                headerHeight: 20,\n                headerWidth: 32,\n                excel: {\n                    proxyURL: '',\n                    fileName: 'Workbook.xlsx'\n                },\n                messages: {},\n                pdf: {\n                    area: 'workbook',\n                    fileName: 'Workbook.pdf',\n                    proxyURL: '',\n                    paperSize: 'a4',\n                    landscape: true,\n                    margin: null,\n                    title: null,\n                    author: null,\n                    subject: null,\n                    keywords: null,\n                    creator: 'Kendo UI PDF Generator v.' + kendo.version,\n                    date: null\n                },\n                defaultCellStyle: {\n                    fontFamily: 'Arial',\n                    fontSize: '12'\n                }\n            },\n            defineName: function (name, value, hidden) {\n                return this._workbook.defineName(name, value, hidden);\n            },\n            undefineName: function (name) {\n                return this._workbook.undefineName(name);\n            },\n            nameValue: function (name) {\n                return this._workbook.nameValue(name);\n            },\n            forEachName: function (func) {\n                return this._workbook.forEachName(func);\n            },\n            cellContextMenu: function () {\n                return this._view.cellContextMenu;\n            },\n            rowHeaderContextMenu: function () {\n                return this._view.rowHeaderContextMenu;\n            },\n            colHeaderContextMenu: function () {\n                return this._view.colHeaderContextMenu;\n            },\n            events: [\n                'cut',\n                'copy',\n                'paste',\n                'pdfExport',\n                'excelExport',\n                'excelImport',\n                'change',\n                'render',\n                'removeSheet',\n                'selectSheet',\n                'renameSheet',\n                'insertRow',\n                'insertColumn',\n                'deleteRow',\n                'insertSheet',\n                'deleteColumn',\n                'hideRow',\n                'hideColumn',\n                'unhideRow',\n                'unhideColumn',\n                'select',\n                'changeFormat'\n            ]\n        });\n        kendo.spreadsheet.ALL_REASONS = ALL_REASONS;\n        kendo.ui.plugin(Spreadsheet);\n        $.extend(true, Spreadsheet, { classNames: classNames });\n    }(window.kendo));\n    return window.kendo;\n}, typeof define == 'function' && define.amd ? define : function (a1, a2, a3) {\n    (a3 || a2)();\n}));"]}